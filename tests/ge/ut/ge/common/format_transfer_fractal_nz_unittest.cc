/**
 * Copyright (c) 2025 Huawei Technologies Co., Ltd.
 * This program is free software, you can redistribute it and/or modify it under the terms and conditions of 
 * CANN Open Software License Agreement Version 2.0 (the "License").
 * Please refer to the License for details. You may not use this file except in compliance with the License.
 * THIS SOFTWARE IS PROVIDED ON AN "AS IS" BASIS, WITHOUT WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED, 
 * INCLUDING BUT NOT LIMITED TO NON-INFRINGEMENT, MERCHANTABILITY, OR FITNESS FOR A PARTICULAR PURPOSE.
 * See LICENSE in the root of the software repository for the full text of the License.
 */

#include <gtest/gtest.h>
#include <ctime>

#include "formats/format_transfers/format_transfer_fractal_nz.h"
#include "formats/formats.h"
#include "time.h"
#include "framework/common/ge_inner_error_codes.h"

namespace ge {
namespace formats {
class UtestFormatTransferNdFractNz : public testing::Test {
 protected:
  void SetUp() {}
  void TearDown() {}
};

TEST_F(UtestFormatTransferNdFractNz, nd_shape4_fp16) {
  uint16_t data[2 * 2 * 17 * 4] = {
      12210, 13522, 12430, 13868, 14463, 12261, 12394, 15327, 14988, 14663, 14310, 12308, 14886, 15036, 13655, 12774,
      13715, 13322, 13198, 14931, 14944, 10231, 14824, 14512, 14493, 14936, 14513, 14481, 13061, 14808, 14637, 13011,
      15351, 15277, 13709, 9313,  14684, 14460, 14576, 13978, 14945, 13652, 14162, 12974, 11122, 15207, 14677, 12431,
      14361, 14347, 14675, 12983, 14020, 13429, 13678, 14861, 14016, 13590, 13322, 9523,  10130, 15338, 11862, 15194,
      14545, 14488, 14159, 15192, 13563, 14782, 13852, 7998,  14920, 12686, 14363, 13754, 14350, 13814, 15258, 14156,
      14198, 14849, 13955, 15126, 13663, 14033, 14483, 12880, 14765, 12977, 14017, 14881, 10395, 14950, 13676, 12497,
      11587, 13427, 14507, 12408, 14615, 12010, 14586, 13531, 9126,  14077, 12947, 13723, 15185, 15262, 15288, 14608,
      15211, 13514, 12745, 14905, 14579, 14199, 14990, 15012, 13932, 13096, 13995, 10413, 9657,  13398, 15304, 10993,
      13516, 14415, 11920, 13584, 13772, 15204, 14925, 14462, 12207, 14373, 14882, 10069, 13641, 12941, 13577, 13330,
      14191, 13926, 13325, 13662, 13478, 14251, 13212, 15161, 14471, 14691, 13904, 12831, 14277, 14566, 14577, 14575,
      12646, 15218, 13438, 13827, 15323, 15245, 12022, 13928, 13358, 15286, 14556, 14414, 12664, 11754, 13737, 15360,
      14533, 14148, 15259, 14354, 14253, 15358, 13804, 13513, 14825, 13973, 14492, 14943, 15124, 14221, 13908, 12768,
      14923, 14801, 15134, 13681, 15313, 10562, 8965,  14670, 15028, 13264, 14901, 14973, 14120, 12946, 13663, 13418,
      9930,  15264, 13267, 11311, 14857, 15204, 14787, 14466, 11394, 14305, 14712, 11728, 14401, 13790, 15359, 15108,
      13342, 15088, 14348, 12047, 14544, 13244, 15299, 14790, 14565, 14827, 12551, 12386, 15074, 13453, 10206, 14530,
      14922, 11713, 14811, 12342, 14867, 13452, 12332, 11289, 15105, 14896, 15182, 14087, 11717, 14525, 12705, 15096,
      13561, 15094, 13168, 15007, 14888, 14556, 15156, 14829, 12482, 14449, 14379, 14233, 12640, 15000, 13268, 15342,
  };
  uint16_t ret[2 * 2 * 1 * 2 * 16 * 16] = {
      12210, 13522, 12430, 13868, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14463, 12261, 12394, 15327, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14988, 14663, 14310, 12308, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14886, 15036, 13655, 12774, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13715, 13322, 13198, 14931, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14944, 10231, 14824, 14512, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14493, 14936, 14513, 14481, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13061, 14808, 14637, 13011, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15351, 15277, 13709, 9313,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14684, 14460, 14576, 13978, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14945, 13652, 14162, 12974, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11122, 15207, 14677, 12431, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14361, 14347, 14675, 12983, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14020, 13429, 13678, 14861, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14016, 13590, 13322, 9523,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      10130, 15338, 11862, 15194, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14545, 14488, 14159, 15192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13563, 14782, 13852, 7998,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14920, 12686, 14363, 13754, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14350, 13814, 15258, 14156, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14198, 14849, 13955, 15126, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13663, 14033, 14483, 12880, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14765, 12977, 14017, 14881, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      10395, 14950, 13676, 12497, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11587, 13427, 14507, 12408, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14615, 12010, 14586, 13531, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      9126,  14077, 12947, 13723, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15185, 15262, 15288, 14608, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15211, 13514, 12745, 14905, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14579, 14199, 14990, 15012, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13932, 13096, 13995, 10413, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      9657,  13398, 15304, 10993, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13516, 14415, 11920, 13584, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13772, 15204, 14925, 14462, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12207, 14373, 14882, 10069, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13641, 12941, 13577, 13330, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14191, 13926, 13325, 13662, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13478, 14251, 13212, 15161, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14471, 14691, 13904, 12831, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14277, 14566, 14577, 14575, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12646, 15218, 13438, 13827, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15323, 15245, 12022, 13928, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13358, 15286, 14556, 14414, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12664, 11754, 13737, 15360, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14533, 14148, 15259, 14354, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14253, 15358, 13804, 13513, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14825, 13973, 14492, 14943, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15124, 14221, 13908, 12768, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14923, 14801, 15134, 13681, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15313, 10562, 8965,  14670, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15028, 13264, 14901, 14973, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14120, 12946, 13663, 13418, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      9930,  15264, 13267, 11311, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14857, 15204, 14787, 14466, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11394, 14305, 14712, 11728, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14401, 13790, 15359, 15108, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13342, 15088, 14348, 12047, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14544, 13244, 15299, 14790, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14565, 14827, 12551, 12386, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15074, 13453, 10206, 14530, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14922, 11713, 14811, 12342, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14867, 13452, 12332, 11289, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15105, 14896, 15182, 14087, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11717, 14525, 12705, 15096, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13561, 15094, 13168, 15007, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14888, 14556, 15156, 14829, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12482, 14449, 14379, 14233, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12640, 15000, 13268, 15342, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  };

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_ND, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_ND, FORMAT_FRACTAL_NZ, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 17, 4}, {2, 2, 1, 2, 16, 16}, DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(TransDataFormat(args, result), SUCCESS);
  EXPECT_EQ(result.length, sizeof(ret) / sizeof(ret[0]) * 2);
  for (size_t i = 0U; i < sizeof(ret) / sizeof(ret[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<uint16_t *>(result.data.get()))[i], ret[i]);
  }
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            SUCCESS);

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_ND, FORMAT_RESERVED, 5));
  TransArgs args2{
      reinterpret_cast<uint8_t *>(ret), src_format2, dst_format2, FORMAT_FRACTAL_NZ, FORMAT_ND, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 1, 2, 16, 16}, {2, 2, 17, 4}, DT_FLOAT16};
  TransResult result2;
  FormatTransferFractalNzND transfer2;
  EXPECT_EQ(TransDataFormat(args2, result2), SUCCESS);
  EXPECT_EQ(result2.length, sizeof(data) / sizeof(data[0]) * 2);
  for (size_t i = 0U; i < sizeof(data) / sizeof(data[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<uint16_t *>(result2.data.get()))[i], data[i]);
  }
  EXPECT_EQ(
      transfer2.TransShape(args2.src_format, args2.src_shape, args2.src_data_type, args2.dst_format, args2.dst_shape),
                           ACL_ERROR_GE_FORMAT_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, nd_shape5_fp16) {
  uint16_t data[2 * 2 * 2 * 17 * 4] = {
      13556, 15090, 13431, 15346, 14703, 12989, 14001, 12860, 13575, 12502, 14798, 15138, 14631, 12157, 14835, 15238,
      12694, 15169, 15085, 14099, 14607, 12480, 14215, 13775, 14927, 11856, 15337, 14506, 14543, 7807,  14832, 10676,
      13073, 13826, 14517, 14412, 13708, 14177, 15000, 13601, 13602, 13334, 12356, 14735, 12911, 13328, 15254, 10387,
      15178, 14461, 14904, 10405, 14517, 15036, 15269, 11255, 11794, 14079, 13985, 14900, 15348, 14743, 10052, 13384,
      15316, 15335, 14157, 13419, 11505, 13544, 12810, 14669, 12757, 15333, 14752, 15037, 15145, 13280, 13592, 10910,
      14744, 13751, 12814, 14982, 14472, 15305, 14934, 15110, 14994, 15006, 14992, 15265, 11530, 14069, 15037, 8437,
      14039, 15081, 12730, 14487, 15310, 13424, 14573, 12558, 14849, 14986, 11413, 13644, 12642, 13521, 13799, 14189,
      11610, 14352, 14088, 13861, 14593, 14717, 14329, 13764, 13170, 13856, 13098, 14325, 14698, 14849, 12469, 14720,
      14304, 14576, 14982, 14447, 14757, 12881, 13558, 14911, 14554, 14337, 14352, 14555, 14389, 12870, 13010, 13167,
      13268, 14942, 14911, 15197, 8206,  14737, 14671, 14054, 14813, 12949, 14572, 15021, 12855, 13987, 12985, 14355,
      15062, 13801, 14908, 12510, 13709, 15026, 12941, 15232, 13479, 15154, 14795, 14828, 13822, 13856, 14727, 12783,
      13970, 14933, 15262, 14714, 11584, 12866, 15210, 14814, 11503, 14593, 15172, 14393, 10815, 13132, 14913, 14604,
      14181, 14879, 14672, 14774, 14897, 13458, 11012, 13005, 13111, 13352, 14459, 11855, 14548, 13371, 14764, 14338,
      13650, 13757, 12772, 15167, 13692, 14370, 15212, 14216, 13461, 10527, 14846, 15332, 14618, 14004, 13418, 15285,
      15229, 10738, 12875, 12084, 14031, 12661, 15150, 14428, 13571, 14880, 14502, 10309, 12040, 14806, 14822, 13210,
      14393, 14655, 15005, 13270, 14886, 10217, 14173, 13759, 14735, 12563, 12367, 10329, 14646, 12655, 14272, 12609,
      15237, 12138, 14607, 14227, 15165, 13831, 14258, 13192, 15224, 11343, 13923, 13314, 15272, 12291, 14374, 14475,
      14371, 13431, 13291, 12922, 10251, 13184, 13515, 14492, 14766, 14170, 12844, 11903, 13872, 14757, 14971, 14913,
      15144, 13792, 11809, 11480, 14205, 14657, 12875, 15073, 13630, 13329, 14373, 13506, 14163, 15304, 13232, 14395,
      14460, 13353, 15082, 14870, 12710, 13103, 13336, 12321, 12647, 15168, 14898, 13728, 12686, 14789, 15240, 14579,
      14397, 15174, 14279, 14121, 11157, 14978, 13277, 12842, 14598, 15286, 13462, 14271, 14094, 14960, 13514, 14075,
      12637, 14892, 14818, 15027, 15014, 15357, 14838, 14989, 12848, 15091, 13763, 13669, 15239, 14462, 14615, 15082,
      14330, 13958, 14246, 15207, 14803, 15161, 12998, 13896, 12147, 14778, 15046, 13333, 14858, 15355, 15162, 12372,
      13517, 13776, 14294, 14426, 14045, 14515, 13986, 14662, 14177, 14523, 13650, 15292, 14592, 14360, 14693, 14678,
      13446, 14333, 11799, 12098, 8510,  10784, 13598, 14546, 14495, 12675, 13347, 8987,  13801, 12245, 10710, 15308,
      15007, 10601, 15296, 13662, 11378, 13952, 13798, 12348, 11870, 13585, 14267, 14469, 14754, 13968, 14876, 14450,
      15165, 14067, 14933, 12365, 15338, 14738, 13092, 13725, 14389, 14073, 14400, 13726, 15150, 14789, 15266, 15153,
      15205, 14654, 14273, 9239,  15187, 14684, 12777, 14878, 8817,  15316, 14618, 14897, 14279, 14911, 15207, 12417,
      15259, 14703, 14236, 15065, 14220, 11487, 15283, 14223, 15250, 15049, 14920, 15189, 14776, 13008, 15171, 15003,
      13927, 13856, 14854, 12342, 15219, 13735, 15170, 15203, 13618, 11929, 14821, 15149, 15123, 14251, 14990, 11703,
      14754, 13892, 13407, 13905, 14442, 14741, 14178, 13100, 15285, 13124, 15017, 15054, 14027, 13320, 13337, 15204,
      13910, 13596, 14558, 14393, 14669, 13791, 14094, 14617, 13563, 15187, 13985, 11905, 14285, 14040, 11892, 12635,
      14749, 15181, 14808, 12451, 14639, 15123, 14346, 15036, 12163, 15157, 14339, 13836, 14722, 14431, 14497, 13198,
      11770, 11317, 13766, 14760, 14773, 14848, 14593, 13575, 11623, 14680, 13875, 14539, 14379, 14348, 15332, 14475,
  };
  uint16_t ret[2 * 2 * 2 * 1 * 2 * 16 * 16] = {
      13556, 15090, 13431, 15346, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14703, 12989, 14001, 12860, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13575, 12502, 14798, 15138, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14631, 12157, 14835, 15238, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12694, 15169, 15085, 14099, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14607, 12480, 14215, 13775, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14927, 11856, 15337, 14506, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14543, 7807,  14832, 10676, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13073, 13826, 14517, 14412, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13708, 14177, 15000, 13601, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13602, 13334, 12356, 14735, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12911, 13328, 15254, 10387, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15178, 14461, 14904, 10405, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14517, 15036, 15269, 11255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11794, 14079, 13985, 14900, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15348, 14743, 10052, 13384, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15316, 15335, 14157, 13419, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11505, 13544, 12810, 14669, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12757, 15333, 14752, 15037, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15145, 13280, 13592, 10910, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14744, 13751, 12814, 14982, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14472, 15305, 14934, 15110, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14994, 15006, 14992, 15265, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11530, 14069, 15037, 8437,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14039, 15081, 12730, 14487, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15310, 13424, 14573, 12558, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14849, 14986, 11413, 13644, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12642, 13521, 13799, 14189, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11610, 14352, 14088, 13861, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14593, 14717, 14329, 13764, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13170, 13856, 13098, 14325, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14698, 14849, 12469, 14720, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14304, 14576, 14982, 14447, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14757, 12881, 13558, 14911, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14554, 14337, 14352, 14555, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14389, 12870, 13010, 13167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13268, 14942, 14911, 15197, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      8206,  14737, 14671, 14054, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14813, 12949, 14572, 15021, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12855, 13987, 12985, 14355, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15062, 13801, 14908, 12510, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13709, 15026, 12941, 15232, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13479, 15154, 14795, 14828, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13822, 13856, 14727, 12783, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13970, 14933, 15262, 14714, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11584, 12866, 15210, 14814, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11503, 14593, 15172, 14393, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      10815, 13132, 14913, 14604, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14181, 14879, 14672, 14774, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14897, 13458, 11012, 13005, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13111, 13352, 14459, 11855, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14548, 13371, 14764, 14338, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13650, 13757, 12772, 15167, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13692, 14370, 15212, 14216, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13461, 10527, 14846, 15332, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14618, 14004, 13418, 15285, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15229, 10738, 12875, 12084, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14031, 12661, 15150, 14428, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13571, 14880, 14502, 10309, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12040, 14806, 14822, 13210, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14393, 14655, 15005, 13270, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14886, 10217, 14173, 13759, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14735, 12563, 12367, 10329, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14646, 12655, 14272, 12609, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15237, 12138, 14607, 14227, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15165, 13831, 14258, 13192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15224, 11343, 13923, 13314, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15272, 12291, 14374, 14475, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14371, 13431, 13291, 12922, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      10251, 13184, 13515, 14492, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14766, 14170, 12844, 11903, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13872, 14757, 14971, 14913, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15144, 13792, 11809, 11480, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14205, 14657, 12875, 15073, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13630, 13329, 14373, 13506, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14163, 15304, 13232, 14395, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14460, 13353, 15082, 14870, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12710, 13103, 13336, 12321, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12647, 15168, 14898, 13728, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12686, 14789, 15240, 14579, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14397, 15174, 14279, 14121, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11157, 14978, 13277, 12842, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14598, 15286, 13462, 14271, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14094, 14960, 13514, 14075, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12637, 14892, 14818, 15027, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15014, 15357, 14838, 14989, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12848, 15091, 13763, 13669, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15239, 14462, 14615, 15082, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14330, 13958, 14246, 15207, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14803, 15161, 12998, 13896, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12147, 14778, 15046, 13333, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14858, 15355, 15162, 12372, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13517, 13776, 14294, 14426, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14045, 14515, 13986, 14662, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14177, 14523, 13650, 15292, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14592, 14360, 14693, 14678, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13446, 14333, 11799, 12098, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      8510,  10784, 13598, 14546, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14495, 12675, 13347, 8987,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13801, 12245, 10710, 15308, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15007, 10601, 15296, 13662, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11378, 13952, 13798, 12348, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11870, 13585, 14267, 14469, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14754, 13968, 14876, 14450, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15165, 14067, 14933, 12365, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15338, 14738, 13092, 13725, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14389, 14073, 14400, 13726, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15150, 14789, 15266, 15153, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15205, 14654, 14273, 9239,  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15187, 14684, 12777, 14878, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      8817,  15316, 14618, 14897, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14279, 14911, 15207, 12417, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15259, 14703, 14236, 15065, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14220, 11487, 15283, 14223, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15250, 15049, 14920, 15189, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14776, 13008, 15171, 15003, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13927, 13856, 14854, 12342, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15219, 13735, 15170, 15203, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13618, 11929, 14821, 15149, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15123, 14251, 14990, 11703, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14754, 13892, 13407, 13905, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14442, 14741, 14178, 13100, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      15285, 13124, 15017, 15054, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14027, 13320, 13337, 15204, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13910, 13596, 14558, 14393, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14669, 13791, 14094, 14617, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      13563, 15187, 13985, 11905, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14285, 14040, 11892, 12635, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14749, 15181, 14808, 12451, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14639, 15123, 14346, 15036, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      12163, 15157, 14339, 13836, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14722, 14431, 14497, 13198, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11770, 11317, 13766, 14760, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14773, 14848, 14593, 13575, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      11623, 14680, 13875, 14539, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      14379, 14348, 15332, 14475, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
      0,     0,     0,     0,     0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
  };

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_ND, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_ND, FORMAT_FRACTAL_NZ, FORMAT_RESERVED,
                 FORMAT_RESERVED, 16, 16, {2, 2, 2, 17, 4},
                 {2, 2, 2, 1, 2, 16, 16}, DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(TransDataFormat(args, result), SUCCESS);
  EXPECT_EQ(result.length, sizeof(ret) / sizeof(ret[0]) * 2);
  for (size_t i = 0U; i < sizeof(ret) / sizeof(ret[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<uint16_t *>(result.data.get()))[i], ret[i]);
  }
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            SUCCESS);

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_ND, FORMAT_RESERVED, 5));
  TransArgs args2{reinterpret_cast<uint8_t *>(ret), src_format2, dst_format2, FORMAT_FRACTAL_NZ, FORMAT_ND,
                  FORMAT_RESERVED, FORMAT_RESERVED, 16, 16, {2, 2, 2, 1, 2, 16, 16}, {2, 2, 2, 17, 4},  DT_FLOAT16};
  TransResult result2;
  FormatTransferFractalNzND transfer2;
  EXPECT_EQ(TransDataFormat(args2, result2), SUCCESS);
  EXPECT_EQ(result2.length, sizeof(data) / sizeof(data[0]) * 2);
  for (size_t i = 0U; i < sizeof(data) / sizeof(data[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<uint16_t *>(result2.data.get()))[i], data[i]);
  }
}

TEST_F(UtestFormatTransferNdFractNz, nd_shape4_fp32) {
  float data[2 * 2 * 17 * 4] = {
      0.24017745833005677,   0.7908338513866925,   0.5051460913827948,   0.9212520685117512,   0.4329735845708327,
      0.9207470159046747,    0.05926231862060216,  0.76990655686985,     0.7223645626864388,   0.43501433129012024,
      0.40570186933951713,   0.702542637118438,    0.773774946386804,    0.04265471007054322,  0.2989896038480955,
      0.4033603882338742,    0.34393668393267907,  0.5850246556661213,   0.6750891081060844,   0.3559427848582608,
      0.43614052169082185,   0.6908271139843668,   0.5897294883672143,   0.35488198940932736,  0.4682340192505966,
      0.9113037459116056,    0.7443829866997046,   0.89433687460791,     0.31510061278863843,  0.20044500575711433,
      0.28142410758015657,   0.4517900601137299,   0.6351885056619392,   0.8974159512127593,   0.3331668058021574,
      0.11222970046456449,   0.8732340412519595,   0.2148878909636669,   0.33598072192817896,  0.5817085292780417,
      0.14893294317017536,   0.5551645528327099,   0.9796426641977305,   0.9568166955425949,   0.7718066236111724,
      0.6300751765176865,    0.8497117123321973,   0.3534708093622494,   0.7657382003166453,   0.587899478133755,
      0.7784779515613647,    0.4015232698113339,   0.9254034195951792,   0.9806776040632871,   0.7398963961756377,
      0.4717105017726926,    0.13075121515420907,  0.26501153374416997,  0.4592668571870513,   0.38083145381689754,
      0.5048080389976721,    0.8316384355591627,   0.016176084697146043, 0.3500580014319852,   0.2494321620580643,
      0.8363651463924084,    0.39040381268116464,  0.41421765968696656,  0.2296129377253905,   0.3795273985435502,
      0.49840831219300297,   0.5660689163115291,   0.5410166356568628,   0.2932118573951793,   0.7231596801124212,
      0.7615642755162464,    0.5700242312079427,   0.015282443180747451, 0.6074141579987347,   0.606840341727317,
      0.7958320122497057,    0.46657383708965916,  0.9198103681172877,   0.7466699920139369,   0.8798355998800057,
      0.5490826769093224,    0.1569764914287578,   0.631652567858096,    0.07538015959634248,  0.30771430912374564,
      0.801341360218133,     0.4112029724744082,   0.24872460704563282,  0.7988220100765487,   0.8956893776310078,
      0.3523457305677019,    0.7607249251896161,   0.9508908308534454,   0.9844149475432433,   0.46137662395819556,
      0.3361994725719326,    0.910215423356587,    0.8514253530131357,   0.18564786925351284,  0.031197422157041577,
      0.32088308811207233,   0.5268494210366956,   0.37652532271007444,  0.018319746627926126, 0.6805316533631041,
      0.6637986306311675,    0.8682215174258817,   0.9928743926162217,   0.11762205726513975,  0.6195005538182846,
      0.573208212736639,     0.5325639815459885,   0.8685720994574258,   0.30416206083796893,  0.29375443689500746,
      0.722600953459129,     0.060879922974677037, 0.5516867775841858,   0.7282801588163559,   0.1544836784918584,
      0.41799093214709193,   0.980749303446289,    0.43370624352513687,  0.36172612101052615,  0.3028306626687869,
      0.2230506430289495,    0.05431581276922193,  0.7968231625249534,   0.8068938615817157,   0.45578821844224493,
      0.0018389569240472303, 0.12845645761430868,  0.43174872314200496,  0.19019706886091625,  0.7206755294822818,
      0.31089686267676875,   0.34478094342047017,  0.20388910753878797,  0.9013725029423029,   0.20172359299220255,
      0.1629922568981731,    0.6954990727866708,   0.26497630445509435,  0.12379402401488193,  0.6447543753857757,
      0.32969746233649067,   0.4546871355393207,   0.9032509525867825,   0.9858786808247757,   0.4862602610112142,
      0.08219085113577962,   0.7870912428425353,   0.9013772471762193,   0.09947185442909168,  0.8752347829007687,
      0.39322080280348903,   0.38553330390114127,  0.815521169321101,    0.25465238460393447,  0.7719638078574547,
      0.3681634855586098,    0.12917191531069916,  0.8782893607825132,   0.31538202975647667,  0.11060152128642453,
      0.8877996039186895,    0.6277653065585466,   0.788572654306122,    0.8473770431762598,   0.06733131234431977,
      0.8257265623261241,    0.7358077509239135,   0.6897284238471844,   0.16316388905274182,  0.6419388952410704,
      0.46373928769713935,   0.22624570338477634,  0.8344650905883917,   0.5220387776690497,   0.8223957140404234,
      0.8522442229878241,    0.914872169915326,    0.9507088797212623,   0.5886632711634477,   0.18329757039598793,
      0.43052254564266745,   0.3273224327191193,   0.7027336757262003,   0.6825647115162772,   0.9175905076205535,
      0.5938919379015825,    0.05279831332678442,  0.9610878906434714,   0.8151949508556603,   0.9200058002592004,
      0.4101544181795893,    0.09912168423937695,  0.17364500943816064,  0.4429247543426651,   0.14062873380913987,
      0.23738371369937172,   0.4938182494622466,   0.28673035611440445,  0.6816179119575762,   0.5172878882496988,
      0.7506142571467134,    0.32139544952437704,  0.3032752890874719,   0.8444155718538534,   0.8331913949169982,
      0.5432084580245907,    0.07799994151132295,  0.6807639318778701,   0.22042219816817854,  0.9407382759228957,
      0.847128737153653,     0.393277915570015,    0.36572620008744783,  0.9932234924651848,   0.980452452787659,
      0.09199460655585212,   0.2040881385507629,   0.6416200216420471,   0.3163820661665575,   0.0178114452425554,
      0.19209600193274623,   0.56386270765364,     0.5883501002605002,   0.047290373739652725, 0.9429035695153023,
      0.29861798784711935,   0.8987397733067158,   0.31081233810078046,  0.32273697333672224,  0.6123857767652331,
      0.47907753776865447,   0.38230796360390273,  0.015510368346530967, 0.10606747306100672,  0.5930796121652361,
      0.3716827365867703,    0.6965466612015544,   0.9129958695419979,   0.13740941341338297,  0.6057045902472779,
      0.795600140320669,     0.9353438814017689,   0.7814345681667847,   0.6606618076700961,   0.15167442010087617,
      0.3024865384516856,    0.4121791513857548,   0.8073450149573994,   0.16939447194962576,  0.05472329091313577,
      0.7853320936770362,    0.7413721006805821,   0.7875008545125217,   0.949175848170841,    0.13480031206099008,
      0.6583276122829612,    0.3606029738996872,   0.3139689644221102,   0.18118778976359917,  0.5639618456607737,
      0.8471462699161201,    0.5527251348233345,
  };
  float ret[2 * 2 * 1 * 2 * 16 * 16] = {
      0.24017745833005677,
      0.7908338513866925,
      0.5051460913827948,
      0.9212520685117512,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4329735845708327,
      0.9207470159046747,
      0.05926231862060216,
      0.76990655686985,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7223645626864388,
      0.43501433129012024,
      0.40570186933951713,
      0.702542637118438,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.773774946386804,
      0.04265471007054322,
      0.2989896038480955,
      0.4033603882338742,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.34393668393267907,
      0.5850246556661213,
      0.6750891081060844,
      0.3559427848582608,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.43614052169082185,
      0.6908271139843668,
      0.5897294883672143,
      0.35488198940932736,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4682340192505966,
      0.9113037459116056,
      0.7443829866997046,
      0.89433687460791,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.31510061278863843,
      0.20044500575711433,
      0.28142410758015657,
      0.4517900601137299,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6351885056619392,
      0.8974159512127593,
      0.3331668058021574,
      0.11222970046456449,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8732340412519595,
      0.2148878909636669,
      0.33598072192817896,
      0.5817085292780417,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.14893294317017536,
      0.5551645528327099,
      0.9796426641977305,
      0.9568166955425949,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7718066236111724,
      0.6300751765176865,
      0.8497117123321973,
      0.3534708093622494,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7657382003166453,
      0.587899478133755,
      0.7784779515613647,
      0.4015232698113339,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9254034195951792,
      0.9806776040632871,
      0.7398963961756377,
      0.4717105017726926,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.13075121515420907,
      0.26501153374416997,
      0.4592668571870513,
      0.38083145381689754,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5048080389976721,
      0.8316384355591627,
      0.016176084697146043,
      0.3500580014319852,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2494321620580643,
      0.8363651463924084,
      0.39040381268116464,
      0.41421765968696656,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2296129377253905,
      0.3795273985435502,
      0.49840831219300297,
      0.5660689163115291,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5410166356568628,
      0.2932118573951793,
      0.7231596801124212,
      0.7615642755162464,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5700242312079427,
      0.015282443180747451,
      0.6074141579987347,
      0.606840341727317,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7958320122497057,
      0.46657383708965916,
      0.9198103681172877,
      0.7466699920139369,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8798355998800057,
      0.5490826769093224,
      0.1569764914287578,
      0.631652567858096,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.07538015959634248,
      0.30771430912374564,
      0.801341360218133,
      0.4112029724744082,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.24872460704563282,
      0.7988220100765487,
      0.8956893776310078,
      0.3523457305677019,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7607249251896161,
      0.9508908308534454,
      0.9844149475432433,
      0.46137662395819556,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3361994725719326,
      0.910215423356587,
      0.8514253530131357,
      0.18564786925351284,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.031197422157041577,
      0.32088308811207233,
      0.5268494210366956,
      0.37652532271007444,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.018319746627926126,
      0.6805316533631041,
      0.6637986306311675,
      0.8682215174258817,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9928743926162217,
      0.11762205726513975,
      0.6195005538182846,
      0.573208212736639,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5325639815459885,
      0.8685720994574258,
      0.30416206083796893,
      0.29375443689500746,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.722600953459129,
      0.060879922974677037,
      0.5516867775841858,
      0.7282801588163559,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.1544836784918584,
      0.41799093214709193,
      0.980749303446289,
      0.43370624352513687,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.36172612101052615,
      0.3028306626687869,
      0.2230506430289495,
      0.05431581276922193,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7968231625249534,
      0.8068938615817157,
      0.45578821844224493,
      0.0018389569240472303,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.12845645761430868,
      0.43174872314200496,
      0.19019706886091625,
      0.7206755294822818,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.31089686267676875,
      0.34478094342047017,
      0.20388910753878797,
      0.9013725029423029,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.20172359299220255,
      0.1629922568981731,
      0.6954990727866708,
      0.26497630445509435,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.12379402401488193,
      0.6447543753857757,
      0.32969746233649067,
      0.4546871355393207,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9032509525867825,
      0.9858786808247757,
      0.4862602610112142,
      0.08219085113577962,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7870912428425353,
      0.9013772471762193,
      0.09947185442909168,
      0.8752347829007687,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.39322080280348903,
      0.38553330390114127,
      0.815521169321101,
      0.25465238460393447,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7719638078574547,
      0.3681634855586098,
      0.12917191531069916,
      0.8782893607825132,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.31538202975647667,
      0.11060152128642453,
      0.8877996039186895,
      0.6277653065585466,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.788572654306122,
      0.8473770431762598,
      0.06733131234431977,
      0.8257265623261241,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7358077509239135,
      0.6897284238471844,
      0.16316388905274182,
      0.6419388952410704,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.46373928769713935,
      0.22624570338477634,
      0.8344650905883917,
      0.5220387776690497,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8223957140404234,
      0.8522442229878241,
      0.914872169915326,
      0.9507088797212623,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5886632711634477,
      0.18329757039598793,
      0.43052254564266745,
      0.3273224327191193,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7027336757262003,
      0.6825647115162772,
      0.9175905076205535,
      0.5938919379015825,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.05279831332678442,
      0.9610878906434714,
      0.8151949508556603,
      0.9200058002592004,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4101544181795893,
      0.09912168423937695,
      0.17364500943816064,
      0.4429247543426651,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.14062873380913987,
      0.23738371369937172,
      0.4938182494622466,
      0.28673035611440445,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6816179119575762,
      0.5172878882496988,
      0.7506142571467134,
      0.32139544952437704,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3032752890874719,
      0.8444155718538534,
      0.8331913949169982,
      0.5432084580245907,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.07799994151132295,
      0.6807639318778701,
      0.22042219816817854,
      0.9407382759228957,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.847128737153653,
      0.393277915570015,
      0.36572620008744783,
      0.9932234924651848,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.980452452787659,
      0.09199460655585212,
      0.2040881385507629,
      0.6416200216420471,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3163820661665575,
      0.0178114452425554,
      0.19209600193274623,
      0.56386270765364,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5883501002605002,
      0.047290373739652725,
      0.9429035695153023,
      0.29861798784711935,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8987397733067158,
      0.31081233810078046,
      0.32273697333672224,
      0.6123857767652331,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.47907753776865447,
      0.38230796360390273,
      0.015510368346530967,
      0.10606747306100672,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5930796121652361,
      0.3716827365867703,
      0.6965466612015544,
      0.9129958695419979,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.13740941341338297,
      0.6057045902472779,
      0.795600140320669,
      0.9353438814017689,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7814345681667847,
      0.6606618076700961,
      0.15167442010087617,
      0.3024865384516856,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4121791513857548,
      0.8073450149573994,
      0.16939447194962576,
      0.05472329091313577,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7853320936770362,
      0.7413721006805821,
      0.7875008545125217,
      0.949175848170841,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.13480031206099008,
      0.6583276122829612,
      0.3606029738996872,
      0.3139689644221102,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.18118778976359917,
      0.5639618456607737,
      0.8471462699161201,
      0.5527251348233345,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
  };

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_ND, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_ND, FORMAT_FRACTAL_NZ, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 17, 4}, {2, 2, 1, 2, 16, 16}, DT_FLOAT};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(TransDataFormat(args, result), SUCCESS);
  EXPECT_EQ(result.length, sizeof(ret) / sizeof(ret[0]) * 4);
  for (size_t i = 0U; i < sizeof(ret) / sizeof(ret[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<float *>(result.data.get()))[i], ret[i]);
  }
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            SUCCESS);

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_ND, FORMAT_RESERVED, 5));
  TransArgs args2{
      reinterpret_cast<uint8_t *>(ret), src_format2, dst_format2, FORMAT_FRACTAL_NZ, FORMAT_ND, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 1, 2, 16, 16}, {2, 2, 17, 4}, DT_FLOAT};
  TransResult result2;
  FormatTransferFractalNzND transfer2;
  EXPECT_EQ(TransDataFormat(args2, result2), SUCCESS);
  EXPECT_EQ(result2.length, sizeof(data) / sizeof(data[0]) * 4);
  for (size_t i = 0U; i < sizeof(data) / sizeof(data[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<float *>(result2.data.get()))[i], data[i]);
  }
  EXPECT_EQ(transfer2.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            ACL_ERROR_GE_FORMAT_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, nchw_shape4_fp32) {
  float data[2 * 2 * 17 * 4] = {
      0.5602121231402468,    0.12800383781971492,  0.5326714230167173,   0.6272243646573483,   0.02789503350921596,
      0.6760986699314114,    0.8240135711596471,   0.34248414683295103,  0.7280572978193823,   0.03408620931709949,
      0.17897548862797752,   0.049319216130346066, 0.5285626554498787,   0.6543935963248121,   0.9499835158011221,
      0.15696623695207612,   0.5518593327582763,   0.735480571158555,    0.27252722389251094,  0.5952131357932664,
      0.9342664862715897,    0.06807185097642088,  0.7986155333967675,   0.2940533147166918,   0.7717279809493778,
      0.06500681776149064,   0.40209523004375736,  0.6402504455119793,   0.7183356244742499,   0.8848092118855054,
      0.9623394724948869,    0.6404196604920734,   0.3129415157617603,   0.6566440258339626,   0.4829961676502589,
      0.9095794636705585,    0.38431275502739315,  0.6618934269256913,   0.016948846804644813, 0.8487902640408118,
      0.0019437036739571312, 0.9593039469007972,   0.7369345068397335,   0.8038376866300426,   0.23733142070927404,
      0.6766568636607861,    0.8791428417567961,   0.34970553354412104,  0.7767111731260719,   0.36939908341858885,
      0.8877771223343094,    0.16656518085775396,  0.40524411235449553,  0.5094980580412446,   0.42932740059809227,
      0.4806992101733476,    0.942893176736217,    0.7569186327365722,   0.43762218258484487,  0.5709277573723915,
      0.6626357139000086,    0.9388125948827755,   0.6922120795940312,   0.2802353109920688,   0.6384950189782832,
      0.8203631774543025,    0.4819185524506592,   0.5612388571573312,   0.7890794105898543,   0.026657068661979144,
      0.36745236086958255,   0.09421420582014717,  0.4125170256726969,   0.8372759010112841,   0.6858892915066466,
      0.055965911139327695,  0.733752513401978,    0.2860600524805865,   0.24581639133981414,  0.4657602259317729,
      0.9844669862500401,    0.04259392169423548,  0.2850934545160856,   0.6116234365122941,   0.8431280227198134,
      0.09330478841127465,   0.10738171141015296,  0.8058302145583697,   0.1887687053820234,   0.020772300699924195,
      0.2675743523191082,    0.509425440737449,    0.7454162260498424,   0.3601811686584533,   0.6356766970010271,
      0.08368780784222996,   0.7954204147818181,   0.6808861341529187,   0.9732894436382853,   0.028456208873444133,
      0.6898670482181255,    0.5602400644580263,   0.007835682106110964, 0.3126424433906586,   0.5461294624203212,
      0.24974364067650745,   0.3225823914937893,   0.5003866335569956,   0.661414559901519,    0.6611594211086985,
      0.0832376382837211,    0.6088151725555888,   0.31350612996189475,  0.6824719404358928,   0.8962030999552082,
      0.5898412128782159,    0.6192600820436853,   0.7065475830586582,   0.47775907849535804,  0.9872123954283326,
      0.5794892396998665,    0.9821886556152676,   0.5938251530775381,   0.30404687707509925,  0.03598332590135811,
      0.43853593213910447,   0.42005264249981566,  0.27092494528759103,  0.5857315286790321,   0.3453845905764671,
      0.38938830465869656,   0.2686851760469917,   0.6080813798369535,   0.8975830535375084,   0.16063980186497728,
      0.6586597679036962,    0.34853632098020637,  0.5222409587324605,   0.34629031735429283,  0.9571001776320724,
      0.22758512028439548,   0.4961198993089996,   0.7035427414896834,   0.9873475820942967,   0.9225755101854336,
      0.4345542179267431,    0.5826852296872961,   0.3959711566516181,   0.8959668161588287,   0.5781473185927918,
      0.15770465606442519,   0.2465330879179335,   0.9967009535833719,   0.7209513334268077,   0.3050224221409039,
      0.9219568626656348,    0.718546385528138,    0.21647873996460432,  0.9485312530824154,   0.7544823112339518,
      0.8793678793431775,    0.5321808027467093,   0.44421663094592234,  0.3540210579398514,   0.5201311798545218,
      0.42005202877685466,   0.9185755141210294,   0.2513817846312163,   0.2726794018274953,   0.4146719265832651,
      0.9556854071727073,    0.34185681700133563,  0.23008112912632606,  0.5530759925523093,   0.1287401965557975,
      0.9329184289796552,    0.597049889010525,    0.6117591325403197,   0.4119313490448945,   0.3232267846716024,
      0.20173136300954464,   0.6002148229523541,   0.7815012855520117,   0.28544406461634386,  0.8269928516978476,
      0.10932038205185535,   0.6143160563886838,   0.2184224010482163,   0.5522809330115714,   0.5677845896560437,
      0.8579879882249971,    0.6355837987328417,   0.04362984397169789,  0.7754836644431609,   0.1431977287912315,
      0.6092936034964014,    0.4596033225489746,   0.3592578817865715,   0.553616658068951,    0.19183381195695703,
      0.45079770418260423,   0.2799744643950717,   0.6432910866105234,   0.08411912299187807,  0.6745840838964664,
      0.07598087848264623,   0.8240250634502845,   0.36570374341381084,  0.006762919216348862, 0.7968845960590147,
      0.02514782044366326,   0.3068699746421577,   0.1138875791627122,   0.4292015547916156,   0.3153636011167973,
      0.9394545926418999,    0.5658737300910498,   0.5162676744048261,   0.06243779693597862,  0.6687945075056573,
      0.6108948588331585,    0.251069063724365,    0.9194382362252776,   0.427182897606301,    0.2859283493741377,
      0.47567202696913746,   0.4158263080352007,   0.13267581511787707,  0.7282071557718046,   0.1269283431875673,
      0.3225554819437485,    0.3474737724799578,   0.9174000239171781,   0.575526441418363,    0.6424082388100079,
      0.7795858447358935,    0.4961176629005909,   0.7783772378271568,   0.42736590566493216,  0.47753749552007785,
      0.1624392018841635,    0.028751267485759735, 0.32060419387936456,  0.9219882035969446,   0.8615631839985258,
      0.769906654883067,     0.8950660850360729,   0.5997750400061773,   0.7849875817664871,   0.4668319723460155,
      0.395114919896967,     0.8253563646816371,   0.07626413874831572,  0.11553536946297527,  0.5967093302357965,
      0.6250874863042443,    0.9295880168076048,   0.09201501553706759,  0.4002992747710562,   0.5020954829641272,
      0.8107293478061589,    0.7991328274514402,   0.14082794482093408,  0.19565070959320263,  0.8149919267700367,
      0.9462274058046314,    0.7109368887841762,   0.3664044938712081,   0.9577840290332994,   0.134161476174524,
      0.08818671344845908,   0.6137505449578752,
  };
  float ret[2 * 2 * 1 * 2 * 16 * 16] = {
      0.5602121231402468,
      0.12800383781971492,
      0.5326714230167173,
      0.6272243646573483,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.02789503350921596,
      0.6760986699314114,
      0.8240135711596471,
      0.34248414683295103,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7280572978193823,
      0.03408620931709949,
      0.17897548862797752,
      0.049319216130346066,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5285626554498787,
      0.6543935963248121,
      0.9499835158011221,
      0.15696623695207612,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5518593327582763,
      0.735480571158555,
      0.27252722389251094,
      0.5952131357932664,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9342664862715897,
      0.06807185097642088,
      0.7986155333967675,
      0.2940533147166918,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7717279809493778,
      0.06500681776149064,
      0.40209523004375736,
      0.6402504455119793,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7183356244742499,
      0.8848092118855054,
      0.9623394724948869,
      0.6404196604920734,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3129415157617603,
      0.6566440258339626,
      0.4829961676502589,
      0.9095794636705585,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.38431275502739315,
      0.6618934269256913,
      0.016948846804644813,
      0.8487902640408118,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0019437036739571312,
      0.9593039469007972,
      0.7369345068397335,
      0.8038376866300426,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.23733142070927404,
      0.6766568636607861,
      0.8791428417567961,
      0.34970553354412104,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7767111731260719,
      0.36939908341858885,
      0.8877771223343094,
      0.16656518085775396,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.40524411235449553,
      0.5094980580412446,
      0.42932740059809227,
      0.4806992101733476,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.942893176736217,
      0.7569186327365722,
      0.43762218258484487,
      0.5709277573723915,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6626357139000086,
      0.9388125948827755,
      0.6922120795940312,
      0.2802353109920688,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6384950189782832,
      0.8203631774543025,
      0.4819185524506592,
      0.5612388571573312,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7890794105898543,
      0.026657068661979144,
      0.36745236086958255,
      0.09421420582014717,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4125170256726969,
      0.8372759010112841,
      0.6858892915066466,
      0.055965911139327695,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.733752513401978,
      0.2860600524805865,
      0.24581639133981414,
      0.4657602259317729,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9844669862500401,
      0.04259392169423548,
      0.2850934545160856,
      0.6116234365122941,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8431280227198134,
      0.09330478841127465,
      0.10738171141015296,
      0.8058302145583697,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.1887687053820234,
      0.020772300699924195,
      0.2675743523191082,
      0.509425440737449,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7454162260498424,
      0.3601811686584533,
      0.6356766970010271,
      0.08368780784222996,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7954204147818181,
      0.6808861341529187,
      0.9732894436382853,
      0.028456208873444133,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6898670482181255,
      0.5602400644580263,
      0.007835682106110964,
      0.3126424433906586,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5461294624203212,
      0.24974364067650745,
      0.3225823914937893,
      0.5003866335569956,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.661414559901519,
      0.6611594211086985,
      0.0832376382837211,
      0.6088151725555888,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.31350612996189475,
      0.6824719404358928,
      0.8962030999552082,
      0.5898412128782159,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6192600820436853,
      0.7065475830586582,
      0.47775907849535804,
      0.9872123954283326,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5794892396998665,
      0.9821886556152676,
      0.5938251530775381,
      0.30404687707509925,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.03598332590135811,
      0.43853593213910447,
      0.42005264249981566,
      0.27092494528759103,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5857315286790321,
      0.3453845905764671,
      0.38938830465869656,
      0.2686851760469917,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6080813798369535,
      0.8975830535375084,
      0.16063980186497728,
      0.6586597679036962,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.34853632098020637,
      0.5222409587324605,
      0.34629031735429283,
      0.9571001776320724,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.22758512028439548,
      0.4961198993089996,
      0.7035427414896834,
      0.9873475820942967,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9225755101854336,
      0.4345542179267431,
      0.5826852296872961,
      0.3959711566516181,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8959668161588287,
      0.5781473185927918,
      0.15770465606442519,
      0.2465330879179335,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9967009535833719,
      0.7209513334268077,
      0.3050224221409039,
      0.9219568626656348,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.718546385528138,
      0.21647873996460432,
      0.9485312530824154,
      0.7544823112339518,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8793678793431775,
      0.5321808027467093,
      0.44421663094592234,
      0.3540210579398514,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5201311798545218,
      0.42005202877685466,
      0.9185755141210294,
      0.2513817846312163,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2726794018274953,
      0.4146719265832651,
      0.9556854071727073,
      0.34185681700133563,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.23008112912632606,
      0.5530759925523093,
      0.1287401965557975,
      0.9329184289796552,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.597049889010525,
      0.6117591325403197,
      0.4119313490448945,
      0.3232267846716024,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.20173136300954464,
      0.6002148229523541,
      0.7815012855520117,
      0.28544406461634386,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8269928516978476,
      0.10932038205185535,
      0.6143160563886838,
      0.2184224010482163,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5522809330115714,
      0.5677845896560437,
      0.8579879882249971,
      0.6355837987328417,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.04362984397169789,
      0.7754836644431609,
      0.1431977287912315,
      0.6092936034964014,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4596033225489746,
      0.3592578817865715,
      0.553616658068951,
      0.19183381195695703,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.45079770418260423,
      0.2799744643950717,
      0.6432910866105234,
      0.08411912299187807,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6745840838964664,
      0.07598087848264623,
      0.8240250634502845,
      0.36570374341381084,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.006762919216348862,
      0.7968845960590147,
      0.02514782044366326,
      0.3068699746421577,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.1138875791627122,
      0.4292015547916156,
      0.3153636011167973,
      0.9394545926418999,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5658737300910498,
      0.5162676744048261,
      0.06243779693597862,
      0.6687945075056573,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6108948588331585,
      0.251069063724365,
      0.9194382362252776,
      0.427182897606301,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.2859283493741377,
      0.47567202696913746,
      0.4158263080352007,
      0.13267581511787707,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7282071557718046,
      0.1269283431875673,
      0.3225554819437485,
      0.3474737724799578,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9174000239171781,
      0.575526441418363,
      0.6424082388100079,
      0.7795858447358935,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4961176629005909,
      0.7783772378271568,
      0.42736590566493216,
      0.47753749552007785,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.1624392018841635,
      0.028751267485759735,
      0.32060419387936456,
      0.9219882035969446,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8615631839985258,
      0.769906654883067,
      0.8950660850360729,
      0.5997750400061773,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.7849875817664871,
      0.4668319723460155,
      0.395114919896967,
      0.8253563646816371,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.07626413874831572,
      0.11553536946297527,
      0.5967093302357965,
      0.6250874863042443,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9295880168076048,
      0.09201501553706759,
      0.4002992747710562,
      0.5020954829641272,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8107293478061589,
      0.7991328274514402,
      0.14082794482093408,
      0.19565070959320263,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.8149919267700367,
      0.9462274058046314,
      0.7109368887841762,
      0.3664044938712081,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9577840290332994,
      0.134161476174524,
      0.08818671344845908,
      0.6137505449578752,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
  };

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NCHW, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_NCHW, FORMAT_FRACTAL_NZ, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
      {2, 2, 17, 4}, {2, 2, 1, 2, 16, 16}, DT_FLOAT};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(TransDataFormat(args, result), SUCCESS);
  EXPECT_EQ(result.length, sizeof(ret) / sizeof(ret[0]) * 4);
  for (size_t i = 0U; i < sizeof(ret) / sizeof(ret[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<float *>(result.data.get()))[i], ret[i]);
  }
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            SUCCESS);

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NCHW, FORMAT_RESERVED, 5));
  TransArgs args2{
      reinterpret_cast<uint8_t *>(ret), src_format2, dst_format2, FORMAT_FRACTAL_NZ, FORMAT_NCHW, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 1, 2, 16, 16}, {2, 2, 17, 4}, DT_FLOAT};
  TransResult result2;
  FormatTransferFractalNzND transfer2;
  EXPECT_EQ(TransDataFormat(args2, result2), SUCCESS);
  EXPECT_EQ(result2.length, sizeof(data) / sizeof(data[0]) * 4);
  for (size_t i = 0U; i < sizeof(data) / sizeof(data[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<float *>(result2.data.get()))[i], data[i]);
  }
}

TEST_F(UtestFormatTransferNdFractNz, nhwc_shape4_fp32) {
  float data[2 * 2 * 4 * 17] = {
      0.011873719514500558, 0.9055337066931509,   0.4007962186879912,   0.4823248697007644,   0.434413711781758,
      0.3374081761653097,   0.1327889293124861,   0.9573280427327941,   0.900157174839599,    0.22675418134305847,
      0.915880789401114,    0.2858704345543902,   0.9538630233786596,   0.7750326328379964,   0.6241316443191395,
      0.9671130471718147,   0.4519972100893155,   0.27178741914922444,  0.9858432029701361,   0.19476602256637698,
      0.3880385111012623,   0.4904599528435152,   0.7763741995316538,   0.595041172451146,    0.7697729614020185,
      0.9008648456464086,   0.10660640559911716,  0.9872130150760993,   0.8863345663931051,   0.42187474552924187,
      0.890712319631421,    0.8511675560554783,   0.49085053954474256,  0.6393638683917573,   0.7753996529731574,
      0.4520989748269998,   0.8049570752479891,   0.8587842070040622,   0.8086535260498522,   0.2874426357486748,
      0.4655016269762732,   0.2966483939283724,   0.034319962943348825, 0.8204809948347593,   0.009691641525112815,
      0.08010193588797776,  0.965026232132812,    0.7971692934454786,   0.8820844501303087,   0.3328045944663507,
      0.18561195288144405,  0.07216530096679319,  0.005908780438422023, 0.06520472370046182,  0.14742586552942527,
      0.1584733061658462,   0.40478873960253803,  0.8517076637562077,   0.38362604730995475,  0.6242972689768637,
      0.8029032121893791,   0.9087739592614803,   0.4937699233327367,   0.45546332276267887,  0.798105153390389,
      0.1314550983849262,   0.2591920182847739,   0.9114933413684086,   0.3414109593297737,   0.026092765672044882,
      0.2931518007384959,   0.8469358330691886,   0.47102665902579355,  0.40483320725316896,  0.12104263689198036,
      0.7610259859295765,   0.18319775575048725,  0.9581675087575537,   0.6023459738089741,   0.9770086789537543,
      0.32030513714161946,  0.9998097997775989,   0.9030541284918164,   0.929507484163007,    0.5701279464990141,
      0.485477868042418,    0.10576997065572546,  0.9869010419984975,   0.7601188774307379,   0.7299650375549,
      0.47395049565443736,  0.2987941122063468,   0.28780906999224076,  0.5007695250663617,   0.9980887820922187,
      0.6505062822604325,   0.2551175826121026,   0.8805142041510927,   0.540881304210333,    0.512165946641996,
      0.7391492488205184,   0.5349603795874779,   0.8477996679763127,   0.36974774843557734,  0.5386600638597664,
      0.8265820196734138,   0.8331013533783092,   0.3184354327418504,   0.21196431290299877,  0.0007803293886190499,
      0.9031099441741426,   0.7338031418981182,   0.4181974944656337,   0.9475100023819251,   0.9164113945149563,
      0.9880971962092363,   0.971369242048584,    0.46347470842977934,  0.514856183416368,    0.5806407538118334,
      0.47403794573443647,  0.4983463935801685,   0.10528401666738596,  0.1526320361717619,   0.28061664920854257,
      0.30961878366674567,  0.44923363657730486,  0.9484407824169037,   0.5159122159882427,   0.5167660592705424,
      0.7367297318467558,   0.5538203882599549,   0.4506813979810824,   0.2442886238881219,   0.759900709991574,
      0.6650499928247546,   0.48708807614210625,  0.15306454148232096,  0.06357296925269262,  0.32107378247726914,
      0.4549262540499909,   0.5730762333418195,   0.657776134839074,    0.46288302719843766,  0.47841000194019123,
      0.44891897033375505,  0.10930401547813162,  0.24339407947523917,  0.12836594551381142,  0.6934045473476478,
      0.3961572539291023,   0.26876738129298816,  0.3666361092088235,   0.021036984332677644, 0.8996511029257301,
      0.8028217206118277,   0.02125903018390507,  0.02961138398355878,  0.6235739131455775,   0.6760579858568656,
      0.5857480476460779,   0.01234894215599136,  0.932659669453309,    0.5769971719464481,   0.4431403578173735,
      0.6210058271168252,   0.44512130009247053,  0.1256576731684177,   0.7554367685462694,   0.4552800403309736,
      0.5782247194165684,   0.9378829346189987,   0.4767719439722925,   0.588459429493016,    0.38309400222741374,
      0.45826986645737,     0.6923380843272136,   0.910198917887028,    0.27557533418495017,  0.5929635576694986,
      0.853359402144766,    0.7887863171140258,   0.6975730076388099,   0.46150867673575524,  0.8701541258470236,
      0.11825577576640478,  0.12613178124889635,  0.6295407278784825,   0.19813460927054138,  0.6415083047302164,
      0.6485982020831015,   0.503325917338586,    0.05296267036442437,  0.84952445870043,     0.45866219246495377,
      0.32768756890079054,  0.589085245208557,    0.34892536724353695,  0.91035413546058,     0.9880017939439389,
      0.40415901103861485,  0.578040771005287,    0.3959288005375471,   0.16148211530085899,  0.9318405934814316,
      0.6756677973943621,   0.4606385109370067,   0.905962237773528,    0.2177532221826981,   0.4261085792963576,
      0.980991006583082,    0.2412848972859596,   0.8431509870043342,   0.48095393083099247,  0.9748865288169085,
      0.7190166864903728,   0.013915463190590227, 0.1845161452237204,   0.9027340647387055,   0.661002921841787,
      0.27262309567650456,  0.980513934833282,    0.905065693190242,    0.48817348627366275,  0.5491844851920269,
      0.41304323921393715,  0.9759785094279378,   0.853997033979551,    0.002002500366118709, 0.6174459093057074,
      0.34462573854351475,  0.14693603152033852,  0.5662501103103056,   0.3249376766553893,   0.9306275547982649,
      0.859786096152122,    0.28218315978146635,  0.3279232246229644,   0.48861872218445535,  0.9233508569342559,
      0.05722530428945971,  0.9083781089398145,   0.4339485341608773,   0.7203410635948555,   0.8095638597988294,
      0.7400838811513829,   0.7086563132366934,   0.21415793475415057,  0.1710534847076408,   0.7560622473588406,
      0.5861151794417773,   0.886760410951225,    0.24883451496070186,  0.16786802676698942,  0.13821448342001896,
      0.5543758072261663,   0.23877866570604567,  0.5009385005089074,   0.5186822212396692,   0.2418401387392375,
      0.6913013072430841,   0.45462902660124316,  0.1971623092606769,   0.9959491383675012,   0.1351262179824929,
      0.8588580970731138,   0.1773361844666207,   0.3586325230242825,   0.8750229859703434,   0.26477337004803103,
      0.8958200538690423,   0.710860220058141,
  };
  float ret[2 * 2 * 1 * 2 * 16 * 16] = {
      0.011873719514500558,
      0.9055337066931509,
      0.4007962186879912,
      0.4823248697007644,
      0.434413711781758,
      0.3374081761653097,
      0.1327889293124861,
      0.9573280427327941,
      0.900157174839599,
      0.22675418134305847,
      0.915880789401114,
      0.2858704345543902,
      0.9538630233786596,
      0.7750326328379964,
      0.6241316443191395,
      0.9671130471718147,
      0.27178741914922444,
      0.9858432029701361,
      0.19476602256637698,
      0.3880385111012623,
      0.4904599528435152,
      0.7763741995316538,
      0.595041172451146,
      0.7697729614020185,
      0.9008648456464086,
      0.10660640559911716,
      0.9872130150760993,
      0.8863345663931051,
      0.42187474552924187,
      0.890712319631421,
      0.8511675560554783,
      0.49085053954474256,
      0.7753996529731574,
      0.4520989748269998,
      0.8049570752479891,
      0.8587842070040622,
      0.8086535260498522,
      0.2874426357486748,
      0.4655016269762732,
      0.2966483939283724,
      0.034319962943348825,
      0.8204809948347593,
      0.009691641525112815,
      0.08010193588797776,
      0.965026232132812,
      0.7971692934454786,
      0.8820844501303087,
      0.3328045944663507,
      0.07216530096679319,
      0.005908780438422023,
      0.06520472370046182,
      0.14742586552942527,
      0.1584733061658462,
      0.40478873960253803,
      0.8517076637562077,
      0.38362604730995475,
      0.6242972689768637,
      0.8029032121893791,
      0.9087739592614803,
      0.4937699233327367,
      0.45546332276267887,
      0.798105153390389,
      0.1314550983849262,
      0.2591920182847739,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4519972100893155,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6393638683917573,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.18561195288144405,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9114933413684086,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3414109593297737,
      0.026092765672044882,
      0.2931518007384959,
      0.8469358330691886,
      0.47102665902579355,
      0.40483320725316896,
      0.12104263689198036,
      0.7610259859295765,
      0.18319775575048725,
      0.9581675087575537,
      0.6023459738089741,
      0.9770086789537543,
      0.32030513714161946,
      0.9998097997775989,
      0.9030541284918164,
      0.929507484163007,
      0.485477868042418,
      0.10576997065572546,
      0.9869010419984975,
      0.7601188774307379,
      0.7299650375549,
      0.47395049565443736,
      0.2987941122063468,
      0.28780906999224076,
      0.5007695250663617,
      0.9980887820922187,
      0.6505062822604325,
      0.2551175826121026,
      0.8805142041510927,
      0.540881304210333,
      0.512165946641996,
      0.7391492488205184,
      0.8477996679763127,
      0.36974774843557734,
      0.5386600638597664,
      0.8265820196734138,
      0.8331013533783092,
      0.3184354327418504,
      0.21196431290299877,
      0.0007803293886190499,
      0.9031099441741426,
      0.7338031418981182,
      0.4181974944656337,
      0.9475100023819251,
      0.9164113945149563,
      0.9880971962092363,
      0.971369242048584,
      0.46347470842977934,
      0.5806407538118334,
      0.47403794573443647,
      0.4983463935801685,
      0.10528401666738596,
      0.1526320361717619,
      0.28061664920854257,
      0.30961878366674567,
      0.44923363657730486,
      0.9484407824169037,
      0.5159122159882427,
      0.5167660592705424,
      0.7367297318467558,
      0.5538203882599549,
      0.4506813979810824,
      0.2442886238881219,
      0.759900709991574,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5701279464990141,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.5349603795874779,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.514856183416368,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.6650499928247546,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.48708807614210625,
      0.15306454148232096,
      0.06357296925269262,
      0.32107378247726914,
      0.4549262540499909,
      0.5730762333418195,
      0.657776134839074,
      0.46288302719843766,
      0.47841000194019123,
      0.44891897033375505,
      0.10930401547813162,
      0.24339407947523917,
      0.12836594551381142,
      0.6934045473476478,
      0.3961572539291023,
      0.26876738129298816,
      0.021036984332677644,
      0.8996511029257301,
      0.8028217206118277,
      0.02125903018390507,
      0.02961138398355878,
      0.6235739131455775,
      0.6760579858568656,
      0.5857480476460779,
      0.01234894215599136,
      0.932659669453309,
      0.5769971719464481,
      0.4431403578173735,
      0.6210058271168252,
      0.44512130009247053,
      0.1256576731684177,
      0.7554367685462694,
      0.5782247194165684,
      0.9378829346189987,
      0.4767719439722925,
      0.588459429493016,
      0.38309400222741374,
      0.45826986645737,
      0.6923380843272136,
      0.910198917887028,
      0.27557533418495017,
      0.5929635576694986,
      0.853359402144766,
      0.7887863171140258,
      0.6975730076388099,
      0.46150867673575524,
      0.8701541258470236,
      0.11825577576640478,
      0.6295407278784825,
      0.19813460927054138,
      0.6415083047302164,
      0.6485982020831015,
      0.503325917338586,
      0.05296267036442437,
      0.84952445870043,
      0.45866219246495377,
      0.32768756890079054,
      0.589085245208557,
      0.34892536724353695,
      0.91035413546058,
      0.9880017939439389,
      0.40415901103861485,
      0.578040771005287,
      0.3959288005375471,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3666361092088235,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.4552800403309736,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.12613178124889635,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.16148211530085899,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.9318405934814316,
      0.6756677973943621,
      0.4606385109370067,
      0.905962237773528,
      0.2177532221826981,
      0.4261085792963576,
      0.980991006583082,
      0.2412848972859596,
      0.8431509870043342,
      0.48095393083099247,
      0.9748865288169085,
      0.7190166864903728,
      0.013915463190590227,
      0.1845161452237204,
      0.9027340647387055,
      0.661002921841787,
      0.980513934833282,
      0.905065693190242,
      0.48817348627366275,
      0.5491844851920269,
      0.41304323921393715,
      0.9759785094279378,
      0.853997033979551,
      0.002002500366118709,
      0.6174459093057074,
      0.34462573854351475,
      0.14693603152033852,
      0.5662501103103056,
      0.3249376766553893,
      0.9306275547982649,
      0.859786096152122,
      0.28218315978146635,
      0.48861872218445535,
      0.9233508569342559,
      0.05722530428945971,
      0.9083781089398145,
      0.4339485341608773,
      0.7203410635948555,
      0.8095638597988294,
      0.7400838811513829,
      0.7086563132366934,
      0.21415793475415057,
      0.1710534847076408,
      0.7560622473588406,
      0.5861151794417773,
      0.886760410951225,
      0.24883451496070186,
      0.16786802676698942,
      0.5543758072261663,
      0.23877866570604567,
      0.5009385005089074,
      0.5186822212396692,
      0.2418401387392375,
      0.6913013072430841,
      0.45462902660124316,
      0.1971623092606769,
      0.9959491383675012,
      0.1351262179824929,
      0.8588580970731138,
      0.1773361844666207,
      0.3586325230242825,
      0.8750229859703434,
      0.26477337004803103,
      0.8958200538690423,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.27262309567650456,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.3279232246229644,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.13821448342001896,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.710860220058141,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
      0.0,
  };

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_NHWC, FORMAT_FRACTAL_NZ, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 4, 17}, {2, 2, 2, 1, 16, 16}, DT_FLOAT};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(TransDataFormat(args, result), SUCCESS);
  EXPECT_EQ(result.length, sizeof(ret) / sizeof(ret[0]) * 4);
  for (size_t i = 0U; i < sizeof(ret) / sizeof(ret[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<float *>(result.data.get()))[i], ret[i]);
  }
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            SUCCESS);

  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format2 = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  TransArgs args2{
      reinterpret_cast<uint8_t *>(ret), src_format2, dst_format2, FORMAT_FRACTAL_NZ, FORMAT_NHWC, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {2, 2, 2, 1, 16, 16}, {2, 2, 4, 17}, DT_FLOAT};
  TransResult result2;
  FormatTransferFractalNzND transfer2;
  EXPECT_EQ(TransDataFormat(args2, result2), SUCCESS);
  EXPECT_EQ(result2.length, sizeof(data) / sizeof(data[0]) * 4);
  for (size_t i = 0U; i < sizeof(data) / sizeof(data[0]); ++i) {
    EXPECT_EQ((reinterpret_cast<float *>(result2.data.get()))[i], data[i]);
  }
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_shape) {
  uint16_t data[1 * 4 * 4 * 1] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_NHWC, FORMAT_FRACTAL_NZ, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {1, 4, 4}, {1, 1, 1, 16, 16}, DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            ACL_ERROR_GE_SHAPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_data_type) {
  uint16_t data[1 * 1 * 4 * 4] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format,
                 FORMAT_NHWC,
                 FORMAT_FRACTAL_NZ, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
                 {
                     1,
                     1,
                     4,
                     4,
                 },
                 {1, 1, 1, 16, 16},
                 DT_UNDEFINED};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_DATATYPE_INVALID);
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            ACL_ERROR_GE_DATATYPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_format) {
  uint16_t data[1 * 1 * 4 * 4] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_HWCN, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format,
                 FORMAT_HWCN,
                 FORMAT_FRACTAL_NZ, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
                 {1, 1, 4, 4},
                 {1, 1, 1, 1, 16, 16},
                 DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            ACL_ERROR_GE_SHAPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_dst_shape) {
  uint16_t data[1 * 1 * 4 * 4] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_NHWC, FORMAT_FRACTAL_NZ, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {1, 1, 4, 4}, {1, 1, 16, 16}, DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNz transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
  EXPECT_EQ(transfer.TransShape(args.src_format, args.src_shape, args.src_data_type, args.dst_format, args.dst_shape),
            SUCCESS);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_dst_shape2) {
  uint16_t data[1 * 1 * 1 * 1 * 16 * 16] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_FRACTAL_NZ, FORMAT_NHWC, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {1, 1, 1, 1, 16, 16}, {1, 4, 4}, DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNzND transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_data_type2) {
  uint16_t data[1 * 1 * 1 * 16 * 16] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format,
                 FORMAT_FRACTAL_NZ,
                 FORMAT_NHWC, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
                 {1, 1, 1, 16, 16},
                 {
                     1,
                     1,
                     4,
                     4,
                 },
                 DT_UNDEFINED};
  TransResult result;
  FormatTransferFractalNzND transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_DATATYPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_data_type3) {
  uint16_t data[1 * 1 * 1 * 16 * 16] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format,
                 FORMAT_FRACTAL_NZ,
                 FORMAT_NHWC, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
                 {1, 1, 1, 16, 16},
                 {
                     1,
                     1,
                     4,
                     4,
                 },
                 DT_STRING};
  TransResult result;
  FormatTransferFractalNzND transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_DATATYPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_dst_format2) {
  uint16_t data[1 * 1 * 1 * 1 * 16 * 16] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_HWCN, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format,
                 FORMAT_FRACTAL_NZ,
                 FORMAT_HWCN, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
                 {1, 1, 1, 1, 16, 16},
                 {1, 1, 4, 4},
                 DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNzND transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
  EXPECT_EQ(TransDataFormat(args, result), ACL_ERROR_GE_FORMAT_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_shape2) {
  uint16_t data[1 * 1 * 1 * 1 * 16 * 16] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  TransArgs args{
      reinterpret_cast<uint8_t *>(data), src_format, dst_format, FORMAT_FRACTAL_NZ, FORMAT_NHWC, FORMAT_RESERVED,
      FORMAT_RESERVED, 16, 16, {1, 1, 16, 16}, {1, 1, 4, 4}, DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNzND transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
}

TEST_F(UtestFormatTransferNdFractNz, invalid_src_dst_shape_relation) {
  uint16_t data[1 * 1 * 2 * 1 * 16 * 16] = {0};
  // {c0_value, bit_value}: c0_value = 2 ^ (bit_value - 1)
  // {1, 1}, {2, 2}, {4, 3}, {8, 4}, {16, 5}, {32, 6}, {64, 7}, {128, 8}, {256, 9}
  // 5 indicates that cube size is 16
  const Format src_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_FRACTAL_NZ, FORMAT_RESERVED, 5));
  const Format dst_format = static_cast<Format>(GetFormatFromSubAndC0(FORMAT_NHWC, FORMAT_RESERVED, 5));
  TransArgs args{reinterpret_cast<uint8_t *>(data), src_format, dst_format,
                 FORMAT_FRACTAL_NZ,
                 FORMAT_NHWC, FORMAT_RESERVED, FORMAT_RESERVED, 16, 16,
                 {1, 1, 2, 1, 16, 16},
                 {1, 1, 17, 15},
                 DT_FLOAT16};
  TransResult result;
  FormatTransferFractalNzND transfer;
  EXPECT_EQ(transfer.TransFormat(args, result), ACL_ERROR_GE_SHAPE_INVALID);
}
}  // namespace formats
}  // namespace ge
