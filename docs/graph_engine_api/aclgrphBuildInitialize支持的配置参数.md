# aclgrphBuildInitialize支持的配置参数<a name="ZH-CN_TOPIC_0000001265404734"></a>

## 基础功能<a name="section729318055311"></a>

<a name="table1354054105414"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002209652682_row12247013356"><th class="cellrowborder" valign="top" width="16.830000000000002%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002209652682_p192241011355"><a name="zh-cn_topic_0000002209652682_p192241011355"></a><a name="zh-cn_topic_0000002209652682_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="83.17%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002209652682_p102241606359"><a name="zh-cn_topic_0000002209652682_p102241606359"></a><a name="zh-cn_topic_0000002209652682_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002209652682_row92247011357"><td class="cellrowborder" valign="top" width="16.830000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652682_p1522430173517"><a name="zh-cn_topic_0000002209652682_p1522430173517"></a><a name="zh-cn_topic_0000002209652682_p1522430173517"></a>SOC_VERSION</p>
</td>
<td class="cellrowborder" valign="top" width="83.17%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652682_zh-cn_topic_0221674006_p4618022114414"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0221674006_p4618022114414"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0221674006_p4618022114414"></a>图编译时使用的<span id="zh-cn_topic_0000002209652682_ph1832382031410"><a name="zh-cn_topic_0000002209652682_ph1832382031410"></a><a name="zh-cn_topic_0000002209652682_ph1832382031410"></a>昇腾AI处理器</span>型号。</p>
<a name="zh-cn_topic_0000002209652682_ul13962924181114"></a><a name="zh-cn_topic_0000002209652682_ul13962924181114"></a><ul id="zh-cn_topic_0000002209652682_ul13962924181114"><li>若当前环境存在<span id="zh-cn_topic_0000002209652682_ph253413406113"><a name="zh-cn_topic_0000002209652682_ph253413406113"></a><a name="zh-cn_topic_0000002209652682_ph253413406113"></a>昇腾AI处理器</span>，该参数可选。</li><li>若当前环境不存在<span id="zh-cn_topic_0000002209652682_ph72117562112"><a name="zh-cn_topic_0000002209652682_ph72117562112"></a><a name="zh-cn_topic_0000002209652682_ph72117562112"></a>昇腾AI处理器</span>，即开发环境，该参数必填。</li></ul>
<p id="zh-cn_topic_0000002209652682_p13849125512316"><a name="zh-cn_topic_0000002209652682_p13849125512316"></a><a name="zh-cn_topic_0000002209652682_p13849125512316"></a><em id="zh-cn_topic_0000002209652682_i108199518320"><a name="zh-cn_topic_0000002209652682_i108199518320"></a><a name="zh-cn_topic_0000002209652682_i108199518320"></a>&lt;soc_version&gt;</em>查询方法为：</p>
<a name="zh-cn_topic_0000002209652682_ul38951527135511"></a><a name="zh-cn_topic_0000002209652682_ul38951527135511"></a><ul id="zh-cn_topic_0000002209652682_ul38951527135511"><li>针对如下<span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph20833205312295"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph20833205312295"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph20833205312295"></a>产品</span>：在安装<span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph196874123168"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph196874123168"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph196874123168"></a>昇腾AI处理器</span>的服务器执行<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b17687612191618"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b17687612191618"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b17687612191618"></a>npu-smi info</strong>命令进行查询，获取<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b10161437131915"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b10161437131915"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b10161437131915"></a>Name</strong>信息。实际配置值为AscendName，例如<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b16284944181920"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b16284944181920"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b16284944181920"></a>Name</strong>取值为<em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i1478775919179"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i1478775919179"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i1478775919179"></a>xxxyy</em>，实际配置值为Ascend<em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i1678775901719"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i1678775901719"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i1678775901719"></a>xxxyy</em>。<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_p3529538154519"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_p3529538154519"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_p3529538154519"></a><span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph1483216010188"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph1483216010188"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph1483216010188"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
</li><li>针对如下<span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph13446185695413"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph13446185695413"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph13446185695413"></a>产品</span>，在安装<span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph17911124171120"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph17911124171120"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph17911124171120"></a>昇腾AI处理器</span>的服务器执行<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b206066255591"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b206066255591"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b206066255591"></a>npu-smi info -t board -i </strong><em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16609202515915"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16609202515915"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16609202515915"></a>id</em><strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b14358631175910"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b14358631175910"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b14358631175910"></a> -c </strong><em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16269732165915"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16269732165915"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16269732165915"></a>chip_id</em>命令进行查询，获取<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b11257114917192"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b11257114917192"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b11257114917192"></a>Chip Name</strong>和<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b72671651121916"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b72671651121916"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b72671651121916"></a>NPU Name</strong>信息，实际配置值为Chip Name_NPU Name。例如<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b13136111611203"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b13136111611203"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b13136111611203"></a>Chip Name</strong>取值为Ascend<em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i68701996189"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i68701996189"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i68701996189"></a>xxx</em>，<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b51347352112"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b51347352112"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b51347352112"></a>NPU Name</strong>取值为1234，实际配置值为Ascend<em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i82901912141813"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i82901912141813"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i82901912141813"></a>xxx</em><em id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i154501458102213"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i154501458102213"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_i154501458102213"></a>_</em>1234。其中：<a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ul2747601334"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ul2747601334"></a><ul id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ul2747601334"><li>id：设备id，通过<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b83171930133314"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b83171930133314"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b83171930133314"></a>npu-smi info -l</strong>命令查出的NPU ID即为设备id。</li><li>chip_id：芯片id，通过<strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b18888204343317"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b18888204343317"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_b18888204343317"></a>npu-smi info -m</strong>命令查出的Chip ID即为芯片id。</li></ul>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_p12136131554410"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_p12136131554410"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_p12136131554410"></a><span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph13754548217"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph13754548217"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_ph13754548217"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002209652682_p15223113921717"><a name="zh-cn_topic_0000002209652682_p15223113921717"></a><a name="zh-cn_topic_0000002209652682_p15223113921717"></a><strong id="zh-cn_topic_0000002209652682_b11164241182"><a name="zh-cn_topic_0000002209652682_b11164241182"></a><a name="zh-cn_topic_0000002209652682_b11164241182"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652682_screen156613579178"><a name="zh-cn_topic_0000002209652682_screen156613579178"></a><a name="zh-cn_topic_0000002209652682_screen156613579178"></a>{ge::ir_option::SOC_VERSION, "<em id="zh-cn_topic_0000002209652682_i1999652601811"><a name="zh-cn_topic_0000002209652682_i1999652601811"></a><a name="zh-cn_topic_0000002209652682_i1999652601811"></a>&lt;soc_version&gt;</em>"}</pre>
<p id="zh-cn_topic_0000002209652682_p53871713104310"><a name="zh-cn_topic_0000002209652682_p53871713104310"></a><a name="zh-cn_topic_0000002209652682_p53871713104310"></a><span class="ddd" id="zh-cn_topic_0000002209652682_ph1348261625514"><a name="zh-cn_topic_0000002209652682_ph1348261625514"></a><a name="zh-cn_topic_0000002209652682_ph1348261625514"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652682_p102251817131919"><a name="zh-cn_topic_0000002209652682_p102251817131919"></a><a name="zh-cn_topic_0000002209652682_p102251817131919"></a><span id="zh-cn_topic_0000002209652682_ph192251917161914"><a name="zh-cn_topic_0000002209652682_ph192251917161914"></a><a name="zh-cn_topic_0000002209652682_ph192251917161914"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652682_p465703434017"><a name="zh-cn_topic_0000002209652682_p465703434017"></a><a name="zh-cn_topic_0000002209652682_p465703434017"></a><span id="zh-cn_topic_0000002209652682_ph13754548217"><a name="zh-cn_topic_0000002209652682_ph13754548217"></a><a name="zh-cn_topic_0000002209652682_ph13754548217"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652682_row13157504315"><td class="cellrowborder" valign="top" width="16.830000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652682_p14528193863516"><a name="zh-cn_topic_0000002209652682_p14528193863516"></a><a name="zh-cn_topic_0000002209652682_p14528193863516"></a>ENABLE_SINGLE_STREAM</p>
</td>
<td class="cellrowborder" valign="top" width="83.17%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652682_p1077812010488"><a name="zh-cn_topic_0000002209652682_p1077812010488"></a><a name="zh-cn_topic_0000002209652682_p1077812010488"></a>静态shape场景下，是否使能模型推理顺序单流串行执行。</p>
<p id="zh-cn_topic_0000002209652682_p89787478344"><a name="zh-cn_topic_0000002209652682_p89787478344"></a><a name="zh-cn_topic_0000002209652682_p89787478344"></a>其中，流（Stream）用于维护一些异步操作的执行顺序，确保按照应用程序中的代码调用顺序在Device上执行。</p>
<p id="zh-cn_topic_0000002209652682_p05815273249"><a name="zh-cn_topic_0000002209652682_p05815273249"></a><a name="zh-cn_topic_0000002209652682_p05815273249"></a><strong id="zh-cn_topic_0000002209652682_b51371371241"><a name="zh-cn_topic_0000002209652682_b51371371241"></a><a name="zh-cn_topic_0000002209652682_b51371371241"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209652682_ul9813212508"></a><a name="zh-cn_topic_0000002209652682_ul9813212508"></a><ul id="zh-cn_topic_0000002209652682_ul9813212508"><li>true：表示使能，模型推理顺序单流串行执行。</li><li>false：（默认值）表示关闭，模型推理时多流并行执行。</li></ul>
<p id="zh-cn_topic_0000002209652682_p442665213412"><a name="zh-cn_topic_0000002209652682_p442665213412"></a><a name="zh-cn_topic_0000002209652682_p442665213412"></a><strong id="zh-cn_topic_0000002209652682_b132542174218"><a name="zh-cn_topic_0000002209652682_b132542174218"></a><a name="zh-cn_topic_0000002209652682_b132542174218"></a>参数值约束：</strong></p>
<p id="zh-cn_topic_0000002209652682_p2099711184211"><a name="zh-cn_topic_0000002209652682_p2099711184211"></a><a name="zh-cn_topic_0000002209652682_p2099711184211"></a>模型中存在Cmo算子和如下控制类算子时，不能使用单Stream特性，只能使用默认值false。</p>
<a name="zh-cn_topic_0000002209652682_ul1631010307424"></a><a name="zh-cn_topic_0000002209652682_ul1631010307424"></a><ul id="zh-cn_topic_0000002209652682_ul1631010307424"><li>Merge</li><li>Switch</li><li>Enter</li><li>RefEnter</li></ul>
<p id="zh-cn_topic_0000002209652682_p3433615192613"><a name="zh-cn_topic_0000002209652682_p3433615192613"></a><a name="zh-cn_topic_0000002209652682_p3433615192613"></a><strong id="zh-cn_topic_0000002209652682_b194341315142619"><a name="zh-cn_topic_0000002209652682_b194341315142619"></a><a name="zh-cn_topic_0000002209652682_b194341315142619"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652682_screen1043491518260"><a name="zh-cn_topic_0000002209652682_screen1043491518260"></a><a name="zh-cn_topic_0000002209652682_screen1043491518260"></a>{ge::ir_option::ENABLE_SINGLE_STREAM, "true"}</pre>
<p id="zh-cn_topic_0000002209652682_p853015315126"><a name="zh-cn_topic_0000002209652682_p853015315126"></a><a name="zh-cn_topic_0000002209652682_p853015315126"></a><span class="ddd" id="zh-cn_topic_0000002209652682_ph105708705617"><a name="zh-cn_topic_0000002209652682_ph105708705617"></a><a name="zh-cn_topic_0000002209652682_ph105708705617"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652682_p053216317124"><a name="zh-cn_topic_0000002209652682_p053216317124"></a><a name="zh-cn_topic_0000002209652682_p053216317124"></a><span id="zh-cn_topic_0000002209652682_ph353216319129"><a name="zh-cn_topic_0000002209652682_ph353216319129"></a><a name="zh-cn_topic_0000002209652682_ph353216319129"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652682_p1734183974013"><a name="zh-cn_topic_0000002209652682_p1734183974013"></a><a name="zh-cn_topic_0000002209652682_p1734183974013"></a><span id="zh-cn_topic_0000002209652682_ph4734143910407"><a name="zh-cn_topic_0000002209652682_ph4734143910407"></a><a name="zh-cn_topic_0000002209652682_ph4734143910407"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652682_row1089881134320"><td class="cellrowborder" valign="top" width="16.830000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652682_p147180195716"><a name="zh-cn_topic_0000002209652682_p147180195716"></a><a name="zh-cn_topic_0000002209652682_p147180195716"></a>DETERMINISTIC</p>
</td>
<td class="cellrowborder" valign="top" width="83.17%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652682_p6498144010115"><a name="zh-cn_topic_0000002209652682_p6498144010115"></a><a name="zh-cn_topic_0000002209652682_p6498144010115"></a>是否开启确定性计算。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p134721729142618"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p134721729142618"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p134721729142618"></a>默认情况下，不开启确定性计算，算子在相同的硬件和输入下，多次执行的结果可能不同。这个差异的来源，一般是因为在算子实现中，存在异步的多线程执行，会导致浮点数累加的顺序变化。当开启确定性计算功能时，算子在相同的硬件和输入下，多次执行将产生相同的输出。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p14966914113113"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p14966914113113"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p14966914113113"></a>通常建议不开启确定性计算，因为确定性计算往往会导致算子执行变慢，进而影响性能。当发现模型多次执行结果不同，或者是进行精度调优时，可开启确定性计算，辅助模型调试、调优。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p338552241016"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p338552241016"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_p338552241016"></a><strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_b172872103114"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_b172872103114"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471930925_b172872103114"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209652682_ul523612521304"></a><a name="zh-cn_topic_0000002209652682_ul523612521304"></a><ul id="zh-cn_topic_0000002209652682_ul523612521304"><li>0：（默认值）不开启确定性计算。</li><li>1：开启确定性计算。</li></ul>
<p id="zh-cn_topic_0000002209652682_p26965112911"><a name="zh-cn_topic_0000002209652682_p26965112911"></a><a name="zh-cn_topic_0000002209652682_p26965112911"></a><strong id="zh-cn_topic_0000002209652682_b6653191611318"><a name="zh-cn_topic_0000002209652682_b6653191611318"></a><a name="zh-cn_topic_0000002209652682_b6653191611318"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652682_screen118862052267"><a name="zh-cn_topic_0000002209652682_screen118862052267"></a><a name="zh-cn_topic_0000002209652682_screen118862052267"></a>{ge::ir_option::DETERMINISTIC, "1"}</pre>
<p id="zh-cn_topic_0000002209652682_p821413143418"><a name="zh-cn_topic_0000002209652682_p821413143418"></a><a name="zh-cn_topic_0000002209652682_p821413143418"></a><span class="ddd" id="zh-cn_topic_0000002209652682_ph146866169576"><a name="zh-cn_topic_0000002209652682_ph146866169576"></a><a name="zh-cn_topic_0000002209652682_ph146866169576"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652682_p145453553310"><a name="zh-cn_topic_0000002209652682_p145453553310"></a><a name="zh-cn_topic_0000002209652682_p145453553310"></a><span id="zh-cn_topic_0000002209652682_ph2054565510311"><a name="zh-cn_topic_0000002209652682_ph2054565510311"></a><a name="zh-cn_topic_0000002209652682_ph2054565510311"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652682_p3261843175215"><a name="zh-cn_topic_0000002209652682_p3261843175215"></a><a name="zh-cn_topic_0000002209652682_p3261843175215"></a><span id="zh-cn_topic_0000002209652682_ph142634310521"><a name="zh-cn_topic_0000002209652682_ph142634310521"></a><a name="zh-cn_topic_0000002209652682_ph142634310521"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652682_row1592415154313"><td class="cellrowborder" valign="top" width="16.830000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652682_p16464511113210"><a name="zh-cn_topic_0000002209652682_p16464511113210"></a><a name="zh-cn_topic_0000002209652682_p16464511113210"></a>OPTION_HOST_ENV_OS</p>
</td>
<td class="cellrowborder" valign="top" width="83.17%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001421537598_p1895443155413"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001421537598_p1895443155413"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001421537598_p1895443155413"></a>若模型编译环境的操作系统及其架构与模型运行环境不一致时，则需使用本参数设置模型运行环境的操作系统类型。如果不设置，则默认取模型编译环境的操作系统类型。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001421537598_p10247133512715"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001421537598_p10247133512715"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001421537598_p10247133512715"></a>模型编译环境的操作系统及其架构与模型运行环境不一致时，需要与OPTION_HOST_ENV_CPU参数配合使用，通过OPTION_HOST_ENV_OS参数设置操作系统类型、通过OPTION_HOST_ENV_CPU参数设置操作系统架构。</p>
<p id="zh-cn_topic_0000002209652682_p1425622510268"><a name="zh-cn_topic_0000002209652682_p1425622510268"></a><a name="zh-cn_topic_0000002209652682_p1425622510268"></a><strong id="zh-cn_topic_0000002209652682_b158326433264"><a name="zh-cn_topic_0000002209652682_b158326433264"></a><a name="zh-cn_topic_0000002209652682_b158326433264"></a>参数取值</strong>：查看<span id="zh-cn_topic_0000002209652682_ph199851328172710"><a name="zh-cn_topic_0000002209652682_ph199851328172710"></a><a name="zh-cn_topic_0000002209652682_ph199851328172710"></a>${INSTALL_DIR}</span>/opp/built-in/op_proto/lib/下打包的算子so的OS类型。</p>
<p id="zh-cn_topic_0000002209652682_p1570821411291"><a name="zh-cn_topic_0000002209652682_p1570821411291"></a><a name="zh-cn_topic_0000002209652682_p1570821411291"></a><strong id="zh-cn_topic_0000002209652682_b01731323194019"><a name="zh-cn_topic_0000002209652682_b01731323194019"></a><a name="zh-cn_topic_0000002209652682_b01731323194019"></a>参数默认值：</strong>查看<span id="zh-cn_topic_0000002209652682_ph10562197165916"><a name="zh-cn_topic_0000002209652682_ph10562197165916"></a><a name="zh-cn_topic_0000002209652682_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/scene.info文件中的取值。</p>
<p id="zh-cn_topic_0000002209652682_p1127562655516"><a name="zh-cn_topic_0000002209652682_p1127562655516"></a><a name="zh-cn_topic_0000002209652682_p1127562655516"></a><span id="zh-cn_topic_0000002209652682_ph1027510266551"><a name="zh-cn_topic_0000002209652682_ph1027510266551"></a><a name="zh-cn_topic_0000002209652682_ph1027510266551"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002209652682_p24469415216"><a name="zh-cn_topic_0000002209652682_p24469415216"></a><a name="zh-cn_topic_0000002209652682_p24469415216"></a><strong id="zh-cn_topic_0000002209652682_b187811300445"><a name="zh-cn_topic_0000002209652682_b187811300445"></a><a name="zh-cn_topic_0000002209652682_b187811300445"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652682_screen386213774619"><a name="zh-cn_topic_0000002209652682_screen386213774619"></a><a name="zh-cn_topic_0000002209652682_screen386213774619"></a>{ge::OPTION_HOST_ENV_OS, "linux"}
{ge::OPTION_HOST_ENV_CPU, "x86_64"}</pre>
<p id="zh-cn_topic_0000002209652682_p1686812211392"><a name="zh-cn_topic_0000002209652682_p1686812211392"></a><a name="zh-cn_topic_0000002209652682_p1686812211392"></a><span class="ddd" id="zh-cn_topic_0000002209652682_ph14100922145719"><a name="zh-cn_topic_0000002209652682_ph14100922145719"></a><a name="zh-cn_topic_0000002209652682_ph14100922145719"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652682_p1690731715597"><a name="zh-cn_topic_0000002209652682_p1690731715597"></a><a name="zh-cn_topic_0000002209652682_p1690731715597"></a><span id="zh-cn_topic_0000002209652682_ph290741713595"><a name="zh-cn_topic_0000002209652682_ph290741713595"></a><a name="zh-cn_topic_0000002209652682_ph290741713595"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652682_p11907101714592"><a name="zh-cn_topic_0000002209652682_p11907101714592"></a><a name="zh-cn_topic_0000002209652682_p11907101714592"></a><span id="zh-cn_topic_0000002209652682_ph1390710179595"><a name="zh-cn_topic_0000002209652682_ph1390710179595"></a><a name="zh-cn_topic_0000002209652682_ph1390710179595"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652682_row19592181510436"><td class="cellrowborder" valign="top" width="16.830000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652682_p1661916154320"><a name="zh-cn_topic_0000002209652682_p1661916154320"></a><a name="zh-cn_topic_0000002209652682_p1661916154320"></a>OPTION_HOST_ENV_CPU</p>
</td>
<td class="cellrowborder" valign="top" width="83.17%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471137389_p1895443155413"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471137389_p1895443155413"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001471137389_p1895443155413"></a>若模型编译环境的操作系统及其架构与模型运行环境不一致时，则需使用本参数设置模型运行环境的操作系统架构。如果不设置，则默认取模型编译环境的操作系统架构。</p>
<p id="zh-cn_topic_0000002209652682_p411817551213"><a name="zh-cn_topic_0000002209652682_p411817551213"></a><a name="zh-cn_topic_0000002209652682_p411817551213"></a>如果模型编译环境的操作系统及其架构与模型运行环境不一致，需要与OPTION_HOST_ENV_OS参数配合使用，通过OPTION_HOST_ENV_OS参数设置操作系统类型、通过OPTION_HOST_ENV_CPU参数设置操作系统架构。</p>
<p id="zh-cn_topic_0000002209652682_p0662334163917"><a name="zh-cn_topic_0000002209652682_p0662334163917"></a><a name="zh-cn_topic_0000002209652682_p0662334163917"></a><strong id="zh-cn_topic_0000002209652682_b810683115292"><a name="zh-cn_topic_0000002209652682_b810683115292"></a><a name="zh-cn_topic_0000002209652682_b810683115292"></a>参数取值</strong>：查看<span id="zh-cn_topic_0000002209652682_ph910623162913"><a name="zh-cn_topic_0000002209652682_ph910623162913"></a><a name="zh-cn_topic_0000002209652682_ph910623162913"></a>${INSTALL_DIR}</span>/opp/built-in/op_proto/lib/下打包的算子so的OS/CPU类型。</p>
<p id="zh-cn_topic_0000002209652682_p19496357132215"><a name="zh-cn_topic_0000002209652682_p19496357132215"></a><a name="zh-cn_topic_0000002209652682_p19496357132215"></a><strong id="zh-cn_topic_0000002209652682_b449695732218"><a name="zh-cn_topic_0000002209652682_b449695732218"></a><a name="zh-cn_topic_0000002209652682_b449695732218"></a>参数默认值：</strong>查看<span id="zh-cn_topic_0000002209652682_ph17496957202219"><a name="zh-cn_topic_0000002209652682_ph17496957202219"></a><a name="zh-cn_topic_0000002209652682_ph17496957202219"></a>${INSTALL_DIR}</span>/opp/scene.info文件中的取值。</p>
<p id="zh-cn_topic_0000002209652682_p198156395113"><a name="zh-cn_topic_0000002209652682_p198156395113"></a><a name="zh-cn_topic_0000002209652682_p198156395113"></a><span id="zh-cn_topic_0000002209652682_ph1181673115115"><a name="zh-cn_topic_0000002209652682_ph1181673115115"></a><a name="zh-cn_topic_0000002209652682_ph1181673115115"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002209652682_p8589195927"><a name="zh-cn_topic_0000002209652682_p8589195927"></a><a name="zh-cn_topic_0000002209652682_p8589195927"></a><strong id="zh-cn_topic_0000002209652682_b13589655214"><a name="zh-cn_topic_0000002209652682_b13589655214"></a><a name="zh-cn_topic_0000002209652682_b13589655214"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652682_screen25896512210"><a name="zh-cn_topic_0000002209652682_screen25896512210"></a><a name="zh-cn_topic_0000002209652682_screen25896512210"></a>{ge::OPTION_HOST_ENV_OS, "linux"}
{ge::OPTION_HOST_ENV_CPU, "x86_64"}</pre>
<a name="zh-cn_topic_0000002209652682_ul19209131593720"></a><a name="zh-cn_topic_0000002209652682_ul19209131593720"></a><ul id="zh-cn_topic_0000002209652682_ul19209131593720"><li>若转换后的离线模型包含操作系统类型、架构，例如：<em id="zh-cn_topic_0000002209652682_i2067017863014"><a name="zh-cn_topic_0000002209652682_i2067017863014"></a><a name="zh-cn_topic_0000002209652682_i2067017863014"></a>xxx_linux_x86_64</em>.om，则说明该模型运行的环境只能是<em id="zh-cn_topic_0000002209652682_i417423193016"><a name="zh-cn_topic_0000002209652682_i417423193016"></a><a name="zh-cn_topic_0000002209652682_i417423193016"></a>x86_64</em>架构的<em id="zh-cn_topic_0000002209652682_i583293416313"><a name="zh-cn_topic_0000002209652682_i583293416313"></a><a name="zh-cn_topic_0000002209652682_i583293416313"></a>linux</em>操作系统。</li><li>若转换后的离线模型不包含操作系统类型、架构，例如：<em id="zh-cn_topic_0000002209652682_i95821843133117"><a name="zh-cn_topic_0000002209652682_i95821843133117"></a><a name="zh-cn_topic_0000002209652682_i95821843133117"></a>xxx</em>.om，则说明CANN软件包所支持的操作系统，都支持该模型运行。</li></ul>
<p id="zh-cn_topic_0000002209652682_p9174195614416"><a name="zh-cn_topic_0000002209652682_p9174195614416"></a><a name="zh-cn_topic_0000002209652682_p9174195614416"></a><span class="ddd" id="zh-cn_topic_0000002209652682_ph116211426145712"><a name="zh-cn_topic_0000002209652682_ph116211426145712"></a><a name="zh-cn_topic_0000002209652682_ph116211426145712"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652682_p2419236155911"><a name="zh-cn_topic_0000002209652682_p2419236155911"></a><a name="zh-cn_topic_0000002209652682_p2419236155911"></a><span id="zh-cn_topic_0000002209652682_ph3419183645913"><a name="zh-cn_topic_0000002209652682_ph3419183645913"></a><a name="zh-cn_topic_0000002209652682_ph3419183645913"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_4"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_4"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_4"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_4"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_4"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_4"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652682_p15419183605919"><a name="zh-cn_topic_0000002209652682_p15419183605919"></a><a name="zh-cn_topic_0000002209652682_p15419183605919"></a><span id="zh-cn_topic_0000002209652682_ph20419136135918"><a name="zh-cn_topic_0000002209652682_ph20419136135918"></a><a name="zh-cn_topic_0000002209652682_ph20419136135918"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_4"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_4"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_4"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_4"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_4"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_4"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652682_row68661717194320"><td class="cellrowborder" valign="top" width="16.830000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652682_p1998603151414"><a name="zh-cn_topic_0000002209652682_p1998603151414"></a><a name="zh-cn_topic_0000002209652682_p1998603151414"></a>VIRTUAL_TYPE</p>
</td>
<td class="cellrowborder" valign="top" width="83.17%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_zh-cn_topic_0221674006_p6339173551615"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_zh-cn_topic_0221674006_p6339173551615"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_zh-cn_topic_0221674006_p6339173551615"></a>是否支持离线模型在昇腾虚拟化实例特性生成的虚拟设备上运行。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p1962119164510"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p1962119164510"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p1962119164510"></a>当前芯片算力比较大，云端用户或者小企业完全不需要使用这么大算力，昇腾虚拟化实例特性支持对芯片的算力进行切分，可满足用户根据自己的业务按需申请算力的诉求。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p0825174164615"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p0825174164615"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p0825174164615"></a>虚拟设备是指按照指定算力在芯片上申请的虚拟加速资源。</p>
<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p778320404465"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p778320404465"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p778320404465"></a><strong id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_b88618116477"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_b88618116477"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_b88618116477"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_zh-cn_topic_0221674006_ul75463814912"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_zh-cn_topic_0221674006_ul75463814912"></a><ul id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_zh-cn_topic_0221674006_ul75463814912"><li>0：（默认值）离线模型不在<span id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_ph11380519113718"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_ph11380519113718"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_ph11380519113718"></a>昇腾虚拟化实例</span>特性生成的虚拟设备上运行。</li><li>1：离线模型在不同算力的虚拟设备上运行。</li></ul>
<p id="zh-cn_topic_0000002209652682_p155741922164617"><a name="zh-cn_topic_0000002209652682_p155741922164617"></a><a name="zh-cn_topic_0000002209652682_p155741922164617"></a><strong id="zh-cn_topic_0000002209652682_b1756463715466"><a name="zh-cn_topic_0000002209652682_b1756463715466"></a><a name="zh-cn_topic_0000002209652682_b1756463715466"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652682_screen58891034144615"><a name="zh-cn_topic_0000002209652682_screen58891034144615"></a><a name="zh-cn_topic_0000002209652682_screen58891034144615"></a>{ge::ir_option::VIRTUAL_TYPE, "1"}</pre>
<p id="zh-cn_topic_0000002209652682_p1278813919229"><a name="zh-cn_topic_0000002209652682_p1278813919229"></a><a name="zh-cn_topic_0000002209652682_p1278813919229"></a><strong id="zh-cn_topic_0000002209652682_b3977151322311"><a name="zh-cn_topic_0000002209652682_b3977151322311"></a><a name="zh-cn_topic_0000002209652682_b3977151322311"></a>使用约束</strong>：</p>
<a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_ol105091310113318"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_ol105091310113318"></a><ol id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_ol105091310113318"><li>参数取值为1时，进行模型转换，则转换后离线模型参与计算的逻辑AI Core核数可能比实际aicore_num核数大，为aicore_num支持配置范围的最小公倍数：<p id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p717314291"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p717314291"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001265392766_p717314291"></a>例如aicore_num支持配置范围为{1,2,4,8}，参数取值为1转换后的离线模型，NPU运行核数可能为8。</p>
</li><li>参数取值为1时，转换后的模型，如果包括如下算子，会默认使用单核，该场景下，将会导致转换后的模型推理性能下降。<a name="zh-cn_topic_0000002209652682_ul1734094111210"></a><a name="zh-cn_topic_0000002209652682_ul1734094111210"></a><ul id="zh-cn_topic_0000002209652682_ul1734094111210"><li>DynamicRNN</li><li>PadV2D</li><li>SquareSumV2</li><li>DynamicRNNV2</li><li>DynamicRNNV3</li><li>DynamicGRUV</li></ul>
</li></ol>
<p id="zh-cn_topic_0000002209652682_p4792123074718"><a name="zh-cn_topic_0000002209652682_p4792123074718"></a><a name="zh-cn_topic_0000002209652682_p4792123074718"></a><span class="ddd" id="zh-cn_topic_0000002209652682_ph065183316570"><a name="zh-cn_topic_0000002209652682_ph065183316570"></a><a name="zh-cn_topic_0000002209652682_ph065183316570"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652682_p167930302470"><a name="zh-cn_topic_0000002209652682_p167930302470"></a><a name="zh-cn_topic_0000002209652682_p167930302470"></a><span id="zh-cn_topic_0000002209652682_ph8793103015472"><a name="zh-cn_topic_0000002209652682_ph8793103015472"></a><a name="zh-cn_topic_0000002209652682_ph8793103015472"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_5"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_5"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term11962195213215_5"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_5"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_5"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term184716139811_5"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652682_p17707131322"><a name="zh-cn_topic_0000002209652682_p17707131322"></a><a name="zh-cn_topic_0000002209652682_p17707131322"></a><span id="zh-cn_topic_0000002209652682_ph97701134214"><a name="zh-cn_topic_0000002209652682_ph97701134214"></a><a name="zh-cn_topic_0000002209652682_ph97701134214"></a><term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_5"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_5"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term1253731311225_5"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_5"><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_5"></a><a name="zh-cn_topic_0000002209652682_zh-cn_topic_0000001312391781_term131434243115_5"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 内存管理<a name="section337010475420"></a>

<a name="table610280145518"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002209492862_row1494131414617"><th class="cellrowborder" valign="top" width="18.54%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002209492862_p192241011355"><a name="zh-cn_topic_0000002209492862_p192241011355"></a><a name="zh-cn_topic_0000002209492862_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="81.46%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002209492862_p102241606359"><a name="zh-cn_topic_0000002209492862_p102241606359"></a><a name="zh-cn_topic_0000002209492862_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002209492862_row139421414134616"><td class="cellrowborder" valign="top" width="18.54%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492862_p2225120183520"><a name="zh-cn_topic_0000002209492862_p2225120183520"></a><a name="zh-cn_topic_0000002209492862_p2225120183520"></a>EXEC_DISABLE_REUSED_MEMORY</p>
</td>
<td class="cellrowborder" valign="top" width="81.46%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492862_p26646309300"><a name="zh-cn_topic_0000002209492862_p26646309300"></a><a name="zh-cn_topic_0000002209492862_p26646309300"></a>内存复用开关。</p>
<p id="zh-cn_topic_0000002209492862_p1230635462015"><a name="zh-cn_topic_0000002209492862_p1230635462015"></a><a name="zh-cn_topic_0000002209492862_p1230635462015"></a><span>内存复用是指按照生命周期和内存大小，把不冲突的内存重复使用，来降低网络内存占用</span>。</p>
<p id="zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_p10176133334810"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_p10176133334810"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_p10176133334810"></a><strong id="zh-cn_topic_0000002209492862_b56787092410"><a name="zh-cn_topic_0000002209492862_b56787092410"></a><a name="zh-cn_topic_0000002209492862_b56787092410"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209492862_ul1553135220471"></a><a name="zh-cn_topic_0000002209492862_ul1553135220471"></a><ul id="zh-cn_topic_0000002209492862_ul1553135220471"><li>0：（默认值）开启内存复用。</li><li>1：关闭内存复用。如果网络模型较大，关闭内存复用开关，会造成后续推理时Device侧内存不复用，从而导致内存不足。</li></ul>
<p id="zh-cn_topic_0000002209492862_p4975133852517"><a name="zh-cn_topic_0000002209492862_p4975133852517"></a><a name="zh-cn_topic_0000002209492862_p4975133852517"></a><strong id="zh-cn_topic_0000002209492862_b89751138162519"><a name="zh-cn_topic_0000002209492862_b89751138162519"></a><a name="zh-cn_topic_0000002209492862_b89751138162519"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209492862_screen89754389258"><a name="zh-cn_topic_0000002209492862_screen89754389258"></a><a name="zh-cn_topic_0000002209492862_screen89754389258"></a>{ge::ir_option::EXEC_DISABLE_REUSED_MEMORY, "0"}</pre>
<p id="zh-cn_topic_0000002209492862_p41083276116"><a name="zh-cn_topic_0000002209492862_p41083276116"></a><a name="zh-cn_topic_0000002209492862_p41083276116"></a><span class="ddd" id="zh-cn_topic_0000002209492862_ph3730559115517"><a name="zh-cn_topic_0000002209492862_ph3730559115517"></a><a name="zh-cn_topic_0000002209492862_ph3730559115517"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492862_p4621437171113"><a name="zh-cn_topic_0000002209492862_p4621437171113"></a><a name="zh-cn_topic_0000002209492862_p4621437171113"></a><span id="zh-cn_topic_0000002209492862_ph21441827161116"><a name="zh-cn_topic_0000002209492862_ph21441827161116"></a><a name="zh-cn_topic_0000002209492862_ph21441827161116"></a><term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492862_p1957617275386"><a name="zh-cn_topic_0000002209492862_p1957617275386"></a><a name="zh-cn_topic_0000002209492862_p1957617275386"></a><span id="zh-cn_topic_0000002209492862_ph673964943810"><a name="zh-cn_topic_0000002209492862_ph673964943810"></a><a name="zh-cn_topic_0000002209492862_ph673964943810"></a><term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209492862_row394231414468"><td class="cellrowborder" valign="top" width="18.54%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492862_p12811210174913"><a name="zh-cn_topic_0000002209492862_p12811210174913"></a><a name="zh-cn_topic_0000002209492862_p12811210174913"></a>EXTERNAL_WEIGHT</p>
</td>
<td class="cellrowborder" valign="top" width="81.46%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_zh-cn_topic_0221674006_zh-cn_topic_0162519416_p135713443159"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_zh-cn_topic_0221674006_zh-cn_topic_0162519416_p135713443159"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_zh-cn_topic_0221674006_zh-cn_topic_0162519416_p135713443159"></a>生成om模型文件时，是否将原始网络中的Const/Constant节点的权重外置，同时将节点类型转换为FileConstant类型。</p>
<p id="zh-cn_topic_0000002209492862_p31171113134015"><a name="zh-cn_topic_0000002209492862_p31171113134015"></a><a name="zh-cn_topic_0000002209492862_p31171113134015"></a>离线场景，如果模型权重较大且环境对om离线模型大小有限制，建议开启外置权重将权重单独保存，来减小om大小。</p>
<p id="zh-cn_topic_0000002209492862_p114101332575"><a name="zh-cn_topic_0000002209492862_p114101332575"></a><a name="zh-cn_topic_0000002209492862_p114101332575"></a><strong id="zh-cn_topic_0000002209492862_b16315023134010"><a name="zh-cn_topic_0000002209492862_b16315023134010"></a><a name="zh-cn_topic_0000002209492862_b16315023134010"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209492862_ul1184514015365"></a><a name="zh-cn_topic_0000002209492862_ul1184514015365"></a><ul id="zh-cn_topic_0000002209492862_ul1184514015365"><li>0：（默认值）权重不外置，直接保存在om离线模型文件中。</li><li>1：权重外置，将网络中所有Const/Constant节点的权重文件落盘，并将节点类型转换为FileConstant类型；权重文件保存在与om文件同层级的weight目录下，不同节点权重保存到不同的文件中，以weight_&lt;hash值&gt;值命名。</li></ul>
<p id="zh-cn_topic_0000002209492862_p105101639459"><a name="zh-cn_topic_0000002209492862_p105101639459"></a><a name="zh-cn_topic_0000002209492862_p105101639459"></a><strong id="zh-cn_topic_0000002209492862_b1817217460434"><a name="zh-cn_topic_0000002209492862_b1817217460434"></a><a name="zh-cn_topic_0000002209492862_b1817217460434"></a>配置示例</strong>：</p>
<pre class="screen" id="zh-cn_topic_0000002209492862_screen1698788863"><a name="zh-cn_topic_0000002209492862_screen1698788863"></a><a name="zh-cn_topic_0000002209492862_screen1698788863"></a>{ge::ir_option::EXTERNAL_WEIGHT, "1"}</pre>
<p id="zh-cn_topic_0000002209492862_p148515719617"><a name="zh-cn_topic_0000002209492862_p148515719617"></a><a name="zh-cn_topic_0000002209492862_p148515719617"></a><strong id="zh-cn_topic_0000002209492862_b20861570618"><a name="zh-cn_topic_0000002209492862_b20861570618"></a><a name="zh-cn_topic_0000002209492862_b20861570618"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002209492862_ul7473514713"></a><a name="zh-cn_topic_0000002209492862_ul7473514713"></a><ul id="zh-cn_topic_0000002209492862_ul7473514713"><li>权重外置场景，在使用<span id="zh-cn_topic_0000002209492862_ph4675172181519"><a name="zh-cn_topic_0000002209492862_ph4675172181519"></a><a name="zh-cn_topic_0000002209492862_ph4675172181519"></a>acl</span>接口开发推理应用、加载模型时：<a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul16530015193420"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul16530015193420"></a><ul id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul16530015193420"><li>使用<a href="aclgrphSaveModel.md">aclgrphSaveModel</a>接口保存om模型：<a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul179642535019"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul179642535019"></a><ul id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul179642535019"><li>若使用aclmdlLoadFromFile接口加载模型，需将权重文件保存在与om文件同层级的weight目录下。</li><li>若使用aclmdlSetConfigOpt和aclmdlLoadWithConfig接口加载模型，对权重外置目录没有要求，后续加载模型时，通过aclmdlLoadWithConfig接口指定权重外置目录。</li></ul>
</li><li>权重更新场景，使用<a href="aclgrphBundleSaveModel.md">aclgrphBundleSaveModel</a>接口保存om模型：<p id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_p20948939185014"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_p20948939185014"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_p20948939185014"></a>只能使用aclmdlBundleLoadFromFile接口加载模型，并且需将权重文件保存在与om文件同层级的weight目录下。</p>
</li></ul>
<p id="zh-cn_topic_0000002209492862_p933224214119"><a name="zh-cn_topic_0000002209492862_p933224214119"></a><a name="zh-cn_topic_0000002209492862_p933224214119"></a>接口详细说明请参见<span id="zh-cn_topic_0000002209492862_ph1993918422110"><a name="zh-cn_topic_0000002209492862_ph1993918422110"></a><a name="zh-cn_topic_0000002209492862_ph1993918422110"></a></span><span id="zh-cn_topic_0000002209492862_ph5452167102918"><a name="zh-cn_topic_0000002209492862_ph5452167102918"></a><a name="zh-cn_topic_0000002209492862_ph5452167102918"></a>《应用开发指南 (C&amp;C++)》</span>。</p>
</li></ul>
<p id="zh-cn_topic_0000002209492862_p136842040175312"><a name="zh-cn_topic_0000002209492862_p136842040175312"></a><a name="zh-cn_topic_0000002209492862_p136842040175312"></a><span class="ddd" id="zh-cn_topic_0000002209492862_ph6292131212578"><a name="zh-cn_topic_0000002209492862_ph6292131212578"></a><a name="zh-cn_topic_0000002209492862_ph6292131212578"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492862_p480175305912"><a name="zh-cn_topic_0000002209492862_p480175305912"></a><a name="zh-cn_topic_0000002209492862_p480175305912"></a><span id="zh-cn_topic_0000002209492862_ph198015335912"><a name="zh-cn_topic_0000002209492862_ph198015335912"></a><a name="zh-cn_topic_0000002209492862_ph198015335912"></a><term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492862_p4801053125910"><a name="zh-cn_topic_0000002209492862_p4801053125910"></a><a name="zh-cn_topic_0000002209492862_p4801053125910"></a><span id="zh-cn_topic_0000002209492862_ph2080353195910"><a name="zh-cn_topic_0000002209492862_ph2080353195910"></a><a name="zh-cn_topic_0000002209492862_ph2080353195910"></a><term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 动态shape<a name="section1512812925419"></a>

<a name="table9231515552"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002244572897_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002244572897_p192241011355"><a name="zh-cn_topic_0000002244572897_p192241011355"></a><a name="zh-cn_topic_0000002244572897_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002244572897_p102241606359"><a name="zh-cn_topic_0000002244572897_p102241606359"></a><a name="zh-cn_topic_0000002244572897_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002244572897_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572897_p15833144123920"><a name="zh-cn_topic_0000002244572897_p15833144123920"></a><a name="zh-cn_topic_0000002244572897_p15833144123920"></a>AC_PARALLEL_ENABLE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572897_p3962116131913"><a name="zh-cn_topic_0000002244572897_p3962116131913"></a><a name="zh-cn_topic_0000002244572897_p3962116131913"></a>动态shape图中，是否允许AI CPU算子和AI Core算子并行运行。</p>
<p id="zh-cn_topic_0000002244572897_p493801713309"><a name="zh-cn_topic_0000002244572897_p493801713309"></a><a name="zh-cn_topic_0000002244572897_p493801713309"></a>动态shape图中，开关开启时，系统自动识别图中可以和AI Core并发的AI CPU算子，不同引擎的算子下发到不同流上，实现多引擎间的并行，从而提升资源利用效率和动态shape执行性能。</p>
<p id="zh-cn_topic_0000002244572897_p150535616117"><a name="zh-cn_topic_0000002244572897_p150535616117"></a><a name="zh-cn_topic_0000002244572897_p150535616117"></a><strong id="zh-cn_topic_0000002244572897_b1676915321217"><a name="zh-cn_topic_0000002244572897_b1676915321217"></a><a name="zh-cn_topic_0000002244572897_b1676915321217"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244572897_ul16951746103014"></a><a name="zh-cn_topic_0000002244572897_ul16951746103014"></a><ul id="zh-cn_topic_0000002244572897_ul16951746103014"><li>1：允许AI CPU和AI Core算子间的并行运行。</li><li>0（默认）：AI CPU算子不会单独分流。</li></ul>
<p id="zh-cn_topic_0000002244572897_p640424215712"><a name="zh-cn_topic_0000002244572897_p640424215712"></a><a name="zh-cn_topic_0000002244572897_p640424215712"></a><strong id="zh-cn_topic_0000002244572897_b93475117120"><a name="zh-cn_topic_0000002244572897_b93475117120"></a><a name="zh-cn_topic_0000002244572897_b93475117120"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572897_screen3258511884"><a name="zh-cn_topic_0000002244572897_screen3258511884"></a><a name="zh-cn_topic_0000002244572897_screen3258511884"></a>{ge::ir_option::AC_PARALLEL_ENABLE, "1"}</pre>
<p id="zh-cn_topic_0000002244572897_p16208153044113"><a name="zh-cn_topic_0000002244572897_p16208153044113"></a><a name="zh-cn_topic_0000002244572897_p16208153044113"></a><span class="ddd" id="zh-cn_topic_0000002244572897_ph920833074119"><a name="zh-cn_topic_0000002244572897_ph920833074119"></a><a name="zh-cn_topic_0000002244572897_ph920833074119"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572897_p1920933016417"><a name="zh-cn_topic_0000002244572897_p1920933016417"></a><a name="zh-cn_topic_0000002244572897_p1920933016417"></a><span id="zh-cn_topic_0000002244572897_ph1220933044114"><a name="zh-cn_topic_0000002244572897_ph1220933044114"></a><a name="zh-cn_topic_0000002244572897_ph1220933044114"></a><term id="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244572897_p777415121318"><a name="zh-cn_topic_0000002244572897_p777415121318"></a><a name="zh-cn_topic_0000002244572897_p777415121318"></a><span id="zh-cn_topic_0000002244572897_ph147718156134"><a name="zh-cn_topic_0000002244572897_ph147718156134"></a><a name="zh-cn_topic_0000002244572897_ph147718156134"></a><term id="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 算子编译与图编译<a name="section58884125540"></a>

<a name="table7182152125512"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002209492870_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002209492870_p192241011355"><a name="zh-cn_topic_0000002209492870_p192241011355"></a><a name="zh-cn_topic_0000002209492870_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002209492870_p102241606359"><a name="zh-cn_topic_0000002209492870_p102241606359"></a><a name="zh-cn_topic_0000002209492870_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002209492870_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492870_p424042359"><a name="zh-cn_topic_0000002209492870_p424042359"></a><a name="zh-cn_topic_0000002209492870_p424042359"></a>CORE_TYPE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492870_p18405163631319"><a name="zh-cn_topic_0000002209492870_p18405163631319"></a><a name="zh-cn_topic_0000002209492870_p18405163631319"></a>设置图编译时使用的Core类型，若图中包括Cube算子，则只能使用AiCore。</p>
<p id="zh-cn_topic_0000002209492870_zh-cn_topic_0221674006_p12602235416"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0221674006_p12602235416"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0221674006_p12602235416"></a><strong id="zh-cn_topic_0000002209492870_b138618310585"><a name="zh-cn_topic_0000002209492870_b138618310585"></a><a name="zh-cn_topic_0000002209492870_b138618310585"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209492870_zh-cn_topic_0221674006_ul75463814912"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0221674006_ul75463814912"></a><ul id="zh-cn_topic_0000002209492870_zh-cn_topic_0221674006_ul75463814912"><li>VectorCore</li><li>AiCore，默认为AiCore。</li></ul>
<p id="zh-cn_topic_0000002209492870_p14536114219139"><a name="zh-cn_topic_0000002209492870_p14536114219139"></a><a name="zh-cn_topic_0000002209492870_p14536114219139"></a><strong id="zh-cn_topic_0000002209492870_b065810280151"><a name="zh-cn_topic_0000002209492870_b065810280151"></a><a name="zh-cn_topic_0000002209492870_b065810280151"></a>配置示例</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209492870_screen827962516156"><a name="zh-cn_topic_0000002209492870_screen827962516156"></a><a name="zh-cn_topic_0000002209492870_screen827962516156"></a>{ge::ir_option::CORE_TYPE, "AiCore"}</pre>
<p id="zh-cn_topic_0000002209492870_p51853511429"><a name="zh-cn_topic_0000002209492870_p51853511429"></a><a name="zh-cn_topic_0000002209492870_p51853511429"></a><span class="ddd" id="zh-cn_topic_0000002209492870_ph764162117337"><a name="zh-cn_topic_0000002209492870_ph764162117337"></a><a name="zh-cn_topic_0000002209492870_ph764162117337"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492870_p15603149304"><a name="zh-cn_topic_0000002209492870_p15603149304"></a><a name="zh-cn_topic_0000002209492870_p15603149304"></a><span id="zh-cn_topic_0000002209492870_ph66021493017"><a name="zh-cn_topic_0000002209492870_ph66021493017"></a><a name="zh-cn_topic_0000002209492870_ph66021493017"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：不支持</p>
<p id="zh-cn_topic_0000002209492870_p20355141012540"><a name="zh-cn_topic_0000002209492870_p20355141012540"></a><a name="zh-cn_topic_0000002209492870_p20355141012540"></a><span id="zh-cn_topic_0000002209492870_ph10356151055417"><a name="zh-cn_topic_0000002209492870_ph10356151055417"></a><a name="zh-cn_topic_0000002209492870_ph10356151055417"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：不支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209492870_row356217715216"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492870_p11832174517353"><a name="zh-cn_topic_0000002209492870_p11832174517353"></a><a name="zh-cn_topic_0000002209492870_p11832174517353"></a>AICORE_NUM</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492870_p1013816913175"><a name="zh-cn_topic_0000002209492870_p1013816913175"></a><a name="zh-cn_topic_0000002209492870_p1013816913175"></a>用于配置算子编译时使用的AI Core核数。</p>
<p id="zh-cn_topic_0000002209492870_p96741129153212"><a name="zh-cn_topic_0000002209492870_p96741129153212"></a><a name="zh-cn_topic_0000002209492870_p96741129153212"></a><strong id="zh-cn_topic_0000002209492870_b7623528514"><a name="zh-cn_topic_0000002209492870_b7623528514"></a><a name="zh-cn_topic_0000002209492870_b7623528514"></a>参数取值：</strong>"整数1|整数2"，中间使用“|”分隔：</p>
<a name="zh-cn_topic_0000002209492870_ul127384863917"></a><a name="zh-cn_topic_0000002209492870_ul127384863917"></a><ul id="zh-cn_topic_0000002209492870_ul127384863917"><li><strong id="zh-cn_topic_0000002209492870_b1681919228571"><a name="zh-cn_topic_0000002209492870_b1681919228571"></a><a name="zh-cn_topic_0000002209492870_b1681919228571"></a>场景1</strong>：针对如下<span id="zh-cn_topic_0000002209492870_ph20833205312295"><a name="zh-cn_topic_0000002209492870_ph20833205312295"></a><a name="zh-cn_topic_0000002209492870_ph20833205312295"></a>产品</span>，整数1表示算子编译时使用的AI Core中的Cube Core核数，整数2表示算子编译时使用的AI Core中的VectorCore核数，整数1与整数2都需要大于0，小于等于<span id="zh-cn_topic_0000002209492870_ph423516525455"><a name="zh-cn_topic_0000002209492870_ph423516525455"></a><a name="zh-cn_topic_0000002209492870_ph423516525455"></a>昇腾AI处理器</span>包含的最大Cube Core和Vector Core数量：<p id="zh-cn_topic_0000002209492870_p1265122215411"><a name="zh-cn_topic_0000002209492870_p1265122215411"></a><a name="zh-cn_topic_0000002209492870_p1265122215411"></a><span id="zh-cn_topic_0000002209492870_ph1943304419396"><a name="zh-cn_topic_0000002209492870_ph1943304419396"></a><a name="zh-cn_topic_0000002209492870_ph1943304419396"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002209492870_p15412964119"><a name="zh-cn_topic_0000002209492870_p15412964119"></a><a name="zh-cn_topic_0000002209492870_p15412964119"></a><span id="zh-cn_topic_0000002209492870_ph7169433143910"><a name="zh-cn_topic_0000002209492870_ph7169433143910"></a><a name="zh-cn_topic_0000002209492870_ph7169433143910"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002209492870_p181510921017"><a name="zh-cn_topic_0000002209492870_p181510921017"></a><a name="zh-cn_topic_0000002209492870_p181510921017"></a><strong id="zh-cn_topic_0000002209492870_b131618917103"><a name="zh-cn_topic_0000002209492870_b131618917103"></a><a name="zh-cn_topic_0000002209492870_b131618917103"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002209492870_ul15344710191019"></a><a name="zh-cn_topic_0000002209492870_ul15344710191019"></a><ul id="zh-cn_topic_0000002209492870_ul15344710191019"><li>针对参数值中的场景1：<div class="p" id="zh-cn_topic_0000002209492870_p17875579521"><a name="zh-cn_topic_0000002209492870_p17875579521"></a><a name="zh-cn_topic_0000002209492870_p17875579521"></a>不同<span id="zh-cn_topic_0000002209492870_ph1555712386204"><a name="zh-cn_topic_0000002209492870_ph1555712386204"></a><a name="zh-cn_topic_0000002209492870_ph1555712386204"></a>昇腾AI处理器</span>包含的最大Cube Core与Vector Core的数量可从"<span id="zh-cn_topic_0000002209492870_ph10562197165916"><a name="zh-cn_topic_0000002209492870_ph10562197165916"></a><a name="zh-cn_topic_0000002209492870_ph10562197165916"></a>${INSTALL_DIR}</span>/<em id="zh-cn_topic_0000002209492870_i19279101185016"><a name="zh-cn_topic_0000002209492870_i19279101185016"></a><a name="zh-cn_topic_0000002209492870_i19279101185016"></a>&lt;arch&gt;</em>-linux/data/platform_config/<em id="zh-cn_topic_0000002209492870_i1727941115019"><a name="zh-cn_topic_0000002209492870_i1727941115019"></a><a name="zh-cn_topic_0000002209492870_i1727941115019"></a>xxx</em>.ini"文件查看，如下所示，说明<span id="zh-cn_topic_0000002209492870_ph193791130181718"><a name="zh-cn_topic_0000002209492870_ph193791130181718"></a><a name="zh-cn_topic_0000002209492870_ph193791130181718"></a>昇腾AI处理器</span>上存在24个Cube Core，存在48个Vector Core。<pre class="screen" id="zh-cn_topic_0000002209492870_screen20279181185012"><a name="zh-cn_topic_0000002209492870_screen20279181185012"></a><a name="zh-cn_topic_0000002209492870_screen20279181185012"></a>[SoCInfo]
# 参数配置为默认值，默认值即为最大值
ai_core_cnt=24
<strong id="zh-cn_topic_0000002209492870_b102044574502"><a name="zh-cn_topic_0000002209492870_b102044574502"></a><a name="zh-cn_topic_0000002209492870_b102044574502"></a>cube_core_cnt</strong>=24
<strong id="zh-cn_topic_0000002209492870_b43688589500"><a name="zh-cn_topic_0000002209492870_b43688589500"></a><a name="zh-cn_topic_0000002209492870_b43688589500"></a>vector_core_cnt</strong>=48</pre>
</div>
</li><li>如果配置该参数的同时启用了算子编译缓存功能（OP_COMPILER_CACHE_MODE参数配置为“enable”或者“force”，默认为“enable”），此参数仅在首次编译时生效。若您想在非首次编译时生效该参数，需要清理编译磁盘的缓存。</li></ul>
<p id="zh-cn_topic_0000002209492870_p3650165455116"><a name="zh-cn_topic_0000002209492870_p3650165455116"></a><a name="zh-cn_topic_0000002209492870_p3650165455116"></a>其中，<span id="zh-cn_topic_0000002209492870_ph1027510266551"><a name="zh-cn_topic_0000002209492870_ph1027510266551"></a><a name="zh-cn_topic_0000002209492870_ph1027510266551"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002209492870_i75081016521"><a name="zh-cn_topic_0000002209492870_i75081016521"></a><a name="zh-cn_topic_0000002209492870_i75081016521"></a>&lt;arch&gt;</em>表示具体操作系统架构，<em id="zh-cn_topic_0000002209492870_i75091010524"><a name="zh-cn_topic_0000002209492870_i75091010524"></a><a name="zh-cn_topic_0000002209492870_i75091010524"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002209492870_ph1150171055216"><a name="zh-cn_topic_0000002209492870_ph1150171055216"></a><a name="zh-cn_topic_0000002209492870_ph1150171055216"></a>产品</span>进行选择。</p>
<p id="zh-cn_topic_0000002209492870_p1747712445309"><a name="zh-cn_topic_0000002209492870_p1747712445309"></a><a name="zh-cn_topic_0000002209492870_p1747712445309"></a><strong id="zh-cn_topic_0000002209492870_b12310112663113"><a name="zh-cn_topic_0000002209492870_b12310112663113"></a><a name="zh-cn_topic_0000002209492870_b12310112663113"></a>配置示例：</strong></p>
<a name="zh-cn_topic_0000002209492870_ul13868135794511"></a><a name="zh-cn_topic_0000002209492870_ul13868135794511"></a><ul id="zh-cn_topic_0000002209492870_ul13868135794511"><li>场景1配置示例：<pre class="screen" id="zh-cn_topic_0000002209492870_screen1216843611811"><a name="zh-cn_topic_0000002209492870_screen1216843611811"></a><a name="zh-cn_topic_0000002209492870_screen1216843611811"></a>{ge::ir_option::AICORE_NUM, "24|48"}</pre>
</li></ul>
<p id="zh-cn_topic_0000002209492870_p9161193419167"><a name="zh-cn_topic_0000002209492870_p9161193419167"></a><a name="zh-cn_topic_0000002209492870_p9161193419167"></a><strong id="zh-cn_topic_0000002209492870_b13639185216166"><a name="zh-cn_topic_0000002209492870_b13639185216166"></a><a name="zh-cn_topic_0000002209492870_b13639185216166"></a>了解AI Core、Cube Core、Vector Core的关系</strong>：</p>
<p id="zh-cn_topic_0000002209492870_p9609151514411"><a name="zh-cn_topic_0000002209492870_p9609151514411"></a><a name="zh-cn_topic_0000002209492870_p9609151514411"></a>为便于理解AI Core、Cube Core、Vector Core的关系，此处先明确Core的定义，Core是指拥有独立Scalar计算单元的一个计算核，通常Scalar计算单元承担了一个计算核的SIMD（单指令多数据，Single Instruction Multiple Data）指令发射等功能，所以我们也通常也把这个Scalar计算单元称为核内的调度单元。不同产品上的AI数据处理核心单元不同，当前分为以下几类：</p>
<a name="zh-cn_topic_0000002209492870_ul6504113413162"></a><a name="zh-cn_topic_0000002209492870_ul6504113413162"></a><ul id="zh-cn_topic_0000002209492870_ul6504113413162"><li>当AI数据处理核心单元是AI Core：<a name="zh-cn_topic_0000002209492870_ul1174813074910"></a><a name="zh-cn_topic_0000002209492870_ul1174813074910"></a><ul id="zh-cn_topic_0000002209492870_ul1174813074910"><li>在AI Core内，Cube和Vector共用一个Scalar调度单元。<p id="zh-cn_topic_0000002209492870_p742833143614"><a name="zh-cn_topic_0000002209492870_p742833143614"></a><a name="zh-cn_topic_0000002209492870_p742833143614"></a><a name="zh-cn_topic_0000002209492870_image1391238163613"></a><a name="zh-cn_topic_0000002209492870_image1391238163613"></a><span><img class="eddx" id="zh-cn_topic_0000002209492870_image1391238163613" src="figures/逻辑架构图.png" width="206.48250000000002" height="163.59"></span></p>
</li><li>在AI Core内，Cube和Vector都有各自的Scalar调度单元，因此又被称为Cube Core、Vector Core。这时，一个Cube Core和一组Vector Core被定义为一个AI Core，AI Core数量通常是以多少个Cube Core为基准计算的，例如<span id="zh-cn_topic_0000002209492870_ph2505726191717"><a name="zh-cn_topic_0000002209492870_ph2505726191717"></a><a name="zh-cn_topic_0000002209492870_ph2505726191717"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>。<p id="zh-cn_topic_0000002209492870_p778114462419"><a name="zh-cn_topic_0000002209492870_p778114462419"></a><a name="zh-cn_topic_0000002209492870_p778114462419"></a><a name="zh-cn_topic_0000002209492870_image14781154412410"></a><a name="zh-cn_topic_0000002209492870_image14781154412410"></a><span><img class="eddx" id="zh-cn_topic_0000002209492870_image14781154412410" src="figures/逻辑架构图-0.png"></span></p>
</li></ul>
</li><li>当AI数据处理核心单元是AI Core以及单独的Vector Core：AI Core和Vector Core都拥有独立的Scalar调度单元。<p id="zh-cn_topic_0000002209492870_p137910620378"><a name="zh-cn_topic_0000002209492870_p137910620378"></a><a name="zh-cn_topic_0000002209492870_p137910620378"></a><a name="zh-cn_topic_0000002209492870_image65091178379"></a><a name="zh-cn_topic_0000002209492870_image65091178379"></a><span><img class="eddx" id="zh-cn_topic_0000002209492870_image65091178379" src="figures/逻辑架构图-1.png" width="450.87" height="172.5675"></span></p>
</li></ul>
</td>
</tr>
<tr id="zh-cn_topic_0000002209492870_row17725410115218"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492870_p46662212812"><a name="zh-cn_topic_0000002209492870_p46662212812"></a><a name="zh-cn_topic_0000002209492870_p46662212812"></a>OP_COMPILER_CACHE_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492870_p088621016169"><a name="zh-cn_topic_0000002209492870_p088621016169"></a><a name="zh-cn_topic_0000002209492870_p088621016169"></a>用于配置算子编译磁盘缓存模式。</p>
<p id="zh-cn_topic_0000002209492870_p144729493303"><a name="zh-cn_topic_0000002209492870_p144729493303"></a><a name="zh-cn_topic_0000002209492870_p144729493303"></a><strong id="zh-cn_topic_0000002209492870_b15675355163010"><a name="zh-cn_topic_0000002209492870_b15675355163010"></a><a name="zh-cn_topic_0000002209492870_b15675355163010"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209492870_ul9580550151712"></a><a name="zh-cn_topic_0000002209492870_ul9580550151712"></a><ul id="zh-cn_topic_0000002209492870_ul9580550151712"><li>enable：（默认值）表示启用算子编译缓存。启用后可以避免针对相同编译参数及算子参数的算子重复编译，从而提升编译速度。</li><li>force：启用算子编译缓存功能，区别于enable模式，force模式下会强制刷新缓存，即先删除已有缓存，再重新编译并加入缓存。比如当用户的python变更、依赖库变更、算子调优后知识库变更等，需要先指定为force用于先清理已有的缓存，后续再修改为enable模式，以避免每次编译时都强制刷新缓存。</li><li>disable：表示禁用算子编译缓存，算子重新编译。</li></ul>
<p id="zh-cn_topic_0000002209492870_p86752020183315"><a name="zh-cn_topic_0000002209492870_p86752020183315"></a><a name="zh-cn_topic_0000002209492870_p86752020183315"></a><strong id="zh-cn_topic_0000002209492870_b248232717334"><a name="zh-cn_topic_0000002209492870_b248232717334"></a><a name="zh-cn_topic_0000002209492870_b248232717334"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209492870_screen624816103413"><a name="zh-cn_topic_0000002209492870_screen624816103413"></a><a name="zh-cn_topic_0000002209492870_screen624816103413"></a>{ge::ir_option::OP_COMPILER_CACHE_MODE, "enable"}</pre>
<p id="zh-cn_topic_0000002209492870_p8370114093219"><a name="zh-cn_topic_0000002209492870_p8370114093219"></a><a name="zh-cn_topic_0000002209492870_p8370114093219"></a><strong id="zh-cn_topic_0000002209492870_b945715612319"><a name="zh-cn_topic_0000002209492870_b945715612319"></a><a name="zh-cn_topic_0000002209492870_b945715612319"></a>使用说明：</strong></p>
<a name="zh-cn_topic_0000002209492870_ul15373204019326"></a><a name="zh-cn_topic_0000002209492870_ul15373204019326"></a><ul id="zh-cn_topic_0000002209492870_ul15373204019326"><li>如果要自行指定算子编译磁盘缓存的路径，则需要与OP_COMPILER_CACHE_DIR配合使用。</li><li>启用算子编译缓存功能时，可以通过<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"></a>配置文件</strong>（算子编译完成后，会在OP_COMPILER_CACHE_DIR参数指定路径下自动生成op_cache.ini文件）、<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"></a>环境变量</strong>两种方式来设置缓存文件夹的磁盘空间大小：<a name="zh-cn_topic_0000002209492870_ol1662675617178"></a><a name="zh-cn_topic_0000002209492870_ol1662675617178"></a><ol id="zh-cn_topic_0000002209492870_ol1662675617178"><li>通过配置文件op_cache.ini设置<p id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p11244135522814"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p11244135522814"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p11244135522814"></a>若op_cache.ini文件不存在，则需要手动创建。打开该文件，增加如下信息：</p>
<pre class="screen" id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen2068111579454"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen2068111579454"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen2068111579454"></a>#配置文件格式，必须包含，自动生成的文件中默认包括如下信息，手动创建时，需要输入
<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1092612334716"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1092612334716"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1092612334716"></a>[op_compiler_cache]</strong>
#限制某个芯片下缓存文件夹的磁盘空间的大小，默认值为500，取值需为整数，单位为MB
<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b183169361071"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b183169361071"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b183169361071"></a>max_op_cache_size=500</strong>
#设置需要保留缓存的空间大小比例，取值范围：[1,100]，默认值为50，单位为百分比；例如取值为80表示缓存空间不足时，删除缓存文件，保留80%缓存空间
<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b104141138171"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b104141138171"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b104141138171"></a>remain_cache_size_ratio=50   </strong> </pre>
<a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul882504017583"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul882504017583"></a><ul id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul882504017583"><li>上述文件中的max_op_cache_size和remain_cache_size_ratio参数取值都有效时，op_cache.ini文件才会生效。</li><li>当编译缓存文件大小超过“max_op_cache_size”的设置值，且超过半小时缓存文件未被访问时，缓存文件就会老化（算子编译时，不会因为编译缓存文件大小超过设置值而中断，所以当“max_op_cache_size”设置过小时，会出现实际编译缓存文件大小超过此设置值的情况）。</li><li>若需要关闭编译缓存老化功能，可将“max_op_cache_size”设置为“-1”，此时访问算子缓存时不会更新访问时间，算子编译缓存不会老化，磁盘空间使用默认大小500MB。</li><li>若多个使用者使用相同的缓存路径，建议使用配置文件的方式进行设置，该场景下op_cache.ini文件会影响所有使用者。</li></ul>
</li><li>通过环境变量设置<p id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p168533161489"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p168533161489"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p168533161489"></a>该场景下，开发者可以通过环境变量ASCEND_MAX_OP_CACHE_SIZE来限制某个芯片下缓存文件夹的磁盘空间的大小，当编译缓存空间大小达到ASCEND_MAX_OP_CACHE_SIZE设置的取值，且超过半个小时缓存文件未被访问时，缓存文件就会老化。可通过环境变量ASCEND_REMAIN_CACHE_SIZE_RATIO设置需要保留缓存的空间大小比例。</p>
<p id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p148481416174115"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p148481416174115"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p148481416174115"></a>配置示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen144318131013"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen144318131013"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen144318131013"></a># ASCEND_MAX_OP_CACHE_SIZE环境变量默认值为500，取值需为整数，单位为MB
<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b192231741079"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b192231741079"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b192231741079"></a>export ASCEND_MAX_OP_CACHE_SIZE=500</strong>
# ASCEND_REMAIN_CACHE_SIZE_RATIO环境变量取值范围：[1,100]，默认值为50，单位为百分比；例如取值为80表示缓存空间不足时，删除缓存文件，保留80%缓存空间
<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b17361124319712"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b17361124319712"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b17361124319712"></a>export ASCEND_REMAIN_CACHE_SIZE_RATIO=50</strong></pre>
<a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul17158135011233"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul17158135011233"></a><ul id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul17158135011233"><li>通过环境变量配置，只对当前用户生效。</li><li>若需要关闭编译缓存老化功能，可将环境变量“<strong id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1775511712244"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1775511712244"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1775511712244"></a>ASCEND_MAX_OP_CACHE_SIZE</strong>”设置为“-1”，此时访问算子缓存时不会更新访问时间，算子编译缓存不会老化，磁盘空间使用默认大小500MB。</li></ul>
</li></ol>
<p id="zh-cn_topic_0000002209492870_p528193213810"><a name="zh-cn_topic_0000002209492870_p528193213810"></a><a name="zh-cn_topic_0000002209492870_p528193213810"></a><strong id="zh-cn_topic_0000002209492870_b15450456152213"><a name="zh-cn_topic_0000002209492870_b15450456152213"></a><a name="zh-cn_topic_0000002209492870_b15450456152213"></a>若同时配置了op_cache.ini文件和环境变量，则优先读取op_cache.ini文件中的配置项，若op_cache.ini文件和环境变量都未设置，则读取系统默认值：默认磁盘空间大小500MB，默认保留缓存空间的50%。</strong></p>
</li><li>由于force选项会先删除已有缓存，所以不建议在程序并行编译时设置，否则可能会导致其他模型因使用的缓存内容被清除而编译失败。</li><li>建议模型最终发布时设置编译缓存选项为disable或者force。</li><li>如果算子调优后知识库变更，则需要通过设置为force来刷新缓存，否则无法应用新的调优知识库，从而导致调优应用执行失败。</li><li>调试开关打开的场景：<a name="zh-cn_topic_0000002209492870_ul928413534811"></a><a name="zh-cn_topic_0000002209492870_ul928413534811"></a><ul id="zh-cn_topic_0000002209492870_ul928413534811"><li>OP_DEBUG_LEVEL配置非0值：会忽略OP_COMPILER_CACHE_MODE参数的配置，不启用算子编译缓存功能，算子全部重新编译。</li><li>OP_DEBUG_CONFIG配置非空，且<strong id="zh-cn_topic_0000002209492870_b3151143582012"><a name="zh-cn_topic_0000002209492870_b3151143582012"></a><a name="zh-cn_topic_0000002209492870_b3151143582012"></a>未配置OP_DEBUG_LIST字段</strong>，会忽略OP_COMPILER_CACHE_MODE参数的配置，不启用算子编译缓存功能，算子全部重新编译。</li><li>OP_DEBUG_CONFIG配置非空，且<strong id="zh-cn_topic_0000002209492870_b4708151194610"><a name="zh-cn_topic_0000002209492870_b4708151194610"></a><a name="zh-cn_topic_0000002209492870_b4708151194610"></a>配置文件中配置了OP_DEBUG_LIST字段</strong>：<a name="zh-cn_topic_0000002209492870_ul1114411237501"></a><a name="zh-cn_topic_0000002209492870_ul1114411237501"></a><ul id="zh-cn_topic_0000002209492870_ul1114411237501"><li>列表中的算子，忽略OP_COMPILER_CACHE_MODE参数的配置继续重新编译。</li><li>列表外的算子，如果OP_COMPILER_CACHE_MODE参数配置为enable或force，则启用缓存功能；若配置为disable，则不启用缓存功能，仍旧重新编译。</li></ul>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002209492870_p333313481141"><a name="zh-cn_topic_0000002209492870_p333313481141"></a><a name="zh-cn_topic_0000002209492870_p333313481141"></a><span class="ddd" id="zh-cn_topic_0000002209492870_ph74404435568"><a name="zh-cn_topic_0000002209492870_ph74404435568"></a><a name="zh-cn_topic_0000002209492870_ph74404435568"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492870_p1016918492710"><a name="zh-cn_topic_0000002209492870_p1016918492710"></a><a name="zh-cn_topic_0000002209492870_p1016918492710"></a><span id="zh-cn_topic_0000002209492870_ph13169114914714"><a name="zh-cn_topic_0000002209492870_ph13169114914714"></a><a name="zh-cn_topic_0000002209492870_ph13169114914714"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492870_p28415145489"><a name="zh-cn_topic_0000002209492870_p28415145489"></a><a name="zh-cn_topic_0000002209492870_p28415145489"></a><span id="zh-cn_topic_0000002209492870_ph17841414184817"><a name="zh-cn_topic_0000002209492870_ph17841414184817"></a><a name="zh-cn_topic_0000002209492870_ph17841414184817"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209492870_row8811913115210"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492870_p115671151142915"><a name="zh-cn_topic_0000002209492870_p115671151142915"></a><a name="zh-cn_topic_0000002209492870_p115671151142915"></a>OP_COMPILER_CACHE_DIR</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492870_p186651122168"><a name="zh-cn_topic_0000002209492870_p186651122168"></a><a name="zh-cn_topic_0000002209492870_p186651122168"></a>用于配置算子编译磁盘缓存的目录。</p>
<p id="zh-cn_topic_0000002209492870_zh-cn_topic_0284199581_p1135164991114"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0284199581_p1135164991114"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0284199581_p1135164991114"></a><strong id="zh-cn_topic_0000002209492870_b562820369812"><a name="zh-cn_topic_0000002209492870_b562820369812"></a><a name="zh-cn_topic_0000002209492870_b562820369812"></a>参数值格式：</strong>路径支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）、中文字符。</p>
<p id="zh-cn_topic_0000002209492870_p1016473113613"><a name="zh-cn_topic_0000002209492870_p1016473113613"></a><a name="zh-cn_topic_0000002209492870_p1016473113613"></a><strong id="zh-cn_topic_0000002209492870_b06161551896"><a name="zh-cn_topic_0000002209492870_b06161551896"></a><a name="zh-cn_topic_0000002209492870_b06161551896"></a>默认值：</strong>$HOME/atc_data</p>
<p id="zh-cn_topic_0000002209492870_p4785202318351"><a name="zh-cn_topic_0000002209492870_p4785202318351"></a><a name="zh-cn_topic_0000002209492870_p4785202318351"></a><strong id="zh-cn_topic_0000002209492870_b460473413357"><a name="zh-cn_topic_0000002209492870_b460473413357"></a><a name="zh-cn_topic_0000002209492870_b460473413357"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209492870_screen64360484353"><a name="zh-cn_topic_0000002209492870_screen64360484353"></a><a name="zh-cn_topic_0000002209492870_screen64360484353"></a>{ge::ir_option::OP_COMPILER_CACHE_MODE, "enable"}
{ge::ir_option::OP_COMPILER_CACHE_DIR, "<em id="zh-cn_topic_0000002209492870_i1883641212386"><a name="zh-cn_topic_0000002209492870_i1883641212386"></a><a name="zh-cn_topic_0000002209492870_i1883641212386"></a>/home/test/data/atc_data</em>"}</pre>
<p id="zh-cn_topic_0000002209492870_p3774912094"><a name="zh-cn_topic_0000002209492870_p3774912094"></a><a name="zh-cn_topic_0000002209492870_p3774912094"></a><strong id="zh-cn_topic_0000002209492870_b166202215914"><a name="zh-cn_topic_0000002209492870_b166202215914"></a><a name="zh-cn_topic_0000002209492870_b166202215914"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002209492870_ul121165422032"></a><a name="zh-cn_topic_0000002209492870_ul121165422032"></a><ul id="zh-cn_topic_0000002209492870_ul121165422032"><li>如果要自行指定算子编译磁盘缓存的路径，则需要与OP_COMPILER_CACHE_MODE配合使用。</li><li>如果参数指定的路径存在且有效，则在指定的路径下自动创建子目录kernel_cache；如果指定的路径不存在但路径有效，则先自动创建目录，然后在该路径下自动创建子目录kernel_cache。</li><li>用户请不要在<strong id="zh-cn_topic_0000002209492870_b18278123915115"><a name="zh-cn_topic_0000002209492870_b18278123915115"></a><a name="zh-cn_topic_0000002209492870_b18278123915115"></a>默认缓存目录</strong>下存放其他自有内容，自有内容在软件包安装或升级时会同默认缓存目录一并被删除。</li><li>通过该参数指定的<strong id="zh-cn_topic_0000002209492870_b73581227013"><a name="zh-cn_topic_0000002209492870_b73581227013"></a><a name="zh-cn_topic_0000002209492870_b73581227013"></a>非默认缓存目录</strong>无法删除（软件包安装或升级时不会被删除）。</li><li>算子编译磁盘缓存路径，除OP_COMPILER_CACHE_DIR参数设置的方式外，还可以配置环境变量ASCEND_CACHE_PATH，几种方式优先级为：配置参数“OP_COMPILER_CACHE_DIR”&gt;环境变量ASCEND_CACHE_PATH&gt;默认存储路径。关于环境变量ASCEND_CACHE_PATH的详细说明请参见<span id="zh-cn_topic_0000002209492870_ph7470838306"><a name="zh-cn_topic_0000002209492870_ph7470838306"></a><a name="zh-cn_topic_0000002209492870_ph7470838306"></a>《环境变量参考》</span>。</li></ul>
<p id="zh-cn_topic_0000002209492870_p48641322518"><a name="zh-cn_topic_0000002209492870_p48641322518"></a><a name="zh-cn_topic_0000002209492870_p48641322518"></a><span class="ddd" id="zh-cn_topic_0000002209492870_ph103251149155613"><a name="zh-cn_topic_0000002209492870_ph103251149155613"></a><a name="zh-cn_topic_0000002209492870_ph103251149155613"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492870_p5269951294"><a name="zh-cn_topic_0000002209492870_p5269951294"></a><a name="zh-cn_topic_0000002209492870_p5269951294"></a><span id="zh-cn_topic_0000002209492870_ph72696513913"><a name="zh-cn_topic_0000002209492870_ph72696513913"></a><a name="zh-cn_topic_0000002209492870_ph72696513913"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_4"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_4"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_4"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_4"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_4"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_4"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492870_p176142813486"><a name="zh-cn_topic_0000002209492870_p176142813486"></a><a name="zh-cn_topic_0000002209492870_p176142813486"></a><span id="zh-cn_topic_0000002209492870_ph14761928114813"><a name="zh-cn_topic_0000002209492870_ph14761928114813"></a><a name="zh-cn_topic_0000002209492870_ph14761928114813"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209492870_row11622142861815"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492870_p106223286186"><a name="zh-cn_topic_0000002209492870_p106223286186"></a><a name="zh-cn_topic_0000002209492870_p106223286186"></a>OPTIMIZATION_SWITCH</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492870_p16712350162015"><a name="zh-cn_topic_0000002209492870_p16712350162015"></a><a name="zh-cn_topic_0000002209492870_p16712350162015"></a>算子编译时，融合规则（Pass）的控制开关。</p>
<p id="zh-cn_topic_0000002209492870_p14675644152312"><a name="zh-cn_topic_0000002209492870_p14675644152312"></a><a name="zh-cn_topic_0000002209492870_p14675644152312"></a>该参数与精度比对中FUSION_SWITCH_FILE参数的区别是：FUSION_SWITCH_FILE仅能关闭图融合和UB融合的规则，并且需要单独配置JSON文件，而该参数适用于所有规则，通过参数就能指定融合规则，不需要再单独设置JSON文件。如果两个参数都配置，且配置了同一个融合规则，则以OPTIMIZATION_SWITCH参数配置的为准。</p>
<p id="zh-cn_topic_0000002209492870_p1257818813415"><a name="zh-cn_topic_0000002209492870_p1257818813415"></a><a name="zh-cn_topic_0000002209492870_p1257818813415"></a><strong id="zh-cn_topic_0000002209492870_b15226020173411"><a name="zh-cn_topic_0000002209492870_b15226020173411"></a><a name="zh-cn_topic_0000002209492870_b15226020173411"></a>参数取值：</strong>"Passname1:on;Passname2:off"，可以拼接多个key-value键值对，key为Pass名称，value为on（表示开）或off（表示关），不支持大小写模式匹配，多组配置使用英文分号分隔。</p>
<p id="zh-cn_topic_0000002209492870_p1842211116349"><a name="zh-cn_topic_0000002209492870_p1842211116349"></a><a name="zh-cn_topic_0000002209492870_p1842211116349"></a><strong id="zh-cn_topic_0000002209492870_b17226152010349"><a name="zh-cn_topic_0000002209492870_b17226152010349"></a><a name="zh-cn_topic_0000002209492870_b17226152010349"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209492870_screen1552031420369"><a name="zh-cn_topic_0000002209492870_screen1552031420369"></a><a name="zh-cn_topic_0000002209492870_screen1552031420369"></a>{ge::ir_option::OPTIMIZATION_SWITCH, "Passname1:on;Passname2:off"}</pre>
<p id="zh-cn_topic_0000002209492870_p53871713104310"><a name="zh-cn_topic_0000002209492870_p53871713104310"></a><a name="zh-cn_topic_0000002209492870_p53871713104310"></a><span class="ddd" id="zh-cn_topic_0000002209492870_ph1348261625514"><a name="zh-cn_topic_0000002209492870_ph1348261625514"></a><a name="zh-cn_topic_0000002209492870_ph1348261625514"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492870_p102251817131919"><a name="zh-cn_topic_0000002209492870_p102251817131919"></a><a name="zh-cn_topic_0000002209492870_p102251817131919"></a><span id="zh-cn_topic_0000002209492870_ph192251917161914"><a name="zh-cn_topic_0000002209492870_ph192251917161914"></a><a name="zh-cn_topic_0000002209492870_ph192251917161914"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_5"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_5"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_5"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_5"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_5"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_5"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492870_p465703434017"><a name="zh-cn_topic_0000002209492870_p465703434017"></a><a name="zh-cn_topic_0000002209492870_p465703434017"></a><span id="zh-cn_topic_0000002209492870_ph13754548217"><a name="zh-cn_topic_0000002209492870_ph13754548217"></a><a name="zh-cn_topic_0000002209492870_ph13754548217"></a><term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_4"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_4"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_4"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_4"><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_4"></a><a name="zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_4"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 功能调试<a name="section535712295418"></a>

<a name="table162938512556"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002244692729_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002244692729_p192241011355"><a name="zh-cn_topic_0000002244692729_p192241011355"></a><a name="zh-cn_topic_0000002244692729_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002244692729_p102241606359"><a name="zh-cn_topic_0000002244692729_p102241606359"></a><a name="zh-cn_topic_0000002244692729_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002244692729_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692729_p1785213120311"><a name="zh-cn_topic_0000002244692729_p1785213120311"></a><a name="zh-cn_topic_0000002244692729_p1785213120311"></a>DEBUG_DIR</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692729_p59034431719"><a name="zh-cn_topic_0000002244692729_p59034431719"></a><a name="zh-cn_topic_0000002244692729_p59034431719"></a>用于配置保存算子编译生成的调试相关的过程文件的路径，过程文件包括但不限于算子.o（算子二进制文件）、.json（算子描述文件）、.cce等文件。</p>
<p id="zh-cn_topic_0000002244692729_p513519112272"><a name="zh-cn_topic_0000002244692729_p513519112272"></a><a name="zh-cn_topic_0000002244692729_p513519112272"></a>默认生成在当前路径下。</p>
<p id="zh-cn_topic_0000002244692729_p1410133311012"><a name="zh-cn_topic_0000002244692729_p1410133311012"></a><a name="zh-cn_topic_0000002244692729_p1410133311012"></a><strong id="zh-cn_topic_0000002244692729_b195041341101012"><a name="zh-cn_topic_0000002244692729_b195041341101012"></a><a name="zh-cn_topic_0000002244692729_b195041341101012"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002244692729_ul1765719562122"></a><a name="zh-cn_topic_0000002244692729_ul1765719562122"></a><ul id="zh-cn_topic_0000002244692729_ul1765719562122"><li>如果要自行指定算子编译的过程文件存放路径，需DEBUG_DIR参数与OP_DEBUG_LEVEL参数配合使用，且当OP_DEBUG_LEVEL取值为0时，不能使用DEBUG_DIR参数。</li><li>算子编译生成的调试文件存储路径，除DEBUG_DIR参数设置的方式外，还可以配置环境变量ASCEND_WORK_PATH，几种方式优先级为：配置参数“DEBUG_DIR”&gt;环境变量ASCEND_WORK_PATH &gt;默认存储路径。关于环境变量ASCEND_WORK_PATH的详细说明请参见<span id="zh-cn_topic_0000002244692729_ph9525133010304"><a name="zh-cn_topic_0000002244692729_ph9525133010304"></a><a name="zh-cn_topic_0000002244692729_ph9525133010304"></a>《环境变量参考》</span>。</li></ul>
<p id="zh-cn_topic_0000002244692729_p81170206396"><a name="zh-cn_topic_0000002244692729_p81170206396"></a><a name="zh-cn_topic_0000002244692729_p81170206396"></a><strong id="zh-cn_topic_0000002244692729_b940352653919"><a name="zh-cn_topic_0000002244692729_b940352653919"></a><a name="zh-cn_topic_0000002244692729_b940352653919"></a>配置示例</strong>：</p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen20573154703919"><a name="zh-cn_topic_0000002244692729_screen20573154703919"></a><a name="zh-cn_topic_0000002244692729_screen20573154703919"></a>{ge::ir_option::OP_DEBUG_LEVEL, "1"}
{ge::ir_option::DEBUG_DIR, "<em id="zh-cn_topic_0000002244692729_i1574047123916"><a name="zh-cn_topic_0000002244692729_i1574047123916"></a><a name="zh-cn_topic_0000002244692729_i1574047123916"></a>/home/test/module/out_debug_info</em>"}</pre>
<p id="zh-cn_topic_0000002244692729_p821620561251"><a name="zh-cn_topic_0000002244692729_p821620561251"></a><a name="zh-cn_topic_0000002244692729_p821620561251"></a><span class="ddd" id="zh-cn_topic_0000002244692729_ph16335453125619"><a name="zh-cn_topic_0000002244692729_ph16335453125619"></a><a name="zh-cn_topic_0000002244692729_ph16335453125619"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692729_p1379612151210"><a name="zh-cn_topic_0000002244692729_p1379612151210"></a><a name="zh-cn_topic_0000002244692729_p1379612151210"></a><span id="zh-cn_topic_0000002244692729_ph107961328128"><a name="zh-cn_topic_0000002244692729_ph107961328128"></a><a name="zh-cn_topic_0000002244692729_ph107961328128"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692729_p8626172314915"><a name="zh-cn_topic_0000002244692729_p8626172314915"></a><a name="zh-cn_topic_0000002244692729_p8626172314915"></a><span id="zh-cn_topic_0000002244692729_ph10627123104917"><a name="zh-cn_topic_0000002244692729_ph10627123104917"></a><a name="zh-cn_topic_0000002244692729_ph10627123104917"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692729_row710550205512"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692729_p6305171194719"><a name="zh-cn_topic_0000002244692729_p6305171194719"></a><a name="zh-cn_topic_0000002244692729_p6305171194719"></a>OP_DEBUG_LEVEL</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692729_p10832153101615"><a name="zh-cn_topic_0000002244692729_p10832153101615"></a><a name="zh-cn_topic_0000002244692729_p10832153101615"></a>算子编译debug功能开关。</p>
<p id="zh-cn_topic_0000002244692729_p13253510169"><a name="zh-cn_topic_0000002244692729_p13253510169"></a><a name="zh-cn_topic_0000002244692729_p13253510169"></a>如果要自行指定算子编译的过程文件存放路径，则需要通过DEBUG_DIR参数指定，OP_DEBUG_LEVEL取值为0时，使用DEBUG_DIR参数不生效。</p>
<p id="zh-cn_topic_0000002244692729_p1263552005710"><a name="zh-cn_topic_0000002244692729_p1263552005710"></a><a name="zh-cn_topic_0000002244692729_p1263552005710"></a><strong id="zh-cn_topic_0000002244692729_b15674183961617"><a name="zh-cn_topic_0000002244692729_b15674183961617"></a><a name="zh-cn_topic_0000002244692729_b15674183961617"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692729_ul18155740191413"></a><a name="zh-cn_topic_0000002244692729_ul18155740191413"></a><ul id="zh-cn_topic_0000002244692729_ul18155740191413"><li>0：（默认值）不开启算子debug功能，在当前执行路径<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b15461845195817"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b15461845195817"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b15461845195817"></a>不生成</strong>算子编译目录kernel_meta。</li><li>1：开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b179782285171"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b179782285171"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b179782285171"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）和TBE指令映射文件（算子cce文件*.cce和python-cce映射文件*_loc.json），用于后续分析AICore Error问题。</li><li>2：开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b10503172717172"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b10503172717172"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b10503172717172"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）和TBE指令映射文件（算子cce文件*.cce和python-cce映射文件*_loc.json），用于后续分析AICore Error问题，同时设置为2，还会关闭编译优化开关、开启ccec调试功能（ccec编译器选项设置为-O0-g）。</li><li>3：不开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹中<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b13358926141716"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b13358926141716"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b13358926141716"></a>生成</strong>*.o（算子二进制文件）和*.json文件（算子描述文件），分析算子问题时可参考。</li><li>4：不开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b14819924101718"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b14819924101718"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b14819924101718"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）、TBE指令映射文件（算子cce文件*.cce）和UB融合计算描述文件（{$kernel_name}_compute.json），可在分析算子问题时进行问题复现、精度比对时使用。</li></ul>
<div class="notice" id="zh-cn_topic_0000002244692729_note1321414364455"><a name="zh-cn_topic_0000002244692729_note1321414364455"></a><a name="zh-cn_topic_0000002244692729_note1321414364455"></a><span class="noticetitle"> 须知： </span><div class="noticebody"><a name="zh-cn_topic_0000002244692729_ul2597173018539"></a><a name="zh-cn_topic_0000002244692729_ul2597173018539"></a><ul id="zh-cn_topic_0000002244692729_ul2597173018539"><li>若OP_DEBUG_LEVEL配置为0，同时配置了OP_DEBUG_CONFIG参数，该场景下在当前执行路径<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b5667181111407"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b5667181111407"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b5667181111407"></a>会保留</strong>算子编译目录kernel_meta。</li><li>若OP_DEBUG_LEVEL配置为0，同时设置了环境变量，则会<strong id="zh-cn_topic_0000002244692729_b594101132614"><a name="zh-cn_topic_0000002244692729_b594101132614"></a><a name="zh-cn_topic_0000002244692729_b594101132614"></a>始终保留</strong>编译目录kernel_meta；若设置了环境变量，则保留在该环境变量指定路径下，若无环境变量，则保留在当前执行路径。</li><li>训练执行时，建议配置为0或3。如果需要进行问题定位，再选择调试开关选项1和2，是因为加入了调试功能会导致网络性能下降。</li><li>配置为2（即开启ccec编译选项）时，会导致算子Kernel（*.o文件）大小增大。动态Shape场景下，由于算子编译时会遍历可能的Shape场景，因此可能会导致算子Kernel文件过大而无法进行编译，此种场景下，建议不要配置ccec编译选项。<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p119132011557"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p119132011557"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p119132011557"></a>由于算子Kernel文件过大而无法编译的报错日志示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_screen1819162055520"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_screen1819162055520"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_screen1819162055520"></a>message:link error ld.lld: <strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b1819122017557"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b1819122017557"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b1819122017557"></a>error: InputSection too large for range extension thunk</strong> ./kernel_meta_xxxxx.o</pre>
</li><li>debug功能开关打开场景下，若模型中含有如下通算融合算子，算子编译目录kernel_meta中，不会生成下述算子的*.o、*.json、*.cce文件。<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719135919173"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719135919173"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719135919173"></a>MatMulAllReduce</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p1171917592173"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p1171917592173"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p1171917592173"></a>MatMulAllReduceAddRmsNorm</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719859161710"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719859161710"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719859161710"></a>AllGatherMatMul</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p57191059121714"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p57191059121714"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p57191059121714"></a>MatMulReduceScatter</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p871905911713"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p871905911713"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p871905911713"></a>AlltoAllAllGatherBatchMatMul</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p4719459131718"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p4719459131718"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p4719459131718"></a>BatchMatMulReduceScatterAlltoAll</p>
</li></ul>
</div></div>
<p id="zh-cn_topic_0000002244692729_p4934165913401"><a name="zh-cn_topic_0000002244692729_p4934165913401"></a><a name="zh-cn_topic_0000002244692729_p4934165913401"></a><strong id="zh-cn_topic_0000002244692729_b1526817734119"><a name="zh-cn_topic_0000002244692729_b1526817734119"></a><a name="zh-cn_topic_0000002244692729_b1526817734119"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen4281630124110"><a name="zh-cn_topic_0000002244692729_screen4281630124110"></a><a name="zh-cn_topic_0000002244692729_screen4281630124110"></a>{ge::ir_option::OP_DEBUG_LEVEL, "1"}</pre>
<p id="zh-cn_topic_0000002244692729_p433415221969"><a name="zh-cn_topic_0000002244692729_p433415221969"></a><a name="zh-cn_topic_0000002244692729_p433415221969"></a><span class="ddd" id="zh-cn_topic_0000002244692729_ph631185810562"><a name="zh-cn_topic_0000002244692729_ph631185810562"></a><a name="zh-cn_topic_0000002244692729_ph631185810562"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692729_p16173195091414"><a name="zh-cn_topic_0000002244692729_p16173195091414"></a><a name="zh-cn_topic_0000002244692729_p16173195091414"></a><span id="zh-cn_topic_0000002244692729_ph1173135051419"><a name="zh-cn_topic_0000002244692729_ph1173135051419"></a><a name="zh-cn_topic_0000002244692729_ph1173135051419"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692729_p357173714919"><a name="zh-cn_topic_0000002244692729_p357173714919"></a><a name="zh-cn_topic_0000002244692729_p357173714919"></a><span id="zh-cn_topic_0000002244692729_ph25711437154914"><a name="zh-cn_topic_0000002244692729_ph25711437154914"></a><a name="zh-cn_topic_0000002244692729_ph25711437154914"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692729_row1279718320553"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692729_p8856157145814"><a name="zh-cn_topic_0000002244692729_p8856157145814"></a><a name="zh-cn_topic_0000002244692729_p8856157145814"></a>OP_DEBUG_CONFIG</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692729_p17387646133615"><a name="zh-cn_topic_0000002244692729_p17387646133615"></a><a name="zh-cn_topic_0000002244692729_p17387646133615"></a>Global Memory内存检测功能开关。</p>
<p id="zh-cn_topic_0000002244692729_p1768154734112"><a name="zh-cn_topic_0000002244692729_p1768154734112"></a><a name="zh-cn_topic_0000002244692729_p1768154734112"></a><strong id="zh-cn_topic_0000002244692729_b12399854194112"><a name="zh-cn_topic_0000002244692729_b12399854194112"></a><a name="zh-cn_topic_0000002244692729_b12399854194112"></a>参数取值：</strong></p>
<p id="zh-cn_topic_0000002244692729_p72049122158"><a name="zh-cn_topic_0000002244692729_p72049122158"></a><a name="zh-cn_topic_0000002244692729_p72049122158"></a>取值为.cfg配置文件路径，配置文件内多个选项用英文逗号分隔：</p>
<a name="zh-cn_topic_0000002244692729_ul24919263716"></a><a name="zh-cn_topic_0000002244692729_ul24919263716"></a><ul id="zh-cn_topic_0000002244692729_ul24919263716"><li><strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b17418155120285"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b17418155120285"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b17418155120285"></a>oom</strong>：算子<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1544210173476"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1544210173476"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1544210173476"></a>执行</strong>过程中，检测Global Memory是否内存越界。<a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul19412352346"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul19412352346"></a><ul id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul19412352346"><li>配置该选项，算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留.o（算子二进制文件）和.json文件（算子描述文件）。</li><li>使用该选项后，在算子编译过程中会加入如下的检测逻辑，用户可以通过再使用<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1692418214107"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1692418214107"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1692418214107"></a>dump_cce</strong>参数，在生成的.cce文件中查看如下的代码。<pre class="screen" id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen9700040330"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen9700040330"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen9700040330"></a>inline __aicore__ void  CheckInvalidAccessOfDDR(<em id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i185658171540"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i185658171540"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i185658171540"></a>xxx</em>) {
    if (access_offset &lt; 0 || access_offset + access_extent &gt; ddr_size) {
        if (read_or_write == 1) {
            <strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1997152116414"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1997152116414"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1997152116414"></a>trap</strong>(0X5A5A0001);
        } else {
            <strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b03115221944"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b03115221944"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b03115221944"></a>trap</strong>(0X5A5A0002);
        }
    }
}</pre>
</li></ul>
</li><li><strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b6797158112816"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b6797158112816"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b6797158112816"></a>dump_cce</strong>：算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留算子cce文件*.cce，以及.o（算子二进制文件）和.json文件（算子描述文件）。</li><li><strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1451717092916"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1451717092916"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1451717092916"></a>dump_loc</strong>：算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留python-cce映射文件*_loc.json，以及.o（算子二进制文件）和.json文件（算子描述文件）。</li><li><strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b0445726297"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b0445726297"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b0445726297"></a>ccec_O0</strong>：算子编译时，开启ccec编译器选项-O0，配置该选项<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1574314052112"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1574314052112"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1574314052112"></a>不会</strong>对调试信息执行优化操作，用于后续分析AI Core Error问题。</li><li><strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b433212414292"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b433212414292"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b433212414292"></a>ccec_g</strong>：算子编译时，开启ccec编译器选项-g，配置该选项<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b464943132117"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b464943132117"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b464943132117"></a>会</strong>对调试信息执行优化操作，用于后续分析AI Core Error问题。</li><li><strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b204541653152615"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b204541653152615"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b204541653152615"></a>check_flag</strong>：算子<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1256222013473"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1256222013473"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1256222013473"></a>执行</strong>时，检测算子内部流水线同步信号是否匹配。<a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1846028182917"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1846028182917"></a><ul id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1846028182917"><li>配置该选项，算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留.o（算子二进制文件）和.json文件（算子描述文件）。</li><li>使用该选项后，在算子编译过程中会加入如下的检测逻辑，用户可以通过再使用<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b114618287299"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b114618287299"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b114618287299"></a>dump_cce</strong>参数，在生成的.cce文件中查看如下的代码。<pre class="screen" id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen144614286299"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen144614286299"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen144614286299"></a>  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID2);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID3);
  ....
  pipe_barrier(PIPE_MTE3);
  pipe_barrier(PIPE_MTE2);
  pipe_barrier(PIPE_M);
  pipe_barrier(PIPE_V);
  pipe_barrier(PIPE_MTE1);
  pipe_barrier(PIPE_ALL);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID2);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID3);
  ...</pre>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p164713283295"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p164713283295"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p164713283295"></a>实际执行推理过程中，如果确实存在算子内部流水线同步信号不匹配，则最终会在<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12480113214158"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12480113214158"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12480113214158"></a>有问题的算子处超时报错，并终止程序</strong>，报错信息示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen1331517541655"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen1331517541655"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen1331517541655"></a>Aicore kernel execute failed, ..., fault kernel_name=<em id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i65002166121"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i65002166121"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i65002166121"></a>算子名</em>,...
rtStreamSynchronizeWithTimeout execute failed....</pre>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002244692729_p240794392520"><a name="zh-cn_topic_0000002244692729_p240794392520"></a><a name="zh-cn_topic_0000002244692729_p240794392520"></a><strong id="zh-cn_topic_0000002244692729_b9993521164211"><a name="zh-cn_topic_0000002244692729_b9993521164211"></a><a name="zh-cn_topic_0000002244692729_b9993521164211"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen197733074511"><a name="zh-cn_topic_0000002244692729_screen197733074511"></a><a name="zh-cn_topic_0000002244692729_screen197733074511"></a>{ge::ir_option::OP_DEBUG_CONFIG, "/root/test0.cfg"}</pre>
<p id="zh-cn_topic_0000002244692729_p715211329510"><a name="zh-cn_topic_0000002244692729_p715211329510"></a><a name="zh-cn_topic_0000002244692729_p715211329510"></a>其中，test0.cfg文件信息为：</p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen15981313132616"><a name="zh-cn_topic_0000002244692729_screen15981313132616"></a><a name="zh-cn_topic_0000002244692729_screen15981313132616"></a>op_debug_config=ccec_g,oom</pre>
<p id="zh-cn_topic_0000002244692729_p19642744541"><a name="zh-cn_topic_0000002244692729_p19642744541"></a><a name="zh-cn_topic_0000002244692729_p19642744541"></a><strong id="zh-cn_topic_0000002244692729_b36101820165413"><a name="zh-cn_topic_0000002244692729_b36101820165413"></a><a name="zh-cn_topic_0000002244692729_b36101820165413"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p2943133093320"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p2943133093320"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p2943133093320"></a>算子编译时，如果用户不想编译所有AI Core算子，而是指定某些AI Core算子进行编译，则需要在上述test0.cfg配置文件中新增<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12954518183515"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12954518183515"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12954518183515"></a>OP_DEBUG_LIST</strong>字段，算子编译时，只编译该列表指定的算子，并按照OP_DEBUG_CONFIG配置的选项进行编译。OP_DEBUG_LIST字段要求如下：</p>
<a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1691044011386"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1691044011386"></a><ul id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1691044011386"><li>支持指定算子名称或者算子类型。</li><li>算子之间使用英文逗号分隔，若为算子类型，则以<strong id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b16555457134117"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b16555457134117"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b16555457134117"></a>OpType::typeName</strong>格式进行配置，支持算子类型和算子名称混合配置。</li><li>要编译的算子，必须放在OP_DEBUG_CONFIG参数指定的配置文件中。</li></ul>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p511381113264"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p511381113264"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p511381113264"></a>配置示例如下，test0.cfg文件中增加如下信息：</p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen12280416826"><a name="zh-cn_topic_0000002244692729_screen12280416826"></a><a name="zh-cn_topic_0000002244692729_screen12280416826"></a>op_debug_config=ccec_g,oom
op_debug_list=<em id="zh-cn_topic_0000002244692729_i1951033145410"><a name="zh-cn_topic_0000002244692729_i1951033145410"></a><a name="zh-cn_topic_0000002244692729_i1951033145410"></a>GatherV2,opType::ReduceSum</em></pre>
<p id="zh-cn_topic_0000002244692729_p765410710210"><a name="zh-cn_topic_0000002244692729_p765410710210"></a><a name="zh-cn_topic_0000002244692729_p765410710210"></a>模型编译时，<em id="zh-cn_topic_0000002244692729_i19710500216"><a name="zh-cn_topic_0000002244692729_i19710500216"></a><a name="zh-cn_topic_0000002244692729_i19710500216"></a>GatherV2,ReduceSum</em>算子按照ccec_g,oom选项进行编译。</p>
<div class="note" id="zh-cn_topic_0000002244692729_note02845114366"><a name="zh-cn_topic_0000002244692729_note02845114366"></a><a name="zh-cn_topic_0000002244692729_note02845114366"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002244692729_ul230710560362"></a><a name="zh-cn_topic_0000002244692729_ul230710560362"></a><ul id="zh-cn_topic_0000002244692729_ul230710560362"><li>开启ccec编译选项的场景下（即ccec_O0、ccec_g选项），会增大算子Kernel（*.o文件）的大小。动态shape场景下，由于算子编译时会遍历可能存在的所有场景，最终可能会导致由于算子Kernel文件过大而无法进行编译的情况，此种场景下，建议不要开启ccec编译选项。<p id="zh-cn_topic_0000002244692729_p321220316517"><a name="zh-cn_topic_0000002244692729_p321220316517"></a><a name="zh-cn_topic_0000002244692729_p321220316517"></a>由于算子kernel文件过大而无法编译的日志显示如下：</p>
<p id="zh-cn_topic_0000002244692729_p61879516373"><a name="zh-cn_topic_0000002244692729_p61879516373"></a><a name="zh-cn_topic_0000002244692729_p61879516373"></a>message:link error ld.lld: <strong id="zh-cn_topic_0000002244692729_b141871859379"><a name="zh-cn_topic_0000002244692729_b141871859379"></a><a name="zh-cn_topic_0000002244692729_b141871859379"></a>error: InputSection too large for range extension thunk</strong> ./kernel_meta_xxxxx.o:(xxxx)</p>
</li><li>ccec编译器选项ccec_O0和oom不能同时开启，可能会导致AICore Error报错，报错信息示例如下：<pre class="screen" id="zh-cn_topic_0000002244692729_screen13162125424812"><a name="zh-cn_topic_0000002244692729_screen13162125424812"></a><a name="zh-cn_topic_0000002244692729_screen13162125424812"></a>...there is an aivec error exception, core id is 49, error code = 0x4 ...</pre>
</li><li>若配置NPU_COLLECT_PATH环境变量，不支持打开“检测Global Memory是否内存越界”的开关（OP_DEBUG_CONFIG指定的配置文件中配置oom），否则编译出来的模型文件或算子kernel包在使用时会报错。</li><li>配置编译选项oom、dump_cce、dump_loc时，若模型中含有如下通算融合算子，算子编译目录kernel_meta中，不会生成下述算子的*.o、*.json、*.cce文件。<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719135919173"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719135919173"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719135919173"></a>MatMulAllReduce</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p1171917592173"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p1171917592173"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p1171917592173"></a>MatMulAllReduceAddRmsNorm</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719859161710"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719859161710"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719859161710"></a>AllGatherMatMul</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p57191059121714"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p57191059121714"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p57191059121714"></a>MatMulReduceScatter</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p871905911713"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p871905911713"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p871905911713"></a>AlltoAllAllGatherBatchMatMul</p>
<p id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p4719459131718"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p4719459131718"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p4719459131718"></a>BatchMatMulReduceScatterAlltoAll</p>
</li></ul>
</div></div>
<p id="zh-cn_topic_0000002244692729_p186771335930"><a name="zh-cn_topic_0000002244692729_p186771335930"></a><a name="zh-cn_topic_0000002244692729_p186771335930"></a><span class="ddd" id="zh-cn_topic_0000002244692729_ph69315515119"><a name="zh-cn_topic_0000002244692729_ph69315515119"></a><a name="zh-cn_topic_0000002244692729_ph69315515119"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692729_p1363132819812"><a name="zh-cn_topic_0000002244692729_p1363132819812"></a><a name="zh-cn_topic_0000002244692729_p1363132819812"></a><span id="zh-cn_topic_0000002244692729_ph1436310288816"><a name="zh-cn_topic_0000002244692729_ph1436310288816"></a><a name="zh-cn_topic_0000002244692729_ph1436310288816"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692729_p186074510502"><a name="zh-cn_topic_0000002244692729_p186074510502"></a><a name="zh-cn_topic_0000002244692729_p186074510502"></a><span id="zh-cn_topic_0000002244692729_ph1386044565020"><a name="zh-cn_topic_0000002244692729_ph1386044565020"></a><a name="zh-cn_topic_0000002244692729_ph1386044565020"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692729_row19797331557"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692729_p1039932317118"><a name="zh-cn_topic_0000002244692729_p1039932317118"></a><a name="zh-cn_topic_0000002244692729_p1039932317118"></a>OPTION_SCREEN_PRINT_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692729_p173362202018"><a name="zh-cn_topic_0000002244692729_p173362202018"></a><a name="zh-cn_topic_0000002244692729_p173362202018"></a>控制图编译过程是否打屏。</p>
<p id="zh-cn_topic_0000002244692729_p1179533919518"><a name="zh-cn_topic_0000002244692729_p1179533919518"></a><a name="zh-cn_topic_0000002244692729_p1179533919518"></a><strong id="zh-cn_topic_0000002244692729_b157968391759"><a name="zh-cn_topic_0000002244692729_b157968391759"></a><a name="zh-cn_topic_0000002244692729_b157968391759"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692729_ul4796113915510"></a><a name="zh-cn_topic_0000002244692729_ul4796113915510"></a><ul id="zh-cn_topic_0000002244692729_ul4796113915510"><li>enable：打屏，默认为enable。</li><li>disable：不打屏。</li></ul>
<p id="zh-cn_topic_0000002244692729_p92491932171119"><a name="zh-cn_topic_0000002244692729_p92491932171119"></a><a name="zh-cn_topic_0000002244692729_p92491932171119"></a><strong id="zh-cn_topic_0000002244692729_b18305164691212"><a name="zh-cn_topic_0000002244692729_b18305164691212"></a><a name="zh-cn_topic_0000002244692729_b18305164691212"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen151751856171212"><a name="zh-cn_topic_0000002244692729_screen151751856171212"></a><a name="zh-cn_topic_0000002244692729_screen151751856171212"></a>{ge::ir_option::OPTION_SCREEN_PRINT_MODE, "disable"}</pre>
<p id="zh-cn_topic_0000002244692729_p511618151982"><a name="zh-cn_topic_0000002244692729_p511618151982"></a><a name="zh-cn_topic_0000002244692729_p511618151982"></a><span class="ddd" id="zh-cn_topic_0000002244692729_ph149071444175713"><a name="zh-cn_topic_0000002244692729_ph149071444175713"></a><a name="zh-cn_topic_0000002244692729_ph149071444175713"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692729_p311910151388"><a name="zh-cn_topic_0000002244692729_p311910151388"></a><a name="zh-cn_topic_0000002244692729_p311910151388"></a><span id="zh-cn_topic_0000002244692729_ph1911910152813"><a name="zh-cn_topic_0000002244692729_ph1911910152813"></a><a name="zh-cn_topic_0000002244692729_ph1911910152813"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692729_p939620493717"><a name="zh-cn_topic_0000002244692729_p939620493717"></a><a name="zh-cn_topic_0000002244692729_p939620493717"></a><span id="zh-cn_topic_0000002244692729_ph831815168815"><a name="zh-cn_topic_0000002244692729_ph831815168815"></a><a name="zh-cn_topic_0000002244692729_ph831815168815"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692729_row1640826195514"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692729_p198112187410"><a name="zh-cn_topic_0000002244692729_p198112187410"></a><a name="zh-cn_topic_0000002244692729_p198112187410"></a><span>OPTION_EXPORT_COMPILE_STAT</span></p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692729_p12811196142117"><a name="zh-cn_topic_0000002244692729_p12811196142117"></a><a name="zh-cn_topic_0000002244692729_p12811196142117"></a>配置图编译过程中是否生成算子融合信息（包括图融合和UB融合）的结果文件fusion_result.json。</p>
<p id="zh-cn_topic_0000002244692729_p8302247202"><a name="zh-cn_topic_0000002244692729_p8302247202"></a><a name="zh-cn_topic_0000002244692729_p8302247202"></a>该文件用于记录图编译过程中使用的融合规则，而精度比对中的FUSION_SWITCH_FILE参数可以关闭指定的融合规则，关闭的融合规则，不会在fusion_result.json文件中呈现，文件中：</p>
<a name="zh-cn_topic_0000002244692729_ul4694626162011"></a><a name="zh-cn_topic_0000002244692729_ul4694626162011"></a><ul id="zh-cn_topic_0000002244692729_ul4694626162011"><li>session_and_graph_id_<em id="zh-cn_topic_0000002244692729_zh-cn_topic_0000002087352816_i98131925111418"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000002087352816_i98131925111418"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000002087352816_i98131925111418"></a>xx_xx</em>：表示融合结果所属线程和图编号。</li><li>graph_fusion：表示图融合。</li><li>ub_fusion：表示UB融合。</li><li>match_times：表示图编译过程中匹配到的融合规则次数。</li><li>effect_times：表示实际生效的次数。</li><li>repository_hit_times：优化UB融合知识库命中的次数。</li></ul>
<p id="zh-cn_topic_0000002244692729_p18191161717919"><a name="zh-cn_topic_0000002244692729_p18191161717919"></a><a name="zh-cn_topic_0000002244692729_p18191161717919"></a><strong id="zh-cn_topic_0000002244692729_b1125103610916"><a name="zh-cn_topic_0000002244692729_b1125103610916"></a><a name="zh-cn_topic_0000002244692729_b1125103610916"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692729_ul015116538916"></a><a name="zh-cn_topic_0000002244692729_ul015116538916"></a><ul id="zh-cn_topic_0000002244692729_ul015116538916"><li>0：不生成算子融合信息结果文件。</li><li>1：（默认值）程序运行正常退出时，生成算子融合信息结果文件。</li><li>2：图编译完成时，生成算子融合信息结果文件。即如果图编译已完成，后续程序提前中断，也会生成算子融合信息结果文件。</li></ul>
<div class="note" id="zh-cn_topic_0000002244692729_note136881328182810"><a name="zh-cn_topic_0000002244692729_note136881328182810"></a><a name="zh-cn_topic_0000002244692729_note136881328182810"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002244692729_ul2337143614287"></a><a name="zh-cn_topic_0000002244692729_ul2337143614287"></a><ul id="zh-cn_topic_0000002244692729_ul2337143614287"><li>若未设置ASCEND_WORK_PATH环境变量，结果文件默认生成在执行脚本的当前路径；若设置了ASCEND_WORK_PATH环境变量，则保存路径为：$ASCEND_WORK_PATH/FE/${进程号}/fusion_result.json。环境变量详细说明请参见<span id="zh-cn_topic_0000002244692729_ph842515311811"><a name="zh-cn_topic_0000002244692729_ph842515311811"></a><a name="zh-cn_topic_0000002244692729_ph842515311811"></a>《环境变量参考》</span>。</li><li>通过FUSION_SWITCH_FILE参数关闭的融合规则，不会在fusion_result.json文件中呈现。</li></ul>
</div></div>
<p id="zh-cn_topic_0000002244692729_p83471930897"><a name="zh-cn_topic_0000002244692729_p83471930897"></a><a name="zh-cn_topic_0000002244692729_p83471930897"></a><strong id="zh-cn_topic_0000002244692729_b142523366914"><a name="zh-cn_topic_0000002244692729_b142523366914"></a><a name="zh-cn_topic_0000002244692729_b142523366914"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692729_screen1724535017100"><a name="zh-cn_topic_0000002244692729_screen1724535017100"></a><a name="zh-cn_topic_0000002244692729_screen1724535017100"></a>{ge::ir_option::<span>OPTION_EXPORT_COMPILE_STAT</span>, "1"}</pre>
<p id="zh-cn_topic_0000002244692729_p192231244201017"><a name="zh-cn_topic_0000002244692729_p192231244201017"></a><a name="zh-cn_topic_0000002244692729_p192231244201017"></a><span class="ddd" id="zh-cn_topic_0000002244692729_ph322334411012"><a name="zh-cn_topic_0000002244692729_ph322334411012"></a><a name="zh-cn_topic_0000002244692729_ph322334411012"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692729_p4223204412104"><a name="zh-cn_topic_0000002244692729_p4223204412104"></a><a name="zh-cn_topic_0000002244692729_p4223204412104"></a><span id="zh-cn_topic_0000002244692729_ph3223164461016"><a name="zh-cn_topic_0000002244692729_ph3223164461016"></a><a name="zh-cn_topic_0000002244692729_ph3223164461016"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_4"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_4"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_4"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_4"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_4"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_4"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692729_p132235446109"><a name="zh-cn_topic_0000002244692729_p132235446109"></a><a name="zh-cn_topic_0000002244692729_p132235446109"></a><span id="zh-cn_topic_0000002244692729_ph162231644111011"><a name="zh-cn_topic_0000002244692729_ph162231644111011"></a><a name="zh-cn_topic_0000002244692729_ph162231644111011"></a><term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_4"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_4"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_4"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_4"><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_4"></a><a name="zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_4"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 精度调优<a name="section749717274546"></a>

<a name="table1459186135516"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002209652690_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002209652690_p192241011355"><a name="zh-cn_topic_0000002209652690_p192241011355"></a><a name="zh-cn_topic_0000002209652690_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002209652690_p102241606359"><a name="zh-cn_topic_0000002209652690_p102241606359"></a><a name="zh-cn_topic_0000002209652690_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002209652690_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652690_p12225130123515"><a name="zh-cn_topic_0000002209652690_p12225130123515"></a><a name="zh-cn_topic_0000002209652690_p12225130123515"></a>PRECISION_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_p1125212618154"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_p1125212618154"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_p1125212618154"></a>设置算子的精度模式。同一张图中不能与PRECISION_MODE_V2同时使用，建议使用PRECISION_MODE_V2参数。</p>
<p id="zh-cn_topic_0000002209652690_p92511055184"><a name="zh-cn_topic_0000002209652690_p92511055184"></a><a name="zh-cn_topic_0000002209652690_p92511055184"></a><strong id="zh-cn_topic_0000002209652690_b325212551982"><a name="zh-cn_topic_0000002209652690_b325212551982"></a><a name="zh-cn_topic_0000002209652690_b325212551982"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_ul561918228306"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_ul561918228306"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_ul561918228306"><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b713235024011"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b713235024011"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b713235024011"></a>force_fp32/cube_fp16in_fp32out：</strong><div class="p" id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p8537814448"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p8537814448"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p8537814448"></a>配置为force_fp32或cube_fp16in_fp32out，效果等同，该选项用来表示AI Core中该算子既支持float32又支持float16数据类型时，系统内部都会根据算子类型不同，选择不同的处理方式。cube_fp16in_fp32out为新版本中新增的，对于矩阵计算类算子，该选项语义更清晰。<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul169010276308"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul169010276308"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul169010276308"><li>对于矩阵计算类算子，系统内部会按算子实现的支持情况处理：<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ol6196318114911"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ol6196318114911"></a><ol id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ol6196318114911"><li>优先选择输入数据类型为float16且输出数据类型为float32；</li><li>如果1中的场景不支持，则选择输入数据类型为float32且输出数据类型为float32；</li><li>如果2中的场景不支持，则选择输入数据类型为float16且输出数据类型为float16；</li><li>如果3中的场景不支持，则报错。</li></ol>
</li><li>对于矢量计算类算子，表示原图中算子精度为float16或bfloat16，强制选择float32。<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p2355122020261"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p2355122020261"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p2355122020261"></a>如果原图中存在部分算子，在AI Core中该算子的实现不支持float32，比如某算子仅支持float16类型，则该参数不生效，仍然使用支持的float16；如果在AI Core中该算子的实现不支持float32，且又配置了黑名单（precision_reduce = false），则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</p>
</li></ul>
</div>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5998125544012"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5998125544012"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5998125544012"></a>force_fp16（默认值）：</strong><p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p59818442401"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p59818442401"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p59818442401"></a>表示原图中算子精度为float16、bfloat16和float32时，强制选择float16。</p>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b8330648174120"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b8330648174120"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b8330648174120"></a>allow_fp32_to_fp16：</strong><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul777312334113"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul777312334113"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul777312334113"><li>对于矩阵类算子：<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6761514144114"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6761514144114"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6761514144114"><li>如果原图中算子精度为float32，优先降低精度到float16，如果AI Core中算子不支持float16，则继续选择float32，如果AI Core中算子不支持float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li>对于矢量类算子，优先保持原图精度：<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul464241443812"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul464241443812"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul464241443812"><li>如果原图中算子精度为float32，则优先使用原图精度float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5252156154212"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5252156154212"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5252156154212"></a>must_keep_origin_dtype：</strong><p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p20280144555815"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p20280144555815"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p20280144555815"></a>保持原图精度。</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul1619894955814"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul1619894955814"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul1619894955814"><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持float32和bfloat16，则系统内部会自动采用高精度float32。</li><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持bfloat16，则会使用float16的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中某算子精度为float32，AI Core中该算子的实现不支持float32类型、仅支持float16类型，则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b14329055205212"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b14329055205212"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b14329055205212"></a>allow_mix_precision/allow_mix_precision_fp16</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p13288949175211"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p13288949175211"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p13288949175211"></a>配置为allow_mix_precision或allow_mix_precision_fp16，效果等同，均表示使用混合精度float16、bfloat16和float32数据类型来处理神经网络的过程。allow_mix_precision_fp16为新版本中新增的，语义更清晰，便于理解。</p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p152814174917"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p152814174917"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p152814174917"></a>针对原始模型中float32和bfloat16数据类型的算子，按照内置的优化策略，自动将部分float32和bfloat16的算子降低精度到float16，从而在精度损失很小的情况下提升系统性能并减少内存使用。</p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p3445181144615"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p3445181144615"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p3445181144615"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph10562197165916"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph10562197165916"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i23791626927"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i23791626927"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i23791626927"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i163391631724"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i163391631724"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i163391631724"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname544591134619"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname544591134619"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname544591134619"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6368123316466"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6368123316466"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6368123316466"><li>若取值为true（白名单），则表示允许将当前float32和bfloat16类型的算子，降低精度到float16。</li><li>若取值为false（黑名单），则不允许将当前float32和bfloat16类型的算子降低精度到float16，相应算子仍旧使用float32或bfloat16精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1133818511228"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1133818511228"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1133818511228"></a>allow_mix_precision_bf16：</strong><p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p645755825314"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p645755825314"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p645755825314"></a>表示使用混合精度bfloat16和float32数据类型来处理神经网络的过程。针对原始模型中float32数据类型的算子，按照内置的优化策略，自动将部分float32的算子降低精度到bfloat16，从而在精度损失很小的情况下提升系统性能并减少内存使用；如果AI Core中算子不支持bfloat16和float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p7213919209"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p7213919209"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p7213919209"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph221381915016"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph221381915016"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph221381915016"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1843218381128"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1843218381128"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1843218381128"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1674910411524"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1674910411524"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1674910411524"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname6213141915012"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname6213141915012"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname6213141915012"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul62133191409"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul62133191409"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul62133191409"><li>若取值为true（白名单），则表示允许将当前float32类型的算子，降低精度到<span>bfloat16</span>。</li><li>若取值为false（黑名单），则不允许将当前float32类型的算子降低精度到<span>bfloat16</span>，相应算子仍旧使用float32精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1845717283465"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1845717283465"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1845717283465"></a>allow_fp32_to_bf16：</strong><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul139030935"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul139030935"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul139030935"><li>如果原图中算子精度为float32，则优先使用原图精度float32，如果AI Core中算子不支持float32，则降低精度到bfloat16；如果AI Core中算子不支持bfloat16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002209652690_p1940315595482"><a name="zh-cn_topic_0000002209652690_p1940315595482"></a><a name="zh-cn_topic_0000002209652690_p1940315595482"></a>上述路径中的<span id="zh-cn_topic_0000002209652690_ph18679216191916"><a name="zh-cn_topic_0000002209652690_ph18679216191916"></a><a name="zh-cn_topic_0000002209652690_ph18679216191916"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002209652690_p51581537165"><a name="zh-cn_topic_0000002209652690_p51581537165"></a><a name="zh-cn_topic_0000002209652690_p51581537165"></a><strong id="zh-cn_topic_0000002209652690_b128608114171"><a name="zh-cn_topic_0000002209652690_b128608114171"></a><a name="zh-cn_topic_0000002209652690_b128608114171"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002209652690_ul7395714184513"></a><a name="zh-cn_topic_0000002209652690_ul7395714184513"></a><ul id="zh-cn_topic_0000002209652690_ul7395714184513"><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b2777171963615"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b2777171963615"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b2777171963615"></a>bfloat16数据类型仅支持以下<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph188916433619"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph188916433619"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph188916433619"></a>产品</span>类型</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p12643143517324"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p12643143517324"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p12643143517324"></a><span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph664353543215"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph664353543215"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph664353543215"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p18643735143214"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p18643735143214"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p18643735143214"></a><span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph264323511325"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph264323511325"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph264323511325"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li><li>该参数默认为性能优先，后续推理时可能会导致精度溢出问题。如果推理时出现精度问题，可以参见<span id="zh-cn_topic_0000002209652690_ph1088124112542"><a name="zh-cn_topic_0000002209652690_ph1088124112542"></a><a name="zh-cn_topic_0000002209652690_ph1088124112542"></a></span>进行定位。</li><li>如果用户聚焦精度问题，可以修改为其他取值，比如<strong id="zh-cn_topic_0000002209652690_b16579597367"><a name="zh-cn_topic_0000002209652690_b16579597367"></a><a name="zh-cn_topic_0000002209652690_b16579597367"></a>must_keep_origin_dtype。</strong></li></ul>
<p id="zh-cn_topic_0000002209652690_p12841842122319"><a name="zh-cn_topic_0000002209652690_p12841842122319"></a><a name="zh-cn_topic_0000002209652690_p12841842122319"></a><strong id="zh-cn_topic_0000002209652690_b134207292415"><a name="zh-cn_topic_0000002209652690_b134207292415"></a><a name="zh-cn_topic_0000002209652690_b134207292415"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652690_screen38471262410"><a name="zh-cn_topic_0000002209652690_screen38471262410"></a><a name="zh-cn_topic_0000002209652690_screen38471262410"></a>{ge::ir_option::PRECISION_MODE, "force_fp16"}</pre>
<p id="zh-cn_topic_0000002209652690_p11928140131114"><a name="zh-cn_topic_0000002209652690_p11928140131114"></a><a name="zh-cn_topic_0000002209652690_p11928140131114"></a><span class="ddd" id="zh-cn_topic_0000002209652690_ph1781213360551"><a name="zh-cn_topic_0000002209652690_ph1781213360551"></a><a name="zh-cn_topic_0000002209652690_ph1781213360551"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652690_p1292940171114"><a name="zh-cn_topic_0000002209652690_p1292940171114"></a><a name="zh-cn_topic_0000002209652690_p1292940171114"></a><span id="zh-cn_topic_0000002209652690_ph492919017113"><a name="zh-cn_topic_0000002209652690_ph492919017113"></a><a name="zh-cn_topic_0000002209652690_ph492919017113"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652690_p990117412244"><a name="zh-cn_topic_0000002209652690_p990117412244"></a><a name="zh-cn_topic_0000002209652690_p990117412244"></a><span id="zh-cn_topic_0000002209652690_ph6606082511"><a name="zh-cn_topic_0000002209652690_ph6606082511"></a><a name="zh-cn_topic_0000002209652690_ph6606082511"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652690_row9183172315580"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652690_p112496310438"><a name="zh-cn_topic_0000002209652690_p112496310438"></a><a name="zh-cn_topic_0000002209652690_p112496310438"></a>PRECISION_MODE_V2</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652690_p699817457497"><a name="zh-cn_topic_0000002209652690_p699817457497"></a><a name="zh-cn_topic_0000002209652690_p699817457497"></a>设置算子的精度模式。同一张图中不能与PRECISION_MODE同时使用，建议使用PRECISION_MODE_V2参数。</p>
<p id="zh-cn_topic_0000002209652690_p1896919461792"><a name="zh-cn_topic_0000002209652690_p1896919461792"></a><a name="zh-cn_topic_0000002209652690_p1896919461792"></a><strong id="zh-cn_topic_0000002209652690_b278320541996"><a name="zh-cn_topic_0000002209652690_b278320541996"></a><a name="zh-cn_topic_0000002209652690_b278320541996"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209652690_ul125913464499"></a><a name="zh-cn_topic_0000002209652690_ul125913464499"></a><ul id="zh-cn_topic_0000002209652690_ul125913464499"><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b6133153320135"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b6133153320135"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b6133153320135"></a>fp16（默认值）</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p37316156141"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p37316156141"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p37316156141"></a>表示原图中算子精度为float16、bfloat16或float32时，强制选择float16。</p>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9661017144"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9661017144"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9661017144"></a>origin</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p10420443128"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p10420443128"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p10420443128"></a>保持原图精度。</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul1872113713125"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul1872113713125"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul1872113713125"><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持float32和bfloat16，则系统内部会自动采用高精度float32。</li><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持bfloat16，则会使用float16的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中某算子精度为float32，AI Core中该算子的实现不支持float32类型、仅支持float16类型，则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1091213018170"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1091213018170"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1091213018170"></a>cube_fp16in_fp32out</strong>：<div class="p" id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1372204971913"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1372204971913"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1372204971913"></a>AI Core中该算子既支持float32又支持float16数据类型时，系统内部根据算子类型不同，选择不同的处理方式。<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul169010276308"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul169010276308"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul169010276308"><li>对于矩阵计算类算子，系统内部会按算子实现的支持情况处理：<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ol6196318114911"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ol6196318114911"></a><ol id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ol6196318114911"><li>优先选择输入数据类型为float16且输出数据类型为float32；</li><li>如果1中的场景不支持，则选择输入数据类型为float32且输出数据类型为float32；</li><li>如果2中的场景不支持，则选择输入数据类型为float16且输出数据类型为float16；</li><li>如果3中的场景不支持，则报错。</li></ol>
</li><li>对于矢量计算类算子，表示原图中算子精度为float16或bfloat16，强制选择float32。<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p2355122020261"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p2355122020261"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p2355122020261"></a>如果原图中存在部分算子，在AI Core中该算子的实现不支持float32，比如某算子仅支持float16类型，则该参数不生效，仍然使用支持的float16；如果在AI Core中该算子的实现不支持float32，且又配置了黑名单（precision_reduce = false），则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</p>
</li></ul>
</div>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1113215426233"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1113215426233"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1113215426233"></a>mixed_float16</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p13288949175211"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p13288949175211"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p13288949175211"></a>表示使用混合精度float16、bfloat16和float32数据类型来处理神经网络。针对原图中float32和bfloat16数据类型的算子，按照内置的优化策略，自动将部分float32和<span>bfloat16</span>的算子降低精度到float16，从而在精度损失很小的情况下提升系统性能并减少内存使用。</p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p3445181144615"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p3445181144615"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p3445181144615"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph10562197165916"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph10562197165916"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i820814615314"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i820814615314"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i820814615314"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i76815552310"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i76815552310"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i76815552310"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname544591134619"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname544591134619"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname544591134619"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul6368123316466"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul6368123316466"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul6368123316466"><li>若取值为true（白名单），则表示允许将当前float32和<span>bfloat16</span>类型的算子，降低精度到float16。</li><li>若取值为false（黑名单），则不允许将当前float32和<span>bfloat16</span>类型的算子降低精度到float16，相应算子仍旧使用float32或<span>bfloat16</span>精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b4594173711235"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b4594173711235"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b4594173711235"></a>mixed_bfloat16</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p645755825314"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p645755825314"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p645755825314"></a>表示使用混合精度bfloat16和float32数据类型来处理神经网络。针对原图中float32数据类型的算子，按照内置的优化策略，自动将部分float32的算子降低精度到<span>bfloat16</span>，从而在精度损失很小的情况下提升系统性能并减少内存使用；<span>如果算子不支持bfloat16和</span>float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p7213919209"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p7213919209"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p7213919209"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph221381915016"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph221381915016"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph221381915016"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i1666213581835"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i1666213581835"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i1666213581835"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i3293221441"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i3293221441"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i3293221441"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname6213141915012"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname6213141915012"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname6213141915012"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul62133191409"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul62133191409"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul62133191409"><li>若取值为true（白名单），则表示允许将当前float32类型的算子，降低精度到<span>bfloat16</span>。</li><li>若取值为false（黑名单），则不允许将当前float32类型的算子降低精度到<span>bfloat16</span>，相应算子仍旧使用float32精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b7210361631"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b7210361631"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b7210361631"></a>mixed_hif8：</strong><p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p148818611318"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p148818611318"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p148818611318"></a>开启自动混合精度功能，表示混合使用hifloat8（此数据类型介绍可参见<a href="https://arxiv.org/abs/2409.16626?context=cs.AR" target="_blank" rel="noopener noreferrer">Link</a>）、float16、bfloat16和float32数据类型来处理神经网络。针对原图中float16、bfloat16和float32数据类型的算子，按照内置的优化策略，自动将部分float16、bfloat16和float32的算子降低精度到hifloat8，从而在精度损失很小的情况下提升系统性能并减少内存使用。<strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9699153118144"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9699153118144"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9699153118144"></a>当前版本不支持该选项。</strong></p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1110861315594"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1110861315594"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1110861315594"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph189988304592"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph189988304592"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph189988304592"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i7381282415"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i7381282415"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i7381282415"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i10251311246"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i10251311246"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i10251311246"></a>xxx</em>-ops-info.json内置优化策略文件中查看“<strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b19575163635912"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b19575163635912"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b19575163635912"></a>precision_reduce</strong>”参数的取值：</p>
<a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul176671048185911"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul176671048185911"></a><ul id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul176671048185911"><li>若取值为true（白名单），则表示允许将当前float16、<span>bfloat16</span>和float32类型的算子，降低精度到hifloat8。</li><li>若取值为false（黑名单），则不允许将当前float16、<span>bfloat16</span>和float32类型的算子降低精度到hifloat8，相应算子仍旧使用float16、<span>bfloat16</span>或float32精度。</li><li>若原图中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b760013935811"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b760013935811"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b760013935811"></a>cube_hif8</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1165518421944"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1165518421944"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1165518421944"></a>表示若原图中的cube算子既支持hifloat8，又支持float16、bfloat16或float32数据类型时，强制选择hifloat8数据类型。<strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b0246174891418"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b0246174891418"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b0246174891418"></a><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b18340134731515"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b18340134731515"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b18340134731515"></a>当前版本不支持该选项。</strong></strong></p>
</li></ul>
<p id="zh-cn_topic_0000002209652690_p584125874719"><a name="zh-cn_topic_0000002209652690_p584125874719"></a><a name="zh-cn_topic_0000002209652690_p584125874719"></a>上述路径中的<span id="zh-cn_topic_0000002209652690_ph584125819476"><a name="zh-cn_topic_0000002209652690_ph584125819476"></a><a name="zh-cn_topic_0000002209652690_ph584125819476"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002209652690_p637365954916"><a name="zh-cn_topic_0000002209652690_p637365954916"></a><a name="zh-cn_topic_0000002209652690_p637365954916"></a><strong id="zh-cn_topic_0000002209652690_b6373195914911"><a name="zh-cn_topic_0000002209652690_b6373195914911"></a><a name="zh-cn_topic_0000002209652690_b6373195914911"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002209652690_ul185899558189"></a><a name="zh-cn_topic_0000002209652690_ul185899558189"></a><ul id="zh-cn_topic_0000002209652690_ul185899558189"><li><strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b2777171963615"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b2777171963615"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b2777171963615"></a>bfloat16数据类型仅支持以下<span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph12992932183619"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph12992932183619"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph12992932183619"></a>产品</span>类型</strong>：<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p12643143517324"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p12643143517324"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p12643143517324"></a><span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph664353543215"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph664353543215"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph664353543215"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p18643735143214"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p18643735143214"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p18643735143214"></a><span id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph264323511325"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph264323511325"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph264323511325"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li><li>该参数默认为性能优先，后续推理时可能会导致精度溢出问题。如果推理时出现精度问题，可以参见<span id="zh-cn_topic_0000002209652690_ph13589755171818"><a name="zh-cn_topic_0000002209652690_ph13589755171818"></a><a name="zh-cn_topic_0000002209652690_ph13589755171818"></a></span>进行定位。</li><li>如果用户聚焦精度问题，可以修改为其他取值，比如<strong id="zh-cn_topic_0000002209652690_b2589135515183"><a name="zh-cn_topic_0000002209652690_b2589135515183"></a><a name="zh-cn_topic_0000002209652690_b2589135515183"></a>origin。</strong></li></ul>
<p id="zh-cn_topic_0000002209652690_p524904152417"><a name="zh-cn_topic_0000002209652690_p524904152417"></a><a name="zh-cn_topic_0000002209652690_p524904152417"></a><strong id="zh-cn_topic_0000002209652690_b8249104102419"><a name="zh-cn_topic_0000002209652690_b8249104102419"></a><a name="zh-cn_topic_0000002209652690_b8249104102419"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209652690_screen10249124122417"><a name="zh-cn_topic_0000002209652690_screen10249124122417"></a><a name="zh-cn_topic_0000002209652690_screen10249124122417"></a>{ge::ir_option::PRECISION_MODE_V2, "fp16"}</pre>
<p id="zh-cn_topic_0000002209652690_p16373115964914"><a name="zh-cn_topic_0000002209652690_p16373115964914"></a><a name="zh-cn_topic_0000002209652690_p16373115964914"></a><span class="ddd" id="zh-cn_topic_0000002209652690_ph276254925519"><a name="zh-cn_topic_0000002209652690_ph276254925519"></a><a name="zh-cn_topic_0000002209652690_ph276254925519"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652690_p10374195918493"><a name="zh-cn_topic_0000002209652690_p10374195918493"></a><a name="zh-cn_topic_0000002209652690_p10374195918493"></a><span id="zh-cn_topic_0000002209652690_ph1137415934919"><a name="zh-cn_topic_0000002209652690_ph1137415934919"></a><a name="zh-cn_topic_0000002209652690_ph1137415934919"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652690_p7611105615253"><a name="zh-cn_topic_0000002209652690_p7611105615253"></a><a name="zh-cn_topic_0000002209652690_p7611105615253"></a><span id="zh-cn_topic_0000002209652690_ph107114512264"><a name="zh-cn_topic_0000002209652690_ph107114512264"></a><a name="zh-cn_topic_0000002209652690_ph107114512264"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209652690_row164451725205813"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209652690_p186126398296"><a name="zh-cn_topic_0000002209652690_p186126398296"></a><a name="zh-cn_topic_0000002209652690_p186126398296"></a>MODIFY_MIXLIST</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209652690_p14117102244"><a name="zh-cn_topic_0000002209652690_p14117102244"></a><a name="zh-cn_topic_0000002209652690_p14117102244"></a>混合精度场景下，通过此参数指定混合精度黑白灰名单的路径以及文件名，自行指定哪些算子允许降精度，哪些算子不允许降精度。配置为路径以及文件名，文件为JSON格式。黑白灰名单，可从“<span id="zh-cn_topic_0000002209652690_ph123231510175111"><a name="zh-cn_topic_0000002209652690_ph123231510175111"></a><a name="zh-cn_topic_0000002209652690_ph123231510175111"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002209652690_i6494142591118"><a name="zh-cn_topic_0000002209652690_i6494142591118"></a><a name="zh-cn_topic_0000002209652690_i6494142591118"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002209652690_i437512338114"><a name="zh-cn_topic_0000002209652690_i437512338114"></a><a name="zh-cn_topic_0000002209652690_i437512338114"></a>xxx</em>-ops-info.json”内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002209652690_parmname193238108518"><a name="zh-cn_topic_0000002209652690_parmname193238108518"></a><a name="zh-cn_topic_0000002209652690_parmname193238108518"></a>“precision_reduce”</span>参数下的flag参数值（其中，<span id="zh-cn_topic_0000002209652690_ph6491162165318"><a name="zh-cn_topic_0000002209652690_ph6491162165318"></a><a name="zh-cn_topic_0000002209652690_ph6491162165318"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002209652690_i129552245219"><a name="zh-cn_topic_0000002209652690_i129552245219"></a><a name="zh-cn_topic_0000002209652690_i129552245219"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002209652690_ph20833205312295"><a name="zh-cn_topic_0000002209652690_ph20833205312295"></a><a name="zh-cn_topic_0000002209652690_ph20833205312295"></a>产品</span>进行选择。）：</p>
<a name="zh-cn_topic_0000002209652690_ul1473622618190"></a><a name="zh-cn_topic_0000002209652690_ul1473622618190"></a><ul id="zh-cn_topic_0000002209652690_ul1473622618190"><li>若取值为true（白名单），表示混合精度模式下，<strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b2304123420539"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b2304123420539"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b2304123420539"></a>允许</strong>降低精度。</li><li>若取值为false（黑名单），表示混合精度模式下，<strong id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b04811035105314"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b04811035105314"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b04811035105314"></a>不允许</strong>降低精度。</li><li>不配置该参数（灰名单），表示混合精度模式下，当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
<p id="zh-cn_topic_0000002209652690_p857043611144"><a name="zh-cn_topic_0000002209652690_p857043611144"></a><a name="zh-cn_topic_0000002209652690_p857043611144"></a>开启混合精度方式：</p>
<a name="zh-cn_topic_0000002209652690_ul116125356314"></a><a name="zh-cn_topic_0000002209652690_ul116125356314"></a><ul id="zh-cn_topic_0000002209652690_ul116125356314"><li>PRECISION_MODE参数设置为allow_mix_precision、allow_mix_precision_fp16、allow_mix_precision_bf16。</li><li>PRECISION_MODE_V2参数设置为mixed_float16、mixed_bfloat16、，与PRECISION_MODE参数不能同时配置，建议使用PRECISION_MODE_V2。</li></ul>
<div class="p" id="zh-cn_topic_0000002209652690_p489982953315"><a name="zh-cn_topic_0000002209652690_p489982953315"></a><a name="zh-cn_topic_0000002209652690_p489982953315"></a><strong id="zh-cn_topic_0000002209652690_b877823617428"><a name="zh-cn_topic_0000002209652690_b877823617428"></a><a name="zh-cn_topic_0000002209652690_b877823617428"></a>配置示例：</strong><pre class="screen" id="zh-cn_topic_0000002209652690_screen689942912339"><a name="zh-cn_topic_0000002209652690_screen689942912339"></a><a name="zh-cn_topic_0000002209652690_screen689942912339"></a>{ge::ir_option::MODIFY_MIXLIST, "/home/test/ops_info.json"}</pre>
</div>
<p id="zh-cn_topic_0000002209652690_p889922918332"><a name="zh-cn_topic_0000002209652690_p889922918332"></a><a name="zh-cn_topic_0000002209652690_p889922918332"></a>ops_info.json中可以指定算子类型，多个算子使用英文逗号分隔，样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002209652690_screen15227852153611"><a name="zh-cn_topic_0000002209652690_screen15227852153611"></a><a name="zh-cn_topic_0000002209652690_screen15227852153611"></a>{
  "black-list": {                  // 黑名单
     "to-remove": [                // 黑名单算子转换为灰名单算子，配置该参数时，请确保被转换的算子已经存在于黑名单中
     "Xlog1py"
     ],
     "to-add": [                   // 白名单或灰名单算子转换为黑名单算子
     "Matmul",
     "Cast"
     ]
  },
  "white-list": {                  // 白名单
     "to-remove": [                // 白名单算子转换为灰名单算子，配置该参数时，请确保被转换的算子已经存在于白名单中 
     "Conv2D"
     ],
     "to-add": [                   // 黑名单或灰名单算子转换为白名单算子
     "Bias"
     ]
  }
}</pre>
<p id="zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_p1785210112503"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_p1785210112503"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_p1785210112503"></a>上述配置文件样例中展示的算子仅作为参考，请基于实际硬件环境和具体的算子内置优化策略进行配置，黑白灰名单查询样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_screen11429186175017"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_screen11429186175017"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_screen11429186175017"></a>"Conv2D":{
    "precision_reduce":{
        "flag":"true"
     }
},</pre>
<p id="zh-cn_topic_0000002209652690_p55361828162011"><a name="zh-cn_topic_0000002209652690_p55361828162011"></a><a name="zh-cn_topic_0000002209652690_p55361828162011"></a>true：白名单。false：黑名单。不配置：灰名单。</p>
<p id="zh-cn_topic_0000002209652690_p119878506533"><a name="zh-cn_topic_0000002209652690_p119878506533"></a><a name="zh-cn_topic_0000002209652690_p119878506533"></a><span class="ddd" id="zh-cn_topic_0000002209652690_ph144037315572"><a name="zh-cn_topic_0000002209652690_ph144037315572"></a><a name="zh-cn_topic_0000002209652690_ph144037315572"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209652690_p16109137205712"><a name="zh-cn_topic_0000002209652690_p16109137205712"></a><a name="zh-cn_topic_0000002209652690_p16109137205712"></a><span id="zh-cn_topic_0000002209652690_ph131091078578"><a name="zh-cn_topic_0000002209652690_ph131091078578"></a><a name="zh-cn_topic_0000002209652690_ph131091078578"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209652690_p7109117165713"><a name="zh-cn_topic_0000002209652690_p7109117165713"></a><a name="zh-cn_topic_0000002209652690_p7109117165713"></a><span id="zh-cn_topic_0000002209652690_ph81101795711"><a name="zh-cn_topic_0000002209652690_ph81101795711"></a><a name="zh-cn_topic_0000002209652690_ph81101795711"></a><term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 精度比对<a name="section2027543175411"></a>

<a name="table184198716551"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002209492866_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002209492866_p192241011355"><a name="zh-cn_topic_0000002209492866_p192241011355"></a><a name="zh-cn_topic_0000002209492866_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002209492866_p102241606359"><a name="zh-cn_topic_0000002209492866_p102241606359"></a><a name="zh-cn_topic_0000002209492866_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002209492866_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492866_p22248043510"><a name="zh-cn_topic_0000002209492866_p22248043510"></a><a name="zh-cn_topic_0000002209492866_p22248043510"></a>BUFFER_OPTIMIZE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492866_p19190141644615"><a name="zh-cn_topic_0000002209492866_p19190141644615"></a><a name="zh-cn_topic_0000002209492866_p19190141644615"></a>数据缓存优化开关。<strong id="zh-cn_topic_0000002209492866_b7233141715221"><a name="zh-cn_topic_0000002209492866_b7233141715221"></a><a name="zh-cn_topic_0000002209492866_b7233141715221"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002209492866_ul116213359375"></a><a name="zh-cn_topic_0000002209492866_ul116213359375"></a><ul id="zh-cn_topic_0000002209492866_ul116213359375"><li>l1_optimize：表示开启l1优化。当前版本该参数无效，等同于off_optimize。</li><li>l2_optimize：（默认值）表示开启l2优化。</li><li>off_optimize：表示关闭数据缓存优化。</li></ul>
<p id="zh-cn_topic_0000002209492866_p5528195117910"><a name="zh-cn_topic_0000002209492866_p5528195117910"></a><a name="zh-cn_topic_0000002209492866_p5528195117910"></a><strong id="zh-cn_topic_0000002209492866_b1821417591791"><a name="zh-cn_topic_0000002209492866_b1821417591791"></a><a name="zh-cn_topic_0000002209492866_b1821417591791"></a>使用建议：</strong></p>
<p id="zh-cn_topic_0000002209492866_p153079112236"><a name="zh-cn_topic_0000002209492866_p153079112236"></a><a name="zh-cn_topic_0000002209492866_p153079112236"></a>建议打开数据缓存优化功能：开启数据缓存优化可提高计算效率、提升性能，但由于部分算子在实现上可能存在未考虑的场景，导致影响精度，因此在出现精度问题时可以尝试关闭数据缓存优化。如果关闭数据缓存优化功能后，精度达标，则需要识别出问题算子，反馈给技术支持进一步分析、解决算子问题；解决算子问题后，建议仍旧保持开启数据缓存优化功能。</p>
<p id="zh-cn_topic_0000002209492866_p134551646111820"><a name="zh-cn_topic_0000002209492866_p134551646111820"></a><a name="zh-cn_topic_0000002209492866_p134551646111820"></a><strong id="zh-cn_topic_0000002209492866_b17561733191"><a name="zh-cn_topic_0000002209492866_b17561733191"></a><a name="zh-cn_topic_0000002209492866_b17561733191"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002209492866_screen8837151431912"><a name="zh-cn_topic_0000002209492866_screen8837151431912"></a><a name="zh-cn_topic_0000002209492866_screen8837151431912"></a>{ge::ir_option::BUFFER_OPTIMIZE, "l2_optimize"}</pre>
<p id="zh-cn_topic_0000002209492866_p35870552296"><a name="zh-cn_topic_0000002209492866_p35870552296"></a><a name="zh-cn_topic_0000002209492866_p35870552296"></a><strong id="zh-cn_topic_0000002209492866_b756518567317"><a name="zh-cn_topic_0000002209492866_b756518567317"></a><a name="zh-cn_topic_0000002209492866_b756518567317"></a>注意：当参数值设置为l1_optimize，则不能与VIRTUAL_TYPE参数同时使用，同时使用会出现报错，表示虚拟化场景不做l1融合，防止算子过大导致调度异常。</strong></p>
<p id="zh-cn_topic_0000002209492866_p59053462438"><a name="zh-cn_topic_0000002209492866_p59053462438"></a><a name="zh-cn_topic_0000002209492866_p59053462438"></a><span class="ddd" id="zh-cn_topic_0000002209492866_ph187554207559"><a name="zh-cn_topic_0000002209492866_ph187554207559"></a><a name="zh-cn_topic_0000002209492866_ph187554207559"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492866_p139615992213"><a name="zh-cn_topic_0000002209492866_p139615992213"></a><a name="zh-cn_topic_0000002209492866_p139615992213"></a><span id="zh-cn_topic_0000002209492866_ph2096114962218"><a name="zh-cn_topic_0000002209492866_ph2096114962218"></a><a name="zh-cn_topic_0000002209492866_ph2096114962218"></a><term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492866_p144742594"><a name="zh-cn_topic_0000002209492866_p144742594"></a><a name="zh-cn_topic_0000002209492866_p144742594"></a><span id="zh-cn_topic_0000002209492866_ph087219445912"><a name="zh-cn_topic_0000002209492866_ph087219445912"></a><a name="zh-cn_topic_0000002209492866_ph087219445912"></a><term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002209492866_row15258132419591"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002209492866_p539034815354"><a name="zh-cn_topic_0000002209492866_p539034815354"></a><a name="zh-cn_topic_0000002209492866_p539034815354"></a>FUSION_SWITCH_FILE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002209492866_zh-cn_topic_0221674006_p92931557193011"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0221674006_p92931557193011"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0221674006_p92931557193011"></a>融合开关配置文件路径以及文件名，路径和文件名：支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）、中文字符。</p>
<p id="zh-cn_topic_0000002209492866_p098510249587"><a name="zh-cn_topic_0000002209492866_p098510249587"></a><a name="zh-cn_topic_0000002209492866_p098510249587"></a>系统内置了一些图融合和UB融合规则，均为默认开启，可以根据需要关闭指定的融合规则，当前可以关闭的融合规则请参见<span id="zh-cn_topic_0000002209492866_ph314818225573"><a name="zh-cn_topic_0000002209492866_ph314818225573"></a><a name="zh-cn_topic_0000002209492866_ph314818225573"></a>《图融合和UB融合规则参考》</span>，但是由于系统机制，其他融合规则无法关闭。</p>
<p id="zh-cn_topic_0000002209492866_p20830639203114"><a name="zh-cn_topic_0000002209492866_p20830639203114"></a><a name="zh-cn_topic_0000002209492866_p20830639203114"></a><strong id="zh-cn_topic_0000002209492866_b19649134719313"><a name="zh-cn_topic_0000002209492866_b19649134719313"></a><a name="zh-cn_topic_0000002209492866_b19649134719313"></a>配置示例：</strong></p>
<p id="zh-cn_topic_0000002209492866_p2085044722212"><a name="zh-cn_topic_0000002209492866_p2085044722212"></a><a name="zh-cn_topic_0000002209492866_p2085044722212"></a>配置文件样例<em id="zh-cn_topic_0000002209492866_i055417552315"><a name="zh-cn_topic_0000002209492866_i055417552315"></a><a name="zh-cn_topic_0000002209492866_i055417552315"></a>fusion_switch.cfg，</em>on表示开启，off表示关闭。</p>
<a name="zh-cn_topic_0000002209492866_ol1177718253381"></a><a name="zh-cn_topic_0000002209492866_ol1177718253381"></a><ol id="zh-cn_topic_0000002209492866_ol1177718253381"><li>非<span id="zh-cn_topic_0000002209492866_ph58025618389"><a name="zh-cn_topic_0000002209492866_ph58025618389"></a><a name="zh-cn_topic_0000002209492866_ph58025618389"></a>昇腾910_95 AI处理器</span>配置文件样例：<pre class="screen" id="zh-cn_topic_0000002209492866_screen1615193144410"><a name="zh-cn_topic_0000002209492866_screen1615193144410"></a><a name="zh-cn_topic_0000002209492866_screen1615193144410"></a>{
    "Switch":{
        "GraphFusion":{
            "RequantFusionPass":"on",
            "ConvToFullyConnectionFusionPass":"off",
            "SoftmaxFusionPass":"on",
            "NotRequantFusionPass":"on",
            "SplitConvConcatFusionPass":"on",
            "ConvConcatFusionPass":"on",
            "MatMulBiasAddFusionPass":"on",
            "PoolingFusionPass":"on",
            "ZConcatv2dFusionPass":"on",
            "ZConcatExt2FusionPass":"on",
            "TfMergeSubFusionPass":"on"
        },
        "UBFusion":{
            "TbePool2dQuantFusionPass":"on"
        }
    }
}</pre>
</li></ol>
<p id="zh-cn_topic_0000002209492866_p18482186152"><a name="zh-cn_topic_0000002209492866_p18482186152"></a><a name="zh-cn_topic_0000002209492866_p18482186152"></a>同时支持用户一键关闭融合规则：</p>
<a name="zh-cn_topic_0000002209492866_ol2329163942218"></a><a name="zh-cn_topic_0000002209492866_ol2329163942218"></a><ol id="zh-cn_topic_0000002209492866_ol2329163942218"><li>非<span id="zh-cn_topic_0000002209492866_ph732911396229"><a name="zh-cn_topic_0000002209492866_ph732911396229"></a><a name="zh-cn_topic_0000002209492866_ph732911396229"></a>昇腾910_95 AI处理器</span>配置文件样例：<pre class="screen" id="zh-cn_topic_0000002209492866_screen26317388150"><a name="zh-cn_topic_0000002209492866_screen26317388150"></a><a name="zh-cn_topic_0000002209492866_screen26317388150"></a>{
    "Switch":{
        "GraphFusion":{
            "ALL":"off"
        },
        "UBFusion":{
            "ALL":"off"
         }
    }
}</pre>
</li></ol>
<p id="zh-cn_topic_0000002209492866_p6276611131714"><a name="zh-cn_topic_0000002209492866_p6276611131714"></a><a name="zh-cn_topic_0000002209492866_p6276611131714"></a>需要注意的是：</p>
<a name="zh-cn_topic_0000002209492866_ol2216140202017"></a><a name="zh-cn_topic_0000002209492866_ol2216140202017"></a><ol id="zh-cn_topic_0000002209492866_ol2216140202017"><li>关闭某些融合规则可能会导致功能问题，因此此处的一键式关闭仅关闭系统部分融合规则，而不是全部融合规则。</li><li>一键式关闭融合规则时，可以同时开启部分融合规则：<a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_ol1177718253381"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_ol1177718253381"></a><ol type="a" id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_ol1177718253381"><li>非<span id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_ph58025618389"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_ph58025618389"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_ph58025618389"></a>昇腾910_95 AI处理器</span>配置文件样例：<pre class="screen" id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_screen1480185614389"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_screen1480185614389"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_screen1480185614389"></a>{
    "Switch":{
        "GraphFusion":{
            "ALL":"off",
            "<em id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_i16815220390"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_i16815220390"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_i16815220390"></a>SoftmaxFusionPass</em>":"on"
        },
        "UBFusion":{
            "ALL":"off",
            "<em id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_i5681722123911"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_i5681722123911"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_i5681722123911"></a>TbePool2dQuantFusionPass</em>":"on"
        }
    }
}</pre>
<p id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_p180256163817"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_p180256163817"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001265073926_p180256163817"></a></p>
</li></ol>
</li></ol>
<p id="zh-cn_topic_0000002209492866_p73141954115912"><a name="zh-cn_topic_0000002209492866_p73141954115912"></a><a name="zh-cn_topic_0000002209492866_p73141954115912"></a><span class="ddd" id="zh-cn_topic_0000002209492866_ph1972012412569"><a name="zh-cn_topic_0000002209492866_ph1972012412569"></a><a name="zh-cn_topic_0000002209492866_ph1972012412569"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002209492866_p15819194619254"><a name="zh-cn_topic_0000002209492866_p15819194619254"></a><a name="zh-cn_topic_0000002209492866_p15819194619254"></a><span id="zh-cn_topic_0000002209492866_ph58197467256"><a name="zh-cn_topic_0000002209492866_ph58197467256"></a><a name="zh-cn_topic_0000002209492866_ph58197467256"></a><term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002209492866_p24041133154315"><a name="zh-cn_topic_0000002209492866_p24041133154315"></a><a name="zh-cn_topic_0000002209492866_p24041133154315"></a><span id="zh-cn_topic_0000002209492866_ph288411566436"><a name="zh-cn_topic_0000002209492866_ph288411566436"></a><a name="zh-cn_topic_0000002209492866_ph288411566436"></a><term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002209492866_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 性能调优<a name="section118068383545"></a>

<a name="table15368191014558"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002244572905_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002244572905_p192241011355"><a name="zh-cn_topic_0000002244572905_p192241011355"></a><a name="zh-cn_topic_0000002244572905_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002244572905_p102241606359"><a name="zh-cn_topic_0000002244572905_p102241606359"></a><a name="zh-cn_topic_0000002244572905_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002244572905_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572905_p2951185233514"><a name="zh-cn_topic_0000002244572905_p2951185233514"></a><a name="zh-cn_topic_0000002244572905_p2951185233514"></a>ENABLE_SMALL_CHANNEL</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572905_p162771826124614"><a name="zh-cn_topic_0000002244572905_p162771826124614"></a><a name="zh-cn_topic_0000002244572905_p162771826124614"></a>是否使能Small Channel的优化，使能后在Channel&lt;=4的卷积层会有性能收益。建议用户在推理场景下打开此开关。</p>
<p id="zh-cn_topic_0000002244572905_p126021233329"><a name="zh-cn_topic_0000002244572905_p126021233329"></a><a name="zh-cn_topic_0000002244572905_p126021233329"></a><strong id="zh-cn_topic_0000002244572905_b16849121033215"><a name="zh-cn_topic_0000002244572905_b16849121033215"></a><a name="zh-cn_topic_0000002244572905_b16849121033215"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244572905_ul1327782610460"></a><a name="zh-cn_topic_0000002244572905_ul1327782610460"></a><ul id="zh-cn_topic_0000002244572905_ul1327782610460"><li>0：（默认值）关闭。</li><li>1：使能。</li></ul>
<p id="zh-cn_topic_0000002244572905_p195491092814"><a name="zh-cn_topic_0000002244572905_p195491092814"></a><a name="zh-cn_topic_0000002244572905_p195491092814"></a><strong id="zh-cn_topic_0000002244572905_b4654142373216"><a name="zh-cn_topic_0000002244572905_b4654142373216"></a><a name="zh-cn_topic_0000002244572905_b4654142373216"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572905_screen1731103242818"><a name="zh-cn_topic_0000002244572905_screen1731103242818"></a><a name="zh-cn_topic_0000002244572905_screen1731103242818"></a>{ge::ir_option::ENABLE_SMALL_CHANNEL, "1"}</pre>
<p id="zh-cn_topic_0000002244572905_p123488489019"><a name="zh-cn_topic_0000002244572905_p123488489019"></a><a name="zh-cn_topic_0000002244572905_p123488489019"></a><span class="ddd" id="zh-cn_topic_0000002244572905_ph5173152875612"><a name="zh-cn_topic_0000002244572905_ph5173152875612"></a><a name="zh-cn_topic_0000002244572905_ph5173152875612"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572905_p39131726112716"><a name="zh-cn_topic_0000002244572905_p39131726112716"></a><a name="zh-cn_topic_0000002244572905_p39131726112716"></a><span id="zh-cn_topic_0000002244572905_ph13913126142715"><a name="zh-cn_topic_0000002244572905_ph13913126142715"></a><a name="zh-cn_topic_0000002244572905_ph13913126142715"></a><term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244572905_p1186961294513"><a name="zh-cn_topic_0000002244572905_p1186961294513"></a><a name="zh-cn_topic_0000002244572905_p1186961294513"></a><span id="zh-cn_topic_0000002244572905_ph1986917125453"><a name="zh-cn_topic_0000002244572905_ph1986917125453"></a><a name="zh-cn_topic_0000002244572905_ph1986917125453"></a><term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244572905_row63491547447"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572905_p13618465367"><a name="zh-cn_topic_0000002244572905_p13618465367"></a><a name="zh-cn_topic_0000002244572905_p13618465367"></a>OPTYPELIST_FOR_IMPLMODE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572905_p8132113913595"><a name="zh-cn_topic_0000002244572905_p8132113913595"></a><a name="zh-cn_topic_0000002244572905_p8132113913595"></a>设置optype列表中算子的实现模式。</p>
<p id="zh-cn_topic_0000002244572905_p6239103018291"><a name="zh-cn_topic_0000002244572905_p6239103018291"></a><a name="zh-cn_topic_0000002244572905_p6239103018291"></a><strong id="zh-cn_topic_0000002244572905_b36373381290"><a name="zh-cn_topic_0000002244572905_b36373381290"></a><a name="zh-cn_topic_0000002244572905_b36373381290"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002244572905_ul124075520295"></a><a name="zh-cn_topic_0000002244572905_ul124075520295"></a><ul id="zh-cn_topic_0000002244572905_ul124075520295"><li>列表中的算子使用OP_SELECT_IMPL_MODE参数指定的模式，当前仅支持指定为high_precision、high_performance两种模式，多个算子使用英文逗号进行分隔。</li><li>该参数需要与OP_SELECT_IMPL_MODE参数配合使用，且仅对指定的算子生效，不指定的算子按照默认实现方式选择。例如：OP_SELECT_IMPL_MODE配置为high_precision；OPTYPELIST_FOR_IMPLMODE配置为Pooling、SoftmaxV2。表示对Pooling、SoftmaxV2算子使用统一的高精度模式，未指定算子使用算子的默认实现方式。</li></ul>
<p id="zh-cn_topic_0000002244572905_p697184743219"><a name="zh-cn_topic_0000002244572905_p697184743219"></a><a name="zh-cn_topic_0000002244572905_p697184743219"></a><strong id="zh-cn_topic_0000002244572905_b15398105613216"><a name="zh-cn_topic_0000002244572905_b15398105613216"></a><a name="zh-cn_topic_0000002244572905_b15398105613216"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572905_screen39166121584"><a name="zh-cn_topic_0000002244572905_screen39166121584"></a><a name="zh-cn_topic_0000002244572905_screen39166121584"></a>{ge::ir_option::OPTYPELIST_FOR_IMPLMODE, "Pooling,SoftmaxV2"}</pre>
<p id="zh-cn_topic_0000002244572905_p4586511248"><a name="zh-cn_topic_0000002244572905_p4586511248"></a><a name="zh-cn_topic_0000002244572905_p4586511248"></a><span class="ddd" id="zh-cn_topic_0000002244572905_ph2677435115617"><a name="zh-cn_topic_0000002244572905_ph2677435115617"></a><a name="zh-cn_topic_0000002244572905_ph2677435115617"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572905_p1040973934517"><a name="zh-cn_topic_0000002244572905_p1040973934517"></a><a name="zh-cn_topic_0000002244572905_p1040973934517"></a><span id="zh-cn_topic_0000002244572905_ph1140912398456"><a name="zh-cn_topic_0000002244572905_ph1140912398456"></a><a name="zh-cn_topic_0000002244572905_ph1140912398456"></a><term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244572905_p1140961624710"><a name="zh-cn_topic_0000002244572905_p1140961624710"></a><a name="zh-cn_topic_0000002244572905_p1140961624710"></a><span id="zh-cn_topic_0000002244572905_ph18409181618473"><a name="zh-cn_topic_0000002244572905_ph18409181618473"></a><a name="zh-cn_topic_0000002244572905_ph18409181618473"></a><term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244572905_row455213604418"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572905_p547504349"><a name="zh-cn_topic_0000002244572905_p547504349"></a><a name="zh-cn_topic_0000002244572905_p547504349"></a>TILING_SCHEDULE_OPTIMIZE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572905_p1039973613417"><a name="zh-cn_topic_0000002244572905_p1039973613417"></a><a name="zh-cn_topic_0000002244572905_p1039973613417"></a>Tiling下沉调度优化开关。</p>
<p id="zh-cn_topic_0000002244572905_p62167612117"><a name="zh-cn_topic_0000002244572905_p62167612117"></a><a name="zh-cn_topic_0000002244572905_p62167612117"></a>由于NPU中AI Core内部存储无法完全容纳算子输入输出的所有数据，需要每次搬运一部分输入数据进行计算然后搬出，再搬运下一部分输入数据进行计算，该过程称之为Tiling；根据算子的shape等信息来确定数据切分算法相关参数（比如每次搬运的块大小，以及总共循环多少次）的计算程序，称之为Tiling实现。由于Tiling实现中完成的均为标量计算，AI Core并不擅长，故一般在Host侧CPU上执行，但是满足下述条件Tiling实现会下沉到Device侧执行：</p>
<a name="zh-cn_topic_0000002244572905_ol19579144632417"></a><a name="zh-cn_topic_0000002244572905_ol19579144632417"></a><ol id="zh-cn_topic_0000002244572905_ol19579144632417"><li>模型为静态shape。</li><li>模型中的算子支持Tiling下沉，比如FusedInferAttentionScore、IncreFlashAttention等融合算子。</li><li>支持Tiling下沉的算子值有依赖，需要满足前一个算子的值有device的执行结果；如果依赖的值是Const，则不需要下沉执行Tiling，编译时会完成Tiling。</li></ol>
<p id="zh-cn_topic_0000002244572905_p9738449125019"><a name="zh-cn_topic_0000002244572905_p9738449125019"></a><a name="zh-cn_topic_0000002244572905_p9738449125019"></a><strong id="zh-cn_topic_0000002244572905_b112031810522"><a name="zh-cn_topic_0000002244572905_b112031810522"></a><a name="zh-cn_topic_0000002244572905_b112031810522"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244572905_ul1198512934019"></a><a name="zh-cn_topic_0000002244572905_ul1198512934019"></a><ul id="zh-cn_topic_0000002244572905_ul1198512934019"><li>0：关闭Tiling下沉，默认为0。</li><li>1：使能Tiling下沉。</li></ul>
<p id="zh-cn_topic_0000002244572905_p0621533512"><a name="zh-cn_topic_0000002244572905_p0621533512"></a><a name="zh-cn_topic_0000002244572905_p0621533512"></a><strong id="zh-cn_topic_0000002244572905_b1321171845212"><a name="zh-cn_topic_0000002244572905_b1321171845212"></a><a name="zh-cn_topic_0000002244572905_b1321171845212"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572905_screen246223217523"><a name="zh-cn_topic_0000002244572905_screen246223217523"></a><a name="zh-cn_topic_0000002244572905_screen246223217523"></a>{ge::ir_option::TILING_SCHEDULE_OPTIMIZE, "1"}</pre>
<p id="zh-cn_topic_0000002244572905_p929316295319"><a name="zh-cn_topic_0000002244572905_p929316295319"></a><a name="zh-cn_topic_0000002244572905_p929316295319"></a><span class="ddd" id="zh-cn_topic_0000002244572905_ph52930218533"><a name="zh-cn_topic_0000002244572905_ph52930218533"></a><a name="zh-cn_topic_0000002244572905_ph52930218533"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572905_p142931427534"><a name="zh-cn_topic_0000002244572905_p142931427534"></a><a name="zh-cn_topic_0000002244572905_p142931427534"></a><span id="zh-cn_topic_0000002244572905_ph132932295312"><a name="zh-cn_topic_0000002244572905_ph132932295312"></a><a name="zh-cn_topic_0000002244572905_ph132932295312"></a><term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244572905_p162937205313"><a name="zh-cn_topic_0000002244572905_p162937205313"></a><a name="zh-cn_topic_0000002244572905_p162937205313"></a><span id="zh-cn_topic_0000002244572905_ph92931924531"><a name="zh-cn_topic_0000002244572905_ph92931924531"></a><a name="zh-cn_topic_0000002244572905_ph92931924531"></a><term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 量化压缩<a name="section7792143465417"></a>

<a name="table37307835517"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002244572917_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002244572917_p192241011355"><a name="zh-cn_topic_0000002244572917_p192241011355"></a><a name="zh-cn_topic_0000002244572917_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002244572917_p102241606359"><a name="zh-cn_topic_0000002244572917_p102241606359"></a><a name="zh-cn_topic_0000002244572917_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002244572917_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572917_p1622430113519"><a name="zh-cn_topic_0000002244572917_p1622430113519"></a><a name="zh-cn_topic_0000002244572917_p1622430113519"></a>ENABLE_COMPRESS_WEIGHT</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572917_p162711174716"><a name="zh-cn_topic_0000002244572917_p162711174716"></a><a name="zh-cn_topic_0000002244572917_p162711174716"></a>使能全局weight压缩。</p>
<p id="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p3470819154610"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p3470819154610"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p3470819154610"></a>AICore支持weight压缩功能，通过使能该参数，可以对weight进行数据压缩，在进行算子计算时，对weight进行解压缩，从而达到减少带宽、提高性能的目的。</p>
<p id="zh-cn_topic_0000002244572917_p060417271781"><a name="zh-cn_topic_0000002244572917_p060417271781"></a><a name="zh-cn_topic_0000002244572917_p060417271781"></a>该参数使能全局weight压缩，不能与COMPRESS_WEIGHT_CONF同时使用。</p>
<p id="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p1952132424616"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p1952132424616"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p1952132424616"></a><strong id="zh-cn_topic_0000002244572917_b1073810465814"><a name="zh-cn_topic_0000002244572917_b1073810465814"></a><a name="zh-cn_topic_0000002244572917_b1073810465814"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_ul29513471222"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_ul29513471222"></a><ul id="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_ul29513471222"><li>true：表示使能。</li><li>false：（默认值）表示关闭。</li></ul>
<p id="zh-cn_topic_0000002244572917_p1180293172119"><a name="zh-cn_topic_0000002244572917_p1180293172119"></a><a name="zh-cn_topic_0000002244572917_p1180293172119"></a><strong id="zh-cn_topic_0000002244572917_b19736172414213"><a name="zh-cn_topic_0000002244572917_b19736172414213"></a><a name="zh-cn_topic_0000002244572917_b19736172414213"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572917_screen177141718152118"><a name="zh-cn_topic_0000002244572917_screen177141718152118"></a><a name="zh-cn_topic_0000002244572917_screen177141718152118"></a>{ge::ir_option::ENABLE_COMPRESS_WEIGHT, "true"}</pre>
<p id="zh-cn_topic_0000002244572917_p182391524515"><a name="zh-cn_topic_0000002244572917_p182391524515"></a><a name="zh-cn_topic_0000002244572917_p182391524515"></a><span class="ddd" id="zh-cn_topic_0000002244572917_ph7724152517557"><a name="zh-cn_topic_0000002244572917_ph7724152517557"></a><a name="zh-cn_topic_0000002244572917_ph7724152517557"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572917_p2089516241756"><a name="zh-cn_topic_0000002244572917_p2089516241756"></a><a name="zh-cn_topic_0000002244572917_p2089516241756"></a><span id="zh-cn_topic_0000002244572917_ph1589512413520"><a name="zh-cn_topic_0000002244572917_ph1589512413520"></a><a name="zh-cn_topic_0000002244572917_ph1589512413520"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：不支持</p>
<p id="zh-cn_topic_0000002244572917_p14729125692112"><a name="zh-cn_topic_0000002244572917_p14729125692112"></a><a name="zh-cn_topic_0000002244572917_p14729125692112"></a><span id="zh-cn_topic_0000002244572917_ph85591813222"><a name="zh-cn_topic_0000002244572917_ph85591813222"></a><a name="zh-cn_topic_0000002244572917_ph85591813222"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：不支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244572917_row172765134014"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572917_p12241607356"><a name="zh-cn_topic_0000002244572917_p12241607356"></a><a name="zh-cn_topic_0000002244572917_p12241607356"></a>COMPRESS_WEIGHT_CONF</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p141610522314"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p141610522314"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p141610522314"></a>要压缩的node节点列表配置文件路径及文件名，node节点主要为conv算子、fc算子。该参数不能与ENABLE_COMPRESS_WEIGHT参数同时使用。</p>
<p id="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p20605358244"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p20605358244"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0221674006_p20605358244"></a><strong id="zh-cn_topic_0000002244572917_b1811865520711"><a name="zh-cn_topic_0000002244572917_b1811865520711"></a><a name="zh-cn_topic_0000002244572917_b1811865520711"></a>参数值格式：</strong>路径和文件名支持大小写字母、数字，下划线；文件名支持大小写字母、数字，下划线和点(.)。</p>
<p id="zh-cn_topic_0000002244572917_p11351658151"><a name="zh-cn_topic_0000002244572917_p11351658151"></a><a name="zh-cn_topic_0000002244572917_p11351658151"></a><strong id="zh-cn_topic_0000002244572917_b46074331612"><a name="zh-cn_topic_0000002244572917_b46074331612"></a><a name="zh-cn_topic_0000002244572917_b46074331612"></a>参数值约束：</strong>weight压缩配置文件由<span id="zh-cn_topic_0000002244572917_ph2538725141110"><a name="zh-cn_topic_0000002244572917_ph2538725141110"></a><a name="zh-cn_topic_0000002244572917_ph2538725141110"></a>AMCT</span>输出，文件内容即为node名称列表，node名称之间以“;”间隔开。例如，compress_weight_nodes.cfg文件内容为：conv1; fc1; conv2_2/x1; fc2;  conv5_32/x2;fc6。</p>
<p id="zh-cn_topic_0000002244572917_p14357765221"><a name="zh-cn_topic_0000002244572917_p14357765221"></a><a name="zh-cn_topic_0000002244572917_p14357765221"></a><strong id="zh-cn_topic_0000002244572917_b1535711615226"><a name="zh-cn_topic_0000002244572917_b1535711615226"></a><a name="zh-cn_topic_0000002244572917_b1535711615226"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572917_screen13357566223"><a name="zh-cn_topic_0000002244572917_screen13357566223"></a><a name="zh-cn_topic_0000002244572917_screen13357566223"></a>{ge::ir_option::COMPRESS_WEIGHT_CONF, "<em id="zh-cn_topic_0000002244572917_i1463016571552"><a name="zh-cn_topic_0000002244572917_i1463016571552"></a><a name="zh-cn_topic_0000002244572917_i1463016571552"></a>$HOME/module</em><em id="zh-cn_topic_0000002244572917_i175300919619"><a name="zh-cn_topic_0000002244572917_i175300919619"></a><a name="zh-cn_topic_0000002244572917_i175300919619"></a>/compress_weight_nodes.cfg</em>"}</pre>
<p id="zh-cn_topic_0000002244572917_p1541511887"><a name="zh-cn_topic_0000002244572917_p1541511887"></a><a name="zh-cn_topic_0000002244572917_p1541511887"></a><span class="ddd" id="zh-cn_topic_0000002244572917_ph1648112918558"><a name="zh-cn_topic_0000002244572917_ph1648112918558"></a><a name="zh-cn_topic_0000002244572917_ph1648112918558"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572917_p10411811812"><a name="zh-cn_topic_0000002244572917_p10411811812"></a><a name="zh-cn_topic_0000002244572917_p10411811812"></a><span id="zh-cn_topic_0000002244572917_ph19411812815"><a name="zh-cn_topic_0000002244572917_ph19411812815"></a><a name="zh-cn_topic_0000002244572917_ph19411812815"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：不支持</p>
<p id="zh-cn_topic_0000002244572917_p112801952313"><a name="zh-cn_topic_0000002244572917_p112801952313"></a><a name="zh-cn_topic_0000002244572917_p112801952313"></a><span id="zh-cn_topic_0000002244572917_ph19289193234"><a name="zh-cn_topic_0000002244572917_ph19289193234"></a><a name="zh-cn_topic_0000002244572917_ph19289193234"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：不支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244572917_row1296810301415"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572917_p2210336133"><a name="zh-cn_topic_0000002244572917_p2210336133"></a><a name="zh-cn_topic_0000002244572917_p2210336133"></a>SPARSITY</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572917_p135479202581"><a name="zh-cn_topic_0000002244572917_p135479202581"></a><a name="zh-cn_topic_0000002244572917_p135479202581"></a>使能全局稀疏特性。</p>
<p id="zh-cn_topic_0000002244572917_p6334195712167"><a name="zh-cn_topic_0000002244572917_p6334195712167"></a><a name="zh-cn_topic_0000002244572917_p6334195712167"></a><span id="zh-cn_topic_0000002244572917_ph1482145815177"><a name="zh-cn_topic_0000002244572917_ph1482145815177"></a><a name="zh-cn_topic_0000002244572917_ph1482145815177"></a>AMCT</span>（昇腾模型压缩工具）4选2结构化稀疏后输出的模型，可能存在weight连续4个Cin维度元素中至少有2个为0的场景，模型转换时通过使能全局稀疏开关，将该场景下的元素筛选成2个，从而节省后续推理的计算量，提高推理性能。</p>
<p id="zh-cn_topic_0000002244572917_p917412581718"><a name="zh-cn_topic_0000002244572917_p917412581718"></a><a name="zh-cn_topic_0000002244572917_p917412581718"></a>由于硬件约束，该参数不能与ENABLE_COMPRESS_WEIGHT、COMPRESS_WEIGHT_CONF同时使用。</p>
<p id="zh-cn_topic_0000002244572917_p106368448319"><a name="zh-cn_topic_0000002244572917_p106368448319"></a><a name="zh-cn_topic_0000002244572917_p106368448319"></a><strong id="zh-cn_topic_0000002244572917_b316811580312"><a name="zh-cn_topic_0000002244572917_b316811580312"></a><a name="zh-cn_topic_0000002244572917_b316811580312"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244572917_ul859032111619"></a><a name="zh-cn_topic_0000002244572917_ul859032111619"></a><ul id="zh-cn_topic_0000002244572917_ul859032111619"><li>1：表示开启4选2结构化稀疏。</li><li>0：（默认值）不开启稀疏特性。</li></ul>
<p id="zh-cn_topic_0000002244572917_p191304521421"><a name="zh-cn_topic_0000002244572917_p191304521421"></a><a name="zh-cn_topic_0000002244572917_p191304521421"></a><strong id="zh-cn_topic_0000002244572917_b7964188134318"><a name="zh-cn_topic_0000002244572917_b7964188134318"></a><a name="zh-cn_topic_0000002244572917_b7964188134318"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244572917_screen8109151164311"><a name="zh-cn_topic_0000002244572917_screen8109151164311"></a><a name="zh-cn_topic_0000002244572917_screen8109151164311"></a>{ge::ir_option::SPARSITY, "1"}</pre>
<p id="zh-cn_topic_0000002244572917_p14459526458"><a name="zh-cn_topic_0000002244572917_p14459526458"></a><a name="zh-cn_topic_0000002244572917_p14459526458"></a><strong id="zh-cn_topic_0000002244572917_b8365153415516"><a name="zh-cn_topic_0000002244572917_b8365153415516"></a><a name="zh-cn_topic_0000002244572917_b8365153415516"></a>使用约束：</strong>使用该参数时，请确保模型是稀疏的模型，建议用户使用<span id="zh-cn_topic_0000002244572917_ph1795105143811"><a name="zh-cn_topic_0000002244572917_ph1795105143811"></a><a name="zh-cn_topic_0000002244572917_ph1795105143811"></a>AMCT</span>（TensorFlow）或<span id="zh-cn_topic_0000002244572917_ph197094819412"><a name="zh-cn_topic_0000002244572917_ph197094819412"></a><a name="zh-cn_topic_0000002244572917_ph197094819412"></a>AMCT</span>（PyTorch）的组合压缩功能获取，且组合压缩只能是4选2结构化稀疏+量化感知训练模式。</p>
<p id="zh-cn_topic_0000002244572917_p78382129148"><a name="zh-cn_topic_0000002244572917_p78382129148"></a><a name="zh-cn_topic_0000002244572917_p78382129148"></a><span class="ddd" id="zh-cn_topic_0000002244572917_ph2033713775717"><a name="zh-cn_topic_0000002244572917_ph2033713775717"></a><a name="zh-cn_topic_0000002244572917_ph2033713775717"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572917_p1865985914513"><a name="zh-cn_topic_0000002244572917_p1865985914513"></a><a name="zh-cn_topic_0000002244572917_p1865985914513"></a><span id="zh-cn_topic_0000002244572917_ph13659175915513"><a name="zh-cn_topic_0000002244572917_ph13659175915513"></a><a name="zh-cn_topic_0000002244572917_ph13659175915513"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>，支持</p>
<p id="zh-cn_topic_0000002244572917_p2051613204587"><a name="zh-cn_topic_0000002244572917_p2051613204587"></a><a name="zh-cn_topic_0000002244572917_p2051613204587"></a><span id="zh-cn_topic_0000002244572917_ph10516112019580"><a name="zh-cn_topic_0000002244572917_ph10516112019580"></a><a name="zh-cn_topic_0000002244572917_ph10516112019580"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244572917_row32769131401"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244572917_p2096111593911"><a name="zh-cn_topic_0000002244572917_p2096111593911"></a><a name="zh-cn_topic_0000002244572917_p2096111593911"></a>COMPRESSION_OPTIMIZE_CONF</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244572917_p12694163111317"><a name="zh-cn_topic_0000002244572917_p12694163111317"></a><a name="zh-cn_topic_0000002244572917_p12694163111317"></a>压缩优化功能配置文件路径以及文件名，通过该参数使能配置文件中指定的压缩优化特性，从而提升网络性能。例如：/home/test/compression_optimize.cfg。</p>
<p id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_zh-cn_topic_0221674006_p122243412410"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_zh-cn_topic_0221674006_p122243412410"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_zh-cn_topic_0221674006_p122243412410"></a>文件内容配置示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_screen2801235183319"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_screen2801235183319"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_screen2801235183319"></a>enable_first_layer_quantization:true</pre>
<a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_ul207861637193118"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_ul207861637193118"></a><ul id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_ul207861637193118"><li>当前配置文件仅支持配置<strong id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_b1851222214264"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_b1851222214264"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312392873_b1851222214264"></a>enable_first_layer_quantization</strong>特性，用于控制AIPP首层卷积是否进行优化（AIPP会与量化后模型首层卷积CONV2D前的Quant算子进行融合）。<p id="zh-cn_topic_0000002244572917_p198891928500"><a name="zh-cn_topic_0000002244572917_p198891928500"></a><a name="zh-cn_topic_0000002244572917_p198891928500"></a>使能<strong id="zh-cn_topic_0000002244572917_b7971514614"><a name="zh-cn_topic_0000002244572917_b7971514614"></a><a name="zh-cn_topic_0000002244572917_b7971514614"></a>enable_first_layer_quantization</strong>特性时，只有网络结构中存在AIPP+CONV2D结构，并且模型编译时ENABLE_SMALL_CHANNEL参数设置为1时，才有可能获得性能收益。由于量化后的模型存在一定程度上的精度损失，用户根据实际情况决定是否使能该特性。</p>
</li><li>配置文件中冒号前面表示压缩优化特性名称，冒号后面表示是否使能该特性，true表示使能，false表示不使能，默认不使能。</li></ul>
<p id="zh-cn_topic_0000002244572917_p1852163855011"><a name="zh-cn_topic_0000002244572917_p1852163855011"></a><a name="zh-cn_topic_0000002244572917_p1852163855011"></a><span class="ddd" id="zh-cn_topic_0000002244572917_ph178315364578"><a name="zh-cn_topic_0000002244572917_ph178315364578"></a><a name="zh-cn_topic_0000002244572917_ph178315364578"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244572917_p1452213817504"><a name="zh-cn_topic_0000002244572917_p1452213817504"></a><a name="zh-cn_topic_0000002244572917_p1452213817504"></a><span id="zh-cn_topic_0000002244572917_ph1522183815504"><a name="zh-cn_topic_0000002244572917_ph1522183815504"></a><a name="zh-cn_topic_0000002244572917_ph1522183815504"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：不支持</p>
<p id="zh-cn_topic_0000002244572917_p1268619542315"><a name="zh-cn_topic_0000002244572917_p1268619542315"></a><a name="zh-cn_topic_0000002244572917_p1268619542315"></a><span id="zh-cn_topic_0000002244572917_ph196911554138"><a name="zh-cn_topic_0000002244572917_ph196911554138"></a><a name="zh-cn_topic_0000002244572917_ph196911554138"></a><term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002244572917_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：不支持</p>
</td>
</tr>
</tbody>
</table>

## 试验参数<a name="section14265134310549"></a>

<a name="table1725481295510"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002244692745_row11357710184714"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002244692745_p192241011355"><a name="zh-cn_topic_0000002244692745_p192241011355"></a><a name="zh-cn_topic_0000002244692745_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002244692745_p102241606359"><a name="zh-cn_topic_0000002244692745_p102241606359"></a><a name="zh-cn_topic_0000002244692745_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002244692745_row8357410104716"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692745_p176198462157"><a name="zh-cn_topic_0000002244692745_p176198462157"></a><a name="zh-cn_topic_0000002244692745_p176198462157"></a>ALLOW_HF32</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692745_p16351442194715"><a name="zh-cn_topic_0000002244692745_p16351442194715"></a><a name="zh-cn_topic_0000002244692745_p16351442194715"></a><strong id="zh-cn_topic_0000002244692745_b144777820189"><a name="zh-cn_topic_0000002244692745_b144777820189"></a><a name="zh-cn_topic_0000002244692745_b144777820189"></a>该参数预留，当前版本暂不支持</strong>。</p>
<p id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p18954551506"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p18954551506"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p18954551506"></a>是否启用HF32自动代替float32数据类型的功能，当前版本该参数仅针对Conv类算子与Matmul类算子生效。</p>
<p id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p186673010212"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p186673010212"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p186673010212"></a>HF32是昇腾推出的专门用于算子内部计算的单精度浮点类型，与其他常用数据类型的比较如下图所示。可见，HF32与float32支持相同的数值范围，但尾数位精度（11位）却接近FP16（10位）。通过降低精度让HF32单精度数据类型代替原有的float32单精度数据类型，可大大降低数据所占空间大小，实现性能的提升。</p>
<p id="zh-cn_topic_0000002244692745_p338552241016"><a name="zh-cn_topic_0000002244692745_p338552241016"></a><a name="zh-cn_topic_0000002244692745_p338552241016"></a><strong id="zh-cn_topic_0000002244692745_b22121255165113"><a name="zh-cn_topic_0000002244692745_b22121255165113"></a><a name="zh-cn_topic_0000002244692745_b22121255165113"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692745_ul5606165855412"></a><a name="zh-cn_topic_0000002244692745_ul5606165855412"></a><ul id="zh-cn_topic_0000002244692745_ul5606165855412"><li>true：针对Conv类算子与Matmul类算子，使能FP32数据类型自动转换为HF32数据类型的功能。<p id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p2041116918198"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p2041116918198"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p2041116918198"></a>具体哪些算子使能了该功能，请参见CANN软件安装后文件存储路径的opp/built-in/op_impl/ai_core/tbe/impl_mode/allow_hf32_matmul_<strong id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b1564011412412"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b1564011412412"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b1564011412412"></a>t</strong>_conv_<strong id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b073828242"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b073828242"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b073828242"></a>t</strong>.ini，该文件不支持用户修改。</p>
</li><li>false：针对Conv类算子与Matmul类算子，不使能FP32数据类型自动转换为HF32数据类型的功能。<p id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p13622112819236"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p13622112819236"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p13622112819236"></a>具体哪些算子未使能该功能，请参见CANN软件安装后文件存储路径的opp/built-in/op_impl/ai_core/tbe/impl_mode/allow_hf32_matmul_<strong id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b118471220412"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b118471220412"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b118471220412"></a>f</strong>_conv_<strong id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b216211146410"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b216211146410"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b216211146410"></a>f</strong>.ini，该文件不支持用户修改。</p>
</li></ul>
<p id="zh-cn_topic_0000002244692745_p1135164991114"><a name="zh-cn_topic_0000002244692745_p1135164991114"></a><a name="zh-cn_topic_0000002244692745_p1135164991114"></a><strong id="zh-cn_topic_0000002244692745_b891124641112"><a name="zh-cn_topic_0000002244692745_b891124641112"></a><a name="zh-cn_topic_0000002244692745_b891124641112"></a>参数默认值：</strong>针对Conv类算子，使能FP32转换为HF32；针对Matmul类算子，不使能FP32转换为HF32。</p>
<p id="zh-cn_topic_0000002244692745_p5668164620568"><a name="zh-cn_topic_0000002244692745_p5668164620568"></a><a name="zh-cn_topic_0000002244692745_p5668164620568"></a><strong id="zh-cn_topic_0000002244692745_b19389489562"><a name="zh-cn_topic_0000002244692745_b19389489562"></a><a name="zh-cn_topic_0000002244692745_b19389489562"></a>使用约束</strong>：</p>
<a name="zh-cn_topic_0000002244692745_ul4400845114316"></a><a name="zh-cn_topic_0000002244692745_ul4400845114316"></a><ul id="zh-cn_topic_0000002244692745_ul4400845114316"><li>针对同一个算子，如果通过OP_PRECISION_MODE参数配置了enable_hi_float_32_execution或enable_float_32_execution，该场景下不建议再与ALLOW_HF32参数同时使用，若同时使用，则优先级如下：<p id="zh-cn_topic_0000002244692745_p446014451524"><a name="zh-cn_topic_0000002244692745_p446014451524"></a><a name="zh-cn_topic_0000002244692745_p446014451524"></a>OP_PRECISION_MODE(ByNodeName，按节点名称设置精度模式) &gt; ALLOW_HF32 &gt; OP_PRECISION_MODE(ByOpType，按算子类型设置精度模式)。</p>
</li><li>由于ALLOW_HF32是使用HF32自动代替float32，要想该参数生效，必须保证被使能的算子输入或者输出类型为float32。由于PRECISION_MODE_V2参数默认值为fp16，原始网络模型中算子类型为float32时会被强制转为float16类型，该场景下使用ALLOW_HF32参数不生效，建议修改PRECISION_MODE_V2参数值为<strong id="zh-cn_topic_0000002244692745_b1784821171517"><a name="zh-cn_topic_0000002244692745_b1784821171517"></a><a name="zh-cn_topic_0000002244692745_b1784821171517"></a>origin</strong>（PRECISION_MODE参数默认值为force_fp16，建议修改为<strong id="zh-cn_topic_0000002244692745_b7923132611209"><a name="zh-cn_topic_0000002244692745_b7923132611209"></a><a name="zh-cn_topic_0000002244692745_b7923132611209"></a>must_keep_origin_dtype</strong>或者<strong id="zh-cn_topic_0000002244692745_b1592314263204"><a name="zh-cn_topic_0000002244692745_b1592314263204"></a><a name="zh-cn_topic_0000002244692745_b1592314263204"></a>force_fp32</strong>）。</li></ul>
<p id="zh-cn_topic_0000002244692745_p019916252512"><a name="zh-cn_topic_0000002244692745_p019916252512"></a><a name="zh-cn_topic_0000002244692745_p019916252512"></a><strong id="zh-cn_topic_0000002244692745_b17199102162514"><a name="zh-cn_topic_0000002244692745_b17199102162514"></a><a name="zh-cn_topic_0000002244692745_b17199102162514"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692745_screen10199192162512"><a name="zh-cn_topic_0000002244692745_screen10199192162512"></a><a name="zh-cn_topic_0000002244692745_screen10199192162512"></a>{ge::ir_option::ALLOW_HF32, "true"}</pre>
<p id="zh-cn_topic_0000002244692745_p69151331172212"><a name="zh-cn_topic_0000002244692745_p69151331172212"></a><a name="zh-cn_topic_0000002244692745_p69151331172212"></a><span class="ddd" id="zh-cn_topic_0000002244692745_ph10915531102219"><a name="zh-cn_topic_0000002244692745_ph10915531102219"></a><a name="zh-cn_topic_0000002244692745_ph10915531102219"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692745_p491619315224"><a name="zh-cn_topic_0000002244692745_p491619315224"></a><a name="zh-cn_topic_0000002244692745_p491619315224"></a><span id="zh-cn_topic_0000002244692745_ph791663116229"><a name="zh-cn_topic_0000002244692745_ph791663116229"></a><a name="zh-cn_topic_0000002244692745_ph791663116229"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692745_p4751054162114"><a name="zh-cn_topic_0000002244692745_p4751054162114"></a><a name="zh-cn_topic_0000002244692745_p4751054162114"></a><span id="zh-cn_topic_0000002244692745_ph364004232819"><a name="zh-cn_topic_0000002244692745_ph364004232819"></a><a name="zh-cn_topic_0000002244692745_ph364004232819"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692745_row132021533121712"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692745_p132027333176"><a name="zh-cn_topic_0000002244692745_p132027333176"></a><a name="zh-cn_topic_0000002244692745_p132027333176"></a>OO_LEVEL</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692745_p155241939134310"><a name="zh-cn_topic_0000002244692745_p155241939134310"></a><a name="zh-cn_topic_0000002244692745_p155241939134310"></a><strong id="zh-cn_topic_0000002244692745_b112761862459"><a name="zh-cn_topic_0000002244692745_b112761862459"></a><a name="zh-cn_topic_0000002244692745_b112761862459"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002244692745_p81713419273"><a name="zh-cn_topic_0000002244692745_p81713419273"></a><a name="zh-cn_topic_0000002244692745_p81713419273"></a>图编译多级优化选项，包括子图优化、整图优化、<span>静态Shape模型下沉</span>等。</p>
<p id="zh-cn_topic_0000002244692745_p13590204722713"><a name="zh-cn_topic_0000002244692745_p13590204722713"></a><a name="zh-cn_topic_0000002244692745_p13590204722713"></a><span>静态Shape模型下沉</span>：静态Shape模型在编译时即可确定所有算子的输入输出Shape，完成模型级内存编排、算子的Tiling计算等Host侧计算，在模型加载时整体下发到Device流上，但不立即执行，通过下发模型执行Task触发模型中所有Task的执行。</p>
<p id="zh-cn_topic_0000002244692745_p14787525853"><a name="zh-cn_topic_0000002244692745_p14787525853"></a><a name="zh-cn_topic_0000002244692745_p14787525853"></a><strong id="zh-cn_topic_0000002244692745_b84818267518"><a name="zh-cn_topic_0000002244692745_b84818267518"></a><a name="zh-cn_topic_0000002244692745_b84818267518"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692745_ul28245481651"></a><a name="zh-cn_topic_0000002244692745_ul28245481651"></a><ul id="zh-cn_topic_0000002244692745_ul28245481651"><li>O1：会关闭所有图融合和UB融合Pass，只做促成静态下沉的相关优化，如InferShape（进行输出Tensor的shape推导）、常量折叠、死边消除等。<p id="zh-cn_topic_0000002244692745_zh-cn_topic_0000002058018885_p6524118144416"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000002058018885_p6524118144416"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000002058018885_p6524118144416"></a></p>
</li><li>O3：（默认值）开启所有优化。</li></ul>
<p id="zh-cn_topic_0000002244692745_p1417116268291"><a name="zh-cn_topic_0000002244692745_p1417116268291"></a><a name="zh-cn_topic_0000002244692745_p1417116268291"></a><strong id="zh-cn_topic_0000002244692745_b628623310294"><a name="zh-cn_topic_0000002244692745_b628623310294"></a><a name="zh-cn_topic_0000002244692745_b628623310294"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002244692745_p11936115015517"><a name="zh-cn_topic_0000002244692745_p11936115015517"></a><a name="zh-cn_topic_0000002244692745_p11936115015517"></a>取值为O1时，会关闭所有图融合和UB融合PASS，只开启静态下沉的相关PASS，但是如下路径文件中的图融合PASS，由于关闭后会有功能问题，会默认开启：</p>
<p id="zh-cn_topic_0000002244692745_p12878123125212"><a name="zh-cn_topic_0000002244692745_p12878123125212"></a><a name="zh-cn_topic_0000002244692745_p12878123125212"></a>“<span id="zh-cn_topic_0000002244692745_ph111861254121815"><a name="zh-cn_topic_0000002244692745_ph111861254121815"></a><a name="zh-cn_topic_0000002244692745_ph111861254121815"></a>${INSTALL_DIR}</span>/<em id="zh-cn_topic_0000002244692745_i1061253485419"><a name="zh-cn_topic_0000002244692745_i1061253485419"></a><a name="zh-cn_topic_0000002244692745_i1061253485419"></a>&lt;arch&gt;</em>-linux/lib64/plugin/opskernel/fusion_pass/config/fusion_config.json”文件中"ExceptionalPassOfO1Level"字段下的所有图融合PASS。</p>
<p id="zh-cn_topic_0000002244692745_li1541231181614p0"><a name="zh-cn_topic_0000002244692745_li1541231181614p0"></a><a name="zh-cn_topic_0000002244692745_li1541231181614p0"></a>其中<span id="zh-cn_topic_0000002244692745_ph13176162271813"><a name="zh-cn_topic_0000002244692745_ph13176162271813"></a><a name="zh-cn_topic_0000002244692745_ph13176162271813"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span>&lt;arch&gt;表示具体操作系统架构。</p>
<p id="zh-cn_topic_0000002244692745_p3439430952"><a name="zh-cn_topic_0000002244692745_p3439430952"></a><a name="zh-cn_topic_0000002244692745_p3439430952"></a><strong id="zh-cn_topic_0000002244692745_b343917305512"><a name="zh-cn_topic_0000002244692745_b343917305512"></a><a name="zh-cn_topic_0000002244692745_b343917305512"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692745_screen10680163516158"><a name="zh-cn_topic_0000002244692745_screen10680163516158"></a><a name="zh-cn_topic_0000002244692745_screen10680163516158"></a>{ge::ir_option::OO_LEVEL, "O3"}</pre>
<p id="zh-cn_topic_0000002244692745_p53871713104310"><a name="zh-cn_topic_0000002244692745_p53871713104310"></a><a name="zh-cn_topic_0000002244692745_p53871713104310"></a><span class="ddd" id="zh-cn_topic_0000002244692745_ph1348261625514"><a name="zh-cn_topic_0000002244692745_ph1348261625514"></a><a name="zh-cn_topic_0000002244692745_ph1348261625514"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692745_p102251817131919"><a name="zh-cn_topic_0000002244692745_p102251817131919"></a><a name="zh-cn_topic_0000002244692745_p102251817131919"></a><span id="zh-cn_topic_0000002244692745_ph192251917161914"><a name="zh-cn_topic_0000002244692745_ph192251917161914"></a><a name="zh-cn_topic_0000002244692745_ph192251917161914"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692745_p465703434017"><a name="zh-cn_topic_0000002244692745_p465703434017"></a><a name="zh-cn_topic_0000002244692745_p465703434017"></a><span id="zh-cn_topic_0000002244692745_ph13754548217"><a name="zh-cn_topic_0000002244692745_ph13754548217"></a><a name="zh-cn_topic_0000002244692745_ph13754548217"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692745_row269611348172"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692745_p1869633461718"><a name="zh-cn_topic_0000002244692745_p1869633461718"></a><a name="zh-cn_topic_0000002244692745_p1869633461718"></a>OO_CONSTANT_FOLDING</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692745_p295082412913"><a name="zh-cn_topic_0000002244692745_p295082412913"></a><a name="zh-cn_topic_0000002244692745_p295082412913"></a><strong id="zh-cn_topic_0000002244692745_b995032417912"><a name="zh-cn_topic_0000002244692745_b995032417912"></a><a name="zh-cn_topic_0000002244692745_b995032417912"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002244692745_p245519502315"><a name="zh-cn_topic_0000002244692745_p245519502315"></a><a name="zh-cn_topic_0000002244692745_p245519502315"></a>是否开启常量折叠优化。</p>
<p id="zh-cn_topic_0000002244692745_p1414619230342"><a name="zh-cn_topic_0000002244692745_p1414619230342"></a><a name="zh-cn_topic_0000002244692745_p1414619230342"></a>常量折叠是将计算图中可以预先确定输出值的节点替换成常量，并对计算图进行一些结构简化的操作。</p>
<p id="zh-cn_topic_0000002244692745_p13761510719"><a name="zh-cn_topic_0000002244692745_p13761510719"></a><a name="zh-cn_topic_0000002244692745_p13761510719"></a><strong id="zh-cn_topic_0000002244692745_b1436914561976"><a name="zh-cn_topic_0000002244692745_b1436914561976"></a><a name="zh-cn_topic_0000002244692745_b1436914561976"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692745_ul9173551280"></a><a name="zh-cn_topic_0000002244692745_ul9173551280"></a><ul id="zh-cn_topic_0000002244692745_ul9173551280"><li>true：（默认值）开启。</li><li>false：关闭。</li></ul>
<p id="zh-cn_topic_0000002244692745_p20880195910714"><a name="zh-cn_topic_0000002244692745_p20880195910714"></a><a name="zh-cn_topic_0000002244692745_p20880195910714"></a><strong id="zh-cn_topic_0000002244692745_b1588018591372"><a name="zh-cn_topic_0000002244692745_b1588018591372"></a><a name="zh-cn_topic_0000002244692745_b1588018591372"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692745_screen965610184108"><a name="zh-cn_topic_0000002244692745_screen965610184108"></a><a name="zh-cn_topic_0000002244692745_screen965610184108"></a>{ge::ir_option::OO_CONSTANT_FOLDING, "true"}</pre>
<p id="zh-cn_topic_0000002244692745_p994013443314"><a name="zh-cn_topic_0000002244692745_p994013443314"></a><a name="zh-cn_topic_0000002244692745_p994013443314"></a><span class="ddd" id="zh-cn_topic_0000002244692745_ph20940144410319"><a name="zh-cn_topic_0000002244692745_ph20940144410319"></a><a name="zh-cn_topic_0000002244692745_ph20940144410319"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692745_p1294014440314"><a name="zh-cn_topic_0000002244692745_p1294014440314"></a><a name="zh-cn_topic_0000002244692745_p1294014440314"></a><span id="zh-cn_topic_0000002244692745_ph10940184410312"><a name="zh-cn_topic_0000002244692745_ph10940184410312"></a><a name="zh-cn_topic_0000002244692745_ph10940184410312"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692745_p694074416314"><a name="zh-cn_topic_0000002244692745_p694074416314"></a><a name="zh-cn_topic_0000002244692745_p694074416314"></a><span id="zh-cn_topic_0000002244692745_ph1094084413117"><a name="zh-cn_topic_0000002244692745_ph1094084413117"></a><a name="zh-cn_topic_0000002244692745_ph1094084413117"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692745_row20275436131713"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692745_p727518360177"><a name="zh-cn_topic_0000002244692745_p727518360177"></a><a name="zh-cn_topic_0000002244692745_p727518360177"></a>OO_DEAD_CODE_ELIMINATION</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692745_p226419281893"><a name="zh-cn_topic_0000002244692745_p226419281893"></a><a name="zh-cn_topic_0000002244692745_p226419281893"></a><strong id="zh-cn_topic_0000002244692745_b626413288915"><a name="zh-cn_topic_0000002244692745_b626413288915"></a><a name="zh-cn_topic_0000002244692745_b626413288915"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002244692745_p15988112512916"><a name="zh-cn_topic_0000002244692745_p15988112512916"></a><a name="zh-cn_topic_0000002244692745_p15988112512916"></a>是否开启死边消除优化。</p>
<p id="zh-cn_topic_0000002244692745_p81794043414"><a name="zh-cn_topic_0000002244692745_p81794043414"></a><a name="zh-cn_topic_0000002244692745_p81794043414"></a>死边消除：switch死边消除，switch的pred输入（1号输入）为const节点时，根据const的值消除其中一条分支：const为true时，消除false分支；const为false时，消除true分支。</p>
<p id="zh-cn_topic_0000002244692745_p20988172512915"><a name="zh-cn_topic_0000002244692745_p20988172512915"></a><a name="zh-cn_topic_0000002244692745_p20988172512915"></a><strong id="zh-cn_topic_0000002244692745_b10988825991"><a name="zh-cn_topic_0000002244692745_b10988825991"></a><a name="zh-cn_topic_0000002244692745_b10988825991"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692745_ul149881025394"></a><a name="zh-cn_topic_0000002244692745_ul149881025394"></a><ul id="zh-cn_topic_0000002244692745_ul149881025394"><li>true：（默认值）开启。</li><li>false：关闭。</li></ul>
<p id="zh-cn_topic_0000002244692745_p109881251197"><a name="zh-cn_topic_0000002244692745_p109881251197"></a><a name="zh-cn_topic_0000002244692745_p109881251197"></a><strong id="zh-cn_topic_0000002244692745_b12988152518915"><a name="zh-cn_topic_0000002244692745_b12988152518915"></a><a name="zh-cn_topic_0000002244692745_b12988152518915"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002244692745_screen1898817259910"><a name="zh-cn_topic_0000002244692745_screen1898817259910"></a><a name="zh-cn_topic_0000002244692745_screen1898817259910"></a>{ge::ir_option::OO_DEAD_CODE_ELIMINATION, "true"}</pre>
<p id="zh-cn_topic_0000002244692745_p13676174863112"><a name="zh-cn_topic_0000002244692745_p13676174863112"></a><a name="zh-cn_topic_0000002244692745_p13676174863112"></a><span class="ddd" id="zh-cn_topic_0000002244692745_ph1967612488319"><a name="zh-cn_topic_0000002244692745_ph1967612488319"></a><a name="zh-cn_topic_0000002244692745_ph1967612488319"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002244692745_p18676348183120"><a name="zh-cn_topic_0000002244692745_p18676348183120"></a><a name="zh-cn_topic_0000002244692745_p18676348183120"></a><span id="zh-cn_topic_0000002244692745_ph267617485316"><a name="zh-cn_topic_0000002244692745_ph267617485316"></a><a name="zh-cn_topic_0000002244692745_ph267617485316"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002244692745_p1967614811315"><a name="zh-cn_topic_0000002244692745_p1967614811315"></a><a name="zh-cn_topic_0000002244692745_p1967614811315"></a><span id="zh-cn_topic_0000002244692745_ph19676174816316"><a name="zh-cn_topic_0000002244692745_ph19676174816316"></a><a name="zh-cn_topic_0000002244692745_ph19676174816316"></a><term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002244692745_row8723114113453"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002244692745_p176141838194218"><a name="zh-cn_topic_0000002244692745_p176141838194218"></a><a name="zh-cn_topic_0000002244692745_p176141838194218"></a>TUNE_DEVICE_IDS</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002244692745_p533055117819"><a name="zh-cn_topic_0000002244692745_p533055117819"></a><a name="zh-cn_topic_0000002244692745_p533055117819"></a><strong id="zh-cn_topic_0000002244692745_b14526171310125"><a name="zh-cn_topic_0000002244692745_b14526171310125"></a><a name="zh-cn_topic_0000002244692745_b14526171310125"></a>当前版本暂不支持</strong>。</p>
</td>
</tr>
</tbody>
</table>

## 后续版本废弃配置<a name="section11105154615318"></a>

<a name="table7277185153115"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002214119106_row15251105212299"><th class="cellrowborder" valign="top" width="19.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002214119106_p192241011355"><a name="zh-cn_topic_0000002214119106_p192241011355"></a><a name="zh-cn_topic_0000002214119106_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.71000000000001%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002214119106_p102241606359"><a name="zh-cn_topic_0000002214119106_p102241606359"></a><a name="zh-cn_topic_0000002214119106_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002214119106_row629682164416"><td class="cellrowborder" valign="top" width="19.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002214119106_p1796591113612"><a name="zh-cn_topic_0000002214119106_p1796591113612"></a><a name="zh-cn_topic_0000002214119106_p1796591113612"></a>OP_SELECT_IMPL_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="80.71000000000001%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002214119106_p69815497582"><a name="zh-cn_topic_0000002214119106_p69815497582"></a><a name="zh-cn_topic_0000002214119106_p69815497582"></a><span id="zh-cn_topic_0000002214119106_ph1555712386204"><a name="zh-cn_topic_0000002214119106_ph1555712386204"></a><a name="zh-cn_topic_0000002214119106_ph1555712386204"></a>昇腾AI处理器</span>部分内置算子有高精度和高性能实现方式，用户可以通过该参数配置模型编译时算子选择哪种实现方式。</p>
<p id="zh-cn_topic_0000002214119106_p19941155835811"><a name="zh-cn_topic_0000002214119106_p19941155835811"></a><a name="zh-cn_topic_0000002214119106_p19941155835811"></a>高精度是指在float16输入场景，通过泰勒展开/牛顿迭代等手段进一步提升算子的精度；高性能是指在float16输入的情况下，不影响网络精度前提下的最优性能实现。</p>
<p id="zh-cn_topic_0000002214119106_p18808872169"><a name="zh-cn_topic_0000002214119106_p18808872169"></a><a name="zh-cn_topic_0000002214119106_p18808872169"></a><strong id="zh-cn_topic_0000002214119106_b163723373278"><a name="zh-cn_topic_0000002214119106_b163723373278"></a><a name="zh-cn_topic_0000002214119106_b163723373278"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002214119106_ul131265313503"></a><a name="zh-cn_topic_0000002214119106_ul131265313503"></a><ul id="zh-cn_topic_0000002214119106_ul131265313503"><li><strong id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b1752173519487"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b1752173519487"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b1752173519487"></a>high_precision</strong>：表示算子采用高精度实现模式。<p id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p79886343518"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p79886343518"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p79886343518"></a>该选项采用系统内置的配置文件设置算子实现模式，内置配置文件路径为<span id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph10562197165916"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph10562197165916"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/impl_mode/high_precision.ini。</p>
<p id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p1382733134116"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p1382733134116"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p1382733134116"></a>为保持兼容，该参数仅对high_precision.ini文件中算子列表生效，通过该列表可以控制算子生效的范围并保证之前版本的网络模型不受影响。</p>
</li><li><strong id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b19880362488"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b19880362488"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b19880362488"></a>high_performance</strong>：（默认值）表示算子采用高性能实现模式。<p id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p521419617314"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p521419617314"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p521419617314"></a>该选项采用系统内置的配置文件设置算子实现模式，内置配置文件路径为<span id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph115493481412"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph115493481412"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph115493481412"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/impl_mode/high_performance.ini。</p>
<p id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p56341418558"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p56341418558"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p56341418558"></a>为保持兼容，该参数仅对high_performance.ini文件中算子列表生效，通过该列表可以控制算子生效的范围并保证之前版本的网络模型不受影响。</p>
</li><li><strong id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b11324153824812"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b11324153824812"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b11324153824812"></a>high_precision_for_all</strong>：表示算子采用高精度实现模式。<p id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p125151221414"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p125151221414"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p125151221414"></a>该选项采用系统内置的配置文件设置算子实现模式，内置配置文件路径为<span id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph5364411414"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph5364411414"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_ph5364411414"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/impl_mode/high_precision_for_all.ini，该文件中列表后续可能会跟随版本更新。</p>
<p id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p19278864222"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p19278864222"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_p19278864222"></a><strong id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b097321901812"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b097321901812"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312473901_b097321901812"></a>该实现模式不保证兼容</strong>，如果后续新的软件包中有算子新增了实现模式（即配置文件中新增了某个算子的实现模式），之前版本使用high_precision_for_all的网络模型，在新版本上性能可能会下降。</p>
</li></ul>
<p id="zh-cn_topic_0000002214119106_p1664111571591"><a name="zh-cn_topic_0000002214119106_p1664111571591"></a><a name="zh-cn_topic_0000002214119106_p1664111571591"></a>上述实现模式，根据算子的dtype进行区分。<span id="zh-cn_topic_0000002214119106_ph13971204010358"><a name="zh-cn_topic_0000002214119106_ph13971204010358"></a><a name="zh-cn_topic_0000002214119106_ph13971204010358"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002214119106_p1788343119283"><a name="zh-cn_topic_0000002214119106_p1788343119283"></a><a name="zh-cn_topic_0000002214119106_p1788343119283"></a><strong id="zh-cn_topic_0000002214119106_b638610295324"><a name="zh-cn_topic_0000002214119106_b638610295324"></a><a name="zh-cn_topic_0000002214119106_b638610295324"></a>参数默认值：</strong>high_performance</p>
<p id="zh-cn_topic_0000002214119106_p185481629185612"><a name="zh-cn_topic_0000002214119106_p185481629185612"></a><a name="zh-cn_topic_0000002214119106_p185481629185612"></a><strong id="zh-cn_topic_0000002214119106_b15400833123211"><a name="zh-cn_topic_0000002214119106_b15400833123211"></a><a name="zh-cn_topic_0000002214119106_b15400833123211"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002214119106_screen13443995576"><a name="zh-cn_topic_0000002214119106_screen13443995576"></a><a name="zh-cn_topic_0000002214119106_screen13443995576"></a>{ge::ir_option::OP_SELECT_IMPL_MODE, "high_performance"}</pre>
<p id="zh-cn_topic_0000002214119106_p4291547337"><a name="zh-cn_topic_0000002214119106_p4291547337"></a><a name="zh-cn_topic_0000002214119106_p4291547337"></a><span class="ddd" id="zh-cn_topic_0000002214119106_ph1448717312564"><a name="zh-cn_topic_0000002214119106_ph1448717312564"></a><a name="zh-cn_topic_0000002214119106_ph1448717312564"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002214119106_p18505129143415"><a name="zh-cn_topic_0000002214119106_p18505129143415"></a><a name="zh-cn_topic_0000002214119106_p18505129143415"></a><span id="zh-cn_topic_0000002214119106_ph1650532963419"><a name="zh-cn_topic_0000002214119106_ph1650532963419"></a><a name="zh-cn_topic_0000002214119106_ph1650532963419"></a><term id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002214119106_p81403246469"><a name="zh-cn_topic_0000002214119106_p81403246469"></a><a name="zh-cn_topic_0000002214119106_p81403246469"></a><span id="zh-cn_topic_0000002214119106_ph19140162454616"><a name="zh-cn_topic_0000002214119106_ph19140162454616"></a><a name="zh-cn_topic_0000002214119106_ph19140162454616"></a><term id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002214119106_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

