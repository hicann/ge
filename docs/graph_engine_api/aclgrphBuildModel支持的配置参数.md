# aclgrphBuildModel支持的配置参数<a name="ZH-CN_TOPIC_0000001265404742"></a>

## 基础功能<a name="section159971511154917"></a>

<a name="table53461286508"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245550901_row20806957171510"><th class="cellrowborder" valign="top" width="17.82%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002245550901_p192241011355"><a name="zh-cn_topic_0000002245550901_p192241011355"></a><a name="zh-cn_topic_0000002245550901_p192241011355"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="82.17999999999999%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002245550901_p102241606359"><a name="zh-cn_topic_0000002245550901_p102241606359"></a><a name="zh-cn_topic_0000002245550901_p102241606359"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245550901_row4806105771518"><td class="cellrowborder" valign="top" width="17.82%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550901_p13994512172916"><a name="zh-cn_topic_0000002245550901_p13994512172916"></a><a name="zh-cn_topic_0000002245550901_p13994512172916"></a>INPUT_FORMAT</p>
</td>
<td class="cellrowborder" valign="top" width="82.17999999999999%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p149687173226"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p149687173226"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p149687173226"></a>输入数据格式。</p>
<p id="zh-cn_topic_0000002245550901_p71820911483"><a name="zh-cn_topic_0000002245550901_p71820911483"></a><a name="zh-cn_topic_0000002245550901_p71820911483"></a><strong id="zh-cn_topic_0000002245550901_b253702534815"><a name="zh-cn_topic_0000002245550901_b253702534815"></a><a name="zh-cn_topic_0000002245550901_b253702534815"></a>参数取值：</strong></p>
<p id="zh-cn_topic_0000002245550901_p27806393306"><a name="zh-cn_topic_0000002245550901_p27806393306"></a><a name="zh-cn_topic_0000002245550901_p27806393306"></a>支持NCHW、NHWC、ND、ND、NCDHW、NDHWC格式。</p>
<p id="zh-cn_topic_0000002245550901_p120413215481"><a name="zh-cn_topic_0000002245550901_p120413215481"></a><a name="zh-cn_topic_0000002245550901_p120413215481"></a><strong id="zh-cn_topic_0000002245550901_b116743359485"><a name="zh-cn_topic_0000002245550901_b116743359485"></a><a name="zh-cn_topic_0000002245550901_b116743359485"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen186002458484"><a name="zh-cn_topic_0000002245550901_screen186002458484"></a><a name="zh-cn_topic_0000002245550901_screen186002458484"></a>{ge::ir_option::INPUT_FORMAT, "NHWC"}</pre>
<p id="zh-cn_topic_0000002245550901_p10886550184415"><a name="zh-cn_topic_0000002245550901_p10886550184415"></a><a name="zh-cn_topic_0000002245550901_p10886550184415"></a>如果同时开启AIPP，在进行推理业务时，输入图片数据要求为NHWC排布。该场景下INPUT_FORMAT参数指定的数据格式不生效。</p>
<div class="note" id="zh-cn_topic_0000002245550901_note1028925145915"><a name="zh-cn_topic_0000002245550901_note1028925145915"></a><a name="zh-cn_topic_0000002245550901_note1028925145915"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="zh-cn_topic_0000002245550901_p0285253592"><a name="zh-cn_topic_0000002245550901_p0285253592"></a><a name="zh-cn_topic_0000002245550901_p0285253592"></a>该参数仅针对动态batch_size、动态分辨率和动态维度场景。</p>
<p id="zh-cn_topic_0000002245550901_p71011729017"><a name="zh-cn_topic_0000002245550901_p71011729017"></a><a name="zh-cn_topic_0000002245550901_p71011729017"></a>上述场景下，INPUT_FORMAT必须设置并且和所有Data算子的format保持一致，否则会导致模型编译失败。</p>
</div></div>
<p id="zh-cn_topic_0000002245550901_p433415221969"><a name="zh-cn_topic_0000002245550901_p433415221969"></a><a name="zh-cn_topic_0000002245550901_p433415221969"></a><span class="ddd" id="zh-cn_topic_0000002245550901_ph764162117337"><a name="zh-cn_topic_0000002245550901_ph764162117337"></a><a name="zh-cn_topic_0000002245550901_ph764162117337"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550901_p311910151388"><a name="zh-cn_topic_0000002245550901_p311910151388"></a><a name="zh-cn_topic_0000002245550901_p311910151388"></a><span id="zh-cn_topic_0000002245550901_ph1911910152813"><a name="zh-cn_topic_0000002245550901_ph1911910152813"></a><a name="zh-cn_topic_0000002245550901_ph1911910152813"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550901_p939620493717"><a name="zh-cn_topic_0000002245550901_p939620493717"></a><a name="zh-cn_topic_0000002245550901_p939620493717"></a><span id="zh-cn_topic_0000002245550901_ph831815168815"><a name="zh-cn_topic_0000002245550901_ph831815168815"></a><a name="zh-cn_topic_0000002245550901_ph831815168815"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245550901_row20806175761513"><td class="cellrowborder" valign="top" width="17.82%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550901_p14132962165"><a name="zh-cn_topic_0000002245550901_p14132962165"></a><a name="zh-cn_topic_0000002245550901_p14132962165"></a>OP_NAME_MAP</p>
</td>
<td class="cellrowborder" valign="top" width="82.17999999999999%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550901_p1797381945310"><a name="zh-cn_topic_0000002245550901_p1797381945310"></a><a name="zh-cn_topic_0000002245550901_p1797381945310"></a>扩展算子（非标准算子）映射配置文件路径和文件名，不同的网络中某扩展算子的功能不同，可以指定该扩展算子到具体网络中实际运行的扩展算子的映射。</p>
<p id="zh-cn_topic_0000002245550901_p16955182343117"><a name="zh-cn_topic_0000002245550901_p16955182343117"></a><a name="zh-cn_topic_0000002245550901_p16955182343117"></a>路径和文件名：支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）、中文字符。</p>
<p id="zh-cn_topic_0000002245550901_p125741541203210"><a name="zh-cn_topic_0000002245550901_p125741541203210"></a><a name="zh-cn_topic_0000002245550901_p125741541203210"></a><strong id="zh-cn_topic_0000002245550901_b1783125510490"><a name="zh-cn_topic_0000002245550901_b1783125510490"></a><a name="zh-cn_topic_0000002245550901_b1783125510490"></a>配置示例</strong>：</p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen128858539518"><a name="zh-cn_topic_0000002245550901_screen128858539518"></a><a name="zh-cn_topic_0000002245550901_screen128858539518"></a>{ge::ir_option::OP_NAME_MAP, "<em id="zh-cn_topic_0000002245550901_i1396334692519"><a name="zh-cn_topic_0000002245550901_i1396334692519"></a><a name="zh-cn_topic_0000002245550901_i1396334692519"></a>/home/test/opname_map.cfg</em>"}</pre>
<p id="zh-cn_topic_0000002245550901_p10350039122318"><a name="zh-cn_topic_0000002245550901_p10350039122318"></a><a name="zh-cn_topic_0000002245550901_p10350039122318"></a>其中，扩展算子映射配置文件内容示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen1288555316515"><a name="zh-cn_topic_0000002245550901_screen1288555316515"></a><a name="zh-cn_topic_0000002245550901_screen1288555316515"></a>OpA:Network1OpA</pre>
<p id="zh-cn_topic_0000002245550901_p8485102416915"><a name="zh-cn_topic_0000002245550901_p8485102416915"></a><a name="zh-cn_topic_0000002245550901_p8485102416915"></a><span class="ddd" id="zh-cn_topic_0000002245550901_ph07241765585"><a name="zh-cn_topic_0000002245550901_ph07241765585"></a><a name="zh-cn_topic_0000002245550901_ph07241765585"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550901_p1589312316334"><a name="zh-cn_topic_0000002245550901_p1589312316334"></a><a name="zh-cn_topic_0000002245550901_p1589312316334"></a><span id="zh-cn_topic_0000002245550901_ph989317314331"><a name="zh-cn_topic_0000002245550901_ph989317314331"></a><a name="zh-cn_topic_0000002245550901_ph989317314331"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550901_p98930333318"><a name="zh-cn_topic_0000002245550901_p98930333318"></a><a name="zh-cn_topic_0000002245550901_p98930333318"></a><span id="zh-cn_topic_0000002245550901_ph08936319333"><a name="zh-cn_topic_0000002245550901_ph08936319333"></a><a name="zh-cn_topic_0000002245550901_ph08936319333"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245550901_row72962321169"><td class="cellrowborder" valign="top" width="17.82%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550901_p139941512152912"><a name="zh-cn_topic_0000002245550901_p139941512152912"></a><a name="zh-cn_topic_0000002245550901_p139941512152912"></a>INSERT_OP_FILE</p>
</td>
<td class="cellrowborder" valign="top" width="82.17999999999999%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550901_zh-cn_topic_0162519416_p3406825151816"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0162519416_p3406825151816"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0162519416_p3406825151816"></a>输入预处理算子的配置文件路径，例如Aipp算子。</p>
<p id="zh-cn_topic_0000002245550901_p37781115134711"><a name="zh-cn_topic_0000002245550901_p37781115134711"></a><a name="zh-cn_topic_0000002245550901_p37781115134711"></a>若配置了该参数，则不能对同一个输入节点同时使用INPUT_FP16_NODES参数。</p>
<p id="zh-cn_topic_0000002245550901_p22071733103113"><a name="zh-cn_topic_0000002245550901_p22071733103113"></a><a name="zh-cn_topic_0000002245550901_p22071733103113"></a>配置文件路径：支持大小写字母、数字，下划线；文件名部分：支持大小写字母、数字，下划线和点(.)</p>
<p id="zh-cn_topic_0000002245550901_p1070171682720"><a name="zh-cn_topic_0000002245550901_p1070171682720"></a><a name="zh-cn_topic_0000002245550901_p1070171682720"></a><strong id="zh-cn_topic_0000002245550901_b9701316102711"><a name="zh-cn_topic_0000002245550901_b9701316102711"></a><a name="zh-cn_topic_0000002245550901_b9701316102711"></a>配置示例</strong>：</p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen11709161279"><a name="zh-cn_topic_0000002245550901_screen11709161279"></a><a name="zh-cn_topic_0000002245550901_screen11709161279"></a>{ge::ir_option::INSERT_OP_FILE, <em id="zh-cn_topic_0000002245550901_i4755155011275"><a name="zh-cn_topic_0000002245550901_i4755155011275"></a><a name="zh-cn_topic_0000002245550901_i4755155011275"></a>"/home/test/aipp.cfg</em><em id="zh-cn_topic_0000002245550901_i1746155382717"><a name="zh-cn_topic_0000002245550901_i1746155382717"></a><a name="zh-cn_topic_0000002245550901_i1746155382717"></a>"</em>}</pre>
<p id="zh-cn_topic_0000002245550901_p55634143114"><a name="zh-cn_topic_0000002245550901_p55634143114"></a><a name="zh-cn_topic_0000002245550901_p55634143114"></a>配置文件的内容示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen15141837123118"><a name="zh-cn_topic_0000002245550901_screen15141837123118"></a><a name="zh-cn_topic_0000002245550901_screen15141837123118"></a>aipp_op {
aipp_mode:static
input_format:YUV420SP_U8
csc_switch:true
var_reci_chn_0:0.00392157
var_reci_chn_1:0.00392157
var_reci_chn_2:0.00392157
}</pre>
<div class="note" id="zh-cn_topic_0000002245550901_zh-cn_topic_0162519416_note113153918220"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0162519416_note113153918220"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0162519416_note113153918220"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="zh-cn_topic_0000002245550901_p414543920317"><a name="zh-cn_topic_0000002245550901_p414543920317"></a><a name="zh-cn_topic_0000002245550901_p414543920317"></a>配置文件详细说明，请参考<span id="zh-cn_topic_0000002245550901_ph3730125602"><a name="zh-cn_topic_0000002245550901_ph3730125602"></a><a name="zh-cn_topic_0000002245550901_ph3730125602"></a>《ATC离线模型编译工具用户指南》</span>。</p>
</div></div>
<p id="zh-cn_topic_0000002245550901_p73275814124"><a name="zh-cn_topic_0000002245550901_p73275814124"></a><a name="zh-cn_topic_0000002245550901_p73275814124"></a><span class="ddd" id="zh-cn_topic_0000002245550901_ph19876295582"><a name="zh-cn_topic_0000002245550901_ph19876295582"></a><a name="zh-cn_topic_0000002245550901_ph19876295582"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550901_p187264302339"><a name="zh-cn_topic_0000002245550901_p187264302339"></a><a name="zh-cn_topic_0000002245550901_p187264302339"></a><span id="zh-cn_topic_0000002245550901_ph2726630163311"><a name="zh-cn_topic_0000002245550901_ph2726630163311"></a><a name="zh-cn_topic_0000002245550901_ph2726630163311"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550901_p15727183053313"><a name="zh-cn_topic_0000002245550901_p15727183053313"></a><a name="zh-cn_topic_0000002245550901_p15727183053313"></a><span id="zh-cn_topic_0000002245550901_ph11727123023313"><a name="zh-cn_topic_0000002245550901_ph11727123023313"></a><a name="zh-cn_topic_0000002245550901_ph11727123023313"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245550901_row1893423751613"><td class="cellrowborder" valign="top" width="17.82%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550901_p499471213290"><a name="zh-cn_topic_0000002245550901_p499471213290"></a><a name="zh-cn_topic_0000002245550901_p499471213290"></a>OUTPUT_TYPE</p>
</td>
<td class="cellrowborder" valign="top" width="82.17999999999999%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550901_p1395919414554"><a name="zh-cn_topic_0000002245550901_p1395919414554"></a><a name="zh-cn_topic_0000002245550901_p1395919414554"></a>网络输出数据类型。</p>
<p id="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p185212414269"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p185212414269"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p185212414269"></a><strong id="zh-cn_topic_0000002245550901_b58941016146"><a name="zh-cn_topic_0000002245550901_b58941016146"></a><a name="zh-cn_topic_0000002245550901_b58941016146"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_ul1719313193217"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_ul1719313193217"></a><ul id="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_ul1719313193217"><li>FP32：推荐分类网络、检测网络使用。</li><li>UINT8：图像超分辨率网络，推荐使用，推理性能更好。</li><li>FP16：推荐分类网络、检测网络使用。通常用于一个网络输出作为另一个网络输入场景。</li><li>INT8</li></ul>
<p id="zh-cn_topic_0000002245550901_p11621205400"><a name="zh-cn_topic_0000002245550901_p11621205400"></a><a name="zh-cn_topic_0000002245550901_p11621205400"></a>模型编译后，在对应的*.om模型文件中，数据类型以DT_FLOAT或DT_UINT8或DT_FLOAT16或DT_INT8值呈现。</p>
<p id="zh-cn_topic_0000002245550901_p14791565556"><a name="zh-cn_topic_0000002245550901_p14791565556"></a><a name="zh-cn_topic_0000002245550901_p14791565556"></a><strong id="zh-cn_topic_0000002245550901_b257714427566"><a name="zh-cn_topic_0000002245550901_b257714427566"></a><a name="zh-cn_topic_0000002245550901_b257714427566"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen1048914270551"><a name="zh-cn_topic_0000002245550901_screen1048914270551"></a><a name="zh-cn_topic_0000002245550901_screen1048914270551"></a>{ge::ir_option::OUTPUT_TYPE, "FP32"}</pre>
<p id="zh-cn_topic_0000002245550901_p1766713264412"><a name="zh-cn_topic_0000002245550901_p1766713264412"></a><a name="zh-cn_topic_0000002245550901_p1766713264412"></a><strong id="zh-cn_topic_0000002245550901_b187631638643"><a name="zh-cn_topic_0000002245550901_b187631638643"></a><a name="zh-cn_topic_0000002245550901_b187631638643"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_ul88677791917"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_ul88677791917"></a><ul id="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_ul88677791917"><li>若不指定具体数据类型，则以原始网络模型最后一层输出的算子数据类型为准。</li><li>若指定了类型，则以该参数指定的类型为准。</li></ul>
<p id="zh-cn_topic_0000002245550901_p119270524158"><a name="zh-cn_topic_0000002245550901_p119270524158"></a><a name="zh-cn_topic_0000002245550901_p119270524158"></a><span class="ddd" id="zh-cn_topic_0000002245550901_ph10300125465819"><a name="zh-cn_topic_0000002245550901_ph10300125465819"></a><a name="zh-cn_topic_0000002245550901_ph10300125465819"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550901_p025155513419"><a name="zh-cn_topic_0000002245550901_p025155513419"></a><a name="zh-cn_topic_0000002245550901_p025155513419"></a><span id="zh-cn_topic_0000002245550901_ph17252055203414"><a name="zh-cn_topic_0000002245550901_ph17252055203414"></a><a name="zh-cn_topic_0000002245550901_ph17252055203414"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550901_p12510558342"><a name="zh-cn_topic_0000002245550901_p12510558342"></a><a name="zh-cn_topic_0000002245550901_p12510558342"></a><span id="zh-cn_topic_0000002245550901_ph12525523411"><a name="zh-cn_topic_0000002245550901_ph12525523411"></a><a name="zh-cn_topic_0000002245550901_ph12525523411"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245550901_row39341137101619"><td class="cellrowborder" valign="top" width="17.82%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550901_p969163903020"><a name="zh-cn_topic_0000002245550901_p969163903020"></a><a name="zh-cn_topic_0000002245550901_p969163903020"></a>INPUT_FP16_NODES</p>
</td>
<td class="cellrowborder" valign="top" width="82.17999999999999%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p1635417325379"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p1635417325379"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0221674006_p1635417325379"></a>指定输入数据类型为FP16的输入节点名称。</p>
<p id="zh-cn_topic_0000002245550901_p47651929124310"><a name="zh-cn_topic_0000002245550901_p47651929124310"></a><a name="zh-cn_topic_0000002245550901_p47651929124310"></a>例如："node_name1;node_name2"，指定的节点必须放在双引号中，节点中间使用英文分号分隔。若配置了该参数，则不能对同一个输入节点同时使用INSERT_OP_FILE参数。</p>
<p id="zh-cn_topic_0000002245550901_p13235101335711"><a name="zh-cn_topic_0000002245550901_p13235101335711"></a><a name="zh-cn_topic_0000002245550901_p13235101335711"></a>配置示例：</p>
<pre class="screen" id="zh-cn_topic_0000002245550901_screen65311226105712"><a name="zh-cn_topic_0000002245550901_screen65311226105712"></a><a name="zh-cn_topic_0000002245550901_screen65311226105712"></a>{ge::ir_option::INPUT_FP16_NODES, "node_name1;node_name2"}</pre>
<p id="zh-cn_topic_0000002245550901_p17972185511200"><a name="zh-cn_topic_0000002245550901_p17972185511200"></a><a name="zh-cn_topic_0000002245550901_p17972185511200"></a><span class="ddd" id="zh-cn_topic_0000002245550901_ph87315595910"><a name="zh-cn_topic_0000002245550901_ph87315595910"></a><a name="zh-cn_topic_0000002245550901_ph87315595910"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550901_p551914273518"><a name="zh-cn_topic_0000002245550901_p551914273518"></a><a name="zh-cn_topic_0000002245550901_p551914273518"></a><span id="zh-cn_topic_0000002245550901_ph105191223512"><a name="zh-cn_topic_0000002245550901_ph105191223512"></a><a name="zh-cn_topic_0000002245550901_ph105191223512"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_4"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_4"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term11962195213215_4"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_4"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_4"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term184716139811_4"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550901_p145192028359"><a name="zh-cn_topic_0000002245550901_p145192028359"></a><a name="zh-cn_topic_0000002245550901_p145192028359"></a><span id="zh-cn_topic_0000002245550901_ph1519202203511"><a name="zh-cn_topic_0000002245550901_ph1519202203511"></a><a name="zh-cn_topic_0000002245550901_ph1519202203511"></a><term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_4"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_4"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term1253731311225_4"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_4"><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_4"></a><a name="zh-cn_topic_0000002245550901_zh-cn_topic_0000001312391781_term131434243115_4"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 内存管理<a name="section10922111584920"></a>

<a name="table226913133502"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210430926_row882992718252"><th class="cellrowborder" valign="top" width="16.72%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002210430926_p1983017275257"><a name="zh-cn_topic_0000002210430926_p1983017275257"></a><a name="zh-cn_topic_0000002210430926_p1983017275257"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="83.28%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002210430926_p1683062717257"><a name="zh-cn_topic_0000002210430926_p1683062717257"></a><a name="zh-cn_topic_0000002210430926_p1683062717257"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210430926_row1975219506307"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430926_p212065319302"><a name="zh-cn_topic_0000002210430926_p212065319302"></a><a name="zh-cn_topic_0000002210430926_p212065319302"></a>EXEC_DISABLE_REUSED_MEMORY</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p26646309300"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p26646309300"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p26646309300"></a>内存复用开关。</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p1230635462015"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p1230635462015"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p1230635462015"></a><span>内存复用是指按照生命周期和内存大小，把不冲突的内存重复使用，来降低网络内存占用</span>。</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_p10176133334810"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_p10176133334810"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_p10176133334810"></a><strong id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b56787092410"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b56787092410"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b56787092410"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul1553135220471"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul1553135220471"></a><ul id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul1553135220471"><li>0：（默认值）开启内存复用。</li><li>1：关闭内存复用。如果网络模型较大，关闭内存复用开关，会造成后续推理时Device侧内存不复用，从而导致内存不足。</li></ul>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4975133852517"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4975133852517"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4975133852517"></a><strong id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b89751138162519"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b89751138162519"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b89751138162519"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_screen89754389258"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_screen89754389258"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_screen89754389258"></a>{ge::ir_option::EXEC_DISABLE_REUSED_MEMORY, "0"}</pre>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p41083276116"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p41083276116"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p41083276116"></a><span class="ddd" id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph3730559115517"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph3730559115517"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph3730559115517"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4621437171113"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4621437171113"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4621437171113"></a><span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph21441827161116"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph21441827161116"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph21441827161116"></a><term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p1957617275386"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p1957617275386"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p1957617275386"></a><span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph673964943810"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph673964943810"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph673964943810"></a><term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210430926_row68521013122117"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430926_p12811210174913"><a name="zh-cn_topic_0000002210430926_p12811210174913"></a><a name="zh-cn_topic_0000002210430926_p12811210174913"></a><span>E</span><span>XTERNAL_WEIGHT</span></p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_zh-cn_topic_0221674006_zh-cn_topic_0162519416_p135713443159"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_zh-cn_topic_0221674006_zh-cn_topic_0162519416_p135713443159"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0221674006_zh-cn_topic_0221674006_zh-cn_topic_0162519416_p135713443159"></a>生成om模型文件时，是否将原始网络中的Const/Constant节点的权重外置，同时将节点类型转换为FileConstant类型。</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p31171113134015"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p31171113134015"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p31171113134015"></a>离线场景，如果模型权重较大且环境对om离线模型大小有限制，建议开启外置权重将权重单独保存，来减小om大小。</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p114101332575"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p114101332575"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p114101332575"></a><strong id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b16315023134010"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b16315023134010"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b16315023134010"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul1184514015365"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul1184514015365"></a><ul id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul1184514015365"><li>0：（默认值）权重不外置，直接保存在om离线模型文件中。</li><li>1：权重外置，将网络中所有Const/Constant节点的权重文件落盘，并将节点类型转换为FileConstant类型；权重文件保存在与om文件同层级的weight目录下，不同节点权重保存到不同的文件中，以weight_&lt;hash值&gt;值命名。</li></ul>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p105101639459"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p105101639459"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p105101639459"></a><strong id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b1817217460434"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b1817217460434"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b1817217460434"></a>配置示例</strong>：</p>
<pre class="screen" id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_screen1698788863"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_screen1698788863"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_screen1698788863"></a>{ge::ir_option::EXTERNAL_WEIGHT, "1"}</pre>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p148515719617"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p148515719617"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p148515719617"></a><strong id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b20861570618"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b20861570618"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_b20861570618"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul7473514713"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul7473514713"></a><ul id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ul7473514713"><li>权重外置场景，在使用<span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph4675172181519"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph4675172181519"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph4675172181519"></a>acl</span>接口开发推理应用、加载模型时：<a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul16530015193420"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul16530015193420"></a><ul id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul16530015193420"><li>使用<a href="aclgrphSaveModel.md">aclgrphSaveModel</a>接口保存om模型：<a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul179642535019"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul179642535019"></a><ul id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_ul179642535019"><li>若使用aclmdlLoadFromFile接口加载模型，需将权重文件保存在与om文件同层级的weight目录下。</li><li>若使用aclmdlSetConfigOpt和aclmdlLoadWithConfig接口加载模型，对权重外置目录没有要求，后续加载模型时，通过aclmdlLoadWithConfig接口指定权重外置目录。</li></ul>
</li><li>权重更新场景，使用<a href="aclgrphBundleSaveModel.md">aclgrphBundleSaveModel</a>接口保存om模型：<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_p20948939185014"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_p20948939185014"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001265404742_p20948939185014"></a>只能使用aclmdlBundleLoadFromFile接口加载模型，并且需将权重文件保存在与om文件同层级的weight目录下。</p>
</li></ul>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p933224214119"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p933224214119"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p933224214119"></a>接口详细说明请参见<span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph1993918422110"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph1993918422110"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph1993918422110"></a></span><span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph5452167102918"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph5452167102918"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph5452167102918"></a>《应用开发指南 (C&amp;C++)》</span>。</p>
</li></ul>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p136842040175312"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p136842040175312"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p136842040175312"></a><span class="ddd" id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph6292131212578"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph6292131212578"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph6292131212578"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p480175305912"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p480175305912"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p480175305912"></a><span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph198015335912"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph198015335912"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph198015335912"></a><term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4801053125910"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4801053125910"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_p4801053125910"></a><span id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph2080353195910"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph2080353195910"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_ph2080353195910"></a><term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002210430926_zh-cn_topic_0000002209492862_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 动态shape<a name="section1548617195492"></a>

<a name="table1278814154507"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210590710_row10684151211255"><th class="cellrowborder" valign="top" width="16.72%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002210590710_p156841212202518"><a name="zh-cn_topic_0000002210590710_p156841212202518"></a><a name="zh-cn_topic_0000002210590710_p156841212202518"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="83.28%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002210590710_p15684181222519"><a name="zh-cn_topic_0000002210590710_p15684181222519"></a><a name="zh-cn_topic_0000002210590710_p15684181222519"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210590710_row899431219291"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590710_p5994201282915"><a name="zh-cn_topic_0000002210590710_p5994201282915"></a><a name="zh-cn_topic_0000002210590710_p5994201282915"></a>INPUT_SHAPE</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590710_p191195313445"><a name="zh-cn_topic_0000002210590710_p191195313445"></a><a name="zh-cn_topic_0000002210590710_p191195313445"></a>模型输入的shape信息。</p>
<p id="zh-cn_topic_0000002210590710_p4818943515"><a name="zh-cn_topic_0000002210590710_p4818943515"></a><a name="zh-cn_topic_0000002210590710_p4818943515"></a><strong id="zh-cn_topic_0000002210590710_b1997853603511"><a name="zh-cn_topic_0000002210590710_b1997853603511"></a><a name="zh-cn_topic_0000002210590710_b1997853603511"></a>参数取值</strong>：</p>
<a name="zh-cn_topic_0000002210590710_ul18348151983611"></a><a name="zh-cn_topic_0000002210590710_ul18348151983611"></a><ul id="zh-cn_topic_0000002210590710_ul18348151983611"><li>模型为固定shape，INPUT_SHAPE参数为<strong id="zh-cn_topic_0000002210590710_b17793534132617"><a name="zh-cn_topic_0000002210590710_b17793534132617"></a><a name="zh-cn_topic_0000002210590710_b17793534132617"></a>可选</strong>配置<a name="zh-cn_topic_0000002210590710_ul1912311449369"></a><a name="zh-cn_topic_0000002210590710_ul1912311449369"></a><ul id="zh-cn_topic_0000002210590710_ul1912311449369"><li>若模型为单个输入，则shape信息为"input_name:n,c,h,w"。</li><li>若模型有多个输入，则shape信息为"input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2"；不同输入之间使用<strong id="zh-cn_topic_0000002210590710_b18776185713355"><a name="zh-cn_topic_0000002210590710_b18776185713355"></a><a name="zh-cn_topic_0000002210590710_b18776185713355"></a>英文分号</strong>分隔，input_name必须是转换前的网络模型中的节点名称。</li></ul>
</li><li>模型为非固定shape，INPUT_SHAPE参数<strong id="zh-cn_topic_0000002210590710_b11320153602619"><a name="zh-cn_topic_0000002210590710_b11320153602619"></a><a name="zh-cn_topic_0000002210590710_b11320153602619"></a>必须</strong>配置<div class="p" id="zh-cn_topic_0000002210590710_p162907435435"><a name="zh-cn_topic_0000002210590710_p162907435435"></a><a name="zh-cn_topic_0000002210590710_p162907435435"></a>若原始模型中输入数据的某个或某些维度值不固定，当前支持通过设置shape分档或设置shape范围两种方式转换模型。<a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_ul1918983152412"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_ul1918983152412"></a><ul id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_ul1918983152412"><li>设置shape分档（静态shape），包括设置batch_size档位、设置分辨率档位、设置动态维度档位。<p id="zh-cn_topic_0000002210590710_p17288570431"><a name="zh-cn_topic_0000002210590710_p17288570431"></a><a name="zh-cn_topic_0000002210590710_p17288570431"></a>设置INPUT_SHAPE参数时，将对应维度值设置为-1，同时配合使用DYNAMIC_BATCH_SIZE（设置batch_size档位）或DYNAMIC_IMAGE_SIZE（设置分辨率档位）或DYNAMIC_DIMS（设置动态维度档位）参数。详细用法请参考DYNAMIC_BATCH_SIZE、DYNAMIC_IMAGE_SIZE、DYNAMIC_DIMS参数说明。</p>
</li><li>设置shape范围（动态shape）。<p id="zh-cn_topic_0000002210590710_p1173134904516"><a name="zh-cn_topic_0000002210590710_p1173134904516"></a><a name="zh-cn_topic_0000002210590710_p1173134904516"></a>设置INPUT_SHAPE参数时，可将对应维度的值设置为范围，例如1~10，<strong id="zh-cn_topic_0000002210590710_b15812881419"><a name="zh-cn_topic_0000002210590710_b15812881419"></a><a name="zh-cn_topic_0000002210590710_b15812881419"></a>设置的range值范围必须有效</strong>。</p>
<a name="zh-cn_topic_0000002210590710_ul183092116455"></a><a name="zh-cn_topic_0000002210590710_ul183092116455"></a><ul id="zh-cn_topic_0000002210590710_ul183092116455"><li>支持按照name设置："input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2"，例如："input_name1:8~20,3,5,-1;input_name2:5,3~9,10,-1"。指定的节点必须放在双引号中，节点中间使用英文分号分隔。input_name必须是转换前的网络模型中的节点名称。如果用户知道data节点的name，推荐按照name设置。</li><li>支持按照index设置："n1,c1,h1,w1;n2,c2,h2,w2"，例如："8~20,3,5,-1;5,3~9,10,-1"。可以不指定节点名，节点按照索引顺序排列，节点中间使用英文分号分隔。按照index设置shape范围时，data节点需要设置属性index，说明是第几个输入，index从0开始。</li></ul>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_p79798472412"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_p79798472412"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_p79798472412"></a>如果用户不想指定维度的范围或具体取值，则可以将其设置为-1，表示此维度可以使用&gt;=0的任意取值，该场景下取值上限为int64数据类型表达范围，但受限于host和device侧物理内存的大小，用户可以通过增大内存来支持。</p>
</li></ul>
</div>
</li><li>模型shape为标量<a name="zh-cn_topic_0000002210590710_ul13148101105515"></a><a name="zh-cn_topic_0000002210590710_ul13148101105515"></a><ul id="zh-cn_topic_0000002210590710_ul13148101105515"><li>非动态分档场景：<p id="zh-cn_topic_0000002210590710_p5673173219453"><a name="zh-cn_topic_0000002210590710_p5673173219453"></a><a name="zh-cn_topic_0000002210590710_p5673173219453"></a>shape为标量的输入，可选配置，例如模型有两个输入，input_name1为标量，即shape为"[]"形式，input_name2输入shape为[n2,c2,h2,w2]，则shape信息为"<strong id="zh-cn_topic_0000002210590710_b1568561055114"><a name="zh-cn_topic_0000002210590710_b1568561055114"></a><a name="zh-cn_topic_0000002210590710_b1568561055114"></a>input_name1:</strong>;input_name2:n2,c2,h2,w2"，不同输入之间使用<strong id="zh-cn_topic_0000002210590710_b146711754173510"><a name="zh-cn_topic_0000002210590710_b146711754173510"></a><a name="zh-cn_topic_0000002210590710_b146711754173510"></a>英文分号</strong>分隔，input_name必须是转换前的网络模型中的节点名称；标量的输入如果配置，则配置为空。</p>
</li><li>动态分档场景：<p id="zh-cn_topic_0000002210590710_p7446410195312"><a name="zh-cn_topic_0000002210590710_p7446410195312"></a><a name="zh-cn_topic_0000002210590710_p7446410195312"></a>如果模型输入中既有标量shape，又有支持动态分档的shape，则标量输入不能忽略，必须配置。例如模型有三个输入，分别为A:[-1,c1,h1,w1]、B:[]、C:[n2,c2,h2,w2]，则shape信息为"A:-1,c1,h1,w1;<strong id="zh-cn_topic_0000002210590710_b03335562567"><a name="zh-cn_topic_0000002210590710_b03335562567"></a><a name="zh-cn_topic_0000002210590710_b03335562567"></a>B:</strong>;C:n2,c2,h2,w2"，标量输入B必须配置。</p>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002210590710_p36438454352"><a name="zh-cn_topic_0000002210590710_p36438454352"></a><a name="zh-cn_topic_0000002210590710_p36438454352"></a><strong id="zh-cn_topic_0000002210590710_b2082541350"><a name="zh-cn_topic_0000002210590710_b2082541350"></a><a name="zh-cn_topic_0000002210590710_b2082541350"></a>配置示例：</strong></p>
<a name="zh-cn_topic_0000002210590710_ul75371434611"></a><a name="zh-cn_topic_0000002210590710_ul75371434611"></a><ul id="zh-cn_topic_0000002210590710_ul75371434611"><li>固定shape，例如某网络的输入shape信息，输入1<strong id="zh-cn_topic_0000002210590710_b47771081914"><a name="zh-cn_topic_0000002210590710_b47771081914"></a><a name="zh-cn_topic_0000002210590710_b47771081914"></a>：</strong>input_0_0 [16,32,208,208]，输入2：input_1_0 [16,64,208,208]，则INPUT_SHAPE的配置信息为：<pre class="screen" id="zh-cn_topic_0000002210590710_screen1485218281822"><a name="zh-cn_topic_0000002210590710_screen1485218281822"></a><a name="zh-cn_topic_0000002210590710_screen1485218281822"></a>{ge::ir_option::INPUT_SHAPE, "input_0_0:16,32,208,208;input_1_0:16,64,208,208"}</pre>
</li><li>非固定shape，静态shape：<a name="zh-cn_topic_0000002210590710_ul587574231913"></a><a name="zh-cn_topic_0000002210590710_ul587574231913"></a><ul id="zh-cn_topic_0000002210590710_ul587574231913"><li>设置batch_size档位的示例，请参见DYNAMIC_BATCH_SIZE。</li><li>设置分辨率档位的示例，请参见DYNAMIC_IMAGE_SIZE。</li><li>设置指定维度档位的示例，请参见DYNAMIC_DIMS。</li></ul>
</li><li>非固定shape，动态shape，设置shape范围的示例：<pre class="screen" id="zh-cn_topic_0000002210590710_screen231111178582"><a name="zh-cn_topic_0000002210590710_screen231111178582"></a><a name="zh-cn_topic_0000002210590710_screen231111178582"></a>{ge::ir_option::INPUT_SHAPE, "input_0_0:1<font style="font-size:8pt" Face="Courier New" >~</font>10,32,208,208;input_1_0:16,64,100<font style="font-size:8pt" Face="Courier New" >~</font>208,100<font style="font-size:8pt" Face="Courier New" >~</font>208"}</pre>
<p id="zh-cn_topic_0000002210590710_p5704413182915"><a name="zh-cn_topic_0000002210590710_p5704413182915"></a><a name="zh-cn_topic_0000002210590710_p5704413182915"></a>详细使用示例以及使用注意事项请参见<a href="zh-cn_topic_0000001265083386.md">专题&gt;动态输入shape范围</a>。</p>
</li><li>shape为标量<a name="zh-cn_topic_0000002210590710_ul954852952520"></a><a name="zh-cn_topic_0000002210590710_ul954852952520"></a><ul id="zh-cn_topic_0000002210590710_ul954852952520"><li>非动态分档场景<p id="zh-cn_topic_0000002210590710_p20574194712282"><a name="zh-cn_topic_0000002210590710_p20574194712282"></a><a name="zh-cn_topic_0000002210590710_p20574194712282"></a>shape为标量的输入，可选配置。例如模型有两个输入，<strong id="zh-cn_topic_0000002210590710_b15823193315273"><a name="zh-cn_topic_0000002210590710_b15823193315273"></a><a name="zh-cn_topic_0000002210590710_b15823193315273"></a>input_name1</strong>为标量，input_name2输入shape为[16,32,208,208]，配置示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002210590710_screen4404181322810"><a name="zh-cn_topic_0000002210590710_screen4404181322810"></a><a name="zh-cn_topic_0000002210590710_screen4404181322810"></a>{ge::ir_option::INPUT_SHAPE<strong id="zh-cn_topic_0000002210590710_b1017916468232"><a name="zh-cn_topic_0000002210590710_b1017916468232"></a><a name="zh-cn_topic_0000002210590710_b1017916468232"></a>, "input_name1:</strong>;input_name2:16,32,208,208<strong id="zh-cn_topic_0000002210590710_b1715151104119"><a name="zh-cn_topic_0000002210590710_b1715151104119"></a><a name="zh-cn_topic_0000002210590710_b1715151104119"></a>"</strong>}</pre>
<p id="zh-cn_topic_0000002210590710_p4526182514289"><a name="zh-cn_topic_0000002210590710_p4526182514289"></a><a name="zh-cn_topic_0000002210590710_p4526182514289"></a>上述示例中的<strong id="zh-cn_topic_0000002210590710_b1610241016434"><a name="zh-cn_topic_0000002210590710_b1610241016434"></a><a name="zh-cn_topic_0000002210590710_b1610241016434"></a>input_name1</strong>为可选配置<strong id="zh-cn_topic_0000002210590710_b8102110114310"><a name="zh-cn_topic_0000002210590710_b8102110114310"></a><a name="zh-cn_topic_0000002210590710_b8102110114310"></a>。</strong></p>
</li><li>动态分档场景<p id="zh-cn_topic_0000002210590710_p91481505267"><a name="zh-cn_topic_0000002210590710_p91481505267"></a><a name="zh-cn_topic_0000002210590710_p91481505267"></a>shape为标量的输入，必须配置。例如模型有三个输入，shape信息分别为A:[-1,32,208,208]、<strong id="zh-cn_topic_0000002210590710_b10898728182611"><a name="zh-cn_topic_0000002210590710_b10898728182611"></a><a name="zh-cn_topic_0000002210590710_b10898728182611"></a>B:[]</strong>、C:[16,64,208,208]，则配置示例为（A为动态分档输入，此处以设置batch_size档位为例）：</p>
<pre class="screen" id="zh-cn_topic_0000002210590710_screen1941843045918"><a name="zh-cn_topic_0000002210590710_screen1941843045918"></a><a name="zh-cn_topic_0000002210590710_screen1941843045918"></a>{ge::ir_option::INPUT_SHAPE,<strong id="zh-cn_topic_0000002210590710_b1835905918235"><a name="zh-cn_topic_0000002210590710_b1835905918235"></a><a name="zh-cn_topic_0000002210590710_b1835905918235"></a> "</strong>A:-1,32,208,208;<strong id="zh-cn_topic_0000002210590710_b161281391449"><a name="zh-cn_topic_0000002210590710_b161281391449"></a><a name="zh-cn_topic_0000002210590710_b161281391449"></a>B:</strong>;C:16,64,208,208<strong id="zh-cn_topic_0000002210590710_b1131915353444"><a name="zh-cn_topic_0000002210590710_b1131915353444"></a><a name="zh-cn_topic_0000002210590710_b1131915353444"></a>"</strong>}, 
{ge::ir_option::DYNAMIC_BATCH_SIZE, "1,2,4"} </pre>
</li></ul>
</li></ul>
<div class="note" id="zh-cn_topic_0000002210590710_note57257346598"><a name="zh-cn_topic_0000002210590710_note57257346598"></a><a name="zh-cn_topic_0000002210590710_note57257346598"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="zh-cn_topic_0000002210590710_p12288101311443"><a name="zh-cn_topic_0000002210590710_p12288101311443"></a><a name="zh-cn_topic_0000002210590710_p12288101311443"></a>如果模型转换时通过该参数设置了shape的范围：</p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_p39015554312"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_p39015554312"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001265392746_p39015554312"></a>使用应用工程进行模型推理时，需要在<strong id="zh-cn_topic_0000002210590710_b1849331123418"><a name="zh-cn_topic_0000002210590710_b1849331123418"></a><a name="zh-cn_topic_0000002210590710_b1849331123418"></a>模型执行</strong>接口之前，调用<strong id="zh-cn_topic_0000002210590710_b120147155614"><a name="zh-cn_topic_0000002210590710_b120147155614"></a><a name="zh-cn_topic_0000002210590710_b120147155614"></a>aclmdlSetDatasetTensorDesc</strong>接口，用于设置真实的输入Tensor描述信息（输入shape范围）；模型执行之后，调用<strong id="zh-cn_topic_0000002210590710_b001447125615"><a name="zh-cn_topic_0000002210590710_b001447125615"></a><a name="zh-cn_topic_0000002210590710_b001447125615"></a>aclmdlGetDatasetTensorDesc</strong>接口获取模型动态输出的Tensor描述信息；再进一步调用aclTensorDesc下的操作接口获取输出Tensor数据占用的内存大小、Tensor的Format信息、Tensor的维度信息等。</p>
<p id="zh-cn_topic_0000002210590710_p6959122393517"><a name="zh-cn_topic_0000002210590710_p6959122393517"></a><a name="zh-cn_topic_0000002210590710_p6959122393517"></a>关于<strong id="zh-cn_topic_0000002210590710_b2959723103519"><a name="zh-cn_topic_0000002210590710_b2959723103519"></a><a name="zh-cn_topic_0000002210590710_b2959723103519"></a>aclmdlSetDatasetTensorDesc</strong>、<strong id="zh-cn_topic_0000002210590710_b1695913231358"><a name="zh-cn_topic_0000002210590710_b1695913231358"></a><a name="zh-cn_topic_0000002210590710_b1695913231358"></a>aclmdlGetDatasetTensorDesc</strong>等接口的具体使用方法，请参见<span id="zh-cn_topic_0000002210590710_ph18959162320355"><a name="zh-cn_topic_0000002210590710_ph18959162320355"></a><a name="zh-cn_topic_0000002210590710_ph18959162320355"></a>《应用开发指南 (C&amp;C++)》</span>。</p>
</div></div>
<p id="zh-cn_topic_0000002210590710_p87571620486"><a name="zh-cn_topic_0000002210590710_p87571620486"></a><a name="zh-cn_topic_0000002210590710_p87571620486"></a><span class="ddd" id="zh-cn_topic_0000002210590710_ph10901175918572"><a name="zh-cn_topic_0000002210590710_ph10901175918572"></a><a name="zh-cn_topic_0000002210590710_ph10901175918572"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590710_p1823165118320"><a name="zh-cn_topic_0000002210590710_p1823165118320"></a><a name="zh-cn_topic_0000002210590710_p1823165118320"></a><span id="zh-cn_topic_0000002210590710_ph32311551153212"><a name="zh-cn_topic_0000002210590710_ph32311551153212"></a><a name="zh-cn_topic_0000002210590710_ph32311551153212"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590710_p15231175119321"><a name="zh-cn_topic_0000002210590710_p15231175119321"></a><a name="zh-cn_topic_0000002210590710_p15231175119321"></a><span id="zh-cn_topic_0000002210590710_ph1023195173213"><a name="zh-cn_topic_0000002210590710_ph1023195173213"></a><a name="zh-cn_topic_0000002210590710_ph1023195173213"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590710_row426857111711"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590710_p32688741711"><a name="zh-cn_topic_0000002210590710_p32688741711"></a><a name="zh-cn_topic_0000002210590710_p32688741711"></a>INPUT_HINT_SHAPE</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590710_p0578438193119"><a name="zh-cn_topic_0000002210590710_p0578438193119"></a><a name="zh-cn_topic_0000002210590710_p0578438193119"></a>自动融合离线编译动态shape场景下，指定模型输入数据的hint shape，以支持该场景下符号化推导。</p>
<p id="zh-cn_topic_0000002210590710_p61591830133917"><a name="zh-cn_topic_0000002210590710_p61591830133917"></a><a name="zh-cn_topic_0000002210590710_p61591830133917"></a>hint shape是模型编译时用户传入的一个提示shape值。如<a href="#zh-cn_topic_0000002210590710_fig18519155217268">图1</a>所示，模型中Data0、Data1和Data2的部分维度未知，但在模型执行时，用户会传入具有静态shape的输入Tensor。例如，在编译下图时，Data0的shape为[2, 3, 4, 2]，Data1的shape为[2, 3, 1, 2]，Data2的shape为[2, 3, 1, 2]；因此，在编译模型时，s0的hint值为2，s1的hint值为3，s2的hint值为4，s3的hint值为2，s4的hint值为1。</p>
<div class="fignone" id="zh-cn_topic_0000002210590710_fig18519155217268"><a name="zh-cn_topic_0000002210590710_fig18519155217268"></a><a name="zh-cn_topic_0000002210590710_fig18519155217268"></a><span class="figcap"><b>图1 </b>Hint值示意图</span><br><a name="zh-cn_topic_0000002210590710_image191522141515"></a><a name="zh-cn_topic_0000002210590710_image191522141515"></a><span><img class="eddx" id="zh-cn_topic_0000002210590710_image191522141515" src="figures/Hint值示意图.png"></span></div>
<p id="zh-cn_topic_0000002210590710_p3771271295"><a name="zh-cn_topic_0000002210590710_p3771271295"></a><a name="zh-cn_topic_0000002210590710_p3771271295"></a>该参数需要与INPUT_SHAPE配合使用，并且该参数需要为动态shape场景；不能与DYNAMIC_BATCH_SIZE、DYNAMIC_IMAGE_SIZE、DYNAMIC_DIMS同时使用。</p>
<p id="zh-cn_topic_0000002210590710_p18175165924812"><a name="zh-cn_topic_0000002210590710_p18175165924812"></a><a name="zh-cn_topic_0000002210590710_p18175165924812"></a><strong id="zh-cn_topic_0000002210590710_b9175115919488"><a name="zh-cn_topic_0000002210590710_b9175115919488"></a><a name="zh-cn_topic_0000002210590710_b9175115919488"></a>参数取值：</strong>输入节点索引及shape信息，例如"input_index1:[n1,c1,h1,w1]<strong id="zh-cn_topic_0000002210590710_b15311162553211"><a name="zh-cn_topic_0000002210590710_b15311162553211"></a><a name="zh-cn_topic_0000002210590710_b15311162553211"></a>;</strong>input_index2:[n2,c2,h2,w2]"，索引从0开始。</p>
<p id="zh-cn_topic_0000002210590710_p9504153383211"><a name="zh-cn_topic_0000002210590710_p9504153383211"></a><a name="zh-cn_topic_0000002210590710_p9504153383211"></a><strong id="zh-cn_topic_0000002210590710_b0638842193214"><a name="zh-cn_topic_0000002210590710_b0638842193214"></a><a name="zh-cn_topic_0000002210590710_b0638842193214"></a>参数值格式：</strong>指定的参数必须放在双引号中，不同输入之间使用<strong id="zh-cn_topic_0000002210590710_b3539111017339"><a name="zh-cn_topic_0000002210590710_b3539111017339"></a><a name="zh-cn_topic_0000002210590710_b3539111017339"></a>英文分号</strong>分隔，shape信息放在英文括号“[]”中。</p>
<p id="zh-cn_topic_0000002210590710_p336373518017"><a name="zh-cn_topic_0000002210590710_p336373518017"></a><a name="zh-cn_topic_0000002210590710_p336373518017"></a><strong id="zh-cn_topic_0000002210590710_b152543421500"><a name="zh-cn_topic_0000002210590710_b152543421500"></a><a name="zh-cn_topic_0000002210590710_b152543421500"></a>参数值约束：</strong>针对INPUT_SHAPE设置范围的维度，INPUT_HINT_SHAPE设置的取值需要在其范围以内。</p>
<p id="zh-cn_topic_0000002210590710_p1168613918311"><a name="zh-cn_topic_0000002210590710_p1168613918311"></a><a name="zh-cn_topic_0000002210590710_p1168613918311"></a><strong id="zh-cn_topic_0000002210590710_b11687133913318"><a name="zh-cn_topic_0000002210590710_b11687133913318"></a><a name="zh-cn_topic_0000002210590710_b11687133913318"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590710_screen1010520599314"><a name="zh-cn_topic_0000002210590710_screen1010520599314"></a><a name="zh-cn_topic_0000002210590710_screen1010520599314"></a>{ge::ir_option::INPUT_SHAPE, "input_0_0:1<font style="font-size:8pt" Face="Courier New" >~</font>10,32,208,208;input_1_0:16,64,100<font style="font-size:8pt" Face="Courier New" >~</font>208,100<font style="font-size:8pt" Face="Courier New" >~</font>208"}
{ge::ir_option::INPUT_HINT_SHAPE, "0:[1,32,208,208];1:[16,64,100,100]"</pre>
<p id="zh-cn_topic_0000002210590710_p13623155262713"><a name="zh-cn_topic_0000002210590710_p13623155262713"></a><a name="zh-cn_topic_0000002210590710_p13623155262713"></a><span class="ddd" id="zh-cn_topic_0000002210590710_ph462316521270"><a name="zh-cn_topic_0000002210590710_ph462316521270"></a><a name="zh-cn_topic_0000002210590710_ph462316521270"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590710_p76241552152713"><a name="zh-cn_topic_0000002210590710_p76241552152713"></a><a name="zh-cn_topic_0000002210590710_p76241552152713"></a><span id="zh-cn_topic_0000002210590710_ph20624155218272"><a name="zh-cn_topic_0000002210590710_ph20624155218272"></a><a name="zh-cn_topic_0000002210590710_ph20624155218272"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590710_p262405252713"><a name="zh-cn_topic_0000002210590710_p262405252713"></a><a name="zh-cn_topic_0000002210590710_p262405252713"></a><span id="zh-cn_topic_0000002210590710_ph10624145252720"><a name="zh-cn_topic_0000002210590710_ph10624145252720"></a><a name="zh-cn_topic_0000002210590710_ph10624145252720"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590710_row33391638112211"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590710_p15994812102915"><a name="zh-cn_topic_0000002210590710_p15994812102915"></a><a name="zh-cn_topic_0000002210590710_p15994812102915"></a>DYNAMIC_BATCH_SIZE</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590710_p1459572112338"><a name="zh-cn_topic_0000002210590710_p1459572112338"></a><a name="zh-cn_topic_0000002210590710_p1459572112338"></a>设置动态batch档位参数，适用于执行推理时，每次处理图片数量不固定的场景。</p>
<p id="zh-cn_topic_0000002210590710_p18595721133313"><a name="zh-cn_topic_0000002210590710_p18595721133313"></a><a name="zh-cn_topic_0000002210590710_p18595721133313"></a>该参数需要与INPUT_SHAPE配合使用，不能与DYNAMIC_IMAGE_SIZE、DYNAMIC_DIMS同时使用；且只支持N在shape首位的场景，即shape的第一位设置为"-1"。如果N在非首位场景下，请使用DYNAMIC_DIMS参数进行设置。</p>
<p id="zh-cn_topic_0000002210590710_p102701332125313"><a name="zh-cn_topic_0000002210590710_p102701332125313"></a><a name="zh-cn_topic_0000002210590710_p102701332125313"></a><strong id="zh-cn_topic_0000002210590710_b122711432145312"><a name="zh-cn_topic_0000002210590710_b122711432145312"></a><a name="zh-cn_topic_0000002210590710_b122711432145312"></a>参数取值：</strong>档位数，例如"1,2,4,8"。</p>
<p id="zh-cn_topic_0000002210590710_p1127173295312"><a name="zh-cn_topic_0000002210590710_p1127173295312"></a><a name="zh-cn_topic_0000002210590710_p1127173295312"></a><strong id="zh-cn_topic_0000002210590710_b027173255311"><a name="zh-cn_topic_0000002210590710_b027173255311"></a><a name="zh-cn_topic_0000002210590710_b027173255311"></a>参数值格式：</strong>指定的参数必须放在双引号中，档位之间使用英文逗号分隔。</p>
<p id="zh-cn_topic_0000002210590710_p162716329538"><a name="zh-cn_topic_0000002210590710_p162716329538"></a><a name="zh-cn_topic_0000002210590710_p162716329538"></a><strong id="zh-cn_topic_0000002210590710_b927143275311"><a name="zh-cn_topic_0000002210590710_b927143275311"></a><a name="zh-cn_topic_0000002210590710_b927143275311"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210590710_ul13835118342"></a><a name="zh-cn_topic_0000002210590710_ul13835118342"></a><ul id="zh-cn_topic_0000002210590710_ul13835118342"><li>针对如下<span id="zh-cn_topic_0000002210590710_ph20833205312295"><a name="zh-cn_topic_0000002210590710_ph20833205312295"></a><a name="zh-cn_topic_0000002210590710_ph20833205312295"></a>产品</span>，档位数约束为：档位数取值范围为(1,100]，即必须设置至少2个档位，最多支持100档配置；每个档位数值建议限制为：[1~2048]。<p id="zh-cn_topic_0000002210590710_p8883123613715"><a name="zh-cn_topic_0000002210590710_p8883123613715"></a><a name="zh-cn_topic_0000002210590710_p8883123613715"></a><span id="zh-cn_topic_0000002210590710_ph204011434677"><a name="zh-cn_topic_0000002210590710_ph204011434677"></a><a name="zh-cn_topic_0000002210590710_ph204011434677"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210590710_p6995174014710"><a name="zh-cn_topic_0000002210590710_p6995174014710"></a><a name="zh-cn_topic_0000002210590710_p6995174014710"></a><span id="zh-cn_topic_0000002210590710_ph1740116346711"><a name="zh-cn_topic_0000002210590710_ph1740116346711"></a><a name="zh-cn_topic_0000002210590710_ph1740116346711"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002210590710_p1851013519268"><a name="zh-cn_topic_0000002210590710_p1851013519268"></a><a name="zh-cn_topic_0000002210590710_p1851013519268"></a><strong id="zh-cn_topic_0000002210590710_b8144161285016"><a name="zh-cn_topic_0000002210590710_b8144161285016"></a><a name="zh-cn_topic_0000002210590710_b8144161285016"></a>配置示例：</strong></p>
<p id="zh-cn_topic_0000002210590710_p2354195554919"><a name="zh-cn_topic_0000002210590710_p2354195554919"></a><a name="zh-cn_topic_0000002210590710_p2354195554919"></a>INPUT_SHAPE中的<span class="parmvalue" id="zh-cn_topic_0000002210590710_parmvalue216012475339"><a name="zh-cn_topic_0000002210590710_parmvalue216012475339"></a><a name="zh-cn_topic_0000002210590710_parmvalue216012475339"></a>“-1”</span>表示设置动态batch。</p>
<pre class="screen" id="zh-cn_topic_0000002210590710_screen118862052267"><a name="zh-cn_topic_0000002210590710_screen118862052267"></a><a name="zh-cn_topic_0000002210590710_screen118862052267"></a>{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b19911513133219"><a name="zh-cn_topic_0000002210590710_b19911513133219"></a><a name="zh-cn_topic_0000002210590710_b19911513133219"></a>INPUT_FORMAT, "NHWC"</strong>}
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b15886205202619"><a name="zh-cn_topic_0000002210590710_b15886205202619"></a><a name="zh-cn_topic_0000002210590710_b15886205202619"></a>INPUT_SHAPE, "data:-1,3,416,416"</strong>}, 
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b9886257269"><a name="zh-cn_topic_0000002210590710_b9886257269"></a><a name="zh-cn_topic_0000002210590710_b9886257269"></a>DYNAMIC_BATCH_SIZE, "1,2,4,8"</strong>}     </pre>
<p id="zh-cn_topic_0000002210590710_p2525121161017"><a name="zh-cn_topic_0000002210590710_p2525121161017"></a><a name="zh-cn_topic_0000002210590710_p2525121161017"></a><span class="ddd" id="zh-cn_topic_0000002210590710_ph148181418587"><a name="zh-cn_topic_0000002210590710_ph148181418587"></a><a name="zh-cn_topic_0000002210590710_ph148181418587"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590710_p11627131412344"><a name="zh-cn_topic_0000002210590710_p11627131412344"></a><a name="zh-cn_topic_0000002210590710_p11627131412344"></a><span id="zh-cn_topic_0000002210590710_ph76271114193419"><a name="zh-cn_topic_0000002210590710_ph76271114193419"></a><a name="zh-cn_topic_0000002210590710_ph76271114193419"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590710_p74988337266"><a name="zh-cn_topic_0000002210590710_p74988337266"></a><a name="zh-cn_topic_0000002210590710_p74988337266"></a><span id="zh-cn_topic_0000002210590710_ph162711412347"><a name="zh-cn_topic_0000002210590710_ph162711412347"></a><a name="zh-cn_topic_0000002210590710_ph162711412347"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590710_row538374011228"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590710_p6994141232919"><a name="zh-cn_topic_0000002210590710_p6994141232919"></a><a name="zh-cn_topic_0000002210590710_p6994141232919"></a>DYNAMIC_IMAGE_SIZE</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p6339173551615"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p6339173551615"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p6339173551615"></a>设置输入图片的动态分辨率参数。适用于执行推理时，每次处理图片宽和高不固定的场景。</p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p1454644641412"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p1454644641412"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p1454644641412"></a>该参数需要与INPUT_SHAPE配合使用，不能与DYNAMIC_BATCH_SIZE、DYNAMIC_DIMS同时使用。</p>
<p id="zh-cn_topic_0000002210590710_p18873152645311"><a name="zh-cn_topic_0000002210590710_p18873152645311"></a><a name="zh-cn_topic_0000002210590710_p18873152645311"></a><strong id="zh-cn_topic_0000002210590710_b208731226165317"><a name="zh-cn_topic_0000002210590710_b208731226165317"></a><a name="zh-cn_topic_0000002210590710_b208731226165317"></a>参数取值：</strong> "imagesize1_height,imagesize1_width;imagesize2_height,imagesize2_width"。</p>
<p id="zh-cn_topic_0000002210590710_p2873182611537"><a name="zh-cn_topic_0000002210590710_p2873182611537"></a><a name="zh-cn_topic_0000002210590710_p2873182611537"></a><strong id="zh-cn_topic_0000002210590710_b1987362619532"><a name="zh-cn_topic_0000002210590710_b1987362619532"></a><a name="zh-cn_topic_0000002210590710_b1987362619532"></a>参数值格式：</strong>指定的参数必须放在双引号中，档位之间英文<strong id="zh-cn_topic_0000002210590710_b11539132652212"><a name="zh-cn_topic_0000002210590710_b11539132652212"></a><a name="zh-cn_topic_0000002210590710_b11539132652212"></a>分号</strong>分隔，每档内参数使用英文<strong id="zh-cn_topic_0000002210590710_b0586728192213"><a name="zh-cn_topic_0000002210590710_b0586728192213"></a><a name="zh-cn_topic_0000002210590710_b0586728192213"></a>逗号</strong>分隔。</p>
<p id="zh-cn_topic_0000002210590710_p118731426205314"><a name="zh-cn_topic_0000002210590710_p118731426205314"></a><a name="zh-cn_topic_0000002210590710_p118731426205314"></a><strong id="zh-cn_topic_0000002210590710_b198731726125311"><a name="zh-cn_topic_0000002210590710_b198731726125311"></a><a name="zh-cn_topic_0000002210590710_b198731726125311"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210590710_ul3207193213619"></a><a name="zh-cn_topic_0000002210590710_ul3207193213619"></a><ul id="zh-cn_topic_0000002210590710_ul3207193213619"><li>针对如下<span id="zh-cn_topic_0000002210590710_ph132568418920"><a name="zh-cn_topic_0000002210590710_ph132568418920"></a><a name="zh-cn_topic_0000002210590710_ph132568418920"></a>产品</span>，档位数约束为：档位数取值范围为(1,100]，即必须设置至少2个档位，最多支持100档配置。<p id="zh-cn_topic_0000002210590710_p12990153673613"><a name="zh-cn_topic_0000002210590710_p12990153673613"></a><a name="zh-cn_topic_0000002210590710_p12990153673613"></a><span id="zh-cn_topic_0000002210590710_ph399003693620"><a name="zh-cn_topic_0000002210590710_ph399003693620"></a><a name="zh-cn_topic_0000002210590710_ph399003693620"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_4"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_4"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_4"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_4"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_4"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_4"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210590710_p89901236173612"><a name="zh-cn_topic_0000002210590710_p89901236173612"></a><a name="zh-cn_topic_0000002210590710_p89901236173612"></a><span id="zh-cn_topic_0000002210590710_ph499053618364"><a name="zh-cn_topic_0000002210590710_ph499053618364"></a><a name="zh-cn_topic_0000002210590710_ph499053618364"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_4"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_4"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_4"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_4"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_4"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_4"></a>Atlas A2 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002210590710_p15511422145011"><a name="zh-cn_topic_0000002210590710_p15511422145011"></a><a name="zh-cn_topic_0000002210590710_p15511422145011"></a><strong id="zh-cn_topic_0000002210590710_b189341930205015"><a name="zh-cn_topic_0000002210590710_b189341930205015"></a><a name="zh-cn_topic_0000002210590710_b189341930205015"></a>配置示例：</strong></p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p11437020164016"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p11437020164016"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_p11437020164016"></a>INPUT_SHAPE中的<span class="parmvalue" id="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_parmvalue135673791712"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_parmvalue135673791712"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0221674006_zh-cn_topic_0221674006_parmvalue135673791712"></a>“-1”</span>表示设置动态分辨率。</p>
<pre class="screen" id="zh-cn_topic_0000002210590710_screen4366335122119"><a name="zh-cn_topic_0000002210590710_screen4366335122119"></a><a name="zh-cn_topic_0000002210590710_screen4366335122119"></a>{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b49605452517"><a name="zh-cn_topic_0000002210590710_b49605452517"></a><a name="zh-cn_topic_0000002210590710_b49605452517"></a>INPUT_FORMAT, "NCHW"</strong>}, 
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b19144162914334"><a name="zh-cn_topic_0000002210590710_b19144162914334"></a><a name="zh-cn_topic_0000002210590710_b19144162914334"></a>INPUT_SHAPE, "data:8,3,-1,-1"</strong>}, 
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b1514422910338"><a name="zh-cn_topic_0000002210590710_b1514422910338"></a><a name="zh-cn_topic_0000002210590710_b1514422910338"></a>DYNAMIC_IMAGE_SIZE, "416,416;832,832"</strong>}</pre>
<p id="zh-cn_topic_0000002210590710_p787362041112"><a name="zh-cn_topic_0000002210590710_p787362041112"></a><a name="zh-cn_topic_0000002210590710_p787362041112"></a><span class="ddd" id="zh-cn_topic_0000002210590710_ph07811719115815"><a name="zh-cn_topic_0000002210590710_ph07811719115815"></a><a name="zh-cn_topic_0000002210590710_ph07811719115815"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590710_p6150618345"><a name="zh-cn_topic_0000002210590710_p6150618345"></a><a name="zh-cn_topic_0000002210590710_p6150618345"></a><span id="zh-cn_topic_0000002210590710_ph181556183418"><a name="zh-cn_topic_0000002210590710_ph181556183418"></a><a name="zh-cn_topic_0000002210590710_ph181556183418"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_5"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_5"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_5"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_5"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_5"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_5"></a>Atlas A3 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590710_p101536173418"><a name="zh-cn_topic_0000002210590710_p101536173418"></a><a name="zh-cn_topic_0000002210590710_p101536173418"></a><span id="zh-cn_topic_0000002210590710_ph715136133411"><a name="zh-cn_topic_0000002210590710_ph715136133411"></a><a name="zh-cn_topic_0000002210590710_ph715136133411"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_5"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_5"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_5"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_5"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_5"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_5"></a>Atlas A2 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590710_row1615244132218"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590710_p1542614010143"><a name="zh-cn_topic_0000002210590710_p1542614010143"></a><a name="zh-cn_topic_0000002210590710_p1542614010143"></a>DYNAMIC_DIMS</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590710_p12426940161419"><a name="zh-cn_topic_0000002210590710_p12426940161419"></a><a name="zh-cn_topic_0000002210590710_p12426940161419"></a>设置ND格式下动态维度的档位。适用于执行推理时，每次处理任意维度的场景。</p>
<p id="zh-cn_topic_0000002210590710_p57771542203914"><a name="zh-cn_topic_0000002210590710_p57771542203914"></a><a name="zh-cn_topic_0000002210590710_p57771542203914"></a>该参数需要与INPUT_SHAPE配合使用，不能与DYNAMIC_BATCH_SIZE、DYNAMIC_IMAGE_SIZE同时使用。</p>
<p id="zh-cn_topic_0000002210590710_p106121652185213"><a name="zh-cn_topic_0000002210590710_p106121652185213"></a><a name="zh-cn_topic_0000002210590710_p106121652185213"></a><strong id="zh-cn_topic_0000002210590710_b162095457530"><a name="zh-cn_topic_0000002210590710_b162095457530"></a><a name="zh-cn_topic_0000002210590710_b162095457530"></a>参数取值：</strong>通过"dim1,dim2,dim3;dim4,dim5,dim6;dim7,dim8,dim9"的形式设置。</p>
<p id="zh-cn_topic_0000002210590710_p1459913114535"><a name="zh-cn_topic_0000002210590710_p1459913114535"></a><a name="zh-cn_topic_0000002210590710_p1459913114535"></a><strong id="zh-cn_topic_0000002210590710_b5111172045315"><a name="zh-cn_topic_0000002210590710_b5111172045315"></a><a name="zh-cn_topic_0000002210590710_b5111172045315"></a>参数值格式：</strong>所有档位必须放在双引号中，档位之间使用英文<strong id="zh-cn_topic_0000002210590710_b18398351232"><a name="zh-cn_topic_0000002210590710_b18398351232"></a><a name="zh-cn_topic_0000002210590710_b18398351232"></a>分号</strong>分隔，每档内参数使用英文<strong id="zh-cn_topic_0000002210590710_b06871610182619"><a name="zh-cn_topic_0000002210590710_b06871610182619"></a><a name="zh-cn_topic_0000002210590710_b06871610182619"></a>逗号</strong>分隔；每档中的dim值与INPUT_SHAPE参数中的-1标识的参数依次对应，INPUT_SHAPE参数中有几个-1，则每档必须设置几个维度。</p>
<p id="zh-cn_topic_0000002210590710_p208812111530"><a name="zh-cn_topic_0000002210590710_p208812111530"></a><a name="zh-cn_topic_0000002210590710_p208812111530"></a><strong id="zh-cn_topic_0000002210590710_b7112132035312"><a name="zh-cn_topic_0000002210590710_b7112132035312"></a><a name="zh-cn_topic_0000002210590710_b7112132035312"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210590710_ul15446817173719"></a><a name="zh-cn_topic_0000002210590710_ul15446817173719"></a><ul id="zh-cn_topic_0000002210590710_ul15446817173719"><li>针对如下<span id="zh-cn_topic_0000002210590710_ph179711881797"><a name="zh-cn_topic_0000002210590710_ph179711881797"></a><a name="zh-cn_topic_0000002210590710_ph179711881797"></a>产品</span>，档位数约束为：档位数取值范围为(1,100]，即必须设置至少2个档位，最多支持100档配置，建议配置为3~4档。<p id="zh-cn_topic_0000002210590710_p13405521163715"><a name="zh-cn_topic_0000002210590710_p13405521163715"></a><a name="zh-cn_topic_0000002210590710_p13405521163715"></a><span id="zh-cn_topic_0000002210590710_ph74051221133719"><a name="zh-cn_topic_0000002210590710_ph74051221133719"></a><a name="zh-cn_topic_0000002210590710_ph74051221133719"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_6"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_6"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_6"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_6"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_6"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_6"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210590710_p840502113716"><a name="zh-cn_topic_0000002210590710_p840502113716"></a><a name="zh-cn_topic_0000002210590710_p840502113716"></a><span id="zh-cn_topic_0000002210590710_ph94050215374"><a name="zh-cn_topic_0000002210590710_ph94050215374"></a><a name="zh-cn_topic_0000002210590710_ph94050215374"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_6"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_6"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_6"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_6"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_6"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_6"></a>Atlas A2 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002210590710_p150122011520"><a name="zh-cn_topic_0000002210590710_p150122011520"></a><a name="zh-cn_topic_0000002210590710_p150122011520"></a><strong id="zh-cn_topic_0000002210590710_b1366961195118"><a name="zh-cn_topic_0000002210590710_b1366961195118"></a><a name="zh-cn_topic_0000002210590710_b1366961195118"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590710_screen175214235126"><a name="zh-cn_topic_0000002210590710_screen175214235126"></a><a name="zh-cn_topic_0000002210590710_screen175214235126"></a>{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b2030313591716"><a name="zh-cn_topic_0000002210590710_b2030313591716"></a><a name="zh-cn_topic_0000002210590710_b2030313591716"></a>INPUT_FORMAT, "ND"</strong>},
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b11489016132518"><a name="zh-cn_topic_0000002210590710_b11489016132518"></a><a name="zh-cn_topic_0000002210590710_b11489016132518"></a>INPUT_SHAPE, "data:1,-1"</strong>}, 
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b8569337112716"><a name="zh-cn_topic_0000002210590710_b8569337112716"></a><a name="zh-cn_topic_0000002210590710_b8569337112716"></a>DYNAMIC_DIMS, "4;8;16;64"</strong>}  
// 模型编译时，支持的data算子的shape为1,4; 1,8; 1,16;1,64
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b189291515819"><a name="zh-cn_topic_0000002210590710_b189291515819"></a><a name="zh-cn_topic_0000002210590710_b189291515819"></a>INPUT_FORMAT, "ND"</strong>},
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b415282132813"><a name="zh-cn_topic_0000002210590710_b415282132813"></a><a name="zh-cn_topic_0000002210590710_b415282132813"></a>INPUT_SHAPE, "data:1,-1,-1"</strong>}, 
{ge::ir_option::<strong id="zh-cn_topic_0000002210590710_b141526212816"><a name="zh-cn_topic_0000002210590710_b141526212816"></a><a name="zh-cn_topic_0000002210590710_b141526212816"></a>DYNAMIC_DIMS, "1,2;3,4;5,6;7,8"</strong>}  
// 模型编译时，支持的data算子的shape为1,1,2; 1,3,4; 1,5,6; 1,7,8</pre>
<p id="zh-cn_topic_0000002210590710_p6498158121110"><a name="zh-cn_topic_0000002210590710_p6498158121110"></a><a name="zh-cn_topic_0000002210590710_p6498158121110"></a><span class="ddd" id="zh-cn_topic_0000002210590710_ph5740132312588"><a name="zh-cn_topic_0000002210590710_ph5740132312588"></a><a name="zh-cn_topic_0000002210590710_ph5740132312588"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590710_p9315118331"><a name="zh-cn_topic_0000002210590710_p9315118331"></a><a name="zh-cn_topic_0000002210590710_p9315118331"></a><span id="zh-cn_topic_0000002210590710_ph15325114331"><a name="zh-cn_topic_0000002210590710_ph15325114331"></a><a name="zh-cn_topic_0000002210590710_ph15325114331"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_7"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_7"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term1253731311225_7"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_7"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_7"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term131434243115_7"></a>Atlas A3 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590710_p9395118338"><a name="zh-cn_topic_0000002210590710_p9395118338"></a><a name="zh-cn_topic_0000002210590710_p9395118338"></a><span id="zh-cn_topic_0000002210590710_ph831519338"><a name="zh-cn_topic_0000002210590710_ph831519338"></a><a name="zh-cn_topic_0000002210590710_ph831519338"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_7"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_7"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term11962195213215_7"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_7"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_7"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000001312391781_term184716139811_7"></a>Atlas A2 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590710_row8615174412219"><td class="cellrowborder" valign="top" width="16.72%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590710_p15833144123920"><a name="zh-cn_topic_0000002210590710_p15833144123920"></a><a name="zh-cn_topic_0000002210590710_p15833144123920"></a>AC_PARALLEL_ENABLE</p>
</td>
<td class="cellrowborder" valign="top" width="83.28%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p3962116131913"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p3962116131913"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p3962116131913"></a>动态shape图中，是否允许AI CPU算子和AI Core算子并行运行。</p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p493801713309"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p493801713309"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p493801713309"></a>动态shape图中，开关开启时，系统自动识别图中可以和AI Core并发的AI CPU算子，不同引擎的算子下发到不同流上，实现多引擎间的并行，从而提升资源利用效率和动态shape执行性能。</p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p150535616117"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p150535616117"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p150535616117"></a><strong id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_b1676915321217"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_b1676915321217"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_b1676915321217"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ul16951746103014"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ul16951746103014"></a><ul id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ul16951746103014"><li>1：允许AI CPU和AI Core算子间的并行运行。</li><li>0（默认）：AI CPU算子不会单独分流。</li></ul>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p640424215712"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p640424215712"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p640424215712"></a><strong id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_b93475117120"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_b93475117120"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_b93475117120"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_screen3258511884"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_screen3258511884"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_screen3258511884"></a>{ge::ir_option::AC_PARALLEL_ENABLE, "1"}</pre>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p16208153044113"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p16208153044113"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p16208153044113"></a><span class="ddd" id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph920833074119"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph920833074119"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph920833074119"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p1920933016417"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p1920933016417"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p1920933016417"></a><span id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph1220933044114"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph1220933044114"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph1220933044114"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p777415121318"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p777415121318"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_p777415121318"></a><span id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph147718156134"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph147718156134"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_ph147718156134"></a><term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590710_zh-cn_topic_0000002244572897_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 算子编译与图编译<a name="section190623194912"></a>

<a name="table282831612505"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245510777_row1629116545245"><th class="cellrowborder" valign="top" width="17.02%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002245510777_p549124382515"><a name="zh-cn_topic_0000002245510777_p549124382515"></a><a name="zh-cn_topic_0000002245510777_p549124382515"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="82.98%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002245510777_p029113544248"><a name="zh-cn_topic_0000002245510777_p029113544248"></a><a name="zh-cn_topic_0000002245510777_p029113544248"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245510777_row112951816388"><td class="cellrowborder" valign="top" width="17.02%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510777_p1875162174014"><a name="zh-cn_topic_0000002245510777_p1875162174014"></a><a name="zh-cn_topic_0000002245510777_p1875162174014"></a>EXCLUDE_ENGINES</p>
</td>
<td class="cellrowborder" valign="top" width="82.98%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510777_p275122116405"><a name="zh-cn_topic_0000002245510777_p275122116405"></a><a name="zh-cn_topic_0000002245510777_p275122116405"></a>设置图编译时不使用某个或某些加速引擎。多个以“|”分隔。</p>
<p id="zh-cn_topic_0000002245510777_p14660173620010"><a name="zh-cn_topic_0000002245510777_p14660173620010"></a><a name="zh-cn_topic_0000002245510777_p14660173620010"></a>NPU集成了多种硬件加速器（也叫加速引擎），比如AiCore/AiVec/AiCpu（按照优先级排列）等，在图编译阶段会按照优先级为算子选择合适的引擎，即当同一个算子被多种引擎支持时，会选择优先级高的那个。</p>
<p id="zh-cn_topic_0000002245510777_p666113361607"><a name="zh-cn_topic_0000002245510777_p666113361607"></a><a name="zh-cn_topic_0000002245510777_p666113361607"></a>EXCLUDE_ENGINES提供了排除某个引擎的功能，比如在一次训练过程中，为避免数据预处理图和主训练图抢占AiCore，可以给数据预处理图配置不使用AiCore引擎。</p>
<p id="zh-cn_topic_0000002245510777_p19541816192417"><a name="zh-cn_topic_0000002245510777_p19541816192417"></a><a name="zh-cn_topic_0000002245510777_p19541816192417"></a><strong id="zh-cn_topic_0000002245510777_b1997312389918"><a name="zh-cn_topic_0000002245510777_b1997312389918"></a><a name="zh-cn_topic_0000002245510777_b1997312389918"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245510777_ul191771221144720"></a><a name="zh-cn_topic_0000002245510777_ul191771221144720"></a><ul id="zh-cn_topic_0000002245510777_ul191771221144720"><li>“AiCore”：AI Core硬件加速引擎</li><li>“AiVec”：Vector Core硬件加速引擎</li><li>“AiCpu”：AI CPU硬件加速引擎</li></ul>
<p id="zh-cn_topic_0000002245510777_p87741943733"><a name="zh-cn_topic_0000002245510777_p87741943733"></a><a name="zh-cn_topic_0000002245510777_p87741943733"></a><strong id="zh-cn_topic_0000002245510777_b16556172611918"><a name="zh-cn_topic_0000002245510777_b16556172611918"></a><a name="zh-cn_topic_0000002245510777_b16556172611918"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245510777_screen9526153517"><a name="zh-cn_topic_0000002245510777_screen9526153517"></a><a name="zh-cn_topic_0000002245510777_screen9526153517"></a>{ge::ir_option::EXCLUDE_ENGINES, "AiCore|AiVec"}</pre>
<p id="zh-cn_topic_0000002245510777_p138302447433"><a name="zh-cn_topic_0000002245510777_p138302447433"></a><a name="zh-cn_topic_0000002245510777_p138302447433"></a><span class="ddd" id="zh-cn_topic_0000002245510777_ph115215318213"><a name="zh-cn_topic_0000002245510777_ph115215318213"></a><a name="zh-cn_topic_0000002245510777_ph115215318213"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510777_p14848413374"><a name="zh-cn_topic_0000002245510777_p14848413374"></a><a name="zh-cn_topic_0000002245510777_p14848413374"></a><span id="zh-cn_topic_0000002245510777_ph784541103715"><a name="zh-cn_topic_0000002245510777_ph784541103715"></a><a name="zh-cn_topic_0000002245510777_ph784541103715"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245510777_p48417414379"><a name="zh-cn_topic_0000002245510777_p48417414379"></a><a name="zh-cn_topic_0000002245510777_p48417414379"></a><span id="zh-cn_topic_0000002245510777_ph0841641103717"><a name="zh-cn_topic_0000002245510777_ph0841641103717"></a><a name="zh-cn_topic_0000002245510777_ph0841641103717"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245510777_row102911254112419"><td class="cellrowborder" valign="top" width="17.02%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510777_p46662212812"><a name="zh-cn_topic_0000002245510777_p46662212812"></a><a name="zh-cn_topic_0000002245510777_p46662212812"></a>OP_COMPILER_CACHE_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="82.98%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p088621016169"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p088621016169"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p088621016169"></a>用于配置算子编译磁盘缓存模式。</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p144729493303"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p144729493303"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p144729493303"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15675355163010"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15675355163010"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15675355163010"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul9580550151712"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul9580550151712"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul9580550151712"><li>enable：（默认值）表示启用算子编译缓存。启用后可以避免针对相同编译参数及算子参数的算子重复编译，从而提升编译速度。</li><li>force：启用算子编译缓存功能，区别于enable模式，force模式下会强制刷新缓存，即先删除已有缓存，再重新编译并加入缓存。比如当用户的python变更、依赖库变更、算子调优后知识库变更等，需要先指定为force用于先清理已有的缓存，后续再修改为enable模式，以避免每次编译时都强制刷新缓存。</li><li>disable：表示禁用算子编译缓存，算子重新编译。</li></ul>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p86752020183315"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p86752020183315"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p86752020183315"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b248232717334"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b248232717334"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b248232717334"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen624816103413"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen624816103413"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen624816103413"></a>{ge::ir_option::OP_COMPILER_CACHE_MODE, "enable"}</pre>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p8370114093219"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p8370114093219"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p8370114093219"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b945715612319"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b945715612319"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b945715612319"></a>使用说明：</strong></p>
<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul15373204019326"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul15373204019326"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul15373204019326"><li>如果要自行指定算子编译磁盘缓存的路径，则需要与OP_COMPILER_CACHE_DIR配合使用。</li><li>启用算子编译缓存功能时，可以通过<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"></a>配置文件</strong>（算子编译完成后，会在OP_COMPILER_CACHE_DIR参数指定路径下自动生成op_cache.ini文件）、<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"></a>环境变量</strong>两种方式来设置缓存文件夹的磁盘空间大小：<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ol1662675617178"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ol1662675617178"></a><ol id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ol1662675617178"><li>通过配置文件op_cache.ini设置<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p11244135522814"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p11244135522814"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p11244135522814"></a>若op_cache.ini文件不存在，则需要手动创建。打开该文件，增加如下信息：</p>
<pre class="screen" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen2068111579454"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen2068111579454"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen2068111579454"></a>#配置文件格式，必须包含，自动生成的文件中默认包括如下信息，手动创建时，需要输入
<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1092612334716"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1092612334716"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1092612334716"></a>[op_compiler_cache]</strong>
#限制某个芯片下缓存文件夹的磁盘空间的大小，默认值为500，取值需为整数，单位为MB
<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b183169361071"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b183169361071"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b183169361071"></a>max_op_cache_size=500</strong>
#设置需要保留缓存的空间大小比例，取值范围：[1,100]，默认值为50，单位为百分比；例如取值为80表示缓存空间不足时，删除缓存文件，保留80%缓存空间
<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b104141138171"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b104141138171"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b104141138171"></a>remain_cache_size_ratio=50   </strong> </pre>
<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul882504017583"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul882504017583"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul882504017583"><li>上述文件中的max_op_cache_size和remain_cache_size_ratio参数取值都有效时，op_cache.ini文件才会生效。</li><li>当编译缓存文件大小超过“max_op_cache_size”的设置值，且超过半小时缓存文件未被访问时，缓存文件就会老化（算子编译时，不会因为编译缓存文件大小超过设置值而中断，所以当“max_op_cache_size”设置过小时，会出现实际编译缓存文件大小超过此设置值的情况）。</li><li>若需要关闭编译缓存老化功能，可将“max_op_cache_size”设置为“-1”，此时访问算子缓存时不会更新访问时间，算子编译缓存不会老化，磁盘空间使用默认大小500MB。</li><li>若多个使用者使用相同的缓存路径，建议使用配置文件的方式进行设置，该场景下op_cache.ini文件会影响所有使用者。</li></ul>
</li><li>通过环境变量设置<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p168533161489"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p168533161489"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p168533161489"></a>该场景下，开发者可以通过环境变量ASCEND_MAX_OP_CACHE_SIZE来限制某个芯片下缓存文件夹的磁盘空间的大小，当编译缓存空间大小达到ASCEND_MAX_OP_CACHE_SIZE设置的取值，且超过半个小时缓存文件未被访问时，缓存文件就会老化。可通过环境变量ASCEND_REMAIN_CACHE_SIZE_RATIO设置需要保留缓存的空间大小比例。</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p148481416174115"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p148481416174115"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_p148481416174115"></a>配置示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen144318131013"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen144318131013"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_screen144318131013"></a># ASCEND_MAX_OP_CACHE_SIZE环境变量默认值为500，取值需为整数，单位为MB
<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b192231741079"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b192231741079"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b192231741079"></a>export ASCEND_MAX_OP_CACHE_SIZE=500</strong>
# ASCEND_REMAIN_CACHE_SIZE_RATIO环境变量取值范围：[1,100]，默认值为50，单位为百分比；例如取值为80表示缓存空间不足时，删除缓存文件，保留80%缓存空间
<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b17361124319712"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b17361124319712"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b17361124319712"></a>export ASCEND_REMAIN_CACHE_SIZE_RATIO=50</strong></pre>
<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul17158135011233"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul17158135011233"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_ul17158135011233"><li>通过环境变量配置，只对当前用户生效。</li><li>若需要关闭编译缓存老化功能，可将环境变量“<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1775511712244"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1775511712244"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1775511712244"></a>ASCEND_MAX_OP_CACHE_SIZE</strong>”设置为“-1”，此时访问算子缓存时不会更新访问时间，算子编译缓存不会老化，磁盘空间使用默认大小500MB。</li></ul>
</li></ol>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p528193213810"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p528193213810"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p528193213810"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15450456152213"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15450456152213"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15450456152213"></a>若同时配置了op_cache.ini文件和环境变量，则优先读取op_cache.ini文件中的配置项，若op_cache.ini文件和环境变量都未设置，则读取系统默认值：默认磁盘空间大小500MB，默认保留缓存空间的50%。</strong></p>
</li><li>由于force选项会先删除已有缓存，所以不建议在程序并行编译时设置，否则可能会导致其他模型因使用的缓存内容被清除而编译失败。</li><li>建议模型最终发布时设置编译缓存选项为disable或者force。</li><li>如果算子调优后知识库变更，则需要通过设置为force来刷新缓存，否则无法应用新的调优知识库，从而导致调优应用执行失败。</li><li>调试开关打开的场景：<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul928413534811"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul928413534811"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul928413534811"><li>OP_DEBUG_LEVEL配置非0值：会忽略OP_COMPILER_CACHE_MODE参数的配置，不启用算子编译缓存功能，算子全部重新编译。</li><li>OP_DEBUG_CONFIG配置非空，且<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b3151143582012"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b3151143582012"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b3151143582012"></a>未配置OP_DEBUG_LIST字段</strong>，会忽略OP_COMPILER_CACHE_MODE参数的配置，不启用算子编译缓存功能，算子全部重新编译。</li><li>OP_DEBUG_CONFIG配置非空，且<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b4708151194610"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b4708151194610"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b4708151194610"></a>配置文件中配置了OP_DEBUG_LIST字段</strong>：<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul1114411237501"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul1114411237501"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul1114411237501"><li>列表中的算子，忽略OP_COMPILER_CACHE_MODE参数的配置继续重新编译。</li><li>列表外的算子，如果OP_COMPILER_CACHE_MODE参数配置为enable或force，则启用缓存功能；若配置为disable，则不启用缓存功能，仍旧重新编译。</li></ul>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p333313481141"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p333313481141"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p333313481141"></a><span class="ddd" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph74404435568"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph74404435568"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph74404435568"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1016918492710"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1016918492710"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1016918492710"></a><span id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph13169114914714"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph13169114914714"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph13169114914714"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p28415145489"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p28415145489"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p28415145489"></a><span id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph17841414184817"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph17841414184817"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph17841414184817"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245510777_row175281573244"><td class="cellrowborder" valign="top" width="17.02%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510777_p115671151142915"><a name="zh-cn_topic_0000002245510777_p115671151142915"></a><a name="zh-cn_topic_0000002245510777_p115671151142915"></a>OP_COMPILER_CACHE_DIR</p>
</td>
<td class="cellrowborder" valign="top" width="82.98%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p186651122168"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p186651122168"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p186651122168"></a>用于配置算子编译磁盘缓存的目录。</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0284199581_p1135164991114"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0284199581_p1135164991114"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0284199581_p1135164991114"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b562820369812"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b562820369812"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b562820369812"></a>参数值格式：</strong>路径支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）、中文字符。</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1016473113613"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1016473113613"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1016473113613"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b06161551896"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b06161551896"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b06161551896"></a>默认值：</strong>$HOME/atc_data</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p4785202318351"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p4785202318351"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p4785202318351"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b460473413357"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b460473413357"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b460473413357"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen64360484353"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen64360484353"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen64360484353"></a>{ge::ir_option::OP_COMPILER_CACHE_MODE, "enable"}
{ge::ir_option::OP_COMPILER_CACHE_DIR, "<em id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_i1883641212386"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_i1883641212386"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_i1883641212386"></a>/home/test/data/atc_data</em>"}</pre>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p3774912094"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p3774912094"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p3774912094"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b166202215914"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b166202215914"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b166202215914"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul121165422032"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul121165422032"></a><ul id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ul121165422032"><li>如果要自行指定算子编译磁盘缓存的路径，则需要与OP_COMPILER_CACHE_MODE配合使用。</li><li>如果参数指定的路径存在且有效，则在指定的路径下自动创建子目录kernel_cache；如果指定的路径不存在但路径有效，则先自动创建目录，然后在该路径下自动创建子目录kernel_cache。</li><li>用户请不要在<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b18278123915115"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b18278123915115"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b18278123915115"></a>默认缓存目录</strong>下存放其他自有内容，自有内容在软件包安装或升级时会同默认缓存目录一并被删除。</li><li>通过该参数指定的<strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b73581227013"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b73581227013"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b73581227013"></a>非默认缓存目录</strong>无法删除（软件包安装或升级时不会被删除）。</li><li>算子编译磁盘缓存路径，除OP_COMPILER_CACHE_DIR参数设置的方式外，还可以配置环境变量ASCEND_CACHE_PATH，几种方式优先级为：配置参数“OP_COMPILER_CACHE_DIR”&gt;环境变量ASCEND_CACHE_PATH&gt;默认存储路径。关于环境变量ASCEND_CACHE_PATH的详细说明请参见<span id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph7470838306"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph7470838306"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph7470838306"></a>《环境变量参考》</span>。</li></ul>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p48641322518"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p48641322518"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p48641322518"></a><span class="ddd" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph103251149155613"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph103251149155613"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph103251149155613"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p5269951294"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p5269951294"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p5269951294"></a><span id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph72696513913"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph72696513913"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph72696513913"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p176142813486"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p176142813486"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p176142813486"></a><span id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph14761928114813"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph14761928114813"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_ph14761928114813"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245510777_row18764192911373"><td class="cellrowborder" valign="top" width="17.02%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510777_p276432915379"><a name="zh-cn_topic_0000002245510777_p276432915379"></a><a name="zh-cn_topic_0000002245510777_p276432915379"></a>OPTIMIZATION_SWITCH</p>
</td>
<td class="cellrowborder" valign="top" width="82.98%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p16712350162015"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p16712350162015"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p16712350162015"></a>算子编译时，融合规则（Pass）的控制开关，该参数适用于所有融合规则。</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1257818813415"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1257818813415"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1257818813415"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15226020173411"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15226020173411"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b15226020173411"></a>参数取值：</strong>"Passname1:on;Passname2:off"，可以拼接多个key-value键值对，key为Pass名称，value为on（表示开）或off（表示关），不支持大小写模式匹配，多组配置使用英文分号分隔。</p>
<p id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1842211116349"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1842211116349"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_p1842211116349"></a><strong id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b17226152010349"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b17226152010349"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_b17226152010349"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen1552031420369"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen1552031420369"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000002209492870_screen1552031420369"></a>{ge::ir_option::OPTIMIZATION_SWITCH, "Passname1:on;Passname2:off"}</pre>
<p id="zh-cn_topic_0000002245510777_p53871713104310"><a name="zh-cn_topic_0000002245510777_p53871713104310"></a><a name="zh-cn_topic_0000002245510777_p53871713104310"></a><span class="ddd" id="zh-cn_topic_0000002245510777_ph1348261625514"><a name="zh-cn_topic_0000002245510777_ph1348261625514"></a><a name="zh-cn_topic_0000002245510777_ph1348261625514"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510777_p102251817131919"><a name="zh-cn_topic_0000002245510777_p102251817131919"></a><a name="zh-cn_topic_0000002245510777_p102251817131919"></a><span id="zh-cn_topic_0000002245510777_ph192251917161914"><a name="zh-cn_topic_0000002245510777_ph192251917161914"></a><a name="zh-cn_topic_0000002245510777_ph192251917161914"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245510777_p465703434017"><a name="zh-cn_topic_0000002245510777_p465703434017"></a><a name="zh-cn_topic_0000002245510777_p465703434017"></a><span id="zh-cn_topic_0000002245510777_ph13754548217"><a name="zh-cn_topic_0000002245510777_ph13754548217"></a><a name="zh-cn_topic_0000002245510777_ph13754548217"></a><term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002245510777_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 功能调试<a name="section2596153919492"></a>

<a name="table17689719185015"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210430930_row535465810270"><th class="cellrowborder" valign="top" width="17.29%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002210430930_p103551558202714"><a name="zh-cn_topic_0000002210430930_p103551558202714"></a><a name="zh-cn_topic_0000002210430930_p103551558202714"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="82.71%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002210430930_p1355758132715"><a name="zh-cn_topic_0000002210430930_p1355758132715"></a><a name="zh-cn_topic_0000002210430930_p1355758132715"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210430930_row10355135815273"><td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430930_p151941143173016"><a name="zh-cn_topic_0000002210430930_p151941143173016"></a><a name="zh-cn_topic_0000002210430930_p151941143173016"></a>LOG_LEVEL</p>
</td>
<td class="cellrowborder" valign="top" width="82.71%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430930_p231414244589"><a name="zh-cn_topic_0000002210430930_p231414244589"></a><a name="zh-cn_topic_0000002210430930_p231414244589"></a>设置显示日志的级别。</p>
<p id="zh-cn_topic_0000002210430930_p78901857097"><a name="zh-cn_topic_0000002210430930_p78901857097"></a><a name="zh-cn_topic_0000002210430930_p78901857097"></a><strong id="zh-cn_topic_0000002210430930_b635143319589"><a name="zh-cn_topic_0000002210430930_b635143319589"></a><a name="zh-cn_topic_0000002210430930_b635143319589"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210430930_ul1976183491120"></a><a name="zh-cn_topic_0000002210430930_ul1976183491120"></a><ul id="zh-cn_topic_0000002210430930_ul1976183491120"><li>debug：输出debug/info/warning/error级别的调试日志信息。</li><li>info：输出info/warning/error级别的调试日志信息。</li><li>warning：输出warning/error级别的调试日志信息。</li><li>error：输出error级别的调试日志信息。</li><li>null：（默认值）不输出调试日志。</li></ul>
<p id="zh-cn_topic_0000002210430930_p1580319735819"><a name="zh-cn_topic_0000002210430930_p1580319735819"></a><a name="zh-cn_topic_0000002210430930_p1580319735819"></a><strong id="zh-cn_topic_0000002210430930_b107593695820"><a name="zh-cn_topic_0000002210430930_b107593695820"></a><a name="zh-cn_topic_0000002210430930_b107593695820"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210430930_screen810018434587"><a name="zh-cn_topic_0000002210430930_screen810018434587"></a><a name="zh-cn_topic_0000002210430930_screen810018434587"></a>{ge::ir_option::LOG_LEVEL, "debug"}</pre>
<p id="zh-cn_topic_0000002210430930_p567714217211"><a name="zh-cn_topic_0000002210430930_p567714217211"></a><a name="zh-cn_topic_0000002210430930_p567714217211"></a><span class="ddd" id="zh-cn_topic_0000002210430930_ph471290594"><a name="zh-cn_topic_0000002210430930_ph471290594"></a><a name="zh-cn_topic_0000002210430930_ph471290594"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430930_p14558586354"><a name="zh-cn_topic_0000002210430930_p14558586354"></a><a name="zh-cn_topic_0000002210430930_p14558586354"></a><span id="zh-cn_topic_0000002210430930_ph12558178163520"><a name="zh-cn_topic_0000002210430930_ph12558178163520"></a><a name="zh-cn_topic_0000002210430930_ph12558178163520"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430930_p855838123515"><a name="zh-cn_topic_0000002210430930_p855838123515"></a><a name="zh-cn_topic_0000002210430930_p855838123515"></a><span id="zh-cn_topic_0000002210430930_ph25582088357"><a name="zh-cn_topic_0000002210430930_ph25582088357"></a><a name="zh-cn_topic_0000002210430930_ph25582088357"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210430930_row108122035202917"><td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430930_p1785213120311"><a name="zh-cn_topic_0000002210430930_p1785213120311"></a><a name="zh-cn_topic_0000002210430930_p1785213120311"></a>DEBUG_DIR</p>
</td>
<td class="cellrowborder" valign="top" width="82.71%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p59034431719"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p59034431719"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p59034431719"></a>用于配置保存算子编译生成的调试相关的过程文件的路径，过程文件包括但不限于算子.o（算子二进制文件）、.json（算子描述文件）、.cce等文件。</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p513519112272"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p513519112272"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p513519112272"></a>默认生成在当前路径下。</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1410133311012"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1410133311012"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1410133311012"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b195041341101012"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b195041341101012"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b195041341101012"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul1765719562122"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul1765719562122"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul1765719562122"><li>如果要自行指定算子编译的过程文件存放路径，需DEBUG_DIR参数与OP_DEBUG_LEVEL参数配合使用，且当OP_DEBUG_LEVEL取值为0时，不能使用DEBUG_DIR参数。</li><li>算子编译生成的调试文件存储路径，除DEBUG_DIR参数设置的方式外，还可以配置环境变量ASCEND_WORK_PATH，几种方式优先级为：配置参数“DEBUG_DIR”&gt;环境变量ASCEND_WORK_PATH &gt;默认存储路径。关于环境变量ASCEND_WORK_PATH的详细说明请参见<span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph9525133010304"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph9525133010304"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph9525133010304"></a>《环境变量参考》</span>。</li></ul>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p81170206396"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p81170206396"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p81170206396"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b940352653919"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b940352653919"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b940352653919"></a>配置示例</strong>：</p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen20573154703919"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen20573154703919"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen20573154703919"></a>{ge::ir_option::OP_DEBUG_LEVEL, "1"}
{ge::ir_option::DEBUG_DIR, "<em id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i1574047123916"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i1574047123916"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i1574047123916"></a>/home/test/module/out_debug_info</em>"}</pre>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p821620561251"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p821620561251"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p821620561251"></a><span class="ddd" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph16335453125619"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph16335453125619"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph16335453125619"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1379612151210"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1379612151210"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1379612151210"></a><span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph107961328128"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph107961328128"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph107961328128"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p8626172314915"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p8626172314915"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p8626172314915"></a><span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph10627123104917"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph10627123104917"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph10627123104917"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210430930_row13355165852716"><td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430930_p6305171194719"><a name="zh-cn_topic_0000002210430930_p6305171194719"></a><a name="zh-cn_topic_0000002210430930_p6305171194719"></a>OP_DEBUG_LEVEL</p>
</td>
<td class="cellrowborder" valign="top" width="82.71%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p10832153101615"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p10832153101615"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p10832153101615"></a>算子编译debug功能开关。</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p13253510169"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p13253510169"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p13253510169"></a>如果要自行指定算子编译的过程文件存放路径，则需要通过DEBUG_DIR参数指定，OP_DEBUG_LEVEL取值为0时，使用DEBUG_DIR参数不生效。</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1263552005710"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1263552005710"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1263552005710"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b15674183961617"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b15674183961617"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b15674183961617"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul18155740191413"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul18155740191413"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul18155740191413"><li>0：（默认值）不开启算子debug功能，在当前执行路径<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b15461845195817"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b15461845195817"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b15461845195817"></a>不生成</strong>算子编译目录kernel_meta。</li><li>1：开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b179782285171"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b179782285171"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b179782285171"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）和TBE指令映射文件（算子cce文件*.cce和python-cce映射文件*_loc.json），用于后续分析AICore Error问题。</li><li>2：开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b10503172717172"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b10503172717172"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b10503172717172"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）和TBE指令映射文件（算子cce文件*.cce和python-cce映射文件*_loc.json），用于后续分析AICore Error问题，同时设置为2，还会关闭编译优化开关、开启ccec调试功能（ccec编译器选项设置为-O0-g）。</li><li>3：不开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹中<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b13358926141716"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b13358926141716"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b13358926141716"></a>生成</strong>*.o（算子二进制文件）和*.json文件（算子描述文件），分析算子问题时可参考。</li><li>4：不开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b14819924101718"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b14819924101718"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b14819924101718"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）、TBE指令映射文件（算子cce文件*.cce）和UB融合计算描述文件（{$kernel_name}_compute.json），可在分析算子问题时进行问题复现、精度比对时使用。</li></ul>
<div class="notice" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note1321414364455"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note1321414364455"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note1321414364455"></a><span class="noticetitle"> 须知： </span><div class="noticebody"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul2597173018539"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul2597173018539"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul2597173018539"><li>若OP_DEBUG_LEVEL配置为0，同时配置了OP_DEBUG_CONFIG参数，该场景下在当前执行路径<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b5667181111407"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b5667181111407"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b5667181111407"></a>会保留</strong>算子编译目录kernel_meta。</li><li>若OP_DEBUG_LEVEL配置为0，同时设置了环境变量，则会<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b594101132614"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b594101132614"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b594101132614"></a>始终保留</strong>编译目录kernel_meta；若设置了环境变量，则保留在该环境变量指定路径下，若无环境变量，则保留在当前执行路径。</li><li>训练执行时，建议配置为0或3。如果需要进行问题定位，再选择调试开关选项1和2，是因为加入了调试功能会导致网络性能下降。</li><li>配置为2（即开启ccec编译选项）时，会导致算子Kernel（*.o文件）大小增大。动态Shape场景下，由于算子编译时会遍历可能的Shape场景，因此可能会导致算子Kernel文件过大而无法进行编译，此种场景下，建议不要配置ccec编译选项。<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p119132011557"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p119132011557"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p119132011557"></a>由于算子Kernel文件过大而无法编译的报错日志示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_screen1819162055520"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_screen1819162055520"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_screen1819162055520"></a>message:link error ld.lld: <strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b1819122017557"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b1819122017557"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_b1819122017557"></a>error: InputSection too large for range extension thunk</strong> ./kernel_meta_xxxxx.o</pre>
</li><li>debug功能开关打开场景下，若模型中含有如下通算融合算子，算子编译目录kernel_meta中，不会生成下述算子的*.o、*.json、*.cce文件。<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719135919173"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719135919173"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719135919173"></a>MatMulAllReduce</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p1171917592173"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p1171917592173"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p1171917592173"></a>MatMulAllReduceAddRmsNorm</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719859161710"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719859161710"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p12719859161710"></a>AllGatherMatMul</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p57191059121714"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p57191059121714"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p57191059121714"></a>MatMulReduceScatter</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p871905911713"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p871905911713"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p871905911713"></a>AlltoAllAllGatherBatchMatMul</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p4719459131718"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p4719459131718"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312713993_p4719459131718"></a>BatchMatMulReduceScatterAlltoAll</p>
</li></ul>
</div></div>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p4934165913401"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p4934165913401"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p4934165913401"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b1526817734119"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b1526817734119"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b1526817734119"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen4281630124110"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen4281630124110"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen4281630124110"></a>{ge::ir_option::OP_DEBUG_LEVEL, "1"}</pre>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p433415221969"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p433415221969"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p433415221969"></a><span class="ddd" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph631185810562"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph631185810562"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph631185810562"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p16173195091414"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p16173195091414"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p16173195091414"></a><span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1173135051419"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1173135051419"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1173135051419"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p357173714919"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p357173714919"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p357173714919"></a><span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph25711437154914"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph25711437154914"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph25711437154914"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210430930_row735555872711"><td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430930_p8856157145814"><a name="zh-cn_topic_0000002210430930_p8856157145814"></a><a name="zh-cn_topic_0000002210430930_p8856157145814"></a>OP_DEBUG_CONFIG</p>
</td>
<td class="cellrowborder" valign="top" width="82.71%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p17387646133615"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p17387646133615"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p17387646133615"></a>Global Memory内存检测功能开关。</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1768154734112"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1768154734112"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1768154734112"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b12399854194112"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b12399854194112"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b12399854194112"></a>参数取值：</strong></p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p72049122158"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p72049122158"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p72049122158"></a>取值为.cfg配置文件路径，配置文件内多个选项用英文逗号分隔：</p>
<a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul24919263716"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul24919263716"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul24919263716"><li><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b17418155120285"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b17418155120285"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b17418155120285"></a>oom</strong>：算子<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1544210173476"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1544210173476"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1544210173476"></a>执行</strong>过程中，检测Global Memory是否内存越界。<a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul19412352346"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul19412352346"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul19412352346"><li>配置该选项，算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留.o（算子二进制文件）和.json文件（算子描述文件）。</li><li>使用该选项后，在算子编译过程中会加入如下的检测逻辑，用户可以通过再使用<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1692418214107"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1692418214107"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1692418214107"></a>dump_cce</strong>参数，在生成的.cce文件中查看如下的代码。<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen9700040330"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen9700040330"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen9700040330"></a>inline __aicore__ void  CheckInvalidAccessOfDDR(<em id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i185658171540"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i185658171540"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i185658171540"></a>xxx</em>) {
    if (access_offset &lt; 0 || access_offset + access_extent &gt; ddr_size) {
        if (read_or_write == 1) {
            <strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1997152116414"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1997152116414"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1997152116414"></a>trap</strong>(0X5A5A0001);
        } else {
            <strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b03115221944"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b03115221944"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b03115221944"></a>trap</strong>(0X5A5A0002);
        }
    }
}</pre>
</li></ul>
</li><li><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b6797158112816"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b6797158112816"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b6797158112816"></a>dump_cce</strong>：算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留算子cce文件*.cce，以及.o（算子二进制文件）和.json文件（算子描述文件）。</li><li><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1451717092916"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1451717092916"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1451717092916"></a>dump_loc</strong>：算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留python-cce映射文件*_loc.json，以及.o（算子二进制文件）和.json文件（算子描述文件）。</li><li><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b0445726297"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b0445726297"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b0445726297"></a>ccec_O0</strong>：算子编译时，开启ccec编译器选项-O0，配置该选项<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1574314052112"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1574314052112"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1574314052112"></a>不会</strong>对调试信息执行优化操作，用于后续分析AI Core Error问题。</li><li><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b433212414292"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b433212414292"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b433212414292"></a>ccec_g</strong>：算子编译时，开启ccec编译器选项-g，配置该选项<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b464943132117"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b464943132117"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b464943132117"></a>会</strong>对调试信息执行优化操作，用于后续分析AI Core Error问题。</li><li><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b204541653152615"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b204541653152615"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b204541653152615"></a>check_flag</strong>：算子<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1256222013473"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1256222013473"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b1256222013473"></a>执行</strong>时，检测算子内部流水线同步信号是否匹配。<a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1846028182917"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1846028182917"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1846028182917"><li>配置该选项，算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留.o（算子二进制文件）和.json文件（算子描述文件）。</li><li>使用该选项后，在算子编译过程中会加入如下的检测逻辑，用户可以通过再使用<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b114618287299"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b114618287299"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b114618287299"></a>dump_cce</strong>参数，在生成的.cce文件中查看如下的代码。<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen144614286299"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen144614286299"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen144614286299"></a>  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID2);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID3);
  ....
  pipe_barrier(PIPE_MTE3);
  pipe_barrier(PIPE_MTE2);
  pipe_barrier(PIPE_M);
  pipe_barrier(PIPE_V);
  pipe_barrier(PIPE_MTE1);
  pipe_barrier(PIPE_ALL);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID2);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID3);
  ...</pre>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p164713283295"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p164713283295"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p164713283295"></a>实际执行推理过程中，如果确实存在算子内部流水线同步信号不匹配，则最终会在<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12480113214158"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12480113214158"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12480113214158"></a>有问题的算子处超时报错，并终止程序</strong>，报错信息示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen1331517541655"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen1331517541655"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_screen1331517541655"></a>Aicore kernel execute failed, ..., fault kernel_name=<em id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i65002166121"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i65002166121"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_i65002166121"></a>算子名</em>,...
rtStreamSynchronizeWithTimeout execute failed....</pre>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p240794392520"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p240794392520"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p240794392520"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b9993521164211"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b9993521164211"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b9993521164211"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen197733074511"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen197733074511"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen197733074511"></a>{ge::ir_option::OP_DEBUG_CONFIG, "/root/test0.cfg"}</pre>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p715211329510"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p715211329510"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p715211329510"></a>其中，test0.cfg文件信息为：</p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen15981313132616"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen15981313132616"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen15981313132616"></a>op_debug_config=ccec_g,oom</pre>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p19642744541"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p19642744541"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p19642744541"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b36101820165413"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b36101820165413"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b36101820165413"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p2943133093320"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p2943133093320"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p2943133093320"></a>算子编译时，如果用户不想编译所有AI Core算子，而是指定某些AI Core算子进行编译，则需要在上述test0.cfg配置文件中新增<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12954518183515"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12954518183515"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b12954518183515"></a>OP_DEBUG_LIST</strong>字段，算子编译时，只编译该列表指定的算子，并按照OP_DEBUG_CONFIG配置的选项进行编译。OP_DEBUG_LIST字段要求如下：</p>
<a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1691044011386"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1691044011386"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_ul1691044011386"><li>支持指定算子名称或者算子类型。</li><li>算子之间使用英文逗号分隔，若为算子类型，则以<strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b16555457134117"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b16555457134117"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_b16555457134117"></a>OpType::typeName</strong>格式进行配置，支持算子类型和算子名称混合配置。</li><li>要编译的算子，必须放在OP_DEBUG_CONFIG参数指定的配置文件中。</li></ul>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p511381113264"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p511381113264"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p511381113264"></a>配置示例如下，test0.cfg文件中增加如下信息：</p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen12280416826"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen12280416826"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen12280416826"></a>op_debug_config=ccec_g,oom
op_debug_list=<em id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i1951033145410"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i1951033145410"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i1951033145410"></a>GatherV2,opType::ReduceSum</em></pre>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p765410710210"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p765410710210"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p765410710210"></a>模型编译时，<em id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i19710500216"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i19710500216"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_i19710500216"></a>GatherV2,ReduceSum</em>算子按照ccec_g,oom选项进行编译。</p>
<div class="note" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note02845114366"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note02845114366"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note02845114366"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul230710560362"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul230710560362"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul230710560362"><li>开启ccec编译选项的场景下（即ccec_O0、ccec_g选项），会增大算子Kernel（*.o文件）的大小。动态shape场景下，由于算子编译时会遍历可能存在的所有场景，最终可能会导致由于算子Kernel文件过大而无法进行编译的情况，此种场景下，建议不要开启ccec编译选项。<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p321220316517"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p321220316517"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p321220316517"></a>由于算子kernel文件过大而无法编译的日志显示如下：</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p61879516373"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p61879516373"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p61879516373"></a>message:link error ld.lld: <strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b141871859379"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b141871859379"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b141871859379"></a>error: InputSection too large for range extension thunk</strong> ./kernel_meta_xxxxx.o:(xxxx)</p>
</li><li>ccec编译器选项ccec_O0和oom不能同时开启，可能会导致AICore Error报错，报错信息示例如下：<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen13162125424812"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen13162125424812"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen13162125424812"></a>...there is an aivec error exception, core id is 49, error code = 0x4 ...</pre>
</li><li>若配置NPU_COLLECT_PATH环境变量，不支持打开“检测Global Memory是否内存越界”的开关（OP_DEBUG_CONFIG指定的配置文件中配置oom），否则编译出来的模型文件或算子kernel包在使用时会报错。</li><li>配置编译选项oom、dump_cce、dump_loc时，若模型中含有如下通算融合算子，算子编译目录kernel_meta中，不会生成下述算子的*.o、*.json、*.cce文件。<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719135919173"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719135919173"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719135919173"></a>MatMulAllReduce</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p1171917592173"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p1171917592173"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p1171917592173"></a>MatMulAllReduceAddRmsNorm</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719859161710"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719859161710"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p12719859161710"></a>AllGatherMatMul</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p57191059121714"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p57191059121714"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p57191059121714"></a>MatMulReduceScatter</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p871905911713"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p871905911713"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p871905911713"></a>AlltoAllAllGatherBatchMatMul</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p4719459131718"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p4719459131718"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001420224261_p4719459131718"></a>BatchMatMulReduceScatterAlltoAll</p>
</li></ul>
</div></div>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p186771335930"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p186771335930"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p186771335930"></a><span class="ddd" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph69315515119"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph69315515119"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph69315515119"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1363132819812"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1363132819812"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p1363132819812"></a><span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1436310288816"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1436310288816"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1436310288816"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p186074510502"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p186074510502"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p186074510502"></a><span id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1386044565020"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1386044565020"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ph1386044565020"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210430930_row5355165892712"><td class="cellrowborder" valign="top" width="17.29%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430930_p198112187410"><a name="zh-cn_topic_0000002210430930_p198112187410"></a><a name="zh-cn_topic_0000002210430930_p198112187410"></a><span>OPTION_EXPORT_COMPILE_STAT</span></p>
</td>
<td class="cellrowborder" valign="top" width="82.71%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p12811196142117"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p12811196142117"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p12811196142117"></a>配置图编译过程中是否生成算子融合信息（包括图融合和UB融合）的结果文件fusion_result.json。</p>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p8302247202"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p8302247202"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p8302247202"></a>该文件用于记录图编译过程中使用的融合规则，文件中：</p>
<a name="zh-cn_topic_0000002244692729_ul4694626162011"></a><a name="zh-cn_topic_0000002244692729_ul4694626162011"></a><ul id="zh-cn_topic_0000002244692729_ul4694626162011"><li>session_and_graph_id_<em id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000002087352816_i98131925111418"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000002087352816_i98131925111418"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_zh-cn_topic_0000002087352816_i98131925111418"></a>xx_xx</em>：表示融合结果所属线程和图编号。</li><li>graph_fusion：表示图融合。</li><li>ub_fusion：表示UB融合。</li><li>match_times：表示图编译过程中匹配到的融合规则次数。</li><li>effect_times：表示实际生效的次数。</li><li>repository_hit_times：优化UB融合知识库命中的次数。</li></ul>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p18191161717919"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p18191161717919"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p18191161717919"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b1125103610916"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b1125103610916"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b1125103610916"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002244692729_ul015116538916"></a><a name="zh-cn_topic_0000002244692729_ul015116538916"></a><ul id="zh-cn_topic_0000002244692729_ul015116538916"><li>0：不生成算子融合信息结果文件。</li><li>1：（默认值）程序运行正常退出时，生成算子融合信息结果文件。</li><li>2：图编译完成时，生成算子融合信息结果文件。即如果图编译已完成，后续程序提前中断，也会生成算子融合信息结果文件。</li></ul>
<div class="note" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note136881328182810"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note136881328182810"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_note136881328182810"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul2337143614287"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul2337143614287"></a><ul id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_ul2337143614287"><li>若未设置ASCEND_WORK_PATH环境变量，结果文件默认生成在执行脚本的当前路径；若设置了ASCEND_WORK_PATH环境变量，则保存路径为：$ASCEND_WORK_PATH/FE/${进程号}/fusion_result.json。环境变量详细说明请参见<span id="zh-cn_topic_0000002210430930_ph786881910545"><a name="zh-cn_topic_0000002210430930_ph786881910545"></a><a name="zh-cn_topic_0000002210430930_ph786881910545"></a>《环境变量参考》</span>。</li><li>通过FUSION_SWITCH_FILE参数关闭的融合规则，不会在fusion_result.json文件中呈现。</li></ul>
</div></div>
<p id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p83471930897"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p83471930897"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_p83471930897"></a><strong id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b142523366914"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b142523366914"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_b142523366914"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen1724535017100"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen1724535017100"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000002244692729_screen1724535017100"></a>{ge::ir_option::<span>OPTION_EXPORT_COMPILE_STAT</span>, "1"}</pre>
<p id="zh-cn_topic_0000002210430930_p174019436382"><a name="zh-cn_topic_0000002210430930_p174019436382"></a><a name="zh-cn_topic_0000002210430930_p174019436382"></a><span class="ddd" id="zh-cn_topic_0000002210430930_ph18740543123814"><a name="zh-cn_topic_0000002210430930_ph18740543123814"></a><a name="zh-cn_topic_0000002210430930_ph18740543123814"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430930_p1740143163812"><a name="zh-cn_topic_0000002210430930_p1740143163812"></a><a name="zh-cn_topic_0000002210430930_p1740143163812"></a><span id="zh-cn_topic_0000002210430930_ph14740194373811"><a name="zh-cn_topic_0000002210430930_ph14740194373811"></a><a name="zh-cn_topic_0000002210430930_ph14740194373811"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430930_p147402438382"><a name="zh-cn_topic_0000002210430930_p147402438382"></a><a name="zh-cn_topic_0000002210430930_p147402438382"></a><span id="zh-cn_topic_0000002210430930_ph20740843133814"><a name="zh-cn_topic_0000002210430930_ph20740843133814"></a><a name="zh-cn_topic_0000002210430930_ph20740843133814"></a><term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002210430930_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 精度调优<a name="section20106134414912"></a>

<a name="table18636182012508"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210590714_row78117164305"><th class="cellrowborder" valign="top" width="17.54%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002210590714_p168121613305"><a name="zh-cn_topic_0000002210590714_p168121613305"></a><a name="zh-cn_topic_0000002210590714_p168121613305"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="82.46%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002210590714_p118101618306"><a name="zh-cn_topic_0000002210590714_p118101618306"></a><a name="zh-cn_topic_0000002210590714_p118101618306"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210590714_row1811216133017"><td class="cellrowborder" valign="top" width="17.54%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590714_p4120105373018"><a name="zh-cn_topic_0000002210590714_p4120105373018"></a><a name="zh-cn_topic_0000002210590714_p4120105373018"></a>PRECISION_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="82.46%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_p1125212618154"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_p1125212618154"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_p1125212618154"></a>设置算子的精度模式。同一张图中不能与PRECISION_MODE_V2同时使用，建议使用PRECISION_MODE_V2参数。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p92511055184"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p92511055184"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p92511055184"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b325212551982"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b325212551982"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b325212551982"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_ul561918228306"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_ul561918228306"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0221674006_ul561918228306"><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b713235024011"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b713235024011"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b713235024011"></a>force_fp32/cube_fp16in_fp32out：</strong><div class="p" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p8537814448"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p8537814448"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p8537814448"></a>配置为force_fp32或cube_fp16in_fp32out，效果等同，该选项用来表示AI Core中该算子既支持float32又支持float16数据类型时，系统内部都会根据算子类型不同，选择不同的处理方式。cube_fp16in_fp32out为新版本中新增的，对于矩阵计算类算子，该选项语义更清晰。<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul169010276308"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul169010276308"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul169010276308"><li>对于矩阵计算类算子，系统内部会按算子实现的支持情况处理：<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ol6196318114911"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ol6196318114911"></a><ol id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ol6196318114911"><li>优先选择输入数据类型为float16且输出数据类型为float32；</li><li>如果1中的场景不支持，则选择输入数据类型为float32且输出数据类型为float32；</li><li>如果2中的场景不支持，则选择输入数据类型为float16且输出数据类型为float16；</li><li>如果3中的场景不支持，则报错。</li></ol>
</li><li>对于矢量计算类算子，表示原图中算子精度为float16或bfloat16，强制选择float32。<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p2355122020261"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p2355122020261"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p2355122020261"></a>如果原图中存在部分算子，在AI Core中该算子的实现不支持float32，比如某算子仅支持float16类型，则该参数不生效，仍然使用支持的float16；如果在AI Core中该算子的实现不支持float32，且又配置了黑名单（precision_reduce = false），则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</p>
</li></ul>
</div>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5998125544012"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5998125544012"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5998125544012"></a>force_fp16（默认值）：</strong><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p59818442401"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p59818442401"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p59818442401"></a>表示原图中算子精度为float16、bfloat16和float32时，强制选择float16。</p>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b8330648174120"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b8330648174120"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b8330648174120"></a>allow_fp32_to_fp16：</strong><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul777312334113"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul777312334113"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul777312334113"><li>对于矩阵类算子：<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6761514144114"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6761514144114"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6761514144114"><li>如果原图中算子精度为float32，优先降低精度到float16，如果AI Core中算子不支持float16，则继续选择float32，如果AI Core中算子不支持float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li>对于矢量类算子，优先保持原图精度：<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul464241443812"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul464241443812"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul464241443812"><li>如果原图中算子精度为float32，则优先使用原图精度float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5252156154212"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5252156154212"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b5252156154212"></a>must_keep_origin_dtype：</strong><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p20280144555815"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p20280144555815"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p20280144555815"></a>保持原图精度。</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul1619894955814"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul1619894955814"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul1619894955814"><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持float32和bfloat16，则系统内部会自动采用高精度float32。</li><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持bfloat16，则会使用float16的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中某算子精度为float32，AI Core中该算子的实现不支持float32类型、仅支持float16类型，则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b14329055205212"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b14329055205212"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b14329055205212"></a>allow_mix_precision/allow_mix_precision_fp16</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p13288949175211"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p13288949175211"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p13288949175211"></a>配置为allow_mix_precision或allow_mix_precision_fp16，效果等同，均表示使用混合精度float16、bfloat16和float32数据类型来处理神经网络的过程。allow_mix_precision_fp16为新版本中新增的，语义更清晰，便于理解。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p152814174917"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p152814174917"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p152814174917"></a>针对原始模型中float32和bfloat16数据类型的算子，按照内置的优化策略，自动将部分float32和bfloat16的算子降低精度到float16，从而在精度损失很小的情况下提升系统性能并减少内存使用。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p3445181144615"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p3445181144615"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p3445181144615"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph10562197165916"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph10562197165916"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i23791626927"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i23791626927"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i23791626927"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i163391631724"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i163391631724"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i163391631724"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname544591134619"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname544591134619"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname544591134619"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6368123316466"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6368123316466"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul6368123316466"><li>若取值为true（白名单），则表示允许将当前float32和bfloat16类型的算子，降低精度到float16。</li><li>若取值为false（黑名单），则不允许将当前float32和bfloat16类型的算子降低精度到float16，相应算子仍旧使用float32或bfloat16精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1133818511228"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1133818511228"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1133818511228"></a>allow_mix_precision_bf16：</strong><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p645755825314"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p645755825314"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p645755825314"></a>表示使用混合精度bfloat16和float32数据类型来处理神经网络的过程。针对原始模型中float32数据类型的算子，按照内置的优化策略，自动将部分float32的算子降低精度到bfloat16，从而在精度损失很小的情况下提升系统性能并减少内存使用；如果AI Core中算子不支持bfloat16和float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p7213919209"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p7213919209"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p7213919209"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph221381915016"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph221381915016"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph221381915016"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1843218381128"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1843218381128"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1843218381128"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1674910411524"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1674910411524"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_i1674910411524"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname6213141915012"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname6213141915012"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_parmname6213141915012"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul62133191409"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul62133191409"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul62133191409"><li>若取值为true（白名单），则表示允许将当前float32类型的算子，降低精度到<span>bfloat16</span>。</li><li>若取值为false（黑名单），则不允许将当前float32类型的算子降低精度到<span>bfloat16</span>，相应算子仍旧使用float32精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1845717283465"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1845717283465"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b1845717283465"></a>allow_fp32_to_bf16：</strong><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul139030935"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul139030935"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ul139030935"><li>如果原图中算子精度为float32，则优先使用原图精度float32，如果AI Core中算子不支持float32，则降低精度到bfloat16；如果AI Core中算子不支持bfloat16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1940315595482"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1940315595482"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1940315595482"></a>上述路径中的<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph18679216191916"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph18679216191916"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph18679216191916"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p51581537165"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p51581537165"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p51581537165"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b128608114171"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b128608114171"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b128608114171"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul7395714184513"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul7395714184513"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul7395714184513"><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b2777171963615"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b2777171963615"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_b2777171963615"></a>bfloat16数据类型仅支持以下<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph188916433619"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph188916433619"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph188916433619"></a>产品</span>类型</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p12643143517324"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p12643143517324"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p12643143517324"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph664353543215"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph664353543215"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph664353543215"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p18643735143214"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p18643735143214"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_p18643735143214"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph264323511325"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph264323511325"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_ph264323511325"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312392865_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li><li>该参数默认为性能优先，后续推理时可能会导致精度溢出问题。如果推理时出现精度问题，可以参见<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1088124112542"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1088124112542"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1088124112542"></a></span>进行定位。</li><li>如果用户聚焦精度问题，可以修改为其他取值，比如<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b16579597367"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b16579597367"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b16579597367"></a>must_keep_origin_dtype。</strong></li></ul>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p12841842122319"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p12841842122319"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p12841842122319"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b134207292415"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b134207292415"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b134207292415"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen38471262410"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen38471262410"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen38471262410"></a>{ge::ir_option::PRECISION_MODE, "force_fp16"}</pre>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p11928140131114"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p11928140131114"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p11928140131114"></a><span class="ddd" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1781213360551"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1781213360551"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1781213360551"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1292940171114"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1292940171114"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1292940171114"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph492919017113"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph492919017113"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph492919017113"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p990117412244"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p990117412244"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p990117412244"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph6606082511"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph6606082511"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph6606082511"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590714_row118110168304"><td class="cellrowborder" valign="top" width="17.54%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590714_p112496310438"><a name="zh-cn_topic_0000002210590714_p112496310438"></a><a name="zh-cn_topic_0000002210590714_p112496310438"></a>PRECISION_MODE_V2</p>
</td>
<td class="cellrowborder" valign="top" width="82.46%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p699817457497"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p699817457497"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p699817457497"></a>设置算子的精度模式。同一张图中不能与PRECISION_MODE同时使用，建议使用PRECISION_MODE_V2参数。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1896919461792"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1896919461792"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p1896919461792"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b278320541996"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b278320541996"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b278320541996"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul125913464499"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul125913464499"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul125913464499"><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b6133153320135"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b6133153320135"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b6133153320135"></a>fp16（默认值）</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p37316156141"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p37316156141"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p37316156141"></a>表示原图中算子精度为float16、bfloat16或float32时，强制选择float16。</p>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9661017144"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9661017144"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9661017144"></a>origin</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p10420443128"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p10420443128"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p10420443128"></a>保持原图精度。</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul1872113713125"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul1872113713125"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul1872113713125"><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持float32和bfloat16，则系统内部会自动采用高精度float32。</li><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持bfloat16，则会使用float16的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中某算子精度为float32，AI Core中该算子的实现不支持float32类型、仅支持float16类型，则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1091213018170"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1091213018170"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1091213018170"></a>cube_fp16in_fp32out</strong>：<div class="p" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1372204971913"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1372204971913"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1372204971913"></a>AI Core中该算子既支持float32又支持float16数据类型时，系统内部根据算子类型不同，选择不同的处理方式。<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul169010276308"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul169010276308"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul169010276308"><li>对于矩阵计算类算子，系统内部会按算子实现的支持情况处理：<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ol6196318114911"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ol6196318114911"></a><ol id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ol6196318114911"><li>优先选择输入数据类型为float16且输出数据类型为float32；</li><li>如果1中的场景不支持，则选择输入数据类型为float32且输出数据类型为float32；</li><li>如果2中的场景不支持，则选择输入数据类型为float16且输出数据类型为float16；</li><li>如果3中的场景不支持，则报错。</li></ol>
</li><li>对于矢量计算类算子，表示原图中算子精度为float16或bfloat16，强制选择float32。<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p2355122020261"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p2355122020261"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p2355122020261"></a>如果原图中存在部分算子，在AI Core中该算子的实现不支持float32，比如某算子仅支持float16类型，则该参数不生效，仍然使用支持的float16；如果在AI Core中该算子的实现不支持float32，且又配置了黑名单（precision_reduce = false），则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</p>
</li></ul>
</div>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1113215426233"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1113215426233"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b1113215426233"></a>mixed_float16</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p13288949175211"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p13288949175211"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p13288949175211"></a>表示使用混合精度float16、bfloat16和float32数据类型来处理神经网络。针对原图中float32和bfloat16数据类型的算子，按照内置的优化策略，自动将部分float32和<span>bfloat16</span>的算子降低精度到float16，从而在精度损失很小的情况下提升系统性能并减少内存使用。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p3445181144615"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p3445181144615"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p3445181144615"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph10562197165916"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph10562197165916"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i820814615314"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i820814615314"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i820814615314"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i76815552310"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i76815552310"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i76815552310"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname544591134619"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname544591134619"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname544591134619"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul6368123316466"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul6368123316466"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul6368123316466"><li>若取值为true（白名单），则表示允许将当前float32和<span>bfloat16</span>类型的算子，降低精度到float16。</li><li>若取值为false（黑名单），则不允许将当前float32和<span>bfloat16</span>类型的算子降低精度到float16，相应算子仍旧使用float32或<span>bfloat16</span>精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b4594173711235"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b4594173711235"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b4594173711235"></a>mixed_bfloat16</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p645755825314"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p645755825314"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p645755825314"></a>表示使用混合精度bfloat16和float32数据类型来处理神经网络。针对原图中float32数据类型的算子，按照内置的优化策略，自动将部分float32的算子降低精度到<span>bfloat16</span>，从而在精度损失很小的情况下提升系统性能并减少内存使用；<span>如果算子不支持bfloat16和</span>float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p7213919209"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p7213919209"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p7213919209"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph221381915016"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph221381915016"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph221381915016"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i1666213581835"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i1666213581835"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i1666213581835"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i3293221441"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i3293221441"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i3293221441"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname6213141915012"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname6213141915012"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_parmname6213141915012"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul62133191409"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul62133191409"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul62133191409"><li>若取值为true（白名单），则表示允许将当前float32类型的算子，降低精度到<span>bfloat16</span>。</li><li>若取值为false（黑名单），则不允许将当前float32类型的算子降低精度到<span>bfloat16</span>，相应算子仍旧使用float32精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b7210361631"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b7210361631"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b7210361631"></a>mixed_hif8：</strong><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p148818611318"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p148818611318"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p148818611318"></a>开启自动混合精度功能，表示混合使用hifloat8（此数据类型介绍可参见<a href="https://arxiv.org/abs/2409.16626?context=cs.AR" target="_blank" rel="noopener noreferrer">Link</a>）、float16、bfloat16和float32数据类型来处理神经网络。针对原图中float16、bfloat16和float32数据类型的算子，按照内置的优化策略，自动将部分float16、bfloat16和float32的算子降低精度到hifloat8，从而在精度损失很小的情况下提升系统性能并减少内存使用。<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9699153118144"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9699153118144"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b9699153118144"></a>当前版本不支持该选项。</strong></p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1110861315594"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1110861315594"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1110861315594"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph189988304592"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph189988304592"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph189988304592"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i7381282415"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i7381282415"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i7381282415"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i10251311246"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i10251311246"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_i10251311246"></a>xxx</em>-ops-info.json内置优化策略文件中查看“<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b19575163635912"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b19575163635912"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b19575163635912"></a>precision_reduce</strong>”参数的取值：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul176671048185911"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul176671048185911"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ul176671048185911"><li>若取值为true（白名单），则表示允许将当前float16、<span>bfloat16</span>和float32类型的算子，降低精度到hifloat8。</li><li>若取值为false（黑名单），则不允许将当前float16、<span>bfloat16</span>和float32类型的算子降低精度到hifloat8，相应算子仍旧使用float16、<span>bfloat16</span>或float32精度。</li><li>若原图中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b760013935811"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b760013935811"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b760013935811"></a>cube_hif8</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1165518421944"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1165518421944"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p1165518421944"></a>表示若原图中的cube算子既支持hifloat8，又支持float16、bfloat16或float32数据类型时，强制选择hifloat8数据类型。<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b0246174891418"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b0246174891418"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b0246174891418"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b18340134731515"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b18340134731515"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b18340134731515"></a>当前版本不支持该选项。</strong></strong></p>
</li></ul>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p584125874719"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p584125874719"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p584125874719"></a>上述路径中的<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph584125819476"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph584125819476"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph584125819476"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p637365954916"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p637365954916"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p637365954916"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b6373195914911"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b6373195914911"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b6373195914911"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul185899558189"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul185899558189"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul185899558189"><li><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b2777171963615"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b2777171963615"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_b2777171963615"></a>bfloat16数据类型仅支持以下<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph12992932183619"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph12992932183619"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph12992932183619"></a>产品</span>类型</strong>：<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p12643143517324"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p12643143517324"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p12643143517324"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph664353543215"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph664353543215"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph664353543215"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p18643735143214"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p18643735143214"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_p18643735143214"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph264323511325"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph264323511325"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_ph264323511325"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001653452773_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li><li>该参数默认为性能优先，后续推理时可能会导致精度溢出问题。如果推理时出现精度问题，可以参见<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph13589755171818"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph13589755171818"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph13589755171818"></a></span>进行定位。</li><li>如果用户聚焦精度问题，可以修改为其他取值，比如<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b2589135515183"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b2589135515183"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b2589135515183"></a>origin。</strong></li></ul>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p524904152417"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p524904152417"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p524904152417"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b8249104102419"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b8249104102419"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b8249104102419"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen10249124122417"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen10249124122417"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen10249124122417"></a>{ge::ir_option::PRECISION_MODE_V2, "fp16"}</pre>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p16373115964914"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p16373115964914"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p16373115964914"></a><span class="ddd" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph276254925519"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph276254925519"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph276254925519"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p10374195918493"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p10374195918493"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p10374195918493"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1137415934919"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1137415934919"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph1137415934919"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p7611105615253"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p7611105615253"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p7611105615253"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph107114512264"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph107114512264"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph107114512264"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590714_row881181643010"><td class="cellrowborder" valign="top" width="17.54%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590714_p186126398296"><a name="zh-cn_topic_0000002210590714_p186126398296"></a><a name="zh-cn_topic_0000002210590714_p186126398296"></a>MODIFY_MIXLIST</p>
</td>
<td class="cellrowborder" valign="top" width="82.46%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p14117102244"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p14117102244"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p14117102244"></a>混合精度场景下，通过此参数指定混合精度黑白灰名单的路径以及文件名，自行指定哪些算子允许降精度，哪些算子不允许降精度。配置为路径以及文件名，文件为JSON格式。黑白灰名单，可从“<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph123231510175111"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph123231510175111"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph123231510175111"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i6494142591118"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i6494142591118"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i6494142591118"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i437512338114"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i437512338114"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i437512338114"></a>xxx</em>-ops-info.json”内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_parmname193238108518"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_parmname193238108518"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_parmname193238108518"></a>“precision_reduce”</span>参数下的flag参数值（其中，<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph6491162165318"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph6491162165318"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph6491162165318"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i129552245219"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i129552245219"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_i129552245219"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph20833205312295"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph20833205312295"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph20833205312295"></a>产品</span>进行选择。）：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul1473622618190"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul1473622618190"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul1473622618190"><li>若取值为true（白名单），表示混合精度模式下，<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b2304123420539"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b2304123420539"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b2304123420539"></a>允许</strong>降低精度。</li><li>若取值为false（黑名单），表示混合精度模式下，<strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b04811035105314"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b04811035105314"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001265073942_b04811035105314"></a>不允许</strong>降低精度。</li><li>不配置该参数（灰名单），表示混合精度模式下，当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p857043611144"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p857043611144"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p857043611144"></a>开启混合精度方式：</p>
<a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul116125356314"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul116125356314"></a><ul id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ul116125356314"><li>PRECISION_MODE参数设置为allow_mix_precision、allow_mix_precision_fp16、allow_mix_precision_bf16。</li><li>PRECISION_MODE_V2参数设置为mixed_float16、mixed_bfloat16、，与PRECISION_MODE参数不能同时配置，建议使用PRECISION_MODE_V2。</li></ul>
<div class="p" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p489982953315"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p489982953315"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p489982953315"></a><strong id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b877823617428"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b877823617428"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_b877823617428"></a>配置示例：</strong><pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen689942912339"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen689942912339"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen689942912339"></a>{ge::ir_option::MODIFY_MIXLIST, "/home/test/ops_info.json"}</pre>
</div>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p889922918332"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p889922918332"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p889922918332"></a>ops_info.json中可以指定算子类型，多个算子使用英文逗号分隔，样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen15227852153611"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen15227852153611"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_screen15227852153611"></a>{
  "black-list": {                  // 黑名单
     "to-remove": [                // 黑名单算子转换为灰名单算子，配置该参数时，请确保被转换的算子已经存在于黑名单中
     "Xlog1py"
     ],
     "to-add": [                   // 白名单或灰名单算子转换为黑名单算子
     "Matmul",
     "Cast"
     ]
  },
  "white-list": {                  // 白名单
     "to-remove": [                // 白名单算子转换为灰名单算子，配置该参数时，请确保被转换的算子已经存在于白名单中 
     "Conv2D"
     ],
     "to-add": [                   // 黑名单或灰名单算子转换为白名单算子
     "Bias"
     ]
  }
}</pre>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_p1785210112503"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_p1785210112503"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_p1785210112503"></a>上述配置文件样例中展示的算子仅作为参考，请基于实际硬件环境和具体的算子内置优化策略进行配置，黑白灰名单查询样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_screen11429186175017"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_screen11429186175017"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0228309389_screen11429186175017"></a>"Conv2D":{
    "precision_reduce":{
        "flag":"true"
     }
},</pre>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p55361828162011"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p55361828162011"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p55361828162011"></a>true：白名单。false：黑名单。不配置：灰名单。</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p119878506533"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p119878506533"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p119878506533"></a><span class="ddd" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph144037315572"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph144037315572"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph144037315572"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p16109137205712"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p16109137205712"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p16109137205712"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph131091078578"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph131091078578"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph131091078578"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p7109117165713"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p7109117165713"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_p7109117165713"></a><span id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph81101795711"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph81101795711"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_ph81101795711"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000002209652690_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590714_row281181653011"><td class="cellrowborder" valign="top" width="17.54%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590714_p12591105045615"><a name="zh-cn_topic_0000002210590714_p12591105045615"></a><a name="zh-cn_topic_0000002210590714_p12591105045615"></a>CUSTOMIZE_DTYPES</p>
</td>
<td class="cellrowborder" valign="top" width="82.46%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590714_p1187712513152"><a name="zh-cn_topic_0000002210590714_p1187712513152"></a><a name="zh-cn_topic_0000002210590714_p1187712513152"></a>通过该参数自定义模型编译时算子的计算精度，模型中其他算子以PRECISION_MODE或PRECISION_MODE_V2指定的精度模式进行编译。该参数需要配置为配置文件路径及文件名，例如：/home/test/customize_dtypes.cfg。</p>
<p id="zh-cn_topic_0000002210590714_p1950952316389"><a name="zh-cn_topic_0000002210590714_p1950952316389"></a><a name="zh-cn_topic_0000002210590714_p1950952316389"></a><strong id="zh-cn_topic_0000002210590714_b1788773417386"><a name="zh-cn_topic_0000002210590714_b1788773417386"></a><a name="zh-cn_topic_0000002210590714_b1788773417386"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210590714_ul064143915385"></a><a name="zh-cn_topic_0000002210590714_ul064143915385"></a><ul id="zh-cn_topic_0000002210590714_ul064143915385"><li>配置文件中列举需要自定义计算精度的算子名称或算子类型，每个算子单独一行，且算子类型必须为基于IR定义的算子的类型。</li><li>对于同一个算子，如果同时配置了算子名称和算子类型，编译时以算子名称为准。</li><li>指定某个算子的计算精度时，如果算子编译过程中该算子被融合掉，则该算子指定的计算精度不生效。</li></ul>
<p id="zh-cn_topic_0000002210590714_p97209557014"><a name="zh-cn_topic_0000002210590714_p97209557014"></a><a name="zh-cn_topic_0000002210590714_p97209557014"></a>配置文件格式要求：</p>
<pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_screen1111811011710"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_screen1111811011710"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_screen1111811011710"></a># 按照算子名称配置
<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i348131516582"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i348131516582"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i348131516582"></a>Opname1</em>::InputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i6372172415582"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i6372172415582"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i6372172415582"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i249792985811"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i249792985811"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i249792985811"></a>dtype1,…</em>
<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i161501785817"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i161501785817"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i161501785817"></a>Opname2</em>::InputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i116198268589"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i116198268589"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i116198268589"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i141196328581"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i141196328581"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i141196328581"></a>dtype1,…</em>
# 按照算子类型配置
OpType::<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i58992655812"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i58992655812"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i58992655812"></a>TypeName1</em>:InputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i791815516598"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i791815516598"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i791815516598"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i0350115610573"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i0350115610573"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i0350115610573"></a>dtype1,…</em>
OpType::<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i104981397582"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i104981397582"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i104981397582"></a>TypeName2</em>:InputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i132335593574"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i132335593574"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i132335593574"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i52771811583"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i52771811583"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_i52771811583"></a>dtype1,…</em></pre>
<p id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_p14821143063816"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_p14821143063816"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_p14821143063816"></a>配置文件配置示例：</p>
<pre class="screen" id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_screen1766716429819"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_screen1766716429819"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001265073950_screen1766716429819"></a># 按照算子名称配置
resnet_v1_50/block1/unit_3/bottleneck_v1/Relu::InputDtype:float16,int8,OutputDtype:float16,int8
# 按照算子类型配置
OpType::Relu:InputDtype:float16,int8,OutputDtype:float16,int8</pre>
<div class="note" id="zh-cn_topic_0000002210590714_note2095432191110"><a name="zh-cn_topic_0000002210590714_note2095432191110"></a><a name="zh-cn_topic_0000002210590714_note2095432191110"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210590714_ul10785154313716"></a><a name="zh-cn_topic_0000002210590714_ul10785154313716"></a><ul id="zh-cn_topic_0000002210590714_ul10785154313716"><li>算子具体支持的计算精度可以从算子信息库中查看，默认存储路径为：<span id="zh-cn_topic_0000002210590714_ph204751948121415"><a name="zh-cn_topic_0000002210590714_ph204751948121415"></a><a name="zh-cn_topic_0000002210590714_ph204751948121415"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002210590714_i0397247191715"><a name="zh-cn_topic_0000002210590714_i0397247191715"></a><a name="zh-cn_topic_0000002210590714_i0397247191715"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002210590714_i78626493172"><a name="zh-cn_topic_0000002210590714_i78626493172"></a><a name="zh-cn_topic_0000002210590714_i78626493172"></a>xxx</em>-ops-info.json。<p id="zh-cn_topic_0000002210590714_p1127562655516"><a name="zh-cn_topic_0000002210590714_p1127562655516"></a><a name="zh-cn_topic_0000002210590714_p1127562655516"></a><span id="zh-cn_topic_0000002210590714_ph1027510266551"><a name="zh-cn_topic_0000002210590714_ph1027510266551"></a><a name="zh-cn_topic_0000002210590714_ph1027510266551"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002210590714_i163451116125616"><a name="zh-cn_topic_0000002210590714_i163451116125616"></a><a name="zh-cn_topic_0000002210590714_i163451116125616"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002210590714_ph10345171612561"><a name="zh-cn_topic_0000002210590714_ph10345171612561"></a><a name="zh-cn_topic_0000002210590714_ph10345171612561"></a>产品</span>进行选择。</p>
</li><li>通过该参数指定的优先级高，因此可能会导致精度/性能的下降，如果指定的dtype不支持，会导致编译失败。</li></ul>
</div></div>
<p id="zh-cn_topic_0000002210590714_p366143318300"><a name="zh-cn_topic_0000002210590714_p366143318300"></a><a name="zh-cn_topic_0000002210590714_p366143318300"></a><strong id="zh-cn_topic_0000002210590714_b19937192319307"><a name="zh-cn_topic_0000002210590714_b19937192319307"></a><a name="zh-cn_topic_0000002210590714_b19937192319307"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590714_screen1549575119303"><a name="zh-cn_topic_0000002210590714_screen1549575119303"></a><a name="zh-cn_topic_0000002210590714_screen1549575119303"></a>{ge::ir_option::CUSTOMIZE_DTYPES, "/home/test/customize_dtypes.cfg"}</pre>
<p id="zh-cn_topic_0000002210590714_p966738839"><a name="zh-cn_topic_0000002210590714_p966738839"></a><a name="zh-cn_topic_0000002210590714_p966738839"></a><span class="ddd" id="zh-cn_topic_0000002210590714_ph1294019435116"><a name="zh-cn_topic_0000002210590714_ph1294019435116"></a><a name="zh-cn_topic_0000002210590714_ph1294019435116"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590714_p1356916614379"><a name="zh-cn_topic_0000002210590714_p1356916614379"></a><a name="zh-cn_topic_0000002210590714_p1356916614379"></a><span id="zh-cn_topic_0000002210590714_ph1856914663716"><a name="zh-cn_topic_0000002210590714_ph1856914663716"></a><a name="zh-cn_topic_0000002210590714_ph1856914663716"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590714_p65695693719"><a name="zh-cn_topic_0000002210590714_p65695693719"></a><a name="zh-cn_topic_0000002210590714_p65695693719"></a><span id="zh-cn_topic_0000002210590714_ph12569166173720"><a name="zh-cn_topic_0000002210590714_ph12569166173720"></a><a name="zh-cn_topic_0000002210590714_ph12569166173720"></a><term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590714_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 精度比对<a name="section189629470495"></a>

<a name="table107682265019"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245510781_row75481504310"><th class="cellrowborder" valign="top" width="19.650000000000002%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002245510781_p1548105013117"><a name="zh-cn_topic_0000002245510781_p1548105013117"></a><a name="zh-cn_topic_0000002245510781_p1548105013117"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="80.35%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002245510781_p154811509314"><a name="zh-cn_topic_0000002245510781_p154811509314"></a><a name="zh-cn_topic_0000002245510781_p154811509314"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245510781_row185483509316"><td class="cellrowborder" valign="top" width="19.650000000000002%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510781_p116362115571"><a name="zh-cn_topic_0000002245510781_p116362115571"></a><a name="zh-cn_topic_0000002245510781_p116362115571"></a>QUANT_DUMPABLE</p>
</td>
<td class="cellrowborder" valign="top" width="80.35%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510781_p493801713309"><a name="zh-cn_topic_0000002245510781_p493801713309"></a><a name="zh-cn_topic_0000002245510781_p493801713309"></a>是否采集量化算子的dump数据。</p>
<p id="zh-cn_topic_0000002245510781_p4628233154411"><a name="zh-cn_topic_0000002245510781_p4628233154411"></a><a name="zh-cn_topic_0000002245510781_p4628233154411"></a>参考<span id="zh-cn_topic_0000002245510781_ph1075716510011"><a name="zh-cn_topic_0000002245510781_ph1075716510011"></a><a name="zh-cn_topic_0000002245510781_ph1075716510011"></a>《应用开发指南 (C&amp;C++)》</span>手册中的<span id="zh-cn_topic_0000002245510781_ph1088124112542"><a name="zh-cn_topic_0000002245510781_ph1088124112542"></a><a name="zh-cn_topic_0000002245510781_ph1088124112542"></a></span>章节进行精度定位时，如果存在<span id="zh-cn_topic_0000002245510781_ph7680131444418"><a name="zh-cn_topic_0000002245510781_ph7680131444418"></a><a name="zh-cn_topic_0000002245510781_ph7680131444418"></a>AMCT</span>量化后的模型，该模型转成om离线模型时，图编译过程中可能优化量化算子的输入输出，从而影响量化算子dump数据的导出，例如：两个被量化的卷积计算，中间输出被优化为int8的量化后输出。</p>
<p id="zh-cn_topic_0000002245510781_p18991452151111"><a name="zh-cn_topic_0000002245510781_p18991452151111"></a><a name="zh-cn_topic_0000002245510781_p18991452151111"></a>为此引入QUANT_DUMPABLE参数，使能该参数后，量化算子的输入输出不做融合，并且会插入transdata算子，还原原始模型的格式，从而能采集到量化算子的dump数据。</p>
<p id="zh-cn_topic_0000002245510781_p1891054619571"><a name="zh-cn_topic_0000002245510781_p1891054619571"></a><a name="zh-cn_topic_0000002245510781_p1891054619571"></a><strong id="zh-cn_topic_0000002245510781_b838124165819"><a name="zh-cn_topic_0000002245510781_b838124165819"></a><a name="zh-cn_topic_0000002245510781_b838124165819"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245510781_ul6780152625814"></a><a name="zh-cn_topic_0000002245510781_ul6780152625814"></a><ul id="zh-cn_topic_0000002245510781_ul6780152625814"><li>0：（默认值）图编译过程中可能优化量化算子的输入输出，此时无法获取量化算子的dump数据。</li><li>1：开启此配置后，可确保能够采集量化算子的dump数据。</li></ul>
<p id="zh-cn_topic_0000002245510781_p1960712012011"><a name="zh-cn_topic_0000002245510781_p1960712012011"></a><a name="zh-cn_topic_0000002245510781_p1960712012011"></a><strong id="zh-cn_topic_0000002245510781_b9774108111012"><a name="zh-cn_topic_0000002245510781_b9774108111012"></a><a name="zh-cn_topic_0000002245510781_b9774108111012"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245510781_screen15685350301"><a name="zh-cn_topic_0000002245510781_screen15685350301"></a><a name="zh-cn_topic_0000002245510781_screen15685350301"></a>{ge::ir_option::QUANT_DUMPABLE, "1"}</pre>
<p id="zh-cn_topic_0000002245510781_p2090419381306"><a name="zh-cn_topic_0000002245510781_p2090419381306"></a><a name="zh-cn_topic_0000002245510781_p2090419381306"></a><span class="ddd" id="zh-cn_topic_0000002245510781_ph159046381802"><a name="zh-cn_topic_0000002245510781_ph159046381802"></a><a name="zh-cn_topic_0000002245510781_ph159046381802"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510781_p1934215293388"><a name="zh-cn_topic_0000002245510781_p1934215293388"></a><a name="zh-cn_topic_0000002245510781_p1934215293388"></a><span id="zh-cn_topic_0000002245510781_ph6342132973811"><a name="zh-cn_topic_0000002245510781_ph6342132973811"></a><a name="zh-cn_topic_0000002245510781_ph6342132973811"></a><term id="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245510781_p1334252916382"><a name="zh-cn_topic_0000002245510781_p1334252916382"></a><a name="zh-cn_topic_0000002245510781_p1334252916382"></a><span id="zh-cn_topic_0000002245510781_ph173421229173816"><a name="zh-cn_topic_0000002245510781_ph173421229173816"></a><a name="zh-cn_topic_0000002245510781_ph173421229173816"></a><term id="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245510781_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 性能调优<a name="section1644165554920"></a>

<a name="table19998172314502"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210430934_row1463704011343"><th class="cellrowborder" valign="top" width="21%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002210430934_p563794073416"><a name="zh-cn_topic_0000002210430934_p563794073416"></a><a name="zh-cn_topic_0000002210430934_p563794073416"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="79%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002210430934_p2637124093414"><a name="zh-cn_topic_0000002210430934_p2637124093414"></a><a name="zh-cn_topic_0000002210430934_p2637124093414"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210430934_row1163716403347"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430934_p16226154162017"><a name="zh-cn_topic_0000002210430934_p16226154162017"></a><a name="zh-cn_topic_0000002210430934_p16226154162017"></a>OP_PRECISION_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430934_p18512585359"><a name="zh-cn_topic_0000002210430934_p18512585359"></a><a name="zh-cn_topic_0000002210430934_p18512585359"></a>设置指定算子内部处理时的精度模式，支持指定一个算子或多个算子。通过该参数传入自定义的精度模式配置文件op_precision.ini，可以为不同的算子设置不同的精度模式。</p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p338552241016"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p338552241016"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p338552241016"></a>配置文件中支持设置如下精度模式：</p>
<a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ul16639842135612"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ul16639842135612"></a><ul id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ul16639842135612"><li>high_precision：表示高精度。</li><li>high_performance：表示高性能。</li><li>enable_float_32_execution：算子内部处理时使用FP32数据类型功能，该场景下FP32数据类型不会自动转换为HF32数据类型；若使用HF32计算，精度损失超过预期时，可启用该配置，指定部分算子内部计算时使用FP32，保持精度。<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p6661125485513"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p6661125485513"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p6661125485513"></a><strong id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b101171430566"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b101171430566"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b101171430566"></a>该选项仅支持以下<span id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph20833205312295"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph20833205312295"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph20833205312295"></a>产品</span>类型：</strong></p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p59938817569"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p59938817569"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p59938817569"></a><span id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph7427131311565"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph7427131311565"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph7427131311565"></a><term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p4838111945615"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p4838111945615"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p4838111945615"></a><span id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph13754548217"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph13754548217"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_ph13754548217"></a><term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li><li>enable_hi_float_32_execution：算子内部处理时使用HF32数据类型功能，使能后，FP32数据类型自动转换为HF32数据类型；该配置可以降低数据所占空间大小，实现性能提升。<strong id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b227075034919"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b227075034919"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b227075034919"></a>当前版本暂不支持。</strong></li><li>support_out_of_bound_index：表示对gather、scatter和segment类算子的indices输入进行越界校验，校验会降低算子的执行性能。</li><li>keep_fp16：算子内部处理时使用FP16数据类型功能，该场景下FP16数据类型不会自动转换为FP32数据类型；若使用FP32计算时性能不满足预期，同时精度要求不高情况下，可以选择keep_fp16模式，<strong id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b1721392915415"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b1721392915415"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_b1721392915415"></a>牺牲精度提升性能，不建议使用该低精度模式</strong>。</li><li>super_performance：表示超高性能，和高性能相比，在算法计算公式上进行了优化。</li></ul>
<p id="zh-cn_topic_0000002210430934_p765645284716"><a name="zh-cn_topic_0000002210430934_p765645284716"></a><a name="zh-cn_topic_0000002210430934_p765645284716"></a>具体某个算子支持配置的精度/性能模式取值，可以通过CANN软件安装后文件存储路径的opp/built-in/op_impl/ai_core/tbe/impl_mode/all_ops_impl_mode.ini文件查看。</p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p74141159433"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p74141159433"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_p74141159433"></a><strong id="zh-cn_topic_0000002210430934_b1838112554316"><a name="zh-cn_topic_0000002210430934_b1838112554316"></a><a name="zh-cn_topic_0000002210430934_b1838112554316"></a>样例如下：</strong>ini文件中按照算子类型、节点名称设置精度模式，每一行设置一个算子类型或节点名称的精度模式，<strong id="zh-cn_topic_0000002210430934_b119082509449"><a name="zh-cn_topic_0000002210430934_b119082509449"></a><a name="zh-cn_topic_0000002210430934_b119082509449"></a>按节点名称设置精度模式的优先级高于按算子类型</strong>。</p>
<pre class="screen" id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_screen71961947803"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_screen71961947803"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_screen71961947803"></a>[ByOpType]
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i48893316212"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i48893316212"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i48893316212"></a>optype1</em>=high_precision
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i58891631220"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i58891631220"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i58891631220"></a>optype2</em>=high_performance
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i734314223467"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i734314223467"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i734314223467"></a>optype3</em>=enable_hi_float_32_execution
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i11382174217311"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i11382174217311"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i11382174217311"></a>optype4</em>=support_out_of_bound_index

[ByNodeName]
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i1241611183288"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i1241611183288"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i1241611183288"></a>nodename1</em>=high_precision
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i14485655192912"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i14485655192912"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i14485655192912"></a>nodename2</em>=high_performance
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i18104357134619"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i18104357134619"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i18104357134619"></a>nodename3</em>=enable_hi_float_32_execution
<em id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i3266115417"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i3266115417"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312392881_i3266115417"></a>nodename4</em>=support_out_of_bound_index</pre>
<p id="zh-cn_topic_0000002210430934_p57017326408"><a name="zh-cn_topic_0000002210430934_p57017326408"></a><a name="zh-cn_topic_0000002210430934_p57017326408"></a><strong id="zh-cn_topic_0000002210430934_b336063610404"><a name="zh-cn_topic_0000002210430934_b336063610404"></a><a name="zh-cn_topic_0000002210430934_b336063610404"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210430934_ul78728391405"></a><a name="zh-cn_topic_0000002210430934_ul78728391405"></a><ul id="zh-cn_topic_0000002210430934_ul78728391405"><li>该参数不能与OP_SELECT_IMPL_MODE、OPTYPELIST_FOR_IMPLMODE参数同时使用，若三个参数同时配置，则只有OP_PRECISION_MODE参数指定的模式生效。</li><li>针对同一个算子，如果通过OP_PRECISION_MODE数配置了enable_hi_float_32_execution或enable_float_32_execution，该场景下不建议再与ALLOW_HF32参数同时使用，若同时使用，则优先级如下：<p id="zh-cn_topic_0000002210430934_p2373954154019"><a name="zh-cn_topic_0000002210430934_p2373954154019"></a><a name="zh-cn_topic_0000002210430934_p2373954154019"></a>op_precision_mode(ByNodeName，按节点名称设置精度模式) <strong id="zh-cn_topic_0000002210430934_b1182295410167"><a name="zh-cn_topic_0000002210430934_b1182295410167"></a><a name="zh-cn_topic_0000002210430934_b1182295410167"></a>&gt;</strong> allow_hf32 <strong id="zh-cn_topic_0000002210430934_b11411576163"><a name="zh-cn_topic_0000002210430934_b11411576163"></a><a name="zh-cn_topic_0000002210430934_b11411576163"></a>&gt; </strong>op_precision_mode(ByOpType，按算子类型设置精度模式)</p>
</li><li>该参数不建议配置，若使用高性能或者高精度模式，网络性能或者精度不是最优，则可以使用该参数，通过配置ini文件调整某个具体算子的精度模式。</li></ul>
<p id="zh-cn_topic_0000002210430934_p1766732652617"><a name="zh-cn_topic_0000002210430934_p1766732652617"></a><a name="zh-cn_topic_0000002210430934_p1766732652617"></a><span class="ddd" id="zh-cn_topic_0000002210430934_ph295013261513"><a name="zh-cn_topic_0000002210430934_ph295013261513"></a><a name="zh-cn_topic_0000002210430934_ph295013261513"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430934_p92271734153614"><a name="zh-cn_topic_0000002210430934_p92271734153614"></a><a name="zh-cn_topic_0000002210430934_p92271734153614"></a><span id="zh-cn_topic_0000002210430934_ph5227123403615"><a name="zh-cn_topic_0000002210430934_ph5227123403615"></a><a name="zh-cn_topic_0000002210430934_ph5227123403615"></a><term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430934_p14227183417367"><a name="zh-cn_topic_0000002210430934_p14227183417367"></a><a name="zh-cn_topic_0000002210430934_p14227183417367"></a><span id="zh-cn_topic_0000002210430934_ph142278342365"><a name="zh-cn_topic_0000002210430934_ph142278342365"></a><a name="zh-cn_topic_0000002210430934_ph142278342365"></a><term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210430934_row11637144018344"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210430934_p1112256164619"><a name="zh-cn_topic_0000002210430934_p1112256164619"></a><a name="zh-cn_topic_0000002210430934_p1112256164619"></a>TILING_SCHEDULE_OPTIMIZE</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p1039973613417"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p1039973613417"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p1039973613417"></a>Tiling下沉调度优化开关。</p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p62167612117"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p62167612117"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p62167612117"></a>由于NPU中AI Core内部存储无法完全容纳算子输入输出的所有数据，需要每次搬运一部分输入数据进行计算然后搬出，再搬运下一部分输入数据进行计算，该过程称之为Tiling；根据算子的shape等信息来确定数据切分算法相关参数（比如每次搬运的块大小，以及总共循环多少次）的计算程序，称之为Tiling实现。由于Tiling实现中完成的均为标量计算，AI Core并不擅长，故一般在Host侧CPU上执行，但是满足下述条件Tiling实现会下沉到Device侧执行：</p>
<a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ol19579144632417"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ol19579144632417"></a><ol id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ol19579144632417"><li>模型为静态shape。</li><li>模型中的算子支持Tiling下沉，比如FusedInferAttentionScore、IncreFlashAttention等融合算子。</li><li>支持Tiling下沉的算子值有依赖，需要满足前一个算子的值有device的执行结果；如果依赖的值是Const，则不需要下沉执行Tiling，编译时会完成Tiling。</li></ol>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p9738449125019"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p9738449125019"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p9738449125019"></a><strong id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_b112031810522"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_b112031810522"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_b112031810522"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ul1198512934019"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ul1198512934019"></a><ul id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ul1198512934019"><li>0：关闭Tiling下沉，默认为0。</li><li>1：使能Tiling下沉。</li></ul>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p0621533512"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p0621533512"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p0621533512"></a><strong id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_b1321171845212"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_b1321171845212"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_b1321171845212"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_screen246223217523"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_screen246223217523"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_screen246223217523"></a>{ge::ir_option::TILING_SCHEDULE_OPTIMIZE, "1"}</pre>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p929316295319"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p929316295319"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p929316295319"></a><span class="ddd" id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph52930218533"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph52930218533"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph52930218533"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p142931427534"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p142931427534"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p142931427534"></a><span id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph132932295312"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph132932295312"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph132932295312"></a><term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p162937205313"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p162937205313"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_p162937205313"></a><span id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph92931924531"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph92931924531"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_ph92931924531"></a><term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210430934_zh-cn_topic_0000002244572905_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## AOE<a name="section6351125134916"></a>

<a name="table4791323175014"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245550909_row8847152093314"><th class="cellrowborder" valign="top" width="20.46%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002245550909_p1984715205339"><a name="zh-cn_topic_0000002245550909_p1984715205339"></a><a name="zh-cn_topic_0000002245550909_p1984715205339"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="79.54%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002245550909_p18847220113312"><a name="zh-cn_topic_0000002245550909_p18847220113312"></a><a name="zh-cn_topic_0000002245550909_p18847220113312"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245550909_row1471490163417"><td class="cellrowborder" valign="top" width="20.46%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550909_p7590143713142"><a name="zh-cn_topic_0000002245550909_p7590143713142"></a><a name="zh-cn_topic_0000002245550909_p7590143713142"></a>MDL_BANK_PATH</p>
</td>
<td class="cellrowborder" valign="top" width="79.54%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550909_p187471149172620"><a name="zh-cn_topic_0000002245550909_p187471149172620"></a><a name="zh-cn_topic_0000002245550909_p187471149172620"></a>加载子图调优后自定义知识库的路径。</p>
<p id="zh-cn_topic_0000002245550909_p115703321007"><a name="zh-cn_topic_0000002245550909_p115703321007"></a><a name="zh-cn_topic_0000002245550909_p115703321007"></a>该参数需要与<a href="aclgrphBuildInitialize支持的配置参数.md">aclgrphBuildInitialize支持的配置参数</a>中的BUFFER_OPTIMIZE参数配合使用，仅在数据缓存优化开关打开的情况下生效，通过利用高速缓存暂存数据的方式，达到提升性能的目的。</p>
<p id="zh-cn_topic_0000002245550909_p682562711473"><a name="zh-cn_topic_0000002245550909_p682562711473"></a><a name="zh-cn_topic_0000002245550909_p682562711473"></a><strong id="zh-cn_topic_0000002245550909_b164102619501"><a name="zh-cn_topic_0000002245550909_b164102619501"></a><a name="zh-cn_topic_0000002245550909_b164102619501"></a>参数值：</strong>模型调优后自定义知识库路径。</p>
<p id="zh-cn_topic_0000002245550909_p5300341154717"><a name="zh-cn_topic_0000002245550909_p5300341154717"></a><a name="zh-cn_topic_0000002245550909_p5300341154717"></a><strong id="zh-cn_topic_0000002245550909_b16747142714506"><a name="zh-cn_topic_0000002245550909_b16747142714506"></a><a name="zh-cn_topic_0000002245550909_b16747142714506"></a>参数值格式：</strong>支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）。</p>
<p id="zh-cn_topic_0000002245550909_p1018625119540"><a name="zh-cn_topic_0000002245550909_p1018625119540"></a><a name="zh-cn_topic_0000002245550909_p1018625119540"></a><strong id="zh-cn_topic_0000002245550909_b198513458371"><a name="zh-cn_topic_0000002245550909_b198513458371"></a><a name="zh-cn_topic_0000002245550909_b198513458371"></a>参数默认值：</strong>$HOME/Ascend/latest/data/aoe/custom/graph/<span id="zh-cn_topic_0000002245550909_ph3725518171818"><a name="zh-cn_topic_0000002245550909_ph3725518171818"></a><a name="zh-cn_topic_0000002245550909_ph3725518171818"></a><em id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312483385_i79331727136"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312483385_i79331727136"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312483385_i79331727136"></a>&lt;soc_version&gt;</em></span></p>
<p id="zh-cn_topic_0000002245550909_p71315451636"><a name="zh-cn_topic_0000002245550909_p71315451636"></a><a name="zh-cn_topic_0000002245550909_p71315451636"></a><strong id="zh-cn_topic_0000002245550909_b141321045833"><a name="zh-cn_topic_0000002245550909_b141321045833"></a><a name="zh-cn_topic_0000002245550909_b141321045833"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245550909_screen31321345539"><a name="zh-cn_topic_0000002245550909_screen31321345539"></a><a name="zh-cn_topic_0000002245550909_screen31321345539"></a>{ge::ir_option::MDL_BANK_PATH, "<em id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001265233842_i151681917173414"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001265233842_i151681917173414"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001265233842_i151681917173414"></a>$HOME/</em><em id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001265233842_i15168131753411"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001265233842_i15168131753411"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001265233842_i15168131753411"></a>custom_module_path</em>"}</pre>
<p id="zh-cn_topic_0000002245550909_p487732932316"><a name="zh-cn_topic_0000002245550909_p487732932316"></a><a name="zh-cn_topic_0000002245550909_p487732932316"></a><strong id="zh-cn_topic_0000002245550909_b46204368230"><a name="zh-cn_topic_0000002245550909_b46204368230"></a><a name="zh-cn_topic_0000002245550909_b46204368230"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245550909_p11473123933220"><a name="zh-cn_topic_0000002245550909_p11473123933220"></a><a name="zh-cn_topic_0000002245550909_p11473123933220"></a>加载子图调优后自定义知识库路径优先级：MDL_BANK_PATH参数加载路径&gt;<strong id="zh-cn_topic_0000002245550909_b16540165613113"><a name="zh-cn_topic_0000002245550909_b16540165613113"></a><a name="zh-cn_topic_0000002245550909_b16540165613113"></a>TUNE_BANK_PATH</strong>环境变量设置路径&gt;默认子图调优后自定义知识库路径。</p>
<a name="zh-cn_topic_0000002245550909_ol1672437144820"></a><a name="zh-cn_topic_0000002245550909_ol1672437144820"></a><ol id="zh-cn_topic_0000002245550909_ol1672437144820"><li>如果模型编译前，通过<strong id="zh-cn_topic_0000002245550909_b1935210484289"><a name="zh-cn_topic_0000002245550909_b1935210484289"></a><a name="zh-cn_topic_0000002245550909_b1935210484289"></a>TUNE_BANK_PATH</strong>环境变量指定了子图调优自定义知识库路径，模型编译时又通过MDL_BANK_PATH参数加载了自定义知识库路径，该场景下以MDL_BANK_PATH参数加载的路径为准，<strong id="zh-cn_topic_0000002245550909_b108411046173416"><a name="zh-cn_topic_0000002245550909_b108411046173416"></a><a name="zh-cn_topic_0000002245550909_b108411046173416"></a>TUNE_BANK_PATH</strong>环境变量设置的路径不生效。</li><li>MDL_BANK_PATH参数和环境变量指定路径都不生效或无可用自定义知识库，则使用默认自定义知识库路径。</li><li>如果上述路径下都无可用的自定义知识库，则会查找子图调优内置知识库，该路径为：<span id="zh-cn_topic_0000002245550909_ph167891612151312"><a name="zh-cn_topic_0000002245550909_ph167891612151312"></a><a name="zh-cn_topic_0000002245550909_ph167891612151312"></a>${INSTALL_DIR}</span>/<em id="zh-cn_topic_0000002245550909_i12290155212572"><a name="zh-cn_topic_0000002245550909_i12290155212572"></a><a name="zh-cn_topic_0000002245550909_i12290155212572"></a>&lt;arch&gt;</em>-linux/data/fusion_strategy/built-in，<em id="zh-cn_topic_0000002245550909_i2621111705816"><a name="zh-cn_topic_0000002245550909_i2621111705816"></a><a name="zh-cn_topic_0000002245550909_i2621111705816"></a>&lt;arch&gt;</em>表示具体操作系统架构。</li></ol>
<p id="zh-cn_topic_0000002245550909_p1974043862411"><a name="zh-cn_topic_0000002245550909_p1974043862411"></a><a name="zh-cn_topic_0000002245550909_p1974043862411"></a><span class="ddd" id="zh-cn_topic_0000002245550909_ph6356171119017"><a name="zh-cn_topic_0000002245550909_ph6356171119017"></a><a name="zh-cn_topic_0000002245550909_ph6356171119017"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550909_p449315412369"><a name="zh-cn_topic_0000002245550909_p449315412369"></a><a name="zh-cn_topic_0000002245550909_p449315412369"></a><span id="zh-cn_topic_0000002245550909_ph14493442363"><a name="zh-cn_topic_0000002245550909_ph14493442363"></a><a name="zh-cn_topic_0000002245550909_ph14493442363"></a><term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550909_p134938463619"><a name="zh-cn_topic_0000002245550909_p134938463619"></a><a name="zh-cn_topic_0000002245550909_p134938463619"></a><span id="zh-cn_topic_0000002245550909_ph34934410366"><a name="zh-cn_topic_0000002245550909_ph34934410366"></a><a name="zh-cn_topic_0000002245550909_ph34934410366"></a><term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245550909_row158479206333"><td class="cellrowborder" valign="top" width="20.46%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245550909_p13194464253"><a name="zh-cn_topic_0000002245550909_p13194464253"></a><a name="zh-cn_topic_0000002245550909_p13194464253"></a>OP_BANK_PATH</p>
</td>
<td class="cellrowborder" valign="top" width="79.54%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245550909_p224144718147"><a name="zh-cn_topic_0000002245550909_p224144718147"></a><a name="zh-cn_topic_0000002245550909_p224144718147"></a>算子调优后自定义知识库路径。</p>
<p id="zh-cn_topic_0000002245550909_p12261182733210"><a name="zh-cn_topic_0000002245550909_p12261182733210"></a><a name="zh-cn_topic_0000002245550909_p12261182733210"></a><strong id="zh-cn_topic_0000002245550909_b2443339103212"><a name="zh-cn_topic_0000002245550909_b2443339103212"></a><a name="zh-cn_topic_0000002245550909_b2443339103212"></a>参数值格式：</strong>支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）。</p>
<p id="zh-cn_topic_0000002245550909_p99216541200"><a name="zh-cn_topic_0000002245550909_p99216541200"></a><a name="zh-cn_topic_0000002245550909_p99216541200"></a><strong id="zh-cn_topic_0000002245550909_b148144823217"><a name="zh-cn_topic_0000002245550909_b148144823217"></a><a name="zh-cn_topic_0000002245550909_b148144823217"></a>参数默认值：</strong>${HOME}/Ascend/latest/data/aoe/custom/op</p>
<p id="zh-cn_topic_0000002245550909_p108441552519"><a name="zh-cn_topic_0000002245550909_p108441552519"></a><a name="zh-cn_topic_0000002245550909_p108441552519"></a><strong id="zh-cn_topic_0000002245550909_b384418518518"><a name="zh-cn_topic_0000002245550909_b384418518518"></a><a name="zh-cn_topic_0000002245550909_b384418518518"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245550909_screen148447516516"><a name="zh-cn_topic_0000002245550909_screen148447516516"></a><a name="zh-cn_topic_0000002245550909_screen148447516516"></a>{ge::ir_option::OP_BANK_PATH, "<em id="zh-cn_topic_0000002245550909_i68441557515"><a name="zh-cn_topic_0000002245550909_i68441557515"></a><a name="zh-cn_topic_0000002245550909_i68441557515"></a>$HOME/</em><em id="zh-cn_topic_0000002245550909_i184435359"><a name="zh-cn_topic_0000002245550909_i184435359"></a><a name="zh-cn_topic_0000002245550909_i184435359"></a>custom_tune_path</em>"}</pre>
<p id="zh-cn_topic_0000002245550909_p184261414143217"><a name="zh-cn_topic_0000002245550909_p184261414143217"></a><a name="zh-cn_topic_0000002245550909_p184261414143217"></a><strong id="zh-cn_topic_0000002245550909_b16959125493219"><a name="zh-cn_topic_0000002245550909_b16959125493219"></a><a name="zh-cn_topic_0000002245550909_b16959125493219"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245550909_p113916614338"><a name="zh-cn_topic_0000002245550909_p113916614338"></a><a name="zh-cn_topic_0000002245550909_p113916614338"></a>加载算子调优后自定义知识库路径优先级：<strong id="zh-cn_topic_0000002245550909_b1313912673314"><a name="zh-cn_topic_0000002245550909_b1313912673314"></a><a name="zh-cn_topic_0000002245550909_b1313912673314"></a>TUNE_BANK_PATH</strong>环境变量设置路径&gt;OP_BANK_PATH参数加载路径&gt;默认算子调优后自定义知识库路径。</p>
<a name="zh-cn_topic_0000002245550909_ol019764317331"></a><a name="zh-cn_topic_0000002245550909_ol019764317331"></a><ol id="zh-cn_topic_0000002245550909_ol019764317331"><li>如果模型转换前，通过<strong id="zh-cn_topic_0000002245550909_b71391663338"><a name="zh-cn_topic_0000002245550909_b71391663338"></a><a name="zh-cn_topic_0000002245550909_b71391663338"></a>TUNE_BANK_PATH</strong>环境变量指定了算子调优自定义知识库路径，模型编译时又通过OP_BANK_PATH参数加载了自定义知识库路径，该场景下以<strong id="zh-cn_topic_0000002245550909_b91397683312"><a name="zh-cn_topic_0000002245550909_b91397683312"></a><a name="zh-cn_topic_0000002245550909_b91397683312"></a>TUNE_BANK_PATH</strong>环境变量设置的路径为准，OP_BANK_PATH参数加载的路径不生效。</li><li>OP_BANK_PATH参数和环境变量指定路径都不生效前提下，使用默认自定义知识库路径。</li><li>如果上述路径下都无可用的自定义知识库，则会查找算子调优内置知识库。</li></ol>
<p id="zh-cn_topic_0000002245550909_p3620459162519"><a name="zh-cn_topic_0000002245550909_p3620459162519"></a><a name="zh-cn_topic_0000002245550909_p3620459162519"></a><span class="ddd" id="zh-cn_topic_0000002245550909_ph95681314203"><a name="zh-cn_topic_0000002245550909_ph95681314203"></a><a name="zh-cn_topic_0000002245550909_ph95681314203"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245550909_p11822201413616"><a name="zh-cn_topic_0000002245550909_p11822201413616"></a><a name="zh-cn_topic_0000002245550909_p11822201413616"></a><span id="zh-cn_topic_0000002245550909_ph1082291483613"><a name="zh-cn_topic_0000002245550909_ph1082291483613"></a><a name="zh-cn_topic_0000002245550909_ph1082291483613"></a><term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245550909_p88224145369"><a name="zh-cn_topic_0000002245550909_p88224145369"></a><a name="zh-cn_topic_0000002245550909_p88224145369"></a><span id="zh-cn_topic_0000002245550909_ph4822414133620"><a name="zh-cn_topic_0000002245550909_ph4822414133620"></a><a name="zh-cn_topic_0000002245550909_ph4822414133620"></a><term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002245550909_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 试验参数<a name="section14878758114912"></a>

<a name="table141516252501"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210590722_row1463704011343"><th class="cellrowborder" valign="top" width="21%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002210590722_p563794073416"><a name="zh-cn_topic_0000002210590722_p563794073416"></a><a name="zh-cn_topic_0000002210590722_p563794073416"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="79%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002210590722_p2637124093414"><a name="zh-cn_topic_0000002210590722_p2637124093414"></a><a name="zh-cn_topic_0000002210590722_p2637124093414"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210590722_row1163716403347"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590722_p176198462157"><a name="zh-cn_topic_0000002210590722_p176198462157"></a><a name="zh-cn_topic_0000002210590722_p176198462157"></a>ALLOW_HF32</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p16351442194715"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p16351442194715"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p16351442194715"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b144777820189"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b144777820189"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b144777820189"></a>该参数预留，当前版本暂不支持</strong>。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p18954551506"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p18954551506"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p18954551506"></a>是否启用HF32自动代替float32数据类型的功能，当前版本该参数仅针对Conv类算子与Matmul类算子生效。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p186673010212"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p186673010212"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001541503508_p186673010212"></a>HF32是昇腾推出的专门用于算子内部计算的单精度浮点类型，与其他常用数据类型的比较如下图所示。可见，HF32与float32支持相同的数值范围，但尾数位精度（11位）却接近FP16（10位）。通过降低精度让HF32单精度数据类型代替原有的float32单精度数据类型，可大大降低数据所占空间大小，实现性能的提升。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p338552241016"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p338552241016"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p338552241016"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b22121255165113"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b22121255165113"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b22121255165113"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul5606165855412"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul5606165855412"></a><ul id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul5606165855412"><li>true：针对Conv类算子与Matmul类算子，使能FP32数据类型自动转换为HF32数据类型的功能。<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p2041116918198"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p2041116918198"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p2041116918198"></a>具体哪些算子使能了该功能，请参见CANN软件安装后文件存储路径的opp/built-in/op_impl/ai_core/tbe/impl_mode/allow_hf32_matmul_<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b1564011412412"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b1564011412412"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b1564011412412"></a>t</strong>_conv_<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b073828242"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b073828242"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b073828242"></a>t</strong>.ini，该文件不支持用户修改。</p>
</li><li>false：针对Conv类算子与Matmul类算子，不使能FP32数据类型自动转换为HF32数据类型的功能。<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p13622112819236"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p13622112819236"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_p13622112819236"></a>具体哪些算子未使能该功能，请参见CANN软件安装后文件存储路径的opp/built-in/op_impl/ai_core/tbe/impl_mode/allow_hf32_matmul_<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b118471220412"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b118471220412"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b118471220412"></a>f</strong>_conv_<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b216211146410"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b216211146410"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001616793245_b216211146410"></a>f</strong>.ini，该文件不支持用户修改。</p>
</li></ul>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1135164991114"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1135164991114"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1135164991114"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b891124641112"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b891124641112"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b891124641112"></a>参数默认值：</strong>针对Conv类算子，使能FP32转换为HF32；针对Matmul类算子，不使能FP32转换为HF32。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p5668164620568"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p5668164620568"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p5668164620568"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b19389489562"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b19389489562"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b19389489562"></a>使用约束</strong>：</p>
<a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul4400845114316"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul4400845114316"></a><ul id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul4400845114316"><li>针对同一个算子，如果通过OP_PRECISION_MODE参数配置了enable_hi_float_32_execution或enable_float_32_execution，该场景下不建议再与ALLOW_HF32参数同时使用，若同时使用，则优先级如下：<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p446014451524"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p446014451524"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p446014451524"></a>OP_PRECISION_MODE(ByNodeName，按节点名称设置精度模式) &gt; ALLOW_HF32 &gt; OP_PRECISION_MODE(ByOpType，按算子类型设置精度模式)。</p>
</li><li>由于ALLOW_HF32是使用HF32自动代替float32，要想该参数生效，必须保证被使能的算子输入或者输出类型为float32。由于PRECISION_MODE_V2参数默认值为fp16，原始网络模型中算子类型为float32时会被强制转为float16类型，该场景下使用ALLOW_HF32参数不生效，建议修改PRECISION_MODE_V2参数值为<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1784821171517"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1784821171517"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1784821171517"></a>origin</strong>（PRECISION_MODE参数默认值为force_fp16，建议修改为<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b7923132611209"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b7923132611209"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b7923132611209"></a>must_keep_origin_dtype</strong>或者<strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1592314263204"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1592314263204"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1592314263204"></a>force_fp32</strong>）。</li></ul>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p019916252512"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p019916252512"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p019916252512"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b17199102162514"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b17199102162514"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b17199102162514"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen10199192162512"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen10199192162512"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen10199192162512"></a>{ge::ir_option::ALLOW_HF32, "true"}</pre>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p69151331172212"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p69151331172212"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p69151331172212"></a><span class="ddd" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph10915531102219"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph10915531102219"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph10915531102219"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p491619315224"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p491619315224"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p491619315224"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph791663116229"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph791663116229"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph791663116229"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p4751054162114"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p4751054162114"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p4751054162114"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph364004232819"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph364004232819"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph364004232819"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590722_row11637144018344"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590722_p397613171538"><a name="zh-cn_topic_0000002210590722_p397613171538"></a><a name="zh-cn_topic_0000002210590722_p397613171538"></a>BUILD_INNER_MODEL</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590722_p1397661717319"><a name="zh-cn_topic_0000002210590722_p1397661717319"></a><a name="zh-cn_topic_0000002210590722_p1397661717319"></a>当前版本暂不支持。</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590722_row070817582189"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590722_p132027333176"><a name="zh-cn_topic_0000002210590722_p132027333176"></a><a name="zh-cn_topic_0000002210590722_p132027333176"></a>OO_LEVEL</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p155241939134310"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p155241939134310"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p155241939134310"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b112761862459"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b112761862459"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b112761862459"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p81713419273"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p81713419273"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p81713419273"></a>图编译多级优化选项，包括子图优化、整图优化、<span>静态Shape模型下沉</span>等。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13590204722713"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13590204722713"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13590204722713"></a><span>静态Shape模型下沉</span>：静态Shape模型在编译时即可确定所有算子的输入输出Shape，完成模型级内存编排、算子的Tiling计算等Host侧计算，在模型加载时整体下发到Device流上，但不立即执行，通过下发模型执行Task触发模型中所有Task的执行。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p14787525853"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p14787525853"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p14787525853"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b84818267518"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b84818267518"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b84818267518"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul28245481651"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul28245481651"></a><ul id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul28245481651"><li>O1：会关闭所有图融合和UB融合Pass，只做促成静态下沉的相关优化，如InferShape（进行输出Tensor的shape推导）、常量折叠、死边消除等。<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000002058018885_p6524118144416"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000002058018885_p6524118144416"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000002058018885_p6524118144416"></a></p>
</li><li>O3：（默认值）开启所有优化。</li></ul>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1417116268291"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1417116268291"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1417116268291"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b628623310294"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b628623310294"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b628623310294"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p11936115015517"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p11936115015517"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p11936115015517"></a>取值为O1时，会关闭所有图融合和UB融合PASS，只开启静态下沉的相关PASS，但是如下路径文件中的图融合PASS，由于关闭后会有功能问题，会默认开启：</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p12878123125212"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p12878123125212"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p12878123125212"></a>“<span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph111861254121815"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph111861254121815"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph111861254121815"></a>${INSTALL_DIR}</span>/<em id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_i1061253485419"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_i1061253485419"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_i1061253485419"></a>&lt;arch&gt;</em>-linux/lib64/plugin/opskernel/fusion_pass/config/fusion_config.json”文件中"ExceptionalPassOfO1Level"字段下的所有图融合PASS。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_li1541231181614p0"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_li1541231181614p0"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_li1541231181614p0"></a>其中<span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph13176162271813"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph13176162271813"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph13176162271813"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span>&lt;arch&gt;表示具体操作系统架构。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p3439430952"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p3439430952"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p3439430952"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b343917305512"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b343917305512"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b343917305512"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen10680163516158"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen10680163516158"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen10680163516158"></a>{ge::ir_option::OO_LEVEL, "O3"}</pre>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p53871713104310"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p53871713104310"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p53871713104310"></a><span class="ddd" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1348261625514"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1348261625514"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1348261625514"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p102251817131919"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p102251817131919"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p102251817131919"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph192251917161914"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph192251917161914"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph192251917161914"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p465703434017"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p465703434017"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p465703434017"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph13754548217"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph13754548217"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph13754548217"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590722_row9503203196"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590722_p1869633461718"><a name="zh-cn_topic_0000002210590722_p1869633461718"></a><a name="zh-cn_topic_0000002210590722_p1869633461718"></a>OO_CONSTANT_FOLDING</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p295082412913"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p295082412913"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p295082412913"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b995032417912"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b995032417912"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b995032417912"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p245519502315"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p245519502315"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p245519502315"></a>是否开启常量折叠优化。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1414619230342"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1414619230342"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1414619230342"></a>常量折叠是将计算图中可以预先确定输出值的节点替换成常量，并对计算图进行一些结构简化的操作。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13761510719"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13761510719"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13761510719"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1436914561976"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1436914561976"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1436914561976"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul9173551280"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul9173551280"></a><ul id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul9173551280"><li>true：（默认值）开启。</li><li>false：关闭。</li></ul>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p20880195910714"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p20880195910714"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p20880195910714"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1588018591372"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1588018591372"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b1588018591372"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen965610184108"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen965610184108"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen965610184108"></a>{ge::ir_option::OO_CONSTANT_FOLDING, "true"}</pre>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p994013443314"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p994013443314"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p994013443314"></a><span class="ddd" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph20940144410319"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph20940144410319"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph20940144410319"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1294014440314"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1294014440314"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1294014440314"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph10940184410312"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph10940184410312"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph10940184410312"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p694074416314"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p694074416314"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p694074416314"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1094084413117"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1094084413117"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1094084413117"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210590722_row143615212194"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002210590722_p727518360177"><a name="zh-cn_topic_0000002210590722_p727518360177"></a><a name="zh-cn_topic_0000002210590722_p727518360177"></a>OO_DEAD_CODE_ELIMINATION</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p226419281893"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p226419281893"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p226419281893"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b626413288915"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b626413288915"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b626413288915"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p15988112512916"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p15988112512916"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p15988112512916"></a>是否开启死边消除优化。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p81794043414"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p81794043414"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p81794043414"></a>死边消除：switch死边消除，switch的pred输入（1号输入）为const节点时，根据const的值消除其中一条分支：const为true时，消除false分支；const为false时，消除true分支。</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p20988172512915"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p20988172512915"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p20988172512915"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b10988825991"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b10988825991"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b10988825991"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul149881025394"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul149881025394"></a><ul id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ul149881025394"><li>true：（默认值）开启。</li><li>false：关闭。</li></ul>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p109881251197"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p109881251197"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p109881251197"></a><strong id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b12988152518915"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b12988152518915"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_b12988152518915"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen1898817259910"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen1898817259910"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_screen1898817259910"></a>{ge::ir_option::OO_DEAD_CODE_ELIMINATION, "true"}</pre>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13676174863112"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13676174863112"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p13676174863112"></a><span class="ddd" id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1967612488319"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1967612488319"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph1967612488319"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p18676348183120"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p18676348183120"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p18676348183120"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph267617485316"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph267617485316"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph267617485316"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1967614811315"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1967614811315"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_p1967614811315"></a><span id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph19676174816316"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph19676174816316"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_ph19676174816316"></a><term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002210590722_zh-cn_topic_0000002244692745_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

## 后续版本废弃配置<a name="section178801021507"></a>

<a name="table1075719266503"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245510785_row1463704011343"><th class="cellrowborder" valign="top" width="21%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002245510785_p563794073416"><a name="zh-cn_topic_0000002245510785_p563794073416"></a><a name="zh-cn_topic_0000002245510785_p563794073416"></a>参数</p>
</th>
<th class="cellrowborder" valign="top" width="79%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002245510785_p2637124093414"><a name="zh-cn_topic_0000002245510785_p2637124093414"></a><a name="zh-cn_topic_0000002245510785_p2637124093414"></a>说明</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245510785_row1163716403347"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510785_p186401339124810"><a name="zh-cn_topic_0000002245510785_p186401339124810"></a><a name="zh-cn_topic_0000002245510785_p186401339124810"></a>INPUT_SHAPE_RANGE</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510785_p1689995815611"><a name="zh-cn_topic_0000002245510785_p1689995815611"></a><a name="zh-cn_topic_0000002245510785_p1689995815611"></a><strong id="zh-cn_topic_0000002245510785_b58551611273"><a name="zh-cn_topic_0000002245510785_b58551611273"></a><a name="zh-cn_topic_0000002245510785_b58551611273"></a>该参数已废弃，请勿使用。</strong>若涉及指定模型输入数据的shape范围，请使用INPUT_SHAPE参数。</p>
<p id="zh-cn_topic_0000002245510785_p8475126185010"><a name="zh-cn_topic_0000002245510785_p8475126185010"></a><a name="zh-cn_topic_0000002245510785_p8475126185010"></a>指定模型输入数据的shape range。该功能不能与DYNAMIC_BATCH_SIZE、DYNAMIC_IMAGE_SIZE、DYNAMIC_DIMS同时使用。</p>
<a name="zh-cn_topic_0000002245510785_ul1981210419611"></a><a name="zh-cn_topic_0000002245510785_ul1981210419611"></a><ul id="zh-cn_topic_0000002245510785_ul1981210419611"><li>支持按照name设置："input_name1:[n1,c1,h1,w1];input_name2:[n2,c2,h2,w2]"，例如："input_name1:[8~20,3,5,-1];input_name2:[5,3~9,10,-1]"。指定的节点必须放在双引号中，节点中间使用英文分号分隔。input_name必须是转换前的网络模型中的节点名称，shape range值必须放在[]中。如果用户知道data节点的name，推荐按照name设置INPUT_SHAPE_RANGE。</li><li>支持按照index设置："[n1,c1,h1,w1],[n2,c2,h2,w2]"，例如："[8~20,3,5,-1],[5,3~9,10,-1]"。可以不指定节点名，默认第一个中括号为第一个输入节点，节点中间使用英文逗号分隔。按照index设置INPUT_SHAPE_RANGE时，data节点需要设置属性index，说明是第几个输入，index从0开始。</li><li>动态维度有shape范围的用波浪号“~”表示，固定维度用固定数字表示，无限定范围的用-1表示；</li><li>对于标量输入，也需要填入shape范围，表示方法为：[]；</li><li>对于多输入场景，例如有三个输入时，如果只有第二个第三个输入具有shape范围，第一个输入为固定输入时，仍需要将固定输入shape填入。</li></ul>
<p id="zh-cn_topic_0000002245510785_p9911612195318"><a name="zh-cn_topic_0000002245510785_p9911612195318"></a><a name="zh-cn_topic_0000002245510785_p9911612195318"></a><span class="ddd" id="zh-cn_topic_0000002245510785_ph1214914325812"><a name="zh-cn_topic_0000002245510785_ph1214914325812"></a><a name="zh-cn_topic_0000002245510785_ph1214914325812"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510785_p1126314163157"><a name="zh-cn_topic_0000002245510785_p1126314163157"></a><a name="zh-cn_topic_0000002245510785_p1126314163157"></a><span id="zh-cn_topic_0000002245510785_ph6263101641518"><a name="zh-cn_topic_0000002245510785_ph6263101641518"></a><a name="zh-cn_topic_0000002245510785_ph6263101641518"></a><term id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>，支持。</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245510785_row11637144018344"><td class="cellrowborder" valign="top" width="21%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002245510785_p18411652122711"><a name="zh-cn_topic_0000002245510785_p18411652122711"></a><a name="zh-cn_topic_0000002245510785_p18411652122711"></a>SHAPE_GENERALIZED_BUILD_MODE</p>
</td>
<td class="cellrowborder" valign="top" width="79%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002245510785_p1547012522168"><a name="zh-cn_topic_0000002245510785_p1547012522168"></a><a name="zh-cn_topic_0000002245510785_p1547012522168"></a>图编译时Shape的编译方式。<strong id="zh-cn_topic_0000002245510785_b2051020421991"><a name="zh-cn_topic_0000002245510785_b2051020421991"></a><a name="zh-cn_topic_0000002245510785_b2051020421991"></a>该参数在后续版本废弃、新开发功能请不要使用该参数。</strong></p>
<a name="zh-cn_topic_0000002245510785_ul14521138181917"></a><a name="zh-cn_topic_0000002245510785_ul14521138181917"></a><ul id="zh-cn_topic_0000002245510785_ul14521138181917"><li>shape_generalized：模糊编译，是指对于支持动态Shape的算子，在编译时系统内部对可变维度做了泛化后再进行编译。<p id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312633917_p1393151315413"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312633917_p1393151315413"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312633917_p1393151315413"></a>该参数使用场景为：用户想编译一次达到多次执行推理的目的时，可以使用模糊编译特性。</p>
</li><li>shape_precise：精确编译，是指按照用户指定的维度信息、在编译时系统内部不做任何转义直接编译。</li></ul>
<p id="zh-cn_topic_0000002245510785_p324818504163"><a name="zh-cn_topic_0000002245510785_p324818504163"></a><a name="zh-cn_topic_0000002245510785_p324818504163"></a><span class="ddd" id="zh-cn_topic_0000002245510785_ph634219391512"><a name="zh-cn_topic_0000002245510785_ph634219391512"></a><a name="zh-cn_topic_0000002245510785_ph634219391512"></a>产品支持情况</span>：</p>
<p id="zh-cn_topic_0000002245510785_p3459115593611"><a name="zh-cn_topic_0000002245510785_p3459115593611"></a><a name="zh-cn_topic_0000002245510785_p3459115593611"></a><span id="zh-cn_topic_0000002245510785_ph24593553366"><a name="zh-cn_topic_0000002245510785_ph24593553366"></a><a name="zh-cn_topic_0000002245510785_ph24593553366"></a><term id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持</p>
<p id="zh-cn_topic_0000002245510785_p114591559365"><a name="zh-cn_topic_0000002245510785_p114591559365"></a><a name="zh-cn_topic_0000002245510785_p114591559365"></a><span id="zh-cn_topic_0000002245510785_ph6459185553614"><a name="zh-cn_topic_0000002245510785_ph6459185553614"></a><a name="zh-cn_topic_0000002245510785_ph6459185553614"></a><term id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245510785_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持</p>
</td>
</tr>
</tbody>
</table>

