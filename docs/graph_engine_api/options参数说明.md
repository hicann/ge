# options参数说明<a name="ZH-CN_TOPIC_0000001264926062"></a>

**本章节列出GEInitialize、Session构造函数、AddGraph接口传入的配置参数，分别在全局、session、graph生效**。

> [!NOTE]说明
>如下表格中仅列出当前版本支持的配置参数，如果表中未列出，表示该参数预留或适用于其他版本的昇腾AI处理器，用户无需关注。

## 基础功能<a name="section356842613556"></a>

<a name="table12984139586"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245600277_row12247013356"><th class="cellrowborder" valign="top" width="14.014413712504869%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002245600277_p3681132911170"><a name="zh-cn_topic_0000002245600277_p3681132911170"></a><a name="zh-cn_topic_0000002245600277_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="69.28320997273082%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002245600277_p326514861719"><a name="zh-cn_topic_0000002245600277_p326514861719"></a><a name="zh-cn_topic_0000002245600277_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="6.817296455005844%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002245600277_p1572818217519"><a name="zh-cn_topic_0000002245600277_p1572818217519"></a><a name="zh-cn_topic_0000002245600277_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="9.885079859758473%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002245600277_p197281421456"><a name="zh-cn_topic_0000002245600277_p197281421456"></a><a name="zh-cn_topic_0000002245600277_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245600277_row92247011357"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p138391755123017"><a name="zh-cn_topic_0000002245600277_p138391755123017"></a><a name="zh-cn_topic_0000002245600277_p138391755123017"></a>ge.graphRunMode</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p281441185216"><a name="zh-cn_topic_0000002245600277_p281441185216"></a><a name="zh-cn_topic_0000002245600277_p281441185216"></a>图执行模式，取值：</p>
<a name="zh-cn_topic_0000002245600277_ul323720465532"></a><a name="zh-cn_topic_0000002245600277_ul323720465532"></a><ul id="zh-cn_topic_0000002245600277_ul323720465532"><li>0：（默认值）在线推理场景下，请配置为0。</li><li>1：训练场景下，请配置为1。</li></ul>
<p id="zh-cn_topic_0000002245600277_p114611199491"><a name="zh-cn_topic_0000002245600277_p114611199491"></a><a name="zh-cn_topic_0000002245600277_p114611199491"></a><strong id="zh-cn_topic_0000002245600277_b54614193494"><a name="zh-cn_topic_0000002245600277_b54614193494"></a><a name="zh-cn_topic_0000002245600277_b54614193494"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen184661944915"><a name="zh-cn_topic_0000002245600277_screen184661944915"></a><a name="zh-cn_topic_0000002245600277_screen184661944915"></a>{"ge.graphRunMode", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p1751132613111"><a name="zh-cn_topic_0000002245600277_p1751132613111"></a><a name="zh-cn_topic_0000002245600277_p1751132613111"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p1865755314543"><a name="zh-cn_topic_0000002245600277_p1865755314543"></a><a name="zh-cn_topic_0000002245600277_p1865755314543"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row28384065314"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p56826292178"><a name="zh-cn_topic_0000002245600277_p56826292178"></a><a name="zh-cn_topic_0000002245600277_p56826292178"></a>ge.exec.deviceId</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p17682192961716"><a name="zh-cn_topic_0000002245600277_p17682192961716"></a><a name="zh-cn_topic_0000002245600277_p17682192961716"></a>GE实例运行时操作设备的逻辑ID。</p>
<a name="zh-cn_topic_0000002245600277_ul892412136313"></a><a name="zh-cn_topic_0000002245600277_ul892412136313"></a><ul id="zh-cn_topic_0000002245600277_ul892412136313"><li>在线推理场景，限制有限范围为-1~N-1，默认值为-1。</li><li>训练场景，限制有限范围为0~N-1，默认值为0。</li></ul>
<p id="zh-cn_topic_0000002245600277_p186633710586"><a name="zh-cn_topic_0000002245600277_p186633710586"></a><a name="zh-cn_topic_0000002245600277_p186633710586"></a>N表示该台Server上的可用<span id="zh-cn_topic_0000002245600277_ph1787192871811"><a name="zh-cn_topic_0000002245600277_ph1787192871811"></a><a name="zh-cn_topic_0000002245600277_ph1787192871811"></a>昇腾AI处理器</span>个数。</p>
<p id="zh-cn_topic_0000002245600277_p19739174711491"><a name="zh-cn_topic_0000002245600277_p19739174711491"></a><a name="zh-cn_topic_0000002245600277_p19739174711491"></a><strong id="zh-cn_topic_0000002245600277_b8739114784912"><a name="zh-cn_topic_0000002245600277_b8739114784912"></a><a name="zh-cn_topic_0000002245600277_b8739114784912"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen1673984754910"><a name="zh-cn_topic_0000002245600277_screen1673984754910"></a><a name="zh-cn_topic_0000002245600277_screen1673984754910"></a>{"ge.exec.deviceId", "-1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p1682529151715"><a name="zh-cn_topic_0000002245600277_p1682529151715"></a><a name="zh-cn_topic_0000002245600277_p1682529151715"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p4197202185119"><a name="zh-cn_topic_0000002245600277_p4197202185119"></a><a name="zh-cn_topic_0000002245600277_p4197202185119"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row1324124455319"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p18466537172812"><a name="zh-cn_topic_0000002245600277_p18466537172812"></a><a name="zh-cn_topic_0000002245600277_p18466537172812"></a>ge.session_device_id</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p1453218111227"><a name="zh-cn_topic_0000002245600277_p1453218111227"></a><a name="zh-cn_topic_0000002245600277_p1453218111227"></a>当用户需要将不同的模型通过同一个脚本在不同的Device上执行，可以通过该参数指定Device的逻辑ID。</p>
<p id="zh-cn_topic_0000002245600277_p14736215164414"><a name="zh-cn_topic_0000002245600277_p14736215164414"></a><a name="zh-cn_topic_0000002245600277_p14736215164414"></a>通常可以创建多个线程，每个线程是不同的Session，每个Session传不同的ge.session_device_id。</p>
<p id="zh-cn_topic_0000002245600277_p173407406323"><a name="zh-cn_topic_0000002245600277_p173407406323"></a><a name="zh-cn_topic_0000002245600277_p173407406323"></a><strong id="zh-cn_topic_0000002245600277_b62364383615"><a name="zh-cn_topic_0000002245600277_b62364383615"></a><a name="zh-cn_topic_0000002245600277_b62364383615"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen8376109373"><a name="zh-cn_topic_0000002245600277_screen8376109373"></a><a name="zh-cn_topic_0000002245600277_screen8376109373"></a>{"ge.session_device_id", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p3467193710280"><a name="zh-cn_topic_0000002245600277_p3467193710280"></a><a name="zh-cn_topic_0000002245600277_p3467193710280"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p8467137142819"><a name="zh-cn_topic_0000002245600277_p8467137142819"></a><a name="zh-cn_topic_0000002245600277_p8467137142819"></a>session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row6241154465317"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p18537101217307"><a name="zh-cn_topic_0000002245600277_p18537101217307"></a><a name="zh-cn_topic_0000002245600277_p18537101217307"></a>ge.socVersion</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p25372127303"><a name="zh-cn_topic_0000002245600277_p25372127303"></a><a name="zh-cn_topic_0000002245600277_p25372127303"></a>指定编译优化模型的<span id="zh-cn_topic_0000002245600277_ph353731220304"><a name="zh-cn_topic_0000002245600277_ph353731220304"></a><a name="zh-cn_topic_0000002245600277_ph353731220304"></a>昇腾AI处理器</span>型号。</p>
<a name="zh-cn_topic_0000002245600277_ul1739215311600"></a><a name="zh-cn_topic_0000002245600277_ul1739215311600"></a><ul id="zh-cn_topic_0000002245600277_ul1739215311600"><li>针对如下<span id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph20833205312295"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph20833205312295"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph20833205312295"></a>产品</span>：在安装<span id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph196874123168"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph196874123168"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph196874123168"></a>昇腾AI处理器</span>的服务器执行<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b17687612191618"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b17687612191618"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b17687612191618"></a>npu-smi info</strong>命令进行查询，获取<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b10161437131915"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b10161437131915"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b10161437131915"></a>Name</strong>信息。实际配置值为AscendName，例如<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b16284944181920"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b16284944181920"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b16284944181920"></a>Name</strong>取值为<em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i1478775919179"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i1478775919179"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i1478775919179"></a>xxxyy</em>，实际配置值为Ascend<em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i1678775901719"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i1678775901719"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i1678775901719"></a>xxxyy</em>。<p id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_p3529538154519"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_p3529538154519"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_p3529538154519"></a><span id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph1483216010188"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph1483216010188"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph1483216010188"></a><term id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
</li><li>针对如下<span id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph13446185695413"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph13446185695413"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph13446185695413"></a>产品</span>，在安装<span id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph17911124171120"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph17911124171120"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph17911124171120"></a>昇腾AI处理器</span>的服务器执行<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b206066255591"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b206066255591"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b206066255591"></a>npu-smi info -t board -i </strong><em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16609202515915"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16609202515915"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16609202515915"></a>id</em><strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b14358631175910"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b14358631175910"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_b14358631175910"></a> -c </strong><em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16269732165915"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16269732165915"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001264656721_zh-cn_topic_0000001117597244_i16269732165915"></a>chip_id</em>命令进行查询，获取<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b11257114917192"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b11257114917192"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b11257114917192"></a>Chip Name</strong>和<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b72671651121916"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b72671651121916"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b72671651121916"></a>NPU Name</strong>信息，实际配置值为Chip Name_NPU Name。例如<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b13136111611203"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b13136111611203"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b13136111611203"></a>Chip Name</strong>取值为Ascend<em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i68701996189"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i68701996189"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i68701996189"></a>xxx</em>，<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b51347352112"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b51347352112"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b51347352112"></a>NPU Name</strong>取值为1234，实际配置值为Ascend<em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i82901912141813"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i82901912141813"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i82901912141813"></a>xxx</em><em id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i154501458102213"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i154501458102213"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_i154501458102213"></a>_</em>1234。其中：<a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ul2747601334"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ul2747601334"></a><ul id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ul2747601334"><li>id：设备id，通过<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b83171930133314"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b83171930133314"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b83171930133314"></a>npu-smi info -l</strong>命令查出的NPU ID即为设备id。</li><li>chip_id：芯片id，通过<strong id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b18888204343317"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b18888204343317"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_b18888204343317"></a>npu-smi info -m</strong>命令查出的Chip ID即为芯片id。</li></ul>
<p id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_p12136131554410"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_p12136131554410"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_p12136131554410"></a><span id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph13754548217"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph13754548217"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_ph13754548217"></a><term id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245600277_zh-cn_topic_0000001265392790_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li></ul>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p1854141263012"><a name="zh-cn_topic_0000002245600277_p1854141263012"></a><a name="zh-cn_topic_0000002245600277_p1854141263012"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p13541151215307"><a name="zh-cn_topic_0000002245600277_p13541151215307"></a><a name="zh-cn_topic_0000002245600277_p13541151215307"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row1056164718532"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p14430757173719"><a name="zh-cn_topic_0000002245600277_p14430757173719"></a><a name="zh-cn_topic_0000002245600277_p14430757173719"></a>ge.enableSingleStream</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p17402132318912"><a name="zh-cn_topic_0000002245600277_p17402132318912"></a><a name="zh-cn_topic_0000002245600277_p17402132318912"></a>静态shape场景下，是否使能图运行顺序单流串行执行。</p>
<p id="zh-cn_topic_0000002245600277_p134021223992"><a name="zh-cn_topic_0000002245600277_p134021223992"></a><a name="zh-cn_topic_0000002245600277_p134021223992"></a>其中，流（Stream）用于维护一些异步操作的执行顺序，确保按照应用程序中的代码调用顺序在Device上执行。</p>
<p id="zh-cn_topic_0000002245600277_p18385183514122"><a name="zh-cn_topic_0000002245600277_p18385183514122"></a><a name="zh-cn_topic_0000002245600277_p18385183514122"></a><strong id="zh-cn_topic_0000002245600277_b4266543131211"><a name="zh-cn_topic_0000002245600277_b4266543131211"></a><a name="zh-cn_topic_0000002245600277_b4266543131211"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245600277_ul9813212508"></a><a name="zh-cn_topic_0000002245600277_ul9813212508"></a><ul id="zh-cn_topic_0000002245600277_ul9813212508"><li>true：表示使能，图运行顺序单流串行执行。</li><li>false：（默认值）表示关闭，图运行时多流并行执行。</li></ul>
<p id="zh-cn_topic_0000002245600277_p230291201317"><a name="zh-cn_topic_0000002245600277_p230291201317"></a><a name="zh-cn_topic_0000002245600277_p230291201317"></a><strong id="zh-cn_topic_0000002245600277_b142463715135"><a name="zh-cn_topic_0000002245600277_b142463715135"></a><a name="zh-cn_topic_0000002245600277_b142463715135"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245600277_p11847203715201"><a name="zh-cn_topic_0000002245600277_p11847203715201"></a><a name="zh-cn_topic_0000002245600277_p11847203715201"></a>模型中存在Cmo算子和如下控制类算子时，不能使用单Stream特性，只能使用默认值false。</p>
<a name="zh-cn_topic_0000002245600277_ul191457389256"></a><a name="zh-cn_topic_0000002245600277_ul191457389256"></a><ul id="zh-cn_topic_0000002245600277_ul191457389256"><li>Merge</li><li>Switch</li><li>Enter</li><li>RefEnter</li></ul>
<p id="zh-cn_topic_0000002245600277_p12186102131"><a name="zh-cn_topic_0000002245600277_p12186102131"></a><a name="zh-cn_topic_0000002245600277_p12186102131"></a><strong id="zh-cn_topic_0000002245600277_b252411710139"><a name="zh-cn_topic_0000002245600277_b252411710139"></a><a name="zh-cn_topic_0000002245600277_b252411710139"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen119310240133"><a name="zh-cn_topic_0000002245600277_screen119310240133"></a><a name="zh-cn_topic_0000002245600277_screen119310240133"></a>{"ge.enableSingleStream", "false"};</pre>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p16430125716373"><a name="zh-cn_topic_0000002245600277_p16430125716373"></a><a name="zh-cn_topic_0000002245600277_p16430125716373"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p1543013577372"><a name="zh-cn_topic_0000002245600277_p1543013577372"></a><a name="zh-cn_topic_0000002245600277_p1543013577372"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row3561164716539"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p19683182971716"><a name="zh-cn_topic_0000002245600277_p19683182971716"></a><a name="zh-cn_topic_0000002245600277_p19683182971716"></a>ge.exec.rankTableFile</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p368392961713"><a name="zh-cn_topic_0000002245600277_p368392961713"></a><a name="zh-cn_topic_0000002245600277_p368392961713"></a>用于描述参与集合通信的集群信息，包括Server，Device，容器等的组织信息，填写ranktable文件路径，包含文件路径和文件名；</p>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p1238492611327"><a name="zh-cn_topic_0000002245600277_p1238492611327"></a><a name="zh-cn_topic_0000002245600277_p1238492611327"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p956541012523"><a name="zh-cn_topic_0000002245600277_p956541012523"></a><a name="zh-cn_topic_0000002245600277_p956541012523"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row165612047165310"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p8683142913177"><a name="zh-cn_topic_0000002245600277_p8683142913177"></a><a name="zh-cn_topic_0000002245600277_p8683142913177"></a>ge.exec.rankId</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p136831529101712"><a name="zh-cn_topic_0000002245600277_p136831529101712"></a><a name="zh-cn_topic_0000002245600277_p136831529101712"></a>rank id，指进程在group中对应的rank标识序号。范围：0~（rank size-1）。对于用户自定义group，rank在本group内从0开始进行重排；对于hccl world group，rank id和world rank id相同。</p>
<a name="zh-cn_topic_0000002245600277_ul26831529161718"></a><a name="zh-cn_topic_0000002245600277_ul26831529161718"></a><ul id="zh-cn_topic_0000002245600277_ul26831529161718"><li>world rank id，指进程在hccl world group中对应的rank标识序号，范围：0~（rank size-1）。</li><li>local rank id，指group内进程在其所在Server内的rank编号，范围：0~（local rank size-1）。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p3386182633218"><a name="zh-cn_topic_0000002245600277_p3386182633218"></a><a name="zh-cn_topic_0000002245600277_p3386182633218"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p722161020529"><a name="zh-cn_topic_0000002245600277_p722161020529"></a><a name="zh-cn_topic_0000002245600277_p722161020529"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row1561547105316"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p18940101012543"><a name="zh-cn_topic_0000002245600277_p18940101012543"></a><a name="zh-cn_topic_0000002245600277_p18940101012543"></a>ge.constLifecycle</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p750892925419"><a name="zh-cn_topic_0000002245600277_p750892925419"></a><a name="zh-cn_topic_0000002245600277_p750892925419"></a>用于训练和在线推理场景下配置常量节点的生命周期。</p>
<a name="zh-cn_topic_0000002245600277_ul1577523145614"></a><a name="zh-cn_topic_0000002245600277_ul1577523145614"></a><ul id="zh-cn_topic_0000002245600277_ul1577523145614"><li>session：按照session级别存储常量节点。配置为session级别时，session内多张图间的常量节点支持内存复用，但需要用户保证多张图上同名的常量节点完全相同。</li><li>graph：按照graph级别存储常量节点，后续用户可调用<a href="SetGraphConstMemoryBase.md">SetGraphConstMemoryBase</a>接口按图级别对const内存自行管理。</li></ul>
<p id="zh-cn_topic_0000002245600277_p471314131315"><a name="zh-cn_topic_0000002245600277_p471314131315"></a><a name="zh-cn_topic_0000002245600277_p471314131315"></a>训练场景默认值为session；在线推理场景默认值为graph。</p>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p95631635161516"><a name="zh-cn_topic_0000002245600277_p95631635161516"></a><a name="zh-cn_topic_0000002245600277_p95631635161516"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p024123042310"><a name="zh-cn_topic_0000002245600277_p024123042310"></a><a name="zh-cn_topic_0000002245600277_p024123042310"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row1396795375316"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p163741381920"><a name="zh-cn_topic_0000002245600277_p163741381920"></a><a name="zh-cn_topic_0000002245600277_p163741381920"></a>ge.deterministic</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p1638131361912"><a name="zh-cn_topic_0000002245600277_p1638131361912"></a><a name="zh-cn_topic_0000002245600277_p1638131361912"></a>是否开启确定性计算。</p>
<p id="zh-cn_topic_0000002245600277_p18284216122114"><a name="zh-cn_topic_0000002245600277_p18284216122114"></a><a name="zh-cn_topic_0000002245600277_p18284216122114"></a>默认情况下，不开启确定性计算，算子在相同的硬件和输入下，多次执行的结果可能不同。这个差异的来源，一般是因为在算子实现中，存在异步的多线程执行，会导致浮点数累加的顺序变化。当开启确定性计算功能时，算子在相同的硬件和输入下，多次执行将产生相同的输出。但启用确定性计算往往导致算子执行变慢。当发现模型多次执行结果不同，或者是进行精度调优时，可开启确定性计算，辅助模型调试、调优。</p>
<p id="zh-cn_topic_0000002245600277_p1096413120224"><a name="zh-cn_topic_0000002245600277_p1096413120224"></a><a name="zh-cn_topic_0000002245600277_p1096413120224"></a><strong id="zh-cn_topic_0000002245600277_b18396141818299"><a name="zh-cn_topic_0000002245600277_b18396141818299"></a><a name="zh-cn_topic_0000002245600277_b18396141818299"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245600277_ul04471536122215"></a><a name="zh-cn_topic_0000002245600277_ul04471536122215"></a><ul id="zh-cn_topic_0000002245600277_ul04471536122215"><li>0：（默认值）不开启确定性计算。</li><li>1：开启确定性计算。</li></ul>
<p id="zh-cn_topic_0000002245600277_p166762172912"><a name="zh-cn_topic_0000002245600277_p166762172912"></a><a name="zh-cn_topic_0000002245600277_p166762172912"></a><strong id="zh-cn_topic_0000002245600277_b1066832112297"><a name="zh-cn_topic_0000002245600277_b1066832112297"></a><a name="zh-cn_topic_0000002245600277_b1066832112297"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen96681421152914"><a name="zh-cn_topic_0000002245600277_screen96681421152914"></a><a name="zh-cn_topic_0000002245600277_screen96681421152914"></a>{"ge.deterministic", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p7381113171914"><a name="zh-cn_topic_0000002245600277_p7381113171914"></a><a name="zh-cn_topic_0000002245600277_p7381113171914"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p163817138192"><a name="zh-cn_topic_0000002245600277_p163817138192"></a><a name="zh-cn_topic_0000002245600277_p163817138192"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row10967165311532"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p230645316537"><a name="zh-cn_topic_0000002245600277_p230645316537"></a><a name="zh-cn_topic_0000002245600277_p230645316537"></a>ge.exec.frozenInputIndexes</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p1992413367113"><a name="zh-cn_topic_0000002245600277_p1992413367113"></a><a name="zh-cn_topic_0000002245600277_p1992413367113"></a>设置地址不刷新的输入Tensor的索引。该参数仅限于<a href="LoadGraph.md">LoadGraph</a>调用。针对不同模型，输入Tensor索引内容不同：</p>
<a name="zh-cn_topic_0000002245600277_ul164816383117"></a><a name="zh-cn_topic_0000002245600277_ul164816383117"></a><ul id="zh-cn_topic_0000002245600277_ul164816383117"><li>动态shape模型：需要传递输入Tensor的索引、数据在Device上的地址、数据长度，其中地址要求十进制表示。</li><li>静态shape模型：只需要传递输入Tensor的索引即可；传其他参数比如数据长度参数，不生效。</li></ul>
<p id="zh-cn_topic_0000002245600277_p344511914555"><a name="zh-cn_topic_0000002245600277_p344511914555"></a><a name="zh-cn_topic_0000002245600277_p344511914555"></a><strong id="zh-cn_topic_0000002245600277_b10445219145510"><a name="zh-cn_topic_0000002245600277_b10445219145510"></a><a name="zh-cn_topic_0000002245600277_b10445219145510"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen19011211165715"><a name="zh-cn_topic_0000002245600277_screen19011211165715"></a><a name="zh-cn_topic_0000002245600277_screen19011211165715"></a># 只传输入Tensor索引
{"ge.exec.frozenInputIndexes", "0;1;2"};
# 传递输入Tensor索引、数据在Device上的地址、数据长度
{"ge.exec.frozenInputIndexes", "0,88832131,4;1,888213294,4;2,193492421,2"};</pre>
<p id="zh-cn_topic_0000002245600277_p2047018241419"><a name="zh-cn_topic_0000002245600277_p2047018241419"></a><a name="zh-cn_topic_0000002245600277_p2047018241419"></a><strong id="zh-cn_topic_0000002245600277_b480012408160"><a name="zh-cn_topic_0000002245600277_b480012408160"></a><a name="zh-cn_topic_0000002245600277_b480012408160"></a>使用约束</strong>：</p>
<p id="zh-cn_topic_0000002245600277_p31775597567"><a name="zh-cn_topic_0000002245600277_p31775597567"></a><a name="zh-cn_topic_0000002245600277_p31775597567"></a>地址不刷新的输入Tensor，必须是静态shape，针对动态shape模型，该输入节点Tensor也必须是静态shape。</p>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p1630612533531"><a name="zh-cn_topic_0000002245600277_p1630612533531"></a><a name="zh-cn_topic_0000002245600277_p1630612533531"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p12306175335319"><a name="zh-cn_topic_0000002245600277_p12306175335319"></a><a name="zh-cn_topic_0000002245600277_p12306175335319"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600277_row13636526112811"><td class="cellrowborder" valign="top" width="14.014413712504869%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600277_p1863782632818"><a name="zh-cn_topic_0000002245600277_p1863782632818"></a><a name="zh-cn_topic_0000002245600277_p1863782632818"></a>ge.exec.hostInputIndexes</p>
</td>
<td class="cellrowborder" valign="top" width="69.28320997273082%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600277_p1363752632818"><a name="zh-cn_topic_0000002245600277_p1363752632818"></a><a name="zh-cn_topic_0000002245600277_p1363752632818"></a>随路拷贝场景，设置placement为Host的输入Tensor索引，多个输入的Tensor索引使用英文分号分隔。</p>
<p id="zh-cn_topic_0000002245600277_p1534236142418"><a name="zh-cn_topic_0000002245600277_p1534236142418"></a><a name="zh-cn_topic_0000002245600277_p1534236142418"></a>随路拷贝是指随着模型内算子地址刷新动作，将Host侧输入的Tensor内存一起拷贝到Device侧。</p>
<p id="zh-cn_topic_0000002245600277_p1762125911373"><a name="zh-cn_topic_0000002245600277_p1762125911373"></a><a name="zh-cn_topic_0000002245600277_p1762125911373"></a><strong id="zh-cn_topic_0000002245600277_b876213598373"><a name="zh-cn_topic_0000002245600277_b876213598373"></a><a name="zh-cn_topic_0000002245600277_b876213598373"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600277_screen476245913718"><a name="zh-cn_topic_0000002245600277_screen476245913718"></a><a name="zh-cn_topic_0000002245600277_screen476245913718"></a>{"ge.exec.hostInputIndexes", "0;1;2"};</pre>
<p id="zh-cn_topic_0000002245600277_p103151112382"><a name="zh-cn_topic_0000002245600277_p103151112382"></a><a name="zh-cn_topic_0000002245600277_p103151112382"></a><strong id="zh-cn_topic_0000002245600277_b10338124511397"><a name="zh-cn_topic_0000002245600277_b10338124511397"></a><a name="zh-cn_topic_0000002245600277_b10338124511397"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002245600277_ul91214172262"></a><a name="zh-cn_topic_0000002245600277_ul91214172262"></a><ul id="zh-cn_topic_0000002245600277_ul91214172262"><li>该参数仅适用于静态shape模型。</li><li>随路拷贝特性不适合大数据量的输入，性能可能会有劣化。</li><li>若模型只有一个输入，不支持和ge.exec.frozenInputIndexes同时使用；若模型有多个输入，不支持和ge.exec.frozenInputIndexes指定同一个输入。</li><li>通过<span>options</span>配置项加载该参数后，后续的执行接口不支持使用<a href="RunGraphAsync.md">RunGraphAsync</a>。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="6.817296455005844%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600277_p578033634112"><a name="zh-cn_topic_0000002245600277_p578033634112"></a><a name="zh-cn_topic_0000002245600277_p578033634112"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="9.885079859758473%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600277_p1278015366411"><a name="zh-cn_topic_0000002245600277_p1278015366411"></a><a name="zh-cn_topic_0000002245600277_p1278015366411"></a>graph</p>
</td>
</tr>
</tbody>
</table>

## 内存管理<a name="section12206194919562"></a>

<a name="table19113122595815"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210640100_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002210640100_p3681132911170"><a name="zh-cn_topic_0000002210640100_p3681132911170"></a><a name="zh-cn_topic_0000002210640100_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002210640100_p326514861719"><a name="zh-cn_topic_0000002210640100_p326514861719"></a><a name="zh-cn_topic_0000002210640100_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002210640100_p1572818217519"><a name="zh-cn_topic_0000002210640100_p1572818217519"></a><a name="zh-cn_topic_0000002210640100_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002210640100_p197281421456"><a name="zh-cn_topic_0000002210640100_p197281421456"></a><a name="zh-cn_topic_0000002210640100_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210640100_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p11268105761910"><a name="zh-cn_topic_0000002210640100_p11268105761910"></a><a name="zh-cn_topic_0000002210640100_p11268105761910"></a>ge.exec.disableReuseMemory</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p7682172916175"><a name="zh-cn_topic_0000002210640100_p7682172916175"></a><a name="zh-cn_topic_0000002210640100_p7682172916175"></a>内存复用开关。</p>
<a name="zh-cn_topic_0000002210640100_ul196821829191715"></a><a name="zh-cn_topic_0000002210640100_ul196821829191715"></a><ul id="zh-cn_topic_0000002210640100_ul196821829191715"><li>1：关闭内存复用。</li><li>0：（默认值）开启内存复用。</li></ul>
<p id="zh-cn_topic_0000002210640100_p118794855514"><a name="zh-cn_topic_0000002210640100_p118794855514"></a><a name="zh-cn_topic_0000002210640100_p118794855514"></a><strong id="zh-cn_topic_0000002210640100_b78744814559"><a name="zh-cn_topic_0000002210640100_b78744814559"></a><a name="zh-cn_topic_0000002210640100_b78744814559"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen08754805518"><a name="zh-cn_topic_0000002210640100_screen08754805518"></a><a name="zh-cn_topic_0000002210640100_screen08754805518"></a>{"ge.exec.disableReuseMemory", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p03742265328"><a name="zh-cn_topic_0000002210640100_p03742265328"></a><a name="zh-cn_topic_0000002210640100_p03742265328"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p122746149522"><a name="zh-cn_topic_0000002210640100_p122746149522"></a><a name="zh-cn_topic_0000002210640100_p122746149522"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p148652051105315"><a name="zh-cn_topic_0000002210640100_p148652051105315"></a><a name="zh-cn_topic_0000002210640100_p148652051105315"></a>ge.exec.atomicCleanPolicy</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p987641719347"><a name="zh-cn_topic_0000002210640100_p987641719347"></a><a name="zh-cn_topic_0000002210640100_p987641719347"></a>是否集中清理网络中所有memset算子（含有memset属性的算子都是memset算子）占用的内存。</p>
<p id="zh-cn_topic_0000002210640100_p575143655210"><a name="zh-cn_topic_0000002210640100_p575143655210"></a><a name="zh-cn_topic_0000002210640100_p575143655210"></a><strong id="zh-cn_topic_0000002210640100_b107991718123416"><a name="zh-cn_topic_0000002210640100_b107991718123416"></a><a name="zh-cn_topic_0000002210640100_b107991718123416"></a>参数取值</strong>：</p>
<a name="zh-cn_topic_0000002210640100_ul03101143105210"></a><a name="zh-cn_topic_0000002210640100_ul03101143105210"></a><ul id="zh-cn_topic_0000002210640100_ul03101143105210"><li>0：（默认值）集中清理。</li><li>1：单独清理，对网络中每一个memset算子进行单独清理。当网络中memset算子内存过大时建议使用此种清理方式，对降低使用内存有明显效果，但可能会导致一定的性能损耗。</li></ul>
<p id="zh-cn_topic_0000002210640100_p4567940114310"><a name="zh-cn_topic_0000002210640100_p4567940114310"></a><a name="zh-cn_topic_0000002210640100_p4567940114310"></a><strong id="zh-cn_topic_0000002210640100_b14568940184311"><a name="zh-cn_topic_0000002210640100_b14568940184311"></a><a name="zh-cn_topic_0000002210640100_b14568940184311"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen1656884024317"><a name="zh-cn_topic_0000002210640100_screen1656884024317"></a><a name="zh-cn_topic_0000002210640100_screen1656884024317"></a>{"ge.exec.atomicCleanPolicy", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p538913520557"><a name="zh-cn_topic_0000002210640100_p538913520557"></a><a name="zh-cn_topic_0000002210640100_p538913520557"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p1838915524557"><a name="zh-cn_topic_0000002210640100_p1838915524557"></a><a name="zh-cn_topic_0000002210640100_p1838915524557"></a>session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p12811210174913"><a name="zh-cn_topic_0000002210640100_p12811210174913"></a><a name="zh-cn_topic_0000002210640100_p12811210174913"></a>ge.externalWeight</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p460446129"><a name="zh-cn_topic_0000002210640100_p460446129"></a><a name="zh-cn_topic_0000002210640100_p460446129"></a>同一个Session内同时加载多个模型时，如果多个模型间的权重能够复用，建议通过此配置项将网络中Const/Constant节点的权重外置，实现多个模型间的权重复用，以减少权重的内存占用。</p>
<p id="zh-cn_topic_0000002210640100_p1284132412512"><a name="zh-cn_topic_0000002210640100_p1284132412512"></a><a name="zh-cn_topic_0000002210640100_p1284132412512"></a><strong id="zh-cn_topic_0000002210640100_b7563121291318"><a name="zh-cn_topic_0000002210640100_b7563121291318"></a><a name="zh-cn_topic_0000002210640100_b7563121291318"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210640100_ul1184514015365"></a><a name="zh-cn_topic_0000002210640100_ul1184514015365"></a><ul id="zh-cn_topic_0000002210640100_ul1184514015365"><li>0：（默认值）权重不外置，直接保存在图中。</li><li>1：权重外置，将网络中所有Const/Constant节点的权重文件落盘，并将节点类型转换为FileConstant类型；不同节点权重保存到不同的文件中，以weight_&lt;hash值&gt;命名。</li></ul>
<p id="zh-cn_topic_0000002210640100_p5886343332"><a name="zh-cn_topic_0000002210640100_p5886343332"></a><a name="zh-cn_topic_0000002210640100_p5886343332"></a>落盘路径说明：</p>
<a name="zh-cn_topic_0000002210640100_ul158941431830"></a><a name="zh-cn_topic_0000002210640100_ul158941431830"></a><ul id="zh-cn_topic_0000002210640100_ul158941431830"><li>若配置了ge.externalWeightDir，则权重文件会落盘到指定目录。</li><li>若环境中未配置环境变量，则权重文件落盘至当前执行目录“tmp_weight_<em id="zh-cn_topic_0000002210640100_i1689434310313"><a name="zh-cn_topic_0000002210640100_i1689434310313"></a><a name="zh-cn_topic_0000002210640100_i1689434310313"></a>&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i88948430312"><a name="zh-cn_topic_0000002210640100_i88948430312"></a><a name="zh-cn_topic_0000002210640100_i88948430312"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i38949432320"><a name="zh-cn_topic_0000002210640100_i38949432320"></a><a name="zh-cn_topic_0000002210640100_i38949432320"></a>&gt;</em>”下。</li><li>若环境中配置环境变量，则权重文件会落盘至${ASCEND_WORK_PATH}/tmp_weight<em id="zh-cn_topic_0000002210640100_i379315291141"><a name="zh-cn_topic_0000002210640100_i379315291141"></a><a name="zh-cn_topic_0000002210640100_i379315291141"></a>_&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i11920951715"><a name="zh-cn_topic_0000002210640100_i11920951715"></a><a name="zh-cn_topic_0000002210640100_i11920951715"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i19201451215"><a name="zh-cn_topic_0000002210640100_i19201451215"></a><a name="zh-cn_topic_0000002210640100_i19201451215"></a>&gt;</em>目录下，</li></ul>
<p id="zh-cn_topic_0000002210640100_p135835475317"><a name="zh-cn_topic_0000002210640100_p135835475317"></a><a name="zh-cn_topic_0000002210640100_p135835475317"></a>落盘路径优先级：ge.externalWeightDir &gt; ${ASCEND_WORK_PATH}/tmp_weight<em id="zh-cn_topic_0000002210640100_i11414174175410"><a name="zh-cn_topic_0000002210640100_i11414174175410"></a><a name="zh-cn_topic_0000002210640100_i11414174175410"></a>_&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i144142445410"><a name="zh-cn_topic_0000002210640100_i144142445410"></a><a name="zh-cn_topic_0000002210640100_i144142445410"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i124145475410"><a name="zh-cn_topic_0000002210640100_i124145475410"></a><a name="zh-cn_topic_0000002210640100_i124145475410"></a>&gt;</em> &gt;当前执行目录tmp_weight_<em id="zh-cn_topic_0000002210640100_i74149495410"><a name="zh-cn_topic_0000002210640100_i74149495410"></a><a name="zh-cn_topic_0000002210640100_i74149495410"></a>&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i1941413425415"><a name="zh-cn_topic_0000002210640100_i1941413425415"></a><a name="zh-cn_topic_0000002210640100_i1941413425415"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i144141545541"><a name="zh-cn_topic_0000002210640100_i144141545541"></a><a name="zh-cn_topic_0000002210640100_i144141545541"></a>&gt;</em>。</p>
<p id="zh-cn_topic_0000002210640100_p1315113111341"><a name="zh-cn_topic_0000002210640100_p1315113111341"></a><a name="zh-cn_topic_0000002210640100_p1315113111341"></a>模型卸载时，会将tmp_weight_<em id="zh-cn_topic_0000002210640100_i1936142720349"><a name="zh-cn_topic_0000002210640100_i1936142720349"></a><a name="zh-cn_topic_0000002210640100_i1936142720349"></a>&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i123672763418"><a name="zh-cn_topic_0000002210640100_i123672763418"></a><a name="zh-cn_topic_0000002210640100_i123672763418"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i8361527153412"><a name="zh-cn_topic_0000002210640100_i8361527153412"></a><a name="zh-cn_topic_0000002210640100_i8361527153412"></a>&gt;</em>目录删除。</p>
<p id="zh-cn_topic_0000002210640100_p65051516151117"><a name="zh-cn_topic_0000002210640100_p65051516151117"></a><a name="zh-cn_topic_0000002210640100_p65051516151117"></a><strong id="zh-cn_topic_0000002210640100_b21111820616"><a name="zh-cn_topic_0000002210640100_b21111820616"></a><a name="zh-cn_topic_0000002210640100_b21111820616"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen5332165051812"><a name="zh-cn_topic_0000002210640100_screen5332165051812"></a><a name="zh-cn_topic_0000002210640100_screen5332165051812"></a>{"ge.externalWeight", "1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p1012615306509"><a name="zh-cn_topic_0000002210640100_p1012615306509"></a><a name="zh-cn_topic_0000002210640100_p1012615306509"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p4234766719"><a name="zh-cn_topic_0000002210640100_p4234766719"></a><a name="zh-cn_topic_0000002210640100_p4234766719"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row1462817421445"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p1862804216411"><a name="zh-cn_topic_0000002210640100_p1862804216411"></a><a name="zh-cn_topic_0000002210640100_p1862804216411"></a>ge.externalWeightDir</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p59034431719"><a name="zh-cn_topic_0000002210640100_p59034431719"></a><a name="zh-cn_topic_0000002210640100_p59034431719"></a>用于配置保存外置权重文件落盘的路径。</p>
<p id="zh-cn_topic_0000002210640100_p6243161820192"><a name="zh-cn_topic_0000002210640100_p6243161820192"></a><a name="zh-cn_topic_0000002210640100_p6243161820192"></a><strong id="zh-cn_topic_0000002210640100_b053462510190"><a name="zh-cn_topic_0000002210640100_b053462510190"></a><a name="zh-cn_topic_0000002210640100_b053462510190"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210640100_ul38514329196"></a><a name="zh-cn_topic_0000002210640100_ul38514329196"></a><ul id="zh-cn_topic_0000002210640100_ul38514329196"><li>如果要自行指定外置权重文件存放路径，需与ge.externalWeight参数配合使用。</li><li>优先级：ge.externalWeightDir &gt; ${ASCEND_WORK_PATH}/tmp_weight<em id="zh-cn_topic_0000002210640100_i129116991219"><a name="zh-cn_topic_0000002210640100_i129116991219"></a><a name="zh-cn_topic_0000002210640100_i129116991219"></a>_&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i7291795121"><a name="zh-cn_topic_0000002210640100_i7291795121"></a><a name="zh-cn_topic_0000002210640100_i7291795121"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i1829118911123"><a name="zh-cn_topic_0000002210640100_i1829118911123"></a><a name="zh-cn_topic_0000002210640100_i1829118911123"></a>&gt;</em> &gt;当前执行目录tmp_weight_<em id="zh-cn_topic_0000002210640100_i19971162117123"><a name="zh-cn_topic_0000002210640100_i19971162117123"></a><a name="zh-cn_topic_0000002210640100_i19971162117123"></a>&lt;pid&gt;</em>_<em id="zh-cn_topic_0000002210640100_i1297142120125"><a name="zh-cn_topic_0000002210640100_i1297142120125"></a><a name="zh-cn_topic_0000002210640100_i1297142120125"></a>&lt;sessionid</em><em id="zh-cn_topic_0000002210640100_i13971162101218"><a name="zh-cn_topic_0000002210640100_i13971162101218"></a><a name="zh-cn_topic_0000002210640100_i13971162101218"></a>&gt;</em>。</li></ul>
<p id="zh-cn_topic_0000002210640100_p15158125165616"><a name="zh-cn_topic_0000002210640100_p15158125165616"></a><a name="zh-cn_topic_0000002210640100_p15158125165616"></a><strong id="zh-cn_topic_0000002210640100_b1315814595614"><a name="zh-cn_topic_0000002210640100_b1315814595614"></a><a name="zh-cn_topic_0000002210640100_b1315814595614"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen915813519569"><a name="zh-cn_topic_0000002210640100_screen915813519569"></a><a name="zh-cn_topic_0000002210640100_screen915813519569"></a>{"ge.externalWeight", "1"};
{"ge.externalWeightDir", "<em id="zh-cn_topic_0000002210640100_i15481854155619"><a name="zh-cn_topic_0000002210640100_i15481854155619"></a><a name="zh-cn_topic_0000002210640100_i15481854155619"></a>$HOME/your_tmp_path</em>"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p196286421644"><a name="zh-cn_topic_0000002210640100_p196286421644"></a><a name="zh-cn_topic_0000002210640100_p196286421644"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p17628134212412"><a name="zh-cn_topic_0000002210640100_p17628134212412"></a><a name="zh-cn_topic_0000002210640100_p17628134212412"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p9373181193516"><a name="zh-cn_topic_0000002210640100_p9373181193516"></a><a name="zh-cn_topic_0000002210640100_p9373181193516"></a>ge.exec.staticMemoryPolicy</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p2044592295816"><a name="zh-cn_topic_0000002210640100_p2044592295816"></a><a name="zh-cn_topic_0000002210640100_p2044592295816"></a>网络运行时使用的内存分配方式。</p>
<p id="zh-cn_topic_0000002210640100_p129545753120"><a name="zh-cn_topic_0000002210640100_p129545753120"></a><a name="zh-cn_topic_0000002210640100_p129545753120"></a><strong id="zh-cn_topic_0000002210640100_b20413135103219"><a name="zh-cn_topic_0000002210640100_b20413135103219"></a><a name="zh-cn_topic_0000002210640100_b20413135103219"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210640100_ul525116524818"></a><a name="zh-cn_topic_0000002210640100_ul525116524818"></a><ul id="zh-cn_topic_0000002210640100_ul525116524818"><li>0：（默认值）动态分配内存，即按照实际大小动态分配，不支持内存扩展。</li><li>2：静态shape内存动态扩展，训练与在线推理场景下，可以通过此取值实现同一Session中多张图之间的内存复用，即以最大图所需内存进行分配。例如，假设当前执行图所需内存超过前一张图的内存时，直接释放前一张图的内存，按照当前图所需内存重新分配。</li><li>3：仅动态shape支持内存动态扩展，解决内存动态分配时的碎片问题，降低动态shape网络内存占用。</li><li>4：静态shape和动态shape同时支持内存动态扩展。</li></ul>
<div class="note" id="zh-cn_topic_0000002210640100_note49485562464"><a name="zh-cn_topic_0000002210640100_note49485562464"></a><a name="zh-cn_topic_0000002210640100_note49485562464"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210640100_ul6956122104715"></a><a name="zh-cn_topic_0000002210640100_ul6956122104715"></a><ul id="zh-cn_topic_0000002210640100_ul6956122104715"><li>多张图并发执行时，不支持配置为“2”和“4”。</li><li>为兼容历史版本配置，配置为“1”的场景下，系统会按照“2”动态扩展内存的方式进行处理。</li><li>配置为“3”和“4”的场景下，会有内存收益，但可能会造成一定的性能损失。</li></ul>
</div></div>
<p id="zh-cn_topic_0000002210640100_p52213589596"><a name="zh-cn_topic_0000002210640100_p52213589596"></a><a name="zh-cn_topic_0000002210640100_p52213589596"></a><strong id="zh-cn_topic_0000002210640100_b11106556143117"><a name="zh-cn_topic_0000002210640100_b11106556143117"></a><a name="zh-cn_topic_0000002210640100_b11106556143117"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen1822115816593"><a name="zh-cn_topic_0000002210640100_screen1822115816593"></a><a name="zh-cn_topic_0000002210640100_screen1822115816593"></a>{"ge.exec.staticMemoryPolicy", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p167231239172914"><a name="zh-cn_topic_0000002210640100_p167231239172914"></a><a name="zh-cn_topic_0000002210640100_p167231239172914"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p187235398291"><a name="zh-cn_topic_0000002210640100_p187235398291"></a><a name="zh-cn_topic_0000002210640100_p187235398291"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p386041913205"><a name="zh-cn_topic_0000002210640100_p386041913205"></a><a name="zh-cn_topic_0000002210640100_p386041913205"></a>ge.featureBaseRefreshable</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p16617202919554"><a name="zh-cn_topic_0000002210640100_p16617202919554"></a><a name="zh-cn_topic_0000002210640100_p16617202919554"></a>配置feature内存地址是否可刷新。若用户需要自行管理feature内存并需要多次刷新该地址，则可将该参数配置为可刷新。</p>
<p id="zh-cn_topic_0000002210640100_p17161135875818"><a name="zh-cn_topic_0000002210640100_p17161135875818"></a><a name="zh-cn_topic_0000002210640100_p17161135875818"></a>该参数仅限于静态shape图。</p>
<p id="zh-cn_topic_0000002210640100_p6446173115554"><a name="zh-cn_topic_0000002210640100_p6446173115554"></a><a name="zh-cn_topic_0000002210640100_p6446173115554"></a><strong id="zh-cn_topic_0000002210640100_b10875852203111"><a name="zh-cn_topic_0000002210640100_b10875852203111"></a><a name="zh-cn_topic_0000002210640100_b10875852203111"></a>参数取值：</strong></p>
<p id="zh-cn_topic_0000002210640100_p194527306530"><a name="zh-cn_topic_0000002210640100_p194527306530"></a><a name="zh-cn_topic_0000002210640100_p194527306530"></a>0：（默认值）feature内存地址不可刷新。</p>
<p id="zh-cn_topic_0000002210640100_p68605198204"><a name="zh-cn_topic_0000002210640100_p68605198204"></a><a name="zh-cn_topic_0000002210640100_p68605198204"></a>1：支持刷新模型的feature内存地址。</p>
<p id="zh-cn_topic_0000002210640100_p021561394511"><a name="zh-cn_topic_0000002210640100_p021561394511"></a><a name="zh-cn_topic_0000002210640100_p021561394511"></a><strong id="zh-cn_topic_0000002210640100_b4215201318451"><a name="zh-cn_topic_0000002210640100_b4215201318451"></a><a name="zh-cn_topic_0000002210640100_b4215201318451"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen821581315455"><a name="zh-cn_topic_0000002210640100_screen821581315455"></a><a name="zh-cn_topic_0000002210640100_screen821581315455"></a>{"ge.featureBaseRefreshable", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p1486013192200"><a name="zh-cn_topic_0000002210640100_p1486013192200"></a><a name="zh-cn_topic_0000002210640100_p1486013192200"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p7860101919205"><a name="zh-cn_topic_0000002210640100_p7860101919205"></a><a name="zh-cn_topic_0000002210640100_p7860101919205"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row3561164716539"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p1680764981713"><a name="zh-cn_topic_0000002210640100_p1680764981713"></a><a name="zh-cn_topic_0000002210640100_p1680764981713"></a>ge.exec.inputReuseMemIndexes</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p12807049111712"><a name="zh-cn_topic_0000002210640100_p12807049111712"></a><a name="zh-cn_topic_0000002210640100_p12807049111712"></a>用于配置是否开启图的输入节点的内存复用功能，开启后，输入节点的内存可作为模型执行过程中所需要的中间内存再次使用，从而达到降低内存峰值的目的。</p>
<p id="zh-cn_topic_0000002210640100_p7176227183011"><a name="zh-cn_topic_0000002210640100_p7176227183011"></a><a name="zh-cn_topic_0000002210640100_p7176227183011"></a>参数取值为输入节点的index；如果对多个输入节点都开启内存复用，多个index间使用英文逗号分隔。输入节点需要设置属性index，说明是第几个输入，index从0开始。</p>
<p id="zh-cn_topic_0000002210640100_p15308127184110"><a name="zh-cn_topic_0000002210640100_p15308127184110"></a><a name="zh-cn_topic_0000002210640100_p15308127184110"></a>注意：</p>
<a name="zh-cn_topic_0000002210640100_ul184110346416"></a><a name="zh-cn_topic_0000002210640100_ul184110346416"></a><ul id="zh-cn_topic_0000002210640100_ul184110346416"><li>若开启了输入节点的内存复用功能，需要用户确保输入的内存大小已经32字节对齐。</li><li>若所配置的输入index大于等于“输入个数”的值，属于非法index，该index配置不生效。</li><li>若开启了输入节点的内存复用功能，输入节点内存中的数据会被改写，图执行后，不可以继续使用输入节点内存中的内容。</li></ul>
<p id="zh-cn_topic_0000002210640100_p1336752173310"><a name="zh-cn_topic_0000002210640100_p1336752173310"></a><a name="zh-cn_topic_0000002210640100_p1336752173310"></a><strong id="zh-cn_topic_0000002210640100_b2111144519314"><a name="zh-cn_topic_0000002210640100_b2111144519314"></a><a name="zh-cn_topic_0000002210640100_b2111144519314"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen4368122117335"><a name="zh-cn_topic_0000002210640100_screen4368122117335"></a><a name="zh-cn_topic_0000002210640100_screen4368122117335"></a>{"ge.exec.inputReuseMemIndexes", "0,1,2"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p159449475371"><a name="zh-cn_topic_0000002210640100_p159449475371"></a><a name="zh-cn_topic_0000002210640100_p159449475371"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p39448471374"><a name="zh-cn_topic_0000002210640100_p39448471374"></a><a name="zh-cn_topic_0000002210640100_p39448471374"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row165612047165310"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p1831151810203"><a name="zh-cn_topic_0000002210640100_p1831151810203"></a><a name="zh-cn_topic_0000002210640100_p1831151810203"></a>ge.exec.outputReuseMemIndexes</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p18745114310332"><a name="zh-cn_topic_0000002210640100_p18745114310332"></a><a name="zh-cn_topic_0000002210640100_p18745114310332"></a>用于配置是否开启整图输出的内存复用功能，开启后，整图输出的内存可作为模型执行过程中所需要的中间内存再次使用，从而达到降低内存峰值的目的。</p>
<p id="zh-cn_topic_0000002210640100_p197458437333"><a name="zh-cn_topic_0000002210640100_p197458437333"></a><a name="zh-cn_topic_0000002210640100_p197458437333"></a>如果开启，配置为整图输出的index；如果对多个输出都开启内存复用，多个index间使用英文逗号分隔。</p>
<p id="zh-cn_topic_0000002210640100_p4838249994"><a name="zh-cn_topic_0000002210640100_p4838249994"></a><a name="zh-cn_topic_0000002210640100_p4838249994"></a>注意：</p>
<a name="zh-cn_topic_0000002210640100_ul162315551397"></a><a name="zh-cn_topic_0000002210640100_ul162315551397"></a><ul id="zh-cn_topic_0000002210640100_ul162315551397"><li>若开启了整图输出的内存复用功能，需要用户确保输出的内存大小已经32字节对齐。</li><li>输出的index，按照整图输出的顺序标识，index从0开始。</li><li>若所配置的输出index大于等于“输出个数”的值，属于非法index，该index配置不生效。</li></ul>
<p id="zh-cn_topic_0000002210640100_p9745194373311"><a name="zh-cn_topic_0000002210640100_p9745194373311"></a><a name="zh-cn_topic_0000002210640100_p9745194373311"></a><strong id="zh-cn_topic_0000002210640100_b715144293118"><a name="zh-cn_topic_0000002210640100_b715144293118"></a><a name="zh-cn_topic_0000002210640100_b715144293118"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen1074554313331"><a name="zh-cn_topic_0000002210640100_screen1074554313331"></a><a name="zh-cn_topic_0000002210640100_screen1074554313331"></a>{"ge.exec.outputReuseMemIndexes", "0,1,2"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p712319490372"><a name="zh-cn_topic_0000002210640100_p712319490372"></a><a name="zh-cn_topic_0000002210640100_p712319490372"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p712344912377"><a name="zh-cn_topic_0000002210640100_p712344912377"></a><a name="zh-cn_topic_0000002210640100_p712344912377"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row16954621191816"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p10488151013915"><a name="zh-cn_topic_0000002210640100_p10488151013915"></a><a name="zh-cn_topic_0000002210640100_p10488151013915"></a>ge.exec.input_fusion_size</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p108193131111"><a name="zh-cn_topic_0000002210640100_p108193131111"></a><a name="zh-cn_topic_0000002210640100_p108193131111"></a>Host侧输入数据搬运到Device侧时，将用户离散多个输入数据合并拷贝的阈值，最小值为0，最大值为32MB（33554432字节），默认值为128KB（131072字节）。若：</p>
<a name="zh-cn_topic_0000002210640100_ul236911413157"></a><a name="zh-cn_topic_0000002210640100_ul236911413157"></a><ul id="zh-cn_topic_0000002210640100_ul236911413157"><li>输入数据大小<strong id="zh-cn_topic_0000002210640100_b1914212113161"><a name="zh-cn_topic_0000002210640100_b1914212113161"></a><a name="zh-cn_topic_0000002210640100_b1914212113161"></a>&lt;=</strong>阈值，则合并输入，然后从host搬运到device。</li><li>输入数据大小<strong id="zh-cn_topic_0000002210640100_b8691122121620"><a name="zh-cn_topic_0000002210640100_b8691122121620"></a><a name="zh-cn_topic_0000002210640100_b8691122121620"></a>&gt;</strong>阈值，或者阈值=0（功能关闭），则不合并，直接从host搬运到device。</li></ul>
<p id="zh-cn_topic_0000002210640100_p22442444132"><a name="zh-cn_topic_0000002210640100_p22442444132"></a><a name="zh-cn_topic_0000002210640100_p22442444132"></a>例如用户有10个输入，有2个输入数据大小为100KB，2个输入数据大小为50KB，其余输入大于100KB，若设置：</p>
<a name="zh-cn_topic_0000002210640100_ul183315508155"></a><a name="zh-cn_topic_0000002210640100_ul183315508155"></a><ul id="zh-cn_topic_0000002210640100_ul183315508155"><li>ge.exec.input_fusion_size=100KB，则上述4个输入合并为300KB，执行搬运；其他6个输入，直接从host搬运到device。</li><li>ge.exec.input_fusion_size=0，则该功能关闭，无输入合并，即10个输入直接从host搬运到device。</li></ul>
<p id="zh-cn_topic_0000002210640100_p136701644112410"><a name="zh-cn_topic_0000002210640100_p136701644112410"></a><a name="zh-cn_topic_0000002210640100_p136701644112410"></a>该参数只在异步静态shape图执行时生效，即使用<a href="RunGraphAsync.md">RunGraphAsync</a>接口运行Graph。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p154880101496"><a name="zh-cn_topic_0000002210640100_p154880101496"></a><a name="zh-cn_topic_0000002210640100_p154880101496"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p194883101993"><a name="zh-cn_topic_0000002210640100_p194883101993"></a><a name="zh-cn_topic_0000002210640100_p194883101993"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640100_row2019171418351"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640100_p18766151142619"><a name="zh-cn_topic_0000002210640100_p18766151142619"></a><a name="zh-cn_topic_0000002210640100_p18766151142619"></a>ge.inputBatchCpy</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640100_p164165094619"><a name="zh-cn_topic_0000002210640100_p164165094619"></a><a name="zh-cn_topic_0000002210640100_p164165094619"></a>Host侧输入数据搬运到Device侧时，是否开启批量内存拷贝功能。</p>
<p id="zh-cn_topic_0000002210640100_p207661411182610"><a name="zh-cn_topic_0000002210640100_p207661411182610"></a><a name="zh-cn_topic_0000002210640100_p207661411182610"></a>该参数可以提升Host到Device的数据搬运性能，适用于需要频繁搬运数据且PCIE带宽使用率低的场景；开启该参数批量拷贝功能后，可以提升带宽利用率。</p>
<p id="zh-cn_topic_0000002210640100_p1973435310379"><a name="zh-cn_topic_0000002210640100_p1973435310379"></a><a name="zh-cn_topic_0000002210640100_p1973435310379"></a><strong id="zh-cn_topic_0000002210640100_b15169155910378"><a name="zh-cn_topic_0000002210640100_b15169155910378"></a><a name="zh-cn_topic_0000002210640100_b15169155910378"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210640100_ul1960421613317"></a><a name="zh-cn_topic_0000002210640100_ul1960421613317"></a><ul id="zh-cn_topic_0000002210640100_ul1960421613317"><li>1：开启批量内存拷贝功能。该取值仅在用户输入个数大于1时，功能才会生效。</li><li>0：（默认值）关闭批量内存拷贝功能。</li></ul>
<p id="zh-cn_topic_0000002210640100_p128791341285"><a name="zh-cn_topic_0000002210640100_p128791341285"></a><a name="zh-cn_topic_0000002210640100_p128791341285"></a><strong id="zh-cn_topic_0000002210640100_b9352141193718"><a name="zh-cn_topic_0000002210640100_b9352141193718"></a><a name="zh-cn_topic_0000002210640100_b9352141193718"></a>使用约束</strong>：</p>
<a name="zh-cn_topic_0000002210640100_ul3643144519192"></a><a name="zh-cn_topic_0000002210640100_ul3643144519192"></a><ul id="zh-cn_topic_0000002210640100_ul3643144519192"><li>该参数仅支持如下<span id="zh-cn_topic_0000002210640100_ph20833205312295"><a name="zh-cn_topic_0000002210640100_ph20833205312295"></a><a name="zh-cn_topic_0000002210640100_ph20833205312295"></a>产品</span>：<p id="zh-cn_topic_0000002210640100_p15992252113218"><a name="zh-cn_topic_0000002210640100_p15992252113218"></a><a name="zh-cn_topic_0000002210640100_p15992252113218"></a><span id="zh-cn_topic_0000002210640100_ph13754548217"><a name="zh-cn_topic_0000002210640100_ph13754548217"></a><a name="zh-cn_topic_0000002210640100_ph13754548217"></a><term id="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210640100_p123298520323"><a name="zh-cn_topic_0000002210640100_p123298520323"></a><a name="zh-cn_topic_0000002210640100_p123298520323"></a><span id="zh-cn_topic_0000002210640100_ph1292674871116"><a name="zh-cn_topic_0000002210640100_ph1292674871116"></a><a name="zh-cn_topic_0000002210640100_ph1292674871116"></a><term id="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210640100_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
</li><li>该特性通常在多Session场景下使用，考虑到不同Session中的输入个数可能不同，因此推荐配置为session级，根据输入情况选择是否使能，不推荐配置为全局级别或者graph级别。</li><li>Session初始化时传入该参数，后续运行Graph时，目前只能通过<a href="RunGraphAsync.md">RunGraphAsync</a>接口使能该特性。</li><li>若网络初始输入个数为1，即使配置了批量拷贝功能也不会生效。</li><li>若同时配置ge.exec.input_fusion_size合并拷贝和开启ge.inputBatchCpy批量拷贝功能，合并拷贝的阈值可能会影响批量拷贝功能。<p id="zh-cn_topic_0000002210640100_p45052537198"><a name="zh-cn_topic_0000002210640100_p45052537198"></a><a name="zh-cn_topic_0000002210640100_p45052537198"></a>例如，用户有5个输入，有4个输入满足合并拷贝阈值，此4个输入执行合并拷贝功能，剩余的1个输入不会执行批量拷贝功能。</p>
</li></ul>
<p id="zh-cn_topic_0000002210640100_p1101184815276"><a name="zh-cn_topic_0000002210640100_p1101184815276"></a><a name="zh-cn_topic_0000002210640100_p1101184815276"></a><strong id="zh-cn_topic_0000002210640100_b1679611598276"><a name="zh-cn_topic_0000002210640100_b1679611598276"></a><a name="zh-cn_topic_0000002210640100_b1679611598276"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640100_screen142765612711"><a name="zh-cn_topic_0000002210640100_screen142765612711"></a><a name="zh-cn_topic_0000002210640100_screen142765612711"></a>{"ge.inputBatchCpy", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640100_p9766111112619"><a name="zh-cn_topic_0000002210640100_p9766111112619"></a><a name="zh-cn_topic_0000002210640100_p9766111112619"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640100_p1179185017434"><a name="zh-cn_topic_0000002210640100_p1179185017434"></a><a name="zh-cn_topic_0000002210640100_p1179185017434"></a>all</p>
</td>
</tr>
</tbody>
</table>

## 动态shape<a name="section1179795275614"></a>

<a name="table1920220269582"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245680161_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002245680161_p3681132911170"><a name="zh-cn_topic_0000002245680161_p3681132911170"></a><a name="zh-cn_topic_0000002245680161_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002245680161_p326514861719"><a name="zh-cn_topic_0000002245680161_p326514861719"></a><a name="zh-cn_topic_0000002245680161_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002245680161_p1572818217519"><a name="zh-cn_topic_0000002245680161_p1572818217519"></a><a name="zh-cn_topic_0000002245680161_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002245680161_p197281421456"><a name="zh-cn_topic_0000002245680161_p197281421456"></a><a name="zh-cn_topic_0000002245680161_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245680161_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680161_p43764386453"><a name="zh-cn_topic_0000002245680161_p43764386453"></a><a name="zh-cn_topic_0000002245680161_p43764386453"></a>ge.inputShape</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680161_p23761038124519"><a name="zh-cn_topic_0000002245680161_p23761038124519"></a><a name="zh-cn_topic_0000002245680161_p23761038124519"></a>指定模型输入数据的shape。</p>
<p id="zh-cn_topic_0000002245680161_p18259141611816"><a name="zh-cn_topic_0000002245680161_p18259141611816"></a><a name="zh-cn_topic_0000002245680161_p18259141611816"></a><strong id="zh-cn_topic_0000002245680161_b1997853603511"><a name="zh-cn_topic_0000002245680161_b1997853603511"></a><a name="zh-cn_topic_0000002245680161_b1997853603511"></a>参数取值</strong>：</p>
<a name="zh-cn_topic_0000002245680161_ul18348151983611"></a><a name="zh-cn_topic_0000002245680161_ul18348151983611"></a><ul id="zh-cn_topic_0000002245680161_ul18348151983611"><li>模型为固定shape，ge.inputShape参数为<strong id="zh-cn_topic_0000002245680161_b17793534132617"><a name="zh-cn_topic_0000002245680161_b17793534132617"></a><a name="zh-cn_topic_0000002245680161_b17793534132617"></a>可选</strong>配置<a name="zh-cn_topic_0000002245680161_ul1912311449369"></a><a name="zh-cn_topic_0000002245680161_ul1912311449369"></a><ul id="zh-cn_topic_0000002245680161_ul1912311449369"><li>若模型为单个输入，则shape信息为"input_name:n,c,h,w"。</li><li>若模型有多个输入，则shape信息为"input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2"；不同输入之间使用<strong id="zh-cn_topic_0000002245680161_b983813911370"><a name="zh-cn_topic_0000002245680161_b983813911370"></a><a name="zh-cn_topic_0000002245680161_b983813911370"></a>英文分号</strong>分隔，input_name必须是转换前的网络模型中的节点名称。</li></ul>
</li><li>模型为非固定shape，ge.inputShape参数<strong id="zh-cn_topic_0000002245680161_b11320153602619"><a name="zh-cn_topic_0000002245680161_b11320153602619"></a><a name="zh-cn_topic_0000002245680161_b11320153602619"></a>必须</strong>配置<div class="p" id="zh-cn_topic_0000002245680161_p114481316456"><a name="zh-cn_topic_0000002245680161_p114481316456"></a><a name="zh-cn_topic_0000002245680161_p114481316456"></a>若原始模型中输入数据的某个或某些维度值不固定，当前支持通过设置shape分档或设置shape范围两种方式转换模型：<a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001265392746_ul1918983152412"></a><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001265392746_ul1918983152412"></a><ul id="zh-cn_topic_0000002245680161_zh-cn_topic_0000001265392746_ul1918983152412"><li>设置shape分档（静态shape），包括设置动态维度档位（最多4维）。<p id="zh-cn_topic_0000002245680161_p17288570431"><a name="zh-cn_topic_0000002245680161_p17288570431"></a><a name="zh-cn_topic_0000002245680161_p17288570431"></a>设置ge.inputShape参数时，将对应维度值设置为-1，需要同时配合ge.dynamicDims（设置动态维度档位）参数、ge.dynamicNodeType（指定动态输入的节点类型）参数一起使用。</p>
</li><li>设置shape范围（动态shape）。<p id="zh-cn_topic_0000002245680161_p1173134904516"><a name="zh-cn_topic_0000002245680161_p1173134904516"></a><a name="zh-cn_topic_0000002245680161_p1173134904516"></a>设置ge.inputShape参数时，可将对应维度的值设置为范围，例如1~10，<strong id="zh-cn_topic_0000002245680161_b15812881419"><a name="zh-cn_topic_0000002245680161_b15812881419"></a><a name="zh-cn_topic_0000002245680161_b15812881419"></a>设置的range值范围必须有效</strong>。</p>
<a name="zh-cn_topic_0000002245680161_ul183092116455"></a><a name="zh-cn_topic_0000002245680161_ul183092116455"></a><ul id="zh-cn_topic_0000002245680161_ul183092116455"><li>支持按照name设置："input_name1:n1,c1,h1,w1;input_name2:n2,c2,h2,w2"，例如："input_name1:8~20,3,5,-1;input_name2:5,3~9,10,-1"。指定的节点必须放在双引号中，节点中间使用英文分号分隔。input_name必须是转换前的网络模型中的节点名称。如果用户知道data节点的name，推荐按照name设置。</li></ul>
<p id="zh-cn_topic_0000002245680161_zh-cn_topic_0000001265392746_p79798472412"><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001265392746_p79798472412"></a><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001265392746_p79798472412"></a>如果用户不想指定维度的范围或具体取值，则可以将其设置为-1，表示此维度可以使用&gt;=0的任意取值，该场景下取值上限为int64数据类型表达范围，但受限于host和device侧物理内存的大小，用户可以通过增大内存来支持。</p>
</li></ul>
</div>
</li><li>模型shape为标量<a name="zh-cn_topic_0000002245680161_ul13148101105515"></a><a name="zh-cn_topic_0000002245680161_ul13148101105515"></a><ul id="zh-cn_topic_0000002245680161_ul13148101105515"><li>非动态分档场景：<p id="zh-cn_topic_0000002245680161_p5673173219453"><a name="zh-cn_topic_0000002245680161_p5673173219453"></a><a name="zh-cn_topic_0000002245680161_p5673173219453"></a>shape为标量的输入，可选配置，例如模型有两个输入，input_name1为标量，即shape为"[]"形式，input_name2输入shape为[n2,c2,h2,w2]，则shape信息为"<strong id="zh-cn_topic_0000002245680161_b1568561055114"><a name="zh-cn_topic_0000002245680161_b1568561055114"></a><a name="zh-cn_topic_0000002245680161_b1568561055114"></a>input_name1:</strong>;input_name2:n2,c2,h2,w2"，不同输入之间使用<strong id="zh-cn_topic_0000002245680161_b13885446375"><a name="zh-cn_topic_0000002245680161_b13885446375"></a><a name="zh-cn_topic_0000002245680161_b13885446375"></a>英文分号</strong>分隔，input_name必须是转换前的网络模型中的节点名称；标量的输入如果配置，则配置为空。</p>
</li><li>动态分档场景：<p id="zh-cn_topic_0000002245680161_p7446410195312"><a name="zh-cn_topic_0000002245680161_p7446410195312"></a><a name="zh-cn_topic_0000002245680161_p7446410195312"></a>如果模型输入中既有标量shape，又有支持动态分档的shape，则标量输入不能忽略，必须配置。例如模型有三个输入，分别为A:[-1,c1,h1,w1]、B:[]、C:[n2,c2,h2,w2]，则shape信息为"A:-1,c1,h1,w1;<strong id="zh-cn_topic_0000002245680161_b03335562567"><a name="zh-cn_topic_0000002245680161_b03335562567"></a><a name="zh-cn_topic_0000002245680161_b03335562567"></a>B:</strong>;C:n2,c2,h2,w2"，标量输入B必须配置。</p>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002245680161_p206921227101819"><a name="zh-cn_topic_0000002245680161_p206921227101819"></a><a name="zh-cn_topic_0000002245680161_p206921227101819"></a><strong id="zh-cn_topic_0000002245680161_b2082541350"><a name="zh-cn_topic_0000002245680161_b2082541350"></a><a name="zh-cn_topic_0000002245680161_b2082541350"></a>配置示例：</strong></p>
<a name="zh-cn_topic_0000002245680161_ul75371434611"></a><a name="zh-cn_topic_0000002245680161_ul75371434611"></a><ul id="zh-cn_topic_0000002245680161_ul75371434611"><li>固定shape，例如某网络的输入shape信息，输入1<strong id="zh-cn_topic_0000002245680161_b47771081914"><a name="zh-cn_topic_0000002245680161_b47771081914"></a><a name="zh-cn_topic_0000002245680161_b47771081914"></a>：</strong>input_0_0 [16,32,208,208]，输入2：input_1_0 [16,64,208,208]，则ge.inputShape的配置信息为：<pre class="screen" id="zh-cn_topic_0000002245680161_screen1485218281822"><a name="zh-cn_topic_0000002245680161_screen1485218281822"></a><a name="zh-cn_topic_0000002245680161_screen1485218281822"></a>{"ge.inputShape", "input_0_0:16,32,208,208;input_1_0:16,64,208,208"}</pre>
</li><li>非固定shape：<a name="zh-cn_topic_0000002245680161_ul42771272371"></a><a name="zh-cn_topic_0000002245680161_ul42771272371"></a><ul id="zh-cn_topic_0000002245680161_ul42771272371"><li>设置指定维度档位的示例，请参见ge.dynamicDims。</li><li>设置shape范围的示例：<pre class="screen" id="zh-cn_topic_0000002245680161_screen231111178582"><a name="zh-cn_topic_0000002245680161_screen231111178582"></a><a name="zh-cn_topic_0000002245680161_screen231111178582"></a>{"ge.inputShape", "input_0_0:1<font style="font-size:8pt" Face="Courier New" >~</font>10,32,208,208;input_1_0:16,64,100<font style="font-size:8pt" Face="Courier New" >~</font>208,100<font style="font-size:8pt" Face="Courier New" >~</font>208"}</pre>
</li></ul>
</li><li>shape为标量<a name="zh-cn_topic_0000002245680161_ul954852952520"></a><a name="zh-cn_topic_0000002245680161_ul954852952520"></a><ul id="zh-cn_topic_0000002245680161_ul954852952520"><li>非动态分档场景<p id="zh-cn_topic_0000002245680161_p20574194712282"><a name="zh-cn_topic_0000002245680161_p20574194712282"></a><a name="zh-cn_topic_0000002245680161_p20574194712282"></a>shape为标量的输入，可选配置。例如模型有两个输入，<strong id="zh-cn_topic_0000002245680161_b15823193315273"><a name="zh-cn_topic_0000002245680161_b15823193315273"></a><a name="zh-cn_topic_0000002245680161_b15823193315273"></a>input_name1</strong>为标量，input_name2输入shape为[16,32,208,208]，配置示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002245680161_screen4404181322810"><a name="zh-cn_topic_0000002245680161_screen4404181322810"></a><a name="zh-cn_topic_0000002245680161_screen4404181322810"></a>{"ge.inputShape",<strong id="zh-cn_topic_0000002245680161_b5424193420242"><a name="zh-cn_topic_0000002245680161_b5424193420242"></a><a name="zh-cn_topic_0000002245680161_b5424193420242"></a> "input_name1:</strong>;input_name2:16,32,208,208<strong id="zh-cn_topic_0000002245680161_b1715151104119"><a name="zh-cn_topic_0000002245680161_b1715151104119"></a><a name="zh-cn_topic_0000002245680161_b1715151104119"></a>"</strong>}</pre>
<p id="zh-cn_topic_0000002245680161_p4526182514289"><a name="zh-cn_topic_0000002245680161_p4526182514289"></a><a name="zh-cn_topic_0000002245680161_p4526182514289"></a>上述示例中的<strong id="zh-cn_topic_0000002245680161_b1610241016434"><a name="zh-cn_topic_0000002245680161_b1610241016434"></a><a name="zh-cn_topic_0000002245680161_b1610241016434"></a>input_name1</strong>为可选配置<strong id="zh-cn_topic_0000002245680161_b8102110114310"><a name="zh-cn_topic_0000002245680161_b8102110114310"></a><a name="zh-cn_topic_0000002245680161_b8102110114310"></a>。</strong></p>
</li><li>动态分档场景<p id="zh-cn_topic_0000002245680161_p91481505267"><a name="zh-cn_topic_0000002245680161_p91481505267"></a><a name="zh-cn_topic_0000002245680161_p91481505267"></a>shape为标量的输入，必须配置。例如模型有三个输入，shape信息分别为A:[-1,32,208,208]、<strong id="zh-cn_topic_0000002245680161_b10898728182611"><a name="zh-cn_topic_0000002245680161_b10898728182611"></a><a name="zh-cn_topic_0000002245680161_b10898728182611"></a>B:[]</strong>、C:[16,64,208,208]，则配置示例为（A为动态分档输入，此处以设置动态维度档位为例）：</p>
<pre class="screen" id="zh-cn_topic_0000002245680161_screen1941843045918"><a name="zh-cn_topic_0000002245680161_screen1941843045918"></a><a name="zh-cn_topic_0000002245680161_screen1941843045918"></a>{"ge.inputShape", "A:-1,32,208,208;<strong id="zh-cn_topic_0000002245680161_b161281391449"><a name="zh-cn_topic_0000002245680161_b161281391449"></a><a name="zh-cn_topic_0000002245680161_b161281391449"></a>B:</strong>;C:16,64,208,208"}, 
{"ge.dynamicDims", "1;2;4"} </pre>
</li></ul>
</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680161_p5376103864516"><a name="zh-cn_topic_0000002245680161_p5376103864516"></a><a name="zh-cn_topic_0000002245680161_p5376103864516"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680161_p20376113844516"><a name="zh-cn_topic_0000002245680161_p20376113844516"></a><a name="zh-cn_topic_0000002245680161_p20376113844516"></a>session/graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680161_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680161_p192351136174515"><a name="zh-cn_topic_0000002245680161_p192351136174515"></a><a name="zh-cn_topic_0000002245680161_p192351136174515"></a>ge.dynamicDims</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680161_p12426940161419"><a name="zh-cn_topic_0000002245680161_p12426940161419"></a><a name="zh-cn_topic_0000002245680161_p12426940161419"></a>设置ND格式下动态维度的档位，适用于执行推理时，每次处理任意维度的场景。该参数需要与ge.inputShape配合使用。详细使用示例请参见<a href="zh-cn_topic_0000001631074125.md">编译并运行Graph场景</a>。</p>
<p id="zh-cn_topic_0000002245680161_p106121652185213"><a name="zh-cn_topic_0000002245680161_p106121652185213"></a><a name="zh-cn_topic_0000002245680161_p106121652185213"></a><strong id="zh-cn_topic_0000002245680161_b162095457530"><a name="zh-cn_topic_0000002245680161_b162095457530"></a><a name="zh-cn_topic_0000002245680161_b162095457530"></a>参数取值：</strong>通过"dim1,dim2,dim3;dim4,dim5,dim6;dim7,dim8,dim9"的形式设置。</p>
<p id="zh-cn_topic_0000002245680161_p1459913114535"><a name="zh-cn_topic_0000002245680161_p1459913114535"></a><a name="zh-cn_topic_0000002245680161_p1459913114535"></a><strong id="zh-cn_topic_0000002245680161_b5111172045315"><a name="zh-cn_topic_0000002245680161_b5111172045315"></a><a name="zh-cn_topic_0000002245680161_b5111172045315"></a>参数值格式：</strong>所有档位必须放在双引号中，档位之间使用英文<strong id="zh-cn_topic_0000002245680161_b18398351232"><a name="zh-cn_topic_0000002245680161_b18398351232"></a><a name="zh-cn_topic_0000002245680161_b18398351232"></a>分号</strong>分隔，每档内参数使用英文<strong id="zh-cn_topic_0000002245680161_b06871610182619"><a name="zh-cn_topic_0000002245680161_b06871610182619"></a><a name="zh-cn_topic_0000002245680161_b06871610182619"></a>逗号</strong>分隔；每档中的dim值与ge.inputShape参数中的-1标识的参数依次对应，inputShape参数中有几个-1，则每档必须设置几个维度。并且要求档位信息必须大于1组。</p>
<p id="zh-cn_topic_0000002245680161_p208812111530"><a name="zh-cn_topic_0000002245680161_p208812111530"></a><a name="zh-cn_topic_0000002245680161_p208812111530"></a><strong id="zh-cn_topic_0000002245680161_b7112132035312"><a name="zh-cn_topic_0000002245680161_b7112132035312"></a><a name="zh-cn_topic_0000002245680161_b7112132035312"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002245680161_ul1922815467394"></a><a name="zh-cn_topic_0000002245680161_ul1922815467394"></a><ul id="zh-cn_topic_0000002245680161_ul1922815467394"><li>针对如下<span id="zh-cn_topic_0000002245680161_ph20833205312295"><a name="zh-cn_topic_0000002245680161_ph20833205312295"></a><a name="zh-cn_topic_0000002245680161_ph20833205312295"></a>产品</span>，档位数约束为：档位数取值范围为(1,100]，即必须设置至少2个档位，最多支持100档配置，建议配置为3~4档。<p id="zh-cn_topic_0000002245680161_p8883123613715"><a name="zh-cn_topic_0000002245680161_p8883123613715"></a><a name="zh-cn_topic_0000002245680161_p8883123613715"></a><span id="zh-cn_topic_0000002245680161_ph204011434677"><a name="zh-cn_topic_0000002245680161_ph204011434677"></a><a name="zh-cn_topic_0000002245680161_ph204011434677"></a><term id="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002245680161_p6995174014710"><a name="zh-cn_topic_0000002245680161_p6995174014710"></a><a name="zh-cn_topic_0000002245680161_p6995174014710"></a><span id="zh-cn_topic_0000002245680161_ph1740116346711"><a name="zh-cn_topic_0000002245680161_ph1740116346711"></a><a name="zh-cn_topic_0000002245680161_ph1740116346711"></a><term id="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245680161_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002245680161_p150122011520"><a name="zh-cn_topic_0000002245680161_p150122011520"></a><a name="zh-cn_topic_0000002245680161_p150122011520"></a>使用示例：</p>
<a name="zh-cn_topic_0000002245680161_ul232619491388"></a><a name="zh-cn_topic_0000002245680161_ul232619491388"></a><ul id="zh-cn_topic_0000002245680161_ul232619491388"><li>若模型只有一个输入：<pre class="screen" id="zh-cn_topic_0000002245680161_screen175214235126"><a name="zh-cn_topic_0000002245680161_screen175214235126"></a><a name="zh-cn_topic_0000002245680161_screen175214235126"></a>{"ge.inputShape", "data:1,-1,-1"}
{"ge.dynamicDims", "1,2;3,4;5,6;7,8"}
// graph运行时，支持的data算子的shape为1,1,2; 1,3,4; 1,5,6; 1,7,8</pre>
</li><li>若网络模型有多个输入：<p id="zh-cn_topic_0000002245680161_p153901625154115"><a name="zh-cn_topic_0000002245680161_p153901625154115"></a><a name="zh-cn_topic_0000002245680161_p153901625154115"></a>每档中的dim值与模型输入参数中的-1标识的参数依次对应，模型输入参数中有几个-1，则每档必须设置几个维度。例如网络模型有三个输入，分别为data(1,1,40,T)，label(1,T)，mask(T,T) ，其中T为动态可变。则配置示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002245680161_screen278116014437"><a name="zh-cn_topic_0000002245680161_screen278116014437"></a><a name="zh-cn_topic_0000002245680161_screen278116014437"></a>{"ge.inputShape", "data:1,1,40,-1;label:1,-1;mask:-1,-1" }
{"ge.dynamicDims", "20,20,1,1;40,40,2,2;80,60,4,4"}
// graph运行时，支持的输入dims组合档数分别为：
//第0档：data(1,1,40,20)+label(1,20)+mask(1,1)
//第1档：data(1,1,40,40)+label(1,40)+mask(2,2)
//第2档：data(1,1,40,80)+label(1,60)+mask(4,4)</pre>
</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680161_p92360360450"><a name="zh-cn_topic_0000002245680161_p92360360450"></a><a name="zh-cn_topic_0000002245680161_p92360360450"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680161_p15236203654511"><a name="zh-cn_topic_0000002245680161_p15236203654511"></a><a name="zh-cn_topic_0000002245680161_p15236203654511"></a>session/graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680161_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680161_p17188833194516"><a name="zh-cn_topic_0000002245680161_p17188833194516"></a><a name="zh-cn_topic_0000002245680161_p17188833194516"></a>ge.dynamicNodeType</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680161_p1072116524811"><a name="zh-cn_topic_0000002245680161_p1072116524811"></a><a name="zh-cn_topic_0000002245680161_p1072116524811"></a>用于指定动态输入的节点类型。</p>
<a name="zh-cn_topic_0000002245680161_ul133106754819"></a><a name="zh-cn_topic_0000002245680161_ul133106754819"></a><ul id="zh-cn_topic_0000002245680161_ul133106754819"><li>0：dataset输入为动态输入。</li><li>1：placeholder输入为动态输入。</li></ul>
<p id="zh-cn_topic_0000002245680161_p1257173914812"><a name="zh-cn_topic_0000002245680161_p1257173914812"></a><a name="zh-cn_topic_0000002245680161_p1257173914812"></a>当前不支持dataset和placeholder输入同时为动态输入。</p>
<p id="zh-cn_topic_0000002245680161_p0396105524"><a name="zh-cn_topic_0000002245680161_p0396105524"></a><a name="zh-cn_topic_0000002245680161_p0396105524"></a><strong id="zh-cn_topic_0000002245680161_b16396607523"><a name="zh-cn_topic_0000002245680161_b16396607523"></a><a name="zh-cn_topic_0000002245680161_b16396607523"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245680161_screen4396110115216"><a name="zh-cn_topic_0000002245680161_screen4396110115216"></a><a name="zh-cn_topic_0000002245680161_screen4396110115216"></a>{"ge.dynamicNodeType", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680161_p1018923374511"><a name="zh-cn_topic_0000002245680161_p1018923374511"></a><a name="zh-cn_topic_0000002245680161_p1018923374511"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680161_p91891333134517"><a name="zh-cn_topic_0000002245680161_p91891333134517"></a><a name="zh-cn_topic_0000002245680161_p91891333134517"></a>session/graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680161_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680161_p175831521105813"><a name="zh-cn_topic_0000002245680161_p175831521105813"></a><a name="zh-cn_topic_0000002245680161_p175831521105813"></a>ac_parallel_enable</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680161_p3962116131913"><a name="zh-cn_topic_0000002245680161_p3962116131913"></a><a name="zh-cn_topic_0000002245680161_p3962116131913"></a>动态shape图中，是否允许AI CPU算子和AI Core算子并行运行。</p>
<p id="zh-cn_topic_0000002245680161_p493801713309"><a name="zh-cn_topic_0000002245680161_p493801713309"></a><a name="zh-cn_topic_0000002245680161_p493801713309"></a>动态shape图中，开关开启时，系统自动识别图中可以和AI Core并发的AI CPU算子，不同引擎的算子下发到不同流上，实现多引擎间的并行，从而提升资源利用效率和动态shape执行性能。</p>
<p id="zh-cn_topic_0000002245680161_p156491259132714"><a name="zh-cn_topic_0000002245680161_p156491259132714"></a><a name="zh-cn_topic_0000002245680161_p156491259132714"></a><strong id="zh-cn_topic_0000002245680161_b2481315122918"><a name="zh-cn_topic_0000002245680161_b2481315122918"></a><a name="zh-cn_topic_0000002245680161_b2481315122918"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245680161_ul16951746103014"></a><a name="zh-cn_topic_0000002245680161_ul16951746103014"></a><ul id="zh-cn_topic_0000002245680161_ul16951746103014"><li>1：允许AI CPU和AI Core算子间的并行运行。</li><li>0：（默认值）AI CPU算子不会单独分流。</li></ul>
<p id="zh-cn_topic_0000002245680161_p0534816205211"><a name="zh-cn_topic_0000002245680161_p0534816205211"></a><a name="zh-cn_topic_0000002245680161_p0534816205211"></a><strong id="zh-cn_topic_0000002245680161_b5743101614297"><a name="zh-cn_topic_0000002245680161_b5743101614297"></a><a name="zh-cn_topic_0000002245680161_b5743101614297"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245680161_screen13534111617527"><a name="zh-cn_topic_0000002245680161_screen13534111617527"></a><a name="zh-cn_topic_0000002245680161_screen13534111617527"></a>{"ac_parallel_enable", "1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680161_p19583142155810"><a name="zh-cn_topic_0000002245680161_p19583142155810"></a><a name="zh-cn_topic_0000002245680161_p19583142155810"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680161_p1058342135810"><a name="zh-cn_topic_0000002245680161_p1058342135810"></a><a name="zh-cn_topic_0000002245680161_p1058342135810"></a>全局</p>
</td>
</tr>
</tbody>
</table>

## 算子编译与图编译<a name="section7719145610561"></a>

**表 1** 

<a name="table346512775815"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210480336_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.2.5.1.1"><p id="zh-cn_topic_0000002210480336_p3681132911170"><a name="zh-cn_topic_0000002210480336_p3681132911170"></a><a name="zh-cn_topic_0000002210480336_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.2.5.1.2"><p id="zh-cn_topic_0000002210480336_p326514861719"><a name="zh-cn_topic_0000002210480336_p326514861719"></a><a name="zh-cn_topic_0000002210480336_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.2.5.1.3"><p id="zh-cn_topic_0000002210480336_p1572818217519"><a name="zh-cn_topic_0000002210480336_p1572818217519"></a><a name="zh-cn_topic_0000002210480336_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.2.5.1.4"><p id="zh-cn_topic_0000002210480336_p197281421456"><a name="zh-cn_topic_0000002210480336_p197281421456"></a><a name="zh-cn_topic_0000002210480336_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210480336_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p10919457181419"><a name="zh-cn_topic_0000002210480336_p10919457181419"></a><a name="zh-cn_topic_0000002210480336_p10919457181419"></a>ge.op_compiler_cache_mode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p088621016169"><a name="zh-cn_topic_0000002210480336_p088621016169"></a><a name="zh-cn_topic_0000002210480336_p088621016169"></a>用于配置算子编译磁盘缓存模式。</p>
<p id="zh-cn_topic_0000002210480336_p69199498208"><a name="zh-cn_topic_0000002210480336_p69199498208"></a><a name="zh-cn_topic_0000002210480336_p69199498208"></a><strong id="zh-cn_topic_0000002210480336_b36111656152017"><a name="zh-cn_topic_0000002210480336_b36111656152017"></a><a name="zh-cn_topic_0000002210480336_b36111656152017"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul9580550151712"></a><a name="zh-cn_topic_0000002210480336_ul9580550151712"></a><ul id="zh-cn_topic_0000002210480336_ul9580550151712"><li>enable：（默认值）表示启用算子编译缓存。启用后可以避免针对相同编译参数及算子参数的算子重复编译，从而提升编译速度。</li><li>force：启用算子编译缓存功能，区别于enable模式，force模式下会强制刷新缓存，即先删除已有缓存，再重新编译并加入缓存。比如当用户的python变更、依赖库变更、算子调优后知识库变更等，需要先指定为force用于先清理已有的缓存，后续再修改为enable模式，以避免每次编译时都强制刷新缓存。</li><li>disable：表示禁用算子编译缓存，算子重新编译。</li></ul>
<p id="zh-cn_topic_0000002210480336_p8370114093219"><a name="zh-cn_topic_0000002210480336_p8370114093219"></a><a name="zh-cn_topic_0000002210480336_p8370114093219"></a><strong id="zh-cn_topic_0000002210480336_b1965001282020"><a name="zh-cn_topic_0000002210480336_b1965001282020"></a><a name="zh-cn_topic_0000002210480336_b1965001282020"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul15373204019326"></a><a name="zh-cn_topic_0000002210480336_ul15373204019326"></a><ul id="zh-cn_topic_0000002210480336_ul15373204019326"><li>如果要自行指定算子编译磁盘缓存的路径，则需要与ge.op_compiler_cache_dir配合使用。</li><li>由于force选项会先删除已有缓存，所以不建议在程序并行编译时设置，否则可能会导致其他模型使用的缓存内容被清除而导致失败。</li><li>建议模型最终发布时设置编译缓存选项为disable或者force。</li><li>如果算子调优后知识库变更，则需要先通过设置为force来清空缓存，然后再设置为enable重新进行编译，否则无法应用新的调优知识库，从而导致调优应用执行失败。</li><li>调试开关打开的场景下：<a name="zh-cn_topic_0000002210480336_ul24811038399"></a><a name="zh-cn_topic_0000002210480336_ul24811038399"></a><ul id="zh-cn_topic_0000002210480336_ul24811038399"><li>ge.opDebugLevel非0值：会忽略ge.op_compiler_cache_mode参数的配置，不启用算子编译缓存功能，算子全部重新编译。</li><li>op_debug_config配置非空时，且<strong id="zh-cn_topic_0000002210480336_b171608442418"><a name="zh-cn_topic_0000002210480336_b171608442418"></a><a name="zh-cn_topic_0000002210480336_b171608442418"></a>未配置op_debug_list字段</strong>，会忽略ge.op_compiler_cache_mode参数的配置，不启用算子编译缓存功能，算子全部重新编译。</li><li>op_debug_config配置非空时，且<strong id="zh-cn_topic_0000002210480336_b10865572090"><a name="zh-cn_topic_0000002210480336_b10865572090"></a><a name="zh-cn_topic_0000002210480336_b10865572090"></a>配置文件中配置了op_debug_list字段</strong>：<a name="zh-cn_topic_0000002210480336_ul129893338223"></a><a name="zh-cn_topic_0000002210480336_ul129893338223"></a><ul id="zh-cn_topic_0000002210480336_ul129893338223"><li>列表中的算子，忽略ge.op_compiler_cache_mode参数的配置继续重新编译。</li><li>列表外的算子，如果ge.op_compiler_cache_mode参数配置为enable或force，则启用缓存功能；若配置为disable，则不启用缓存功能，仍旧重新编译。</li></ul>
</li></ul>
</li><li>启用算子编译缓存功能时，可以通过<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b1319751554119"></a>配置文件</strong>（算子编译完成后，会在ge.op_compiler_cache_dir参数指定路径下自动生成op_cache.ini文件）、<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_zh-cn_topic_0000001312713941_b16197215104115"></a>环境变量</strong>两种方式来设置缓存文件夹的磁盘空间大小：<a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_ol1662675617178"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_ol1662675617178"></a><ol id="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_ol1662675617178"><li>通过配置文件op_cache.ini设置<p id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p11244135522814"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p11244135522814"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p11244135522814"></a>若op_cache.ini文件不存在，则需要手动创建。打开该文件，增加如下信息：</p>
<pre class="screen" id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_screen2068111579454"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_screen2068111579454"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_screen2068111579454"></a>#配置文件格式，必须包含，自动生成的文件中默认包括如下信息，手动创建时，需要输入
<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b1092612334716"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b1092612334716"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b1092612334716"></a>[op_compiler_cache]</strong>
#限制某个芯片下缓存文件夹的磁盘空间的大小，默认值为500，取值需为整数，单位为MB
<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b183169361071"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b183169361071"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b183169361071"></a>max_op_cache_size=500</strong>
#设置需要保留缓存的空间大小比例，取值范围：[1,100]，默认值为50，单位为百分比；例如取值为80表示缓存空间不足时，删除缓存文件，保留80%缓存空间
<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b104141138171"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b104141138171"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b104141138171"></a>remain_cache_size_ratio=50   </strong> </pre>
<a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_ul882504017583"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_ul882504017583"></a><ul id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_ul882504017583"><li>上述文件中的max_op_cache_size和remain_cache_size_ratio参数取值都有效时，op_cache.ini文件才会生效。</li><li>当编译缓存文件大小超过“max_op_cache_size”的设置值，且超过半小时缓存文件未被访问时，缓存文件就会老化（算子编译时，不会因为编译缓存文件大小超过设置值而中断，所以当“max_op_cache_size”设置过小时，会出现实际编译缓存文件大小超过此设置值的情况）。</li><li>若需要关闭编译缓存老化功能，可将“max_op_cache_size”设置为“-1”，此时访问算子缓存时不会更新访问时间，算子编译缓存不会老化，磁盘空间使用默认大小500MB。</li><li>若多个使用者使用相同的缓存路径，建议使用配置文件的方式进行设置，该场景下op_cache.ini文件会影响所有使用者。</li></ul>
</li><li>通过环境变量设置<p id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p168533161489"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p168533161489"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p168533161489"></a>该场景下，开发者可以通过环境变量ASCEND_MAX_OP_CACHE_SIZE来限制某个芯片下缓存文件夹的磁盘空间的大小，当编译缓存空间大小达到ASCEND_MAX_OP_CACHE_SIZE设置的取值，且超过半个小时缓存文件未被访问时，缓存文件就会老化。可通过环境变量ASCEND_REMAIN_CACHE_SIZE_RATIO设置需要保留缓存的空间大小比例。</p>
<p id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p148481416174115"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p148481416174115"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_p148481416174115"></a>配置示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_screen144318131013"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_screen144318131013"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_screen144318131013"></a># ASCEND_MAX_OP_CACHE_SIZE环境变量默认值为500，取值需为整数，单位为MB
<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b192231741079"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b192231741079"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b192231741079"></a>export ASCEND_MAX_OP_CACHE_SIZE=500</strong>
# ASCEND_REMAIN_CACHE_SIZE_RATIO环境变量取值范围：[1,100]，默认值为50，单位为百分比；例如取值为80表示缓存空间不足时，删除缓存文件，保留80%缓存空间
<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b17361124319712"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b17361124319712"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b17361124319712"></a>export ASCEND_REMAIN_CACHE_SIZE_RATIO=50</strong></pre>
<a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_ul17158135011233"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_ul17158135011233"></a><ul id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_ul17158135011233"><li>通过环境变量配置，只对当前用户生效。</li><li>若需要关闭编译缓存老化功能，可将环境变量“<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b1775511712244"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b1775511712244"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312713941_b1775511712244"></a>ASCEND_MAX_OP_CACHE_SIZE</strong>”设置为“-1”，此时访问算子缓存时不会更新访问时间，算子编译缓存不会老化，磁盘空间使用默认大小500MB。</li></ul>
</li></ol>
<p id="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_p528193213810"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_p528193213810"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_p528193213810"></a><strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_b15450456152213"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_b15450456152213"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000002209492870_b15450456152213"></a>若同时配置了op_cache.ini文件和环境变量，则优先读取op_cache.ini文件中的配置项，若op_cache.ini文件和环境变量都未设置，则读取系统默认值：默认磁盘空间大小500MB，默认保留缓存空间的50%。</strong></p>
</li></ul>
<p id="zh-cn_topic_0000002210480336_p887452811576"><a name="zh-cn_topic_0000002210480336_p887452811576"></a><a name="zh-cn_topic_0000002210480336_p887452811576"></a><strong id="zh-cn_topic_0000002210480336_b087512289575"><a name="zh-cn_topic_0000002210480336_b087512289575"></a><a name="zh-cn_topic_0000002210480336_b087512289575"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480336_screen587532805718"><a name="zh-cn_topic_0000002210480336_screen587532805718"></a><a name="zh-cn_topic_0000002210480336_screen587532805718"></a>{"ge.op_compiler_cache_mode", "enable"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p1688685063216"><a name="zh-cn_topic_0000002210480336_p1688685063216"></a><a name="zh-cn_topic_0000002210480336_p1688685063216"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p5511107195210"><a name="zh-cn_topic_0000002210480336_p5511107195210"></a><a name="zh-cn_topic_0000002210480336_p5511107195210"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p4210194911417"><a name="zh-cn_topic_0000002210480336_p4210194911417"></a><a name="zh-cn_topic_0000002210480336_p4210194911417"></a>ge.op_compiler_cache_dir</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p186651122168"><a name="zh-cn_topic_0000002210480336_p186651122168"></a><a name="zh-cn_topic_0000002210480336_p186651122168"></a>用于配置算子编译磁盘缓存的目录。</p>
<p id="zh-cn_topic_0000002210480336_p15628143516500"><a name="zh-cn_topic_0000002210480336_p15628143516500"></a><a name="zh-cn_topic_0000002210480336_p15628143516500"></a><strong id="zh-cn_topic_0000002210480336_b14343133161712"><a name="zh-cn_topic_0000002210480336_b14343133161712"></a><a name="zh-cn_topic_0000002210480336_b14343133161712"></a>参数值格式：</strong>路径支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）、中文字符。</p>
<p id="zh-cn_topic_0000002210480336_p462853510504"><a name="zh-cn_topic_0000002210480336_p462853510504"></a><a name="zh-cn_topic_0000002210480336_p462853510504"></a><strong id="zh-cn_topic_0000002210480336_b6725535111713"><a name="zh-cn_topic_0000002210480336_b6725535111713"></a><a name="zh-cn_topic_0000002210480336_b6725535111713"></a>默认值：</strong>$HOME/atc_data</p>
<a name="zh-cn_topic_0000002210480336_ul17555151319188"></a><a name="zh-cn_topic_0000002210480336_ul17555151319188"></a><ul id="zh-cn_topic_0000002210480336_ul17555151319188"><li>如果参数指定的路径存在且有效，则在指定的路径下自动创建子目录kernel_cache；如果指定的路径不存在但路径有效，则先自动创建目录，然后在该路径下自动创建子目录kernel_cache。</li><li>用户请不要在<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001265404734_b18278123915115"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001265404734_b18278123915115"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001265404734_b18278123915115"></a>默认缓存目录</strong>下存放其他自有内容，自有内容在软件包安装或升级时会同默认缓存目录一并被删除。</li><li>通过该参数指定的<strong id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001265404734_b73581227013"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001265404734_b73581227013"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001265404734_b73581227013"></a>非默认缓存目录</strong>无法删除（软件包安装或升级时不会被删除）。</li><li>算子编译磁盘缓存路径，除ge.op_compiler_cache_dir参数设置的方式外，还可以配置环境变量ASCEND_CACHE_PATH，几种方式优先级为：配置参数“ge.op_compiler_cache_dir”&gt;环境变量ASCEND_CACHE_PATH&gt;默认存储路径。关于环境变量ASCEND_CACHE_PATH的详细说明请参见<span id="zh-cn_topic_0000002210480336_ph203151027145212"><a name="zh-cn_topic_0000002210480336_ph203151027145212"></a><a name="zh-cn_topic_0000002210480336_ph203151027145212"></a>《环境变量参考》</span>。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p149008503325"><a name="zh-cn_topic_0000002210480336_p149008503325"></a><a name="zh-cn_topic_0000002210480336_p149008503325"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p177133135215"><a name="zh-cn_topic_0000002210480336_p177133135215"></a><a name="zh-cn_topic_0000002210480336_p177133135215"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p8851943302"><a name="zh-cn_topic_0000002210480336_p8851943302"></a><a name="zh-cn_topic_0000002210480336_p8851943302"></a>ge.graph_compiler_cache_dir</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p2576297240"><a name="zh-cn_topic_0000002210480336_p2576297240"></a><a name="zh-cn_topic_0000002210480336_p2576297240"></a>图编译磁盘缓存目录，和ge.graph_key配合使用，ge.graph_compiler_cache_dir和ge.graph_key同时配置非空时图编译磁盘缓存功能生效。</p>
<p id="zh-cn_topic_0000002210480336_p65814331248"><a name="zh-cn_topic_0000002210480336_p65814331248"></a><a name="zh-cn_topic_0000002210480336_p65814331248"></a>配置的缓存目录必须存在，否则会导致编译失败。</p>
<p id="zh-cn_topic_0000002210480336_p4800113715242"><a name="zh-cn_topic_0000002210480336_p4800113715242"></a><a name="zh-cn_topic_0000002210480336_p4800113715242"></a>图发生变化后，原来的缓存文件不可用，用户需要手动删除缓存目录中的缓存文件或者修改ge.graph_key，重新编译生成缓存文件。</p>
<p id="zh-cn_topic_0000002210480336_p88513431904"><a name="zh-cn_topic_0000002210480336_p88513431904"></a><a name="zh-cn_topic_0000002210480336_p88513431904"></a>其他使用约束和具体的使用方法请参见<a href="zh-cn_topic_0000001450757790.md">图编译缓存</a>。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p98512431707"><a name="zh-cn_topic_0000002210480336_p98512431707"></a><a name="zh-cn_topic_0000002210480336_p98512431707"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p4854431014"><a name="zh-cn_topic_0000002210480336_p4854431014"></a><a name="zh-cn_topic_0000002210480336_p4854431014"></a>session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p1062618101844"><a name="zh-cn_topic_0000002210480336_p1062618101844"></a><a name="zh-cn_topic_0000002210480336_p1062618101844"></a>ge.graph_key</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p129451457015"><a name="zh-cn_topic_0000002210480336_p129451457015"></a><a name="zh-cn_topic_0000002210480336_p129451457015"></a>图唯一标识，取值只包含大小写字母（A-Z，a-z）、数字（0-9）、下划线（_）、中划线（-）并且长度不超过128。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p2094518451705"><a name="zh-cn_topic_0000002210480336_p2094518451705"></a><a name="zh-cn_topic_0000002210480336_p2094518451705"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p1194513454013"><a name="zh-cn_topic_0000002210480336_p1194513454013"></a><a name="zh-cn_topic_0000002210480336_p1194513454013"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row17712145022015"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p77121550112011"><a name="zh-cn_topic_0000002210480336_p77121550112011"></a><a name="zh-cn_topic_0000002210480336_p77121550112011"></a>ge.optimizationSwitch</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p16712350162015"><a name="zh-cn_topic_0000002210480336_p16712350162015"></a><a name="zh-cn_topic_0000002210480336_p16712350162015"></a>算子编译时，融合规则（Pass）的控制开关。</p>
<p id="zh-cn_topic_0000002210480336_p14675644152312"><a name="zh-cn_topic_0000002210480336_p14675644152312"></a><a name="zh-cn_topic_0000002210480336_p14675644152312"></a>该参数与ge.fusionSwitchFile的区别是：ge.fusionSwitchFile仅能关闭图融合和UB融合的规则，并且需要单独配置JSON文件，而该参数适用于所有规则，通过参数就能指定融合规则，不需要再单独设置JSON文件。如果两个参数都配置，且配置了同一个融合规则，则以ge.optimizationSwitch参数配置的为准。</p>
<p id="zh-cn_topic_0000002210480336_p1257818813415"><a name="zh-cn_topic_0000002210480336_p1257818813415"></a><a name="zh-cn_topic_0000002210480336_p1257818813415"></a><strong id="zh-cn_topic_0000002210480336_b15226020173411"><a name="zh-cn_topic_0000002210480336_b15226020173411"></a><a name="zh-cn_topic_0000002210480336_b15226020173411"></a>参数取值：</strong>"Passname1:on;Passname2:off"，可以拼接多个key-value键值对，key为Pass名称，value为on（表示开）或off（表示关），不支持大小写模式匹配，多组配置使用英文分号分隔。可配置的融合规则请参见<a href="zh-cn_topic_0000002312519970.md">融合规则列表</a>。</p>
<p id="zh-cn_topic_0000002210480336_p1842211116349"><a name="zh-cn_topic_0000002210480336_p1842211116349"></a><a name="zh-cn_topic_0000002210480336_p1842211116349"></a><strong id="zh-cn_topic_0000002210480336_b17226152010349"><a name="zh-cn_topic_0000002210480336_b17226152010349"></a><a name="zh-cn_topic_0000002210480336_b17226152010349"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480336_screen41071132133416"><a name="zh-cn_topic_0000002210480336_screen41071132133416"></a><a name="zh-cn_topic_0000002210480336_screen41071132133416"></a>{"ge.optimizationSwitch", "Passname1:on;Passname2:off"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p20712125042018"><a name="zh-cn_topic_0000002210480336_p20712125042018"></a><a name="zh-cn_topic_0000002210480336_p20712125042018"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p16712155013203"><a name="zh-cn_topic_0000002210480336_p16712155013203"></a><a name="zh-cn_topic_0000002210480336_p16712155013203"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p1581065191611"><a name="zh-cn_topic_0000002210480336_p1581065191611"></a><a name="zh-cn_topic_0000002210480336_p1581065191611"></a><span>ge.topoSortingMode</span></p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p208111581617"><a name="zh-cn_topic_0000002210480336_p208111581617"></a><a name="zh-cn_topic_0000002210480336_p208111581617"></a>对算子进行图模式编译时，可选择的不同的图遍历模式。主要面向在线推理场景。</p>
<p id="zh-cn_topic_0000002210480336_p9795450131813"><a name="zh-cn_topic_0000002210480336_p9795450131813"></a><a name="zh-cn_topic_0000002210480336_p9795450131813"></a><strong id="zh-cn_topic_0000002210480336_b822311117199"><a name="zh-cn_topic_0000002210480336_b822311117199"></a><a name="zh-cn_topic_0000002210480336_b822311117199"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul1254694211198"></a><a name="zh-cn_topic_0000002210480336_ul1254694211198"></a><ul id="zh-cn_topic_0000002210480336_ul1254694211198"><li>0：BFS，Breadth First Search，广度优先遍历策略。</li><li>1：（默认值）DFS，Depth First Search，深度优先遍历策略。</li><li>2：RDFS，Reverse DFS，反向深度优先遍历策略。</li><li>3：StableRDFS，稳定拓扑序策略，针对图里已有的算子，不会改变其计算顺序；针对图里新增的算子，使用RDFS遍历策略。</li></ul>
<p id="zh-cn_topic_0000002210480336_p1973919152717"><a name="zh-cn_topic_0000002210480336_p1973919152717"></a><a name="zh-cn_topic_0000002210480336_p1973919152717"></a><strong id="zh-cn_topic_0000002210480336_b073019122715"><a name="zh-cn_topic_0000002210480336_b073019122715"></a><a name="zh-cn_topic_0000002210480336_b073019122715"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480336_screen1473191912717"><a name="zh-cn_topic_0000002210480336_screen1473191912717"></a><a name="zh-cn_topic_0000002210480336_screen1473191912717"></a>{"ge.topoSortingMode", "1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p58112059160"><a name="zh-cn_topic_0000002210480336_p58112059160"></a><a name="zh-cn_topic_0000002210480336_p58112059160"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p15525113141416"><a name="zh-cn_topic_0000002210480336_p15525113141416"></a><a name="zh-cn_topic_0000002210480336_p15525113141416"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row3561164716539"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p10452154381320"><a name="zh-cn_topic_0000002210480336_p10452154381320"></a><a name="zh-cn_topic_0000002210480336_p10452154381320"></a>ge.aicoreNum</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p164521343121317"><a name="zh-cn_topic_0000002210480336_p164521343121317"></a><a name="zh-cn_topic_0000002210480336_p164521343121317"></a>用于配置算子编译时使用的AI Core核数。</p>
<p id="zh-cn_topic_0000002210480336_p96741129153212"><a name="zh-cn_topic_0000002210480336_p96741129153212"></a><a name="zh-cn_topic_0000002210480336_p96741129153212"></a><strong id="zh-cn_topic_0000002210480336_b7623528514"><a name="zh-cn_topic_0000002210480336_b7623528514"></a><a name="zh-cn_topic_0000002210480336_b7623528514"></a>参数取值：</strong>"整数1|整数2"，中间使用“|”分隔：</p>
<a name="zh-cn_topic_0000002210480336_ul127384863917"></a><a name="zh-cn_topic_0000002210480336_ul127384863917"></a><ul id="zh-cn_topic_0000002210480336_ul127384863917"><li><strong id="zh-cn_topic_0000002210480336_b1681919228571"><a name="zh-cn_topic_0000002210480336_b1681919228571"></a><a name="zh-cn_topic_0000002210480336_b1681919228571"></a>场景1</strong>：针对如下<span id="zh-cn_topic_0000002210480336_ph20833205312295"><a name="zh-cn_topic_0000002210480336_ph20833205312295"></a><a name="zh-cn_topic_0000002210480336_ph20833205312295"></a>产品</span>，整数1表示算子编译时使用的AI Core中的Cube Core核数，整数2表示算子编译时使用的AI Core中的Vector Core核数，整数1与整数2都需要大于0，小于等于<span id="zh-cn_topic_0000002210480336_ph10294714196"><a name="zh-cn_topic_0000002210480336_ph10294714196"></a><a name="zh-cn_topic_0000002210480336_ph10294714196"></a>昇腾AI处理器</span>包含的最大Cube Core和Vector Core数量：<p id="zh-cn_topic_0000002210480336_p1265122215411"><a name="zh-cn_topic_0000002210480336_p1265122215411"></a><a name="zh-cn_topic_0000002210480336_p1265122215411"></a><span id="zh-cn_topic_0000002210480336_ph1943304419396"><a name="zh-cn_topic_0000002210480336_ph1943304419396"></a><a name="zh-cn_topic_0000002210480336_ph1943304419396"></a><term id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210480336_p15412964119"><a name="zh-cn_topic_0000002210480336_p15412964119"></a><a name="zh-cn_topic_0000002210480336_p15412964119"></a><span id="zh-cn_topic_0000002210480336_ph7169433143910"><a name="zh-cn_topic_0000002210480336_ph7169433143910"></a><a name="zh-cn_topic_0000002210480336_ph7169433143910"></a><term id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
</li></ul>
<p id="zh-cn_topic_0000002210480336_p181510921017"><a name="zh-cn_topic_0000002210480336_p181510921017"></a><a name="zh-cn_topic_0000002210480336_p181510921017"></a><strong id="zh-cn_topic_0000002210480336_b131618917103"><a name="zh-cn_topic_0000002210480336_b131618917103"></a><a name="zh-cn_topic_0000002210480336_b131618917103"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul15344710191019"></a><a name="zh-cn_topic_0000002210480336_ul15344710191019"></a><ul id="zh-cn_topic_0000002210480336_ul15344710191019"><li>针对参数值中的场景1：<div class="p" id="zh-cn_topic_0000002210480336_p17875579521"><a name="zh-cn_topic_0000002210480336_p17875579521"></a><a name="zh-cn_topic_0000002210480336_p17875579521"></a>不同<span id="zh-cn_topic_0000002210480336_ph187992161919"><a name="zh-cn_topic_0000002210480336_ph187992161919"></a><a name="zh-cn_topic_0000002210480336_ph187992161919"></a>昇腾AI处理器</span>包含的最大Cube Core与Vector Core的数量可从"<span id="zh-cn_topic_0000002210480336_ph10562197165916"><a name="zh-cn_topic_0000002210480336_ph10562197165916"></a><a name="zh-cn_topic_0000002210480336_ph10562197165916"></a>${INSTALL_DIR}</span>/<em id="zh-cn_topic_0000002210480336_i19279101185016"><a name="zh-cn_topic_0000002210480336_i19279101185016"></a><a name="zh-cn_topic_0000002210480336_i19279101185016"></a>&lt;arch&gt;</em>-linux/data/platform_config/<em id="zh-cn_topic_0000002210480336_i1727941115019"><a name="zh-cn_topic_0000002210480336_i1727941115019"></a><a name="zh-cn_topic_0000002210480336_i1727941115019"></a>xxx</em>.ini"文件查看，如下所示，说明<span id="zh-cn_topic_0000002210480336_ph1536613588180"><a name="zh-cn_topic_0000002210480336_ph1536613588180"></a><a name="zh-cn_topic_0000002210480336_ph1536613588180"></a>昇腾AI处理器</span>上存在24个Cube Core，存在48个Vector Core。<pre class="screen" id="zh-cn_topic_0000002210480336_screen20279181185012"><a name="zh-cn_topic_0000002210480336_screen20279181185012"></a><a name="zh-cn_topic_0000002210480336_screen20279181185012"></a>[SoCInfo]
# 参数配置为默认值，默认值即为最大值
ai_core_cnt=24
<strong id="zh-cn_topic_0000002210480336_b102044574502"><a name="zh-cn_topic_0000002210480336_b102044574502"></a><a name="zh-cn_topic_0000002210480336_b102044574502"></a>cube_core_cnt</strong>=24
<strong id="zh-cn_topic_0000002210480336_b43688589500"><a name="zh-cn_topic_0000002210480336_b43688589500"></a><a name="zh-cn_topic_0000002210480336_b43688589500"></a>vector_core_cnt</strong>=48</pre>
</div>
</li><li>如果配置该参数的同时启用了算子编译缓存功能（ge.op_compiler_cache_mode参数配置为“enable”或者“force”，默认为“enable”），此参数仅在首次编译时生效。若您想在非首次编译时生效该参数，需要清理编译磁盘的缓存。</li></ul>
<p id="zh-cn_topic_0000002210480336_p1127562655516"><a name="zh-cn_topic_0000002210480336_p1127562655516"></a><a name="zh-cn_topic_0000002210480336_p1127562655516"></a>其中，<span id="zh-cn_topic_0000002210480336_ph1027510266551"><a name="zh-cn_topic_0000002210480336_ph1027510266551"></a><a name="zh-cn_topic_0000002210480336_ph1027510266551"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002210480336_i16828195725816"><a name="zh-cn_topic_0000002210480336_i16828195725816"></a><a name="zh-cn_topic_0000002210480336_i16828195725816"></a>&lt;arch&gt;</em>表示具体操作系统架构，<em id="zh-cn_topic_0000002210480336_i2828145710585"><a name="zh-cn_topic_0000002210480336_i2828145710585"></a><a name="zh-cn_topic_0000002210480336_i2828145710585"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002210480336_ph1282845715582"><a name="zh-cn_topic_0000002210480336_ph1282845715582"></a><a name="zh-cn_topic_0000002210480336_ph1282845715582"></a>产品</span>进行选择。</p>
<p id="zh-cn_topic_0000002210480336_p1747712445309"><a name="zh-cn_topic_0000002210480336_p1747712445309"></a><a name="zh-cn_topic_0000002210480336_p1747712445309"></a><strong id="zh-cn_topic_0000002210480336_b12310112663113"><a name="zh-cn_topic_0000002210480336_b12310112663113"></a><a name="zh-cn_topic_0000002210480336_b12310112663113"></a>配置示例：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul13868135794511"></a><a name="zh-cn_topic_0000002210480336_ul13868135794511"></a><ul id="zh-cn_topic_0000002210480336_ul13868135794511"><li>场景1配置示例：<pre class="screen" id="zh-cn_topic_0000002210480336_screen1216843611811"><a name="zh-cn_topic_0000002210480336_screen1216843611811"></a><a name="zh-cn_topic_0000002210480336_screen1216843611811"></a>{"ge.aicoreNum", "24|48"};</pre>
</li></ul>
<p id="zh-cn_topic_0000002210480336_p9161193419167"><a name="zh-cn_topic_0000002210480336_p9161193419167"></a><a name="zh-cn_topic_0000002210480336_p9161193419167"></a><strong id="zh-cn_topic_0000002210480336_b13639185216166"><a name="zh-cn_topic_0000002210480336_b13639185216166"></a><a name="zh-cn_topic_0000002210480336_b13639185216166"></a>了解AI Core、Cube Core、Vector Core的关系</strong>：</p>
<p id="zh-cn_topic_0000002210480336_p9609151514411"><a name="zh-cn_topic_0000002210480336_p9609151514411"></a><a name="zh-cn_topic_0000002210480336_p9609151514411"></a>为便于理解AI Core、Cube Core、Vector Core的关系，此处先明确Core的定义，Core是指拥有独立Scalar计算单元的一个计算核，通常Scalar计算单元承担了一个计算核的SIMD（单指令多数据，Single Instruction Multiple Data）指令发射等功能，所以我们也通常也把这个Scalar计算单元称为核内的调度单元。不同产品上的AI数据处理核心单元不同，当前分为以下几类：</p>
<a name="zh-cn_topic_0000002210480336_ul6504113413162"></a><a name="zh-cn_topic_0000002210480336_ul6504113413162"></a><ul id="zh-cn_topic_0000002210480336_ul6504113413162"><li>当AI数据处理核心单元是AI Core：<a name="zh-cn_topic_0000002210480336_ul1174813074910"></a><a name="zh-cn_topic_0000002210480336_ul1174813074910"></a><ul id="zh-cn_topic_0000002210480336_ul1174813074910"><li>在AI Core内，Cube和Vector共用一个Scalar调度单元。<p id="zh-cn_topic_0000002210480336_p742833143614"><a name="zh-cn_topic_0000002210480336_p742833143614"></a><a name="zh-cn_topic_0000002210480336_p742833143614"></a><a name="zh-cn_topic_0000002210480336_image1391238163613"></a><a name="zh-cn_topic_0000002210480336_image1391238163613"></a><span><img class="eddx" id="zh-cn_topic_0000002210480336_image1391238163613" src="figures/逻辑架构图-2.png" width="206.48250000000002" height="163.59"></span></p>
</li><li>在AI Core内，Cube和Vector都有各自的Scalar调度单元，因此又被称为Cube Core、Vector Core。这时，一个Cube Core和一组Vector Core被定义为一个AI Core，AI Core数量通常是以多少个Cube Core为基准计算的，例如<span id="zh-cn_topic_0000002210480336_ph2505726191717"><a name="zh-cn_topic_0000002210480336_ph2505726191717"></a><a name="zh-cn_topic_0000002210480336_ph2505726191717"></a><term id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002210480336_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>。<p id="zh-cn_topic_0000002210480336_p778114462419"><a name="zh-cn_topic_0000002210480336_p778114462419"></a><a name="zh-cn_topic_0000002210480336_p778114462419"></a><a name="zh-cn_topic_0000002210480336_image14781154412410"></a><a name="zh-cn_topic_0000002210480336_image14781154412410"></a><span><img class="eddx" id="zh-cn_topic_0000002210480336_image14781154412410" src="figures/逻辑架构图-3.png"></span></p>
</li></ul>
</li><li>当AI数据处理核心单元是AI Core以及单独的Vector Core：AI Core和Vector Core都拥有独立的Scalar调度单元。<p id="zh-cn_topic_0000002210480336_p137910620378"><a name="zh-cn_topic_0000002210480336_p137910620378"></a><a name="zh-cn_topic_0000002210480336_p137910620378"></a><a name="zh-cn_topic_0000002210480336_image65091178379"></a><a name="zh-cn_topic_0000002210480336_image65091178379"></a><span><img class="eddx" id="zh-cn_topic_0000002210480336_image65091178379" src="figures/逻辑架构图-4.png" width="450.87" height="172.5675"></span></p>
</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p17452114301316"><a name="zh-cn_topic_0000002210480336_p17452114301316"></a><a name="zh-cn_topic_0000002210480336_p17452114301316"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p9452114351311"><a name="zh-cn_topic_0000002210480336_p9452114351311"></a><a name="zh-cn_topic_0000002210480336_p9452114351311"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480336_row1964104911015"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.2.5.1.1 "><p id="zh-cn_topic_0000002210480336_p1864111493014"><a name="zh-cn_topic_0000002210480336_p1864111493014"></a><a name="zh-cn_topic_0000002210480336_p1864111493014"></a>ge.AllowMultiGraphParallelCompile</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.2.5.1.2 "><p id="zh-cn_topic_0000002210480336_p96411497018"><a name="zh-cn_topic_0000002210480336_p96411497018"></a><a name="zh-cn_topic_0000002210480336_p96411497018"></a>用于使能同一个Session内多线程编译多张图。如果配置为"1"，会禁止变量转换格式（参考ge.exec.variable_acc说明）。</p>
<p id="zh-cn_topic_0000002210480336_p82285234186"><a name="zh-cn_topic_0000002210480336_p82285234186"></a><a name="zh-cn_topic_0000002210480336_p82285234186"></a><strong id="zh-cn_topic_0000002210480336_b1813435131916"><a name="zh-cn_topic_0000002210480336_b1813435131916"></a><a name="zh-cn_topic_0000002210480336_b1813435131916"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul149921515102611"></a><a name="zh-cn_topic_0000002210480336_ul149921515102611"></a><ul id="zh-cn_topic_0000002210480336_ul149921515102611"><li>"0"，默认值，同一个Session内一个线程编译多张图。</li><li>"1"，表示允许用户在一个Session内使用多个线程并发编译多张图。</li></ul>
<p id="zh-cn_topic_0000002210480336_p61461145152015"><a name="zh-cn_topic_0000002210480336_p61461145152015"></a><a name="zh-cn_topic_0000002210480336_p61461145152015"></a><strong id="zh-cn_topic_0000002210480336_b8651422162113"><a name="zh-cn_topic_0000002210480336_b8651422162113"></a><a name="zh-cn_topic_0000002210480336_b8651422162113"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210480336_ul185561221153313"></a><a name="zh-cn_topic_0000002210480336_ul185561221153313"></a><ul id="zh-cn_topic_0000002210480336_ul185561221153313"><li>如果配置为"1"，不能同时配置ge.exec.variable_acc为"True"，否则会校验报错。</li><li>如果配置为"1"，资源类算子如果导致其他图重编译，立即报错。</li></ul>
<p id="zh-cn_topic_0000002210480336_p122819416317"><a name="zh-cn_topic_0000002210480336_p122819416317"></a><a name="zh-cn_topic_0000002210480336_p122819416317"></a><strong id="zh-cn_topic_0000002210480336_b3447150163120"><a name="zh-cn_topic_0000002210480336_b3447150163120"></a><a name="zh-cn_topic_0000002210480336_b3447150163120"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480336_screen3419171113329"><a name="zh-cn_topic_0000002210480336_screen3419171113329"></a><a name="zh-cn_topic_0000002210480336_screen3419171113329"></a>{"ge.AllowMultiGraphParallelCompile", "1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.2.5.1.3 "><p id="zh-cn_topic_0000002210480336_p26410491020"><a name="zh-cn_topic_0000002210480336_p26410491020"></a><a name="zh-cn_topic_0000002210480336_p26410491020"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.2.5.1.4 "><p id="zh-cn_topic_0000002210480336_p206410492008"><a name="zh-cn_topic_0000002210480336_p206410492008"></a><a name="zh-cn_topic_0000002210480336_p206410492008"></a>全局/session</p>
</td>
</tr>
</tbody>
</table>

## 功能调试<a name="section05181570576"></a>

<a name="table5812112912584"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210640124_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002210640124_p3681132911170"><a name="zh-cn_topic_0000002210640124_p3681132911170"></a><a name="zh-cn_topic_0000002210640124_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002210640124_p326514861719"><a name="zh-cn_topic_0000002210640124_p326514861719"></a><a name="zh-cn_topic_0000002210640124_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002210640124_p1572818217519"><a name="zh-cn_topic_0000002210640124_p1572818217519"></a><a name="zh-cn_topic_0000002210640124_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002210640124_p197281421456"><a name="zh-cn_topic_0000002210640124_p197281421456"></a><a name="zh-cn_topic_0000002210640124_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210640124_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640124_p149641320143014"><a name="zh-cn_topic_0000002210640124_p149641320143014"></a><a name="zh-cn_topic_0000002210640124_p149641320143014"></a>ge.exec.enable_exception_dump</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><div class="p" id="zh-cn_topic_0000002210640124_p16488193921920"><a name="zh-cn_topic_0000002210640124_p16488193921920"></a><a name="zh-cn_topic_0000002210640124_p16488193921920"></a>是否dump异常算子数据。<a name="zh-cn_topic_0000002210640124_ul9575844131614"></a><a name="zh-cn_topic_0000002210640124_ul9575844131614"></a><ul id="zh-cn_topic_0000002210640124_ul9575844131614"><li>0：（默认值）关闭异常算子数据dump功能。</li><li>1：开启普通exception dump（L1 exception dump），dump异常算子的输入输出数据、tensor描述信息（shape、dtype、format等）以及workspace信息。<p id="zh-cn_topic_0000002210640124_p1359812266431"><a name="zh-cn_topic_0000002210640124_p1359812266431"></a><a name="zh-cn_topic_0000002210640124_p1359812266431"></a>dump数据存储路径优先级为：NPU_COLLECT_PATH&gt;ASCEND_WORK_PATH&gt;默认路径（指当前脚本执行路径的extra-info目录）</p>
</li><li>2：开启Lite execption dump（L0 exception dump），dump异常算子的输入输出数据、workspace信息、Tiling信息。<p id="zh-cn_topic_0000002210640124_p15091719104510"><a name="zh-cn_topic_0000002210640124_p15091719104510"></a><a name="zh-cn_topic_0000002210640124_p15091719104510"></a>dump数据存储路径优先级为：ASCEND_WORK_PATH&gt;默认路径（指当前脚本执行路径的/extra-info/data-dump/&lt;device_id&gt;目录）</p>
</li></ul>
<div class="note" id="zh-cn_topic_0000002210640124_note178391845173816"><a name="zh-cn_topic_0000002210640124_note178391845173816"></a><a name="zh-cn_topic_0000002210640124_note178391845173816"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210640124_ul44368458474"></a><a name="zh-cn_topic_0000002210640124_ul44368458474"></a><ul id="zh-cn_topic_0000002210640124_ul44368458474"><li>若配置了环境变量NPU_COLLECT_PATH，不论配置项“ge.exec.enable_exception_dump”的取值如何，仅收集普通exception dump信息，包括异常算子的输入数据和输出数据，且dump数据存储在环境变量NPU_COLLECT_PATH的指定目录下。</li><li>L1 exception dump即普通exception dump，L0 exception dump即Lite exception dump（轻量化的exception dump），两者都会导出算子输入输出、workspace数据等信息，但相比L0 exception dump，L1 exception dump的信息更多，开启L1 exception dump时，会在Host应用类日志文件（即plog日志）中打印出来各tensor的dtype等信息，还会把算子相关的算子名、kernel都打印出来。</li></ul>
</div></div>
</div>
<p id="zh-cn_topic_0000002210640124_p95802488388"><a name="zh-cn_topic_0000002210640124_p95802488388"></a><a name="zh-cn_topic_0000002210640124_p95802488388"></a>关于环境变量的详细说明可参见<span id="zh-cn_topic_0000002210640124_ph85801648153817"><a name="zh-cn_topic_0000002210640124_ph85801648153817"></a><a name="zh-cn_topic_0000002210640124_ph85801648153817"></a>《环境变量参考》</span>。</p>
<div class="p" id="zh-cn_topic_0000002210640124_p631984783416"><a name="zh-cn_topic_0000002210640124_p631984783416"></a><a name="zh-cn_topic_0000002210640124_p631984783416"></a>配置示例：<pre class="screen" id="zh-cn_topic_0000002210640124_screen276116393341"><a name="zh-cn_topic_0000002210640124_screen276116393341"></a><a name="zh-cn_topic_0000002210640124_screen276116393341"></a>std::map&lt;ge::AscendString, ge::AscendString&gt; ge_options = {"ge.exec.enable_exception_dump", "0"}, </pre>
</div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640124_p1865010337354"><a name="zh-cn_topic_0000002210640124_p1865010337354"></a><a name="zh-cn_topic_0000002210640124_p1865010337354"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640124_p1965093373513"><a name="zh-cn_topic_0000002210640124_p1965093373513"></a><a name="zh-cn_topic_0000002210640124_p1965093373513"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640124_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640124_p88684012916"><a name="zh-cn_topic_0000002210640124_p88684012916"></a><a name="zh-cn_topic_0000002210640124_p88684012916"></a>ge.opDebugLevel</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640124_p1263552005710"><a name="zh-cn_topic_0000002210640124_p1263552005710"></a><a name="zh-cn_topic_0000002210640124_p1263552005710"></a>算子debug功能开关，取值：</p>
<a name="zh-cn_topic_0000002210640124_ul18155740191413"></a><a name="zh-cn_topic_0000002210640124_ul18155740191413"></a><ul id="zh-cn_topic_0000002210640124_ul18155740191413"><li>0：（默认值）不开启算子debug功能，在当前执行路径<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b15461845195817"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b15461845195817"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b15461845195817"></a>不生成</strong>算子编译目录kernel_meta。</li><li>1：开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b179782285171"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b179782285171"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b179782285171"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）和TBE指令映射文件（算子cce文件*.cce和python-cce映射文件*_loc.json），用于后续分析AICore Error问题。</li><li>2：开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b10503172717172"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b10503172717172"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b10503172717172"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）和TBE指令映射文件（算子cce文件*.cce和python-cce映射文件*_loc.json），用于后续分析AICore Error问题，同时设置为2，还会关闭编译优化开关、开启ccec调试功能（ccec编译器选项设置为-O0-g）。</li><li>3：不开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹中<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b13358926141716"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b13358926141716"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b13358926141716"></a>生成</strong>*.o（算子二进制文件）和*.json文件（算子描述文件），分析算子问题时可参考。</li><li>4：不开启算子debug功能，在当前执行路径生成kernel_meta文件夹，并在该文件夹下<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b14819924101718"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b14819924101718"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b14819924101718"></a>生成</strong>*.o（算子二进制文件）、*.json文件（算子描述文件）、TBE指令映射文件（算子cce文件*.cce）和UB融合计算描述文件（{$kernel_name}_compute.json），可在分析算子问题时进行问题复现、精度比对时使用。</li></ul>
<div class="notice" id="zh-cn_topic_0000002210640124_note1321414364455"><a name="zh-cn_topic_0000002210640124_note1321414364455"></a><a name="zh-cn_topic_0000002210640124_note1321414364455"></a><span class="noticetitle"> 须知： </span><div class="noticebody"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_ul2597173018539"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_ul2597173018539"></a><ul id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_ul2597173018539"><li>若ge.opDebugLevel配置为0，同时又配置了op_debug_config参数，该场景下在当前执行路径<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_zh-cn_topic_0000001312713993_b5667181111407"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_zh-cn_topic_0000001312713993_b5667181111407"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_zh-cn_topic_0000001312713993_b5667181111407"></a>仍旧会生成</strong>算子编译目录kernel_meta。</li><li>训练执行时，建议配置为0或3。如果需要进行问题定位，再选择调试开关选项1和2，是因为加入了调试功能会导致网络性能下降。</li><li>配置为2（即开启ccec编译选项）时，会导致算子Kernel（*.o文件）大小增大。动态Shape场景下，由于算子编译时会遍历可能的Shape场景，因此可能会导致算子Kernel文件过大而无法进行编译，此种场景下，建议不要配置ccec编译选项。<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p119132011557"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p119132011557"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p119132011557"></a>由于算子Kernel文件过大而无法编译的报错日志示例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_screen1819162055520"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_screen1819162055520"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_screen1819162055520"></a>message:link error ld.lld: <strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b1819122017557"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b1819122017557"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_b1819122017557"></a>error: InputSection too large for range extension thunk</strong> ./kernel_meta_xxxxx.o</pre>
</li><li>debug功能开关打开场景下，若模型中含有如下通算融合算子，算子编译目录kernel_meta中，不会生成下述算子的*.o、*.json、*.cce文件。<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p12719135919173"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p12719135919173"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p12719135919173"></a>MatMulAllReduce</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p1171917592173"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p1171917592173"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p1171917592173"></a>MatMulAllReduceAddRmsNorm</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p12719859161710"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p12719859161710"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p12719859161710"></a>AllGatherMatMul</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p57191059121714"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p57191059121714"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p57191059121714"></a>MatMulReduceScatter</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p871905911713"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p871905911713"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p871905911713"></a>AlltoAllAllGatherBatchMatMul</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p4719459131718"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p4719459131718"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001312713993_p4719459131718"></a>BatchMatMulReduceScatterAlltoAll</p>
</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640124_p1187218501326"><a name="zh-cn_topic_0000002210640124_p1187218501326"></a><a name="zh-cn_topic_0000002210640124_p1187218501326"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640124_p17679118195214"><a name="zh-cn_topic_0000002210640124_p17679118195214"></a><a name="zh-cn_topic_0000002210640124_p17679118195214"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640124_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640124_p156448073916"><a name="zh-cn_topic_0000002210640124_p156448073916"></a><a name="zh-cn_topic_0000002210640124_p156448073916"></a>op_debug_config</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640124_p17387646133615"><a name="zh-cn_topic_0000002210640124_p17387646133615"></a><a name="zh-cn_topic_0000002210640124_p17387646133615"></a>Global Memory内存检测功能开关。</p>
<p id="zh-cn_topic_0000002210640124_p72049122158"><a name="zh-cn_topic_0000002210640124_p72049122158"></a><a name="zh-cn_topic_0000002210640124_p72049122158"></a>取值为.cfg配置文件路径，配置文件内多个选项用英文逗号分隔：</p>
<a name="zh-cn_topic_0000002210640124_ul24919263716"></a><a name="zh-cn_topic_0000002210640124_ul24919263716"></a><ul id="zh-cn_topic_0000002210640124_ul24919263716"><li><strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b17418155120285"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b17418155120285"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b17418155120285"></a>oom</strong>：算子<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1544210173476"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1544210173476"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1544210173476"></a>执行</strong>过程中，检测Global Memory是否内存越界。<a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul19412352346"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul19412352346"></a><ul id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul19412352346"><li>配置该选项，算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留.o（算子二进制文件）和.json文件（算子描述文件）。</li><li>使用该选项后，在算子编译过程中会加入如下的检测逻辑，用户可以通过再使用<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1692418214107"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1692418214107"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1692418214107"></a>dump_cce</strong>参数，在生成的.cce文件中查看如下的代码。<pre class="screen" id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen9700040330"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen9700040330"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen9700040330"></a>inline __aicore__ void  CheckInvalidAccessOfDDR(<em id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_i185658171540"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_i185658171540"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_i185658171540"></a>xxx</em>) {
    if (access_offset &lt; 0 || access_offset + access_extent &gt; ddr_size) {
        if (read_or_write == 1) {
            <strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1997152116414"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1997152116414"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1997152116414"></a>trap</strong>(0X5A5A0001);
        } else {
            <strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b03115221944"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b03115221944"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b03115221944"></a>trap</strong>(0X5A5A0002);
        }
    }
}</pre>
</li></ul>
</li><li><strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b6797158112816"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b6797158112816"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b6797158112816"></a>dump_cce</strong>：算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留算子cce文件*.cce，以及.o（算子二进制文件）和.json文件（算子描述文件）。</li><li><strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1451717092916"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1451717092916"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1451717092916"></a>dump_loc</strong>：算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留python-cce映射文件*_loc.json，以及.o（算子二进制文件）和.json文件（算子描述文件）。</li><li><strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b0445726297"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b0445726297"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b0445726297"></a>ccec_O0</strong>：算子编译时，开启ccec编译器选项-O0，配置该选项<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1574314052112"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1574314052112"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1574314052112"></a>不会</strong>对调试信息执行优化操作，用于后续分析AI Core Error问题。</li><li><strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b433212414292"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b433212414292"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b433212414292"></a>ccec_g</strong>：算子编译时，开启ccec编译器选项-g，配置该选项<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b464943132117"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b464943132117"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b464943132117"></a>会</strong>对调试信息执行优化操作，用于后续分析AI Core Error问题。</li><li><strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b204541653152615"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b204541653152615"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b204541653152615"></a>check_flag</strong>：算子<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1256222013473"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1256222013473"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b1256222013473"></a>执行</strong>时，检测算子内部流水线同步信号是否匹配。<a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul1846028182917"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul1846028182917"></a><ul id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul1846028182917"><li>配置该选项，算子编译时，在当前执行路径算子编译生成的kernel_meta文件夹中保留.o（算子二进制文件）和.json文件（算子描述文件）。</li><li>使用该选项后，在算子编译过程中会加入如下的检测逻辑，用户可以通过再使用<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b114618287299"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b114618287299"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b114618287299"></a>dump_cce</strong>参数，在生成的.cce文件中查看如下的代码。<pre class="screen" id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen144614286299"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen144614286299"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen144614286299"></a>  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID2);
  set_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID3);
  ....
  pipe_barrier(PIPE_MTE3);
  pipe_barrier(PIPE_MTE2);
  pipe_barrier(PIPE_M);
  pipe_barrier(PIPE_V);
  pipe_barrier(PIPE_MTE1);
  pipe_barrier(PIPE_ALL);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID0);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID1);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID2);
  wait_flag(PIPE_MTE3, PIPE_MTE2, EVENT_ID3);
  ...</pre>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p164713283295"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p164713283295"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p164713283295"></a>实际执行推理过程中，如果确实存在算子内部流水线同步信号不匹配，则最终会在<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b12480113214158"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b12480113214158"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b12480113214158"></a>有问题的算子处超时报错，并终止程序</strong>，报错信息示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen1331517541655"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen1331517541655"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_screen1331517541655"></a>Aicore kernel execute failed, ..., fault kernel_name=<em id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_i65002166121"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_i65002166121"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_i65002166121"></a>算子名</em>,...
rtStreamSynchronizeWithTimeout execute failed....</pre>
</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002210640124_p1996810476611"><a name="zh-cn_topic_0000002210640124_p1996810476611"></a><a name="zh-cn_topic_0000002210640124_p1996810476611"></a><strong id="zh-cn_topic_0000002210640124_b1496844719615"><a name="zh-cn_topic_0000002210640124_b1496844719615"></a><a name="zh-cn_topic_0000002210640124_b1496844719615"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640124_screen72372501763"><a name="zh-cn_topic_0000002210640124_screen72372501763"></a><a name="zh-cn_topic_0000002210640124_screen72372501763"></a>{"op_debug_config", "/root/test0.cfg"};</pre>
<p id="zh-cn_topic_0000002210640124_p240794392520"><a name="zh-cn_topic_0000002210640124_p240794392520"></a><a name="zh-cn_topic_0000002210640124_p240794392520"></a>其中，test0.cfg文件信息为：</p>
<pre class="screen" id="zh-cn_topic_0000002210640124_screen3695182615548"><a name="zh-cn_topic_0000002210640124_screen3695182615548"></a><a name="zh-cn_topic_0000002210640124_screen3695182615548"></a>op_debug_config = ccec_g,oom</pre>
<p id="zh-cn_topic_0000002210640124_p19642744541"><a name="zh-cn_topic_0000002210640124_p19642744541"></a><a name="zh-cn_topic_0000002210640124_p19642744541"></a><strong id="zh-cn_topic_0000002210640124_b36101820165413"><a name="zh-cn_topic_0000002210640124_b36101820165413"></a><a name="zh-cn_topic_0000002210640124_b36101820165413"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p2943133093320"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p2943133093320"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p2943133093320"></a>算子编译时，如果用户不想编译所有AI Core算子，而是指定某些AI Core算子进行编译，则需要在上述test0.cfg配置文件中新增<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b12954518183515"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b12954518183515"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b12954518183515"></a>op_debug_list</strong>字段，算子编译时，只编译该列表指定的算子，并按照op_debug_config配置的选项进行编译。op_debug_list字段要求如下：</p>
<a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul1691044011386"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul1691044011386"></a><ul id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_ul1691044011386"><li>支持指定算子名称或者算子类型。</li><li>算子之间使用英文逗号分隔，若为算子类型，则以<strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b16555457134117"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b16555457134117"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_b16555457134117"></a>OpType::typeName</strong>格式进行配置，支持算子类型和算子名称混合配置。</li><li>要编译的算子，必须放在op_debug_config参数指定的配置文件中。</li></ul>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p511381113264"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p511381113264"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p511381113264"></a>配置示例如下：op_debug_config参数指定的配置文件（例如test0.cfg）中增加如下信息：</p>
<pre class="screen" id="zh-cn_topic_0000002210640124_screen12280416826"><a name="zh-cn_topic_0000002210640124_screen12280416826"></a><a name="zh-cn_topic_0000002210640124_screen12280416826"></a>op_debug_config= ccec_g,oom
<strong id="zh-cn_topic_0000002210640124_b929241614213"><a name="zh-cn_topic_0000002210640124_b929241614213"></a><a name="zh-cn_topic_0000002210640124_b929241614213"></a>op_debug_list=<em id="zh-cn_topic_0000002210640124_i1429219160219"><a name="zh-cn_topic_0000002210640124_i1429219160219"></a><a name="zh-cn_topic_0000002210640124_i1429219160219"></a>GatherV2,opType::ReduceSum</em></strong></pre>
<p id="zh-cn_topic_0000002210640124_p765410710210"><a name="zh-cn_topic_0000002210640124_p765410710210"></a><a name="zh-cn_topic_0000002210640124_p765410710210"></a>模型编译时，<em id="zh-cn_topic_0000002210640124_i19710500216"><a name="zh-cn_topic_0000002210640124_i19710500216"></a><a name="zh-cn_topic_0000002210640124_i19710500216"></a>GatherV2,ReduceSum</em>算子按照ccec_g,oom选项进行编译。</p>
<div class="note" id="zh-cn_topic_0000002210640124_note02845114366"><a name="zh-cn_topic_0000002210640124_note02845114366"></a><a name="zh-cn_topic_0000002210640124_note02845114366"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_ul230710560362"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_ul230710560362"></a><ul id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_ul230710560362"><li>开启ccec编译选项的场景下（即ccec_O0、ccec_g选项），会增大算子Kernel（*.o文件）的大小。动态shape场景下，由于算子编译时会遍历可能存在的所有场景，最终可能会导致由于算子Kernel文件过大而无法进行编译的情况，此种场景下，建议不要开启ccec编译选项。<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_p321220316517"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_p321220316517"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_p321220316517"></a>由于算子kernel文件过大而无法编译的日志显示如下：</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_p61879516373"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_p61879516373"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_p61879516373"></a>message:link error ld.lld: <strong id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_b141871859379"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_b141871859379"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001265404734_b141871859379"></a>error: InputSection too large for range extension thunk</strong> ./kernel_meta_xxxxx.o:(xxxx)</p>
</li><li>ccec编译器选项ccec_O0和oom不能同时开启，可能会导致AICore Error报错，报错信息示例如下：<pre class="screen" id="zh-cn_topic_0000002210640124_screen2063085075320"><a name="zh-cn_topic_0000002210640124_screen2063085075320"></a><a name="zh-cn_topic_0000002210640124_screen2063085075320"></a>...there is an aivec error exception, core id is 49, error code = 0x4 ...</pre>
</li><li>若配置NPU_COLLECT_PATH环境变量，不支持打开“检测Global Memory是否内存越界”的开关（op_debug_config指定的配置文件中配置oom），否则编译出来的模型文件或算子kernel包在使用时会报错。</li><li>配置编译选项oom、dump_cce、dump_loc时，若模型中含有如下通算融合算子，算子编译目录kernel_meta中，不会生成下述算子的*.o、*.json、*.cce文件。<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p12719135919173"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p12719135919173"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p12719135919173"></a>MatMulAllReduce</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p1171917592173"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p1171917592173"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p1171917592173"></a>MatMulAllReduceAddRmsNorm</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p12719859161710"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p12719859161710"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p12719859161710"></a>AllGatherMatMul</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p57191059121714"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p57191059121714"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p57191059121714"></a>MatMulReduceScatter</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p871905911713"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p871905911713"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p871905911713"></a>AlltoAllAllGatherBatchMatMul</p>
<p id="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p4719459131718"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p4719459131718"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000001420224261_p4719459131718"></a>BatchMatMulReduceScatterAlltoAll</p>
</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640124_p19184134611253"><a name="zh-cn_topic_0000002210640124_p19184134611253"></a><a name="zh-cn_topic_0000002210640124_p19184134611253"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640124_p01844469252"><a name="zh-cn_topic_0000002210640124_p01844469252"></a><a name="zh-cn_topic_0000002210640124_p01844469252"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640124_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640124_p1022854011411"><a name="zh-cn_topic_0000002210640124_p1022854011411"></a><a name="zh-cn_topic_0000002210640124_p1022854011411"></a>ge.debugDir</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640124_p59034431719"><a name="zh-cn_topic_0000002210640124_p59034431719"></a><a name="zh-cn_topic_0000002210640124_p59034431719"></a>用于配置保存算子编译生成的调试相关过程文件的路径，过程文件包括但不限于算子.o（算子二进制文件）、.json（算子描述文件）、.cce等文件。</p>
<p id="zh-cn_topic_0000002210640124_p513519112272"><a name="zh-cn_topic_0000002210640124_p513519112272"></a><a name="zh-cn_topic_0000002210640124_p513519112272"></a>默认生成在当前训练脚本执行路径下。</p>
<p id="zh-cn_topic_0000002210640124_p6243161820192"><a name="zh-cn_topic_0000002210640124_p6243161820192"></a><a name="zh-cn_topic_0000002210640124_p6243161820192"></a><strong id="zh-cn_topic_0000002210640124_b053462510190"><a name="zh-cn_topic_0000002210640124_b053462510190"></a><a name="zh-cn_topic_0000002210640124_b053462510190"></a>使用约束：</strong></p>
<a name="zh-cn_topic_0000002210640124_ul38514329196"></a><a name="zh-cn_topic_0000002210640124_ul38514329196"></a><ul id="zh-cn_topic_0000002210640124_ul38514329196"><li>如果要自行指定算子编译的过程文件存放路径，需ge.debugDir参数与ge.opDebugLevel参数配合使用，且当ge.opDebugLevel取值为0时，不能使用ge.debugDir参数。</li><li>算子编译生成的调试文件存储路径，除ge.debugDir参数设置的方式外，还可以配置环境变量ASCEND_WORK_PATH，几种方式优先级为：配置参数“ge.debugDir”&gt; 环境变量ASCEND_WORK_PATH &gt; 默认存储路径。关于环境变量ASCEND_WORK_PATH的详细说明请参见<span id="zh-cn_topic_0000002210640124_ph484113010559"><a name="zh-cn_topic_0000002210640124_ph484113010559"></a><a name="zh-cn_topic_0000002210640124_ph484113010559"></a>《环境变量参考》</span>。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640124_p59041508327"><a name="zh-cn_topic_0000002210640124_p59041508327"></a><a name="zh-cn_topic_0000002210640124_p59041508327"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640124_p1240320155214"><a name="zh-cn_topic_0000002210640124_p1240320155214"></a><a name="zh-cn_topic_0000002210640124_p1240320155214"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640124_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640124_p14980184234019"><a name="zh-cn_topic_0000002210640124_p14980184234019"></a><a name="zh-cn_topic_0000002210640124_p14980184234019"></a>ge.exportCompileStat</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640124_p12811196142117"><a name="zh-cn_topic_0000002210640124_p12811196142117"></a><a name="zh-cn_topic_0000002210640124_p12811196142117"></a>配置图编译过程中是否生成算子融合信息（包括图融合和UB融合）的结果文件fusion_result.json。</p>
<p id="zh-cn_topic_0000002210640124_p447102213221"><a name="zh-cn_topic_0000002210640124_p447102213221"></a><a name="zh-cn_topic_0000002210640124_p447102213221"></a>该文件用于记录图编译过程中使用的融合规则，而精度比对中的ge.fusionSwitchFile参数可以关闭指定的融合规则，关闭的融合规则，不会在fusion_result.json文件中呈现，文件中：</p>
<a name="zh-cn_topic_0000002210640124_ul693662352216"></a><a name="zh-cn_topic_0000002210640124_ul693662352216"></a><ul id="zh-cn_topic_0000002210640124_ul693662352216"><li>session_and_graph_id_<em id="zh-cn_topic_0000002210640124_zh-cn_topic_0000002087352816_i98131925111418"><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000002087352816_i98131925111418"></a><a name="zh-cn_topic_0000002210640124_zh-cn_topic_0000002087352816_i98131925111418"></a>xx_xx</em>：表示融合结果所属线程和图编号。</li><li>graph_fusion：表示图融合。</li><li>ub_fusion：表示UB融合。</li><li>match_times：表示图编译过程中匹配到的融合规则次数。</li><li>effect_times：表示实际生效的次数。</li><li>repository_hit_times：优化UB融合知识库命中的次数。</li></ul>
<p id="zh-cn_topic_0000002210640124_p18191161717919"><a name="zh-cn_topic_0000002210640124_p18191161717919"></a><a name="zh-cn_topic_0000002210640124_p18191161717919"></a><strong id="zh-cn_topic_0000002210640124_b1125103610916"><a name="zh-cn_topic_0000002210640124_b1125103610916"></a><a name="zh-cn_topic_0000002210640124_b1125103610916"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210640124_ul015116538916"></a><a name="zh-cn_topic_0000002210640124_ul015116538916"></a><ul id="zh-cn_topic_0000002210640124_ul015116538916"><li>0：不生成算子融合信息结果文件。</li><li>1：（默认值）程序运行正常退出时，生成算子融合信息结果文件。</li><li>2：图编译完成时，生成算子融合信息结果文件。即如果图编译已完成，后续程序提前中断，也会生成算子融合信息结果文件。</li></ul>
<div class="note" id="zh-cn_topic_0000002210640124_note136881328182810"><a name="zh-cn_topic_0000002210640124_note136881328182810"></a><a name="zh-cn_topic_0000002210640124_note136881328182810"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="zh-cn_topic_0000002210640124_p1170311587449"><a name="zh-cn_topic_0000002210640124_p1170311587449"></a><a name="zh-cn_topic_0000002210640124_p1170311587449"></a>若未设置ASCEND_WORK_PATH环境变量，结果文件默认生成在执行脚本当前路径；若设置了ASCEND_WORK_PATH环境变量，则保存路径为：$ASCEND_WORK_PATH/FE/${进程号}/fusion_result.json。环境变量详细说明请参见<span id="zh-cn_topic_0000002210640124_ph842515311811"><a name="zh-cn_topic_0000002210640124_ph842515311811"></a><a name="zh-cn_topic_0000002210640124_ph842515311811"></a>《环境变量参考》</span>。</p>
</div></div>
<p id="zh-cn_topic_0000002210640124_p83471930897"><a name="zh-cn_topic_0000002210640124_p83471930897"></a><a name="zh-cn_topic_0000002210640124_p83471930897"></a><strong id="zh-cn_topic_0000002210640124_b142523366914"><a name="zh-cn_topic_0000002210640124_b142523366914"></a><a name="zh-cn_topic_0000002210640124_b142523366914"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640124_screen1724535017100"><a name="zh-cn_topic_0000002210640124_screen1724535017100"></a><a name="zh-cn_topic_0000002210640124_screen1724535017100"></a>{"ge.exportCompileStat", "1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640124_p164113267423"><a name="zh-cn_topic_0000002210640124_p164113267423"></a><a name="zh-cn_topic_0000002210640124_p164113267423"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640124_p17411326174214"><a name="zh-cn_topic_0000002210640124_p17411326174214"></a><a name="zh-cn_topic_0000002210640124_p17411326174214"></a>全局</p>
</td>
</tr>
</tbody>
</table>

## 精度调优<a name="section481219169574"></a>

<a name="table102241031195820"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245680197_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002245680197_p3681132911170"><a name="zh-cn_topic_0000002245680197_p3681132911170"></a><a name="zh-cn_topic_0000002245680197_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002245680197_p326514861719"><a name="zh-cn_topic_0000002245680197_p326514861719"></a><a name="zh-cn_topic_0000002245680197_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002245680197_p1572818217519"><a name="zh-cn_topic_0000002245680197_p1572818217519"></a><a name="zh-cn_topic_0000002245680197_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002245680197_p197281421456"><a name="zh-cn_topic_0000002245680197_p197281421456"></a><a name="zh-cn_topic_0000002245680197_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245680197_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680197_p14681163113510"><a name="zh-cn_topic_0000002245680197_p14681163113510"></a><a name="zh-cn_topic_0000002245680197_p14681163113510"></a>ge.exec.precision_mode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680197_p1268117317359"><a name="zh-cn_topic_0000002245680197_p1268117317359"></a><a name="zh-cn_topic_0000002245680197_p1268117317359"></a>算子精度模式，配置要求为string类型。不能与ge.exec.precision_mode_v2同时使用，建议使用ge.exec.precision_mode_v2参数。</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0221674006_ul561918228306"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0221674006_ul561918228306"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0221674006_ul561918228306"><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b713235024011"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b713235024011"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b713235024011"></a>force_fp32/cube_fp16in_fp32out：</strong><div class="p" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p8537814448"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p8537814448"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p8537814448"></a>配置为force_fp32或cube_fp16in_fp32out，效果等同，该选项用来表示AI Core中该算子既支持float32又支持float16数据类型时，系统内部都会根据算子类型不同，选择不同的处理方式。cube_fp16in_fp32out为新版本中新增的，对于矩阵计算类算子，该选项语义更清晰。<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul169010276308"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul169010276308"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul169010276308"><li>对于矩阵计算类算子，系统内部会按算子实现的支持情况处理：<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ol6196318114911"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ol6196318114911"></a><ol id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ol6196318114911"><li>优先选择输入数据类型为float16且输出数据类型为float32；</li><li>如果1中的场景不支持，则选择输入数据类型为float32且输出数据类型为float32；</li><li>如果2中的场景不支持，则选择输入数据类型为float16且输出数据类型为float16；</li><li>如果3中的场景不支持，则报错。</li></ol>
</li><li>对于矢量计算类算子，表示原图中算子精度为float16或bfloat16，强制选择float32。<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p2355122020261"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p2355122020261"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p2355122020261"></a>如果原图中存在部分算子，在AI Core中该算子的实现不支持float32，比如某算子仅支持float16类型，则该参数不生效，仍然使用支持的float16；如果在AI Core中该算子的实现不支持float32，且又配置了黑名单（precision_reduce = false），则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</p>
</li></ul>
</div>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b5998125544012"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b5998125544012"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b5998125544012"></a>force_fp16：</strong><p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p59818442401"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p59818442401"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p59818442401"></a>表示原图中算子精度为float16、bfloat16和float32时，强制选择float16。</p>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b8330648174120"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b8330648174120"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b8330648174120"></a>allow_fp32_to_fp16：</strong><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul777312334113"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul777312334113"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul777312334113"><li>对于矩阵类算子：<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul6761514144114"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul6761514144114"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul6761514144114"><li>如果原图中算子精度为float32，优先降低精度到float16，如果AI Core中算子不支持float16，则继续选择float32，如果AI Core中算子不支持float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li>对于矢量类算子，优先保持原图精度：<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul464241443812"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul464241443812"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul464241443812"><li>如果原图中算子精度为float32，则优先使用原图精度float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则直接降低精度到float16；如果AI Core中算子不支持float16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b5252156154212"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b5252156154212"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b5252156154212"></a>must_keep_origin_dtype：</strong><p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p20280144555815"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p20280144555815"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p20280144555815"></a>保持原图精度。</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul1619894955814"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul1619894955814"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul1619894955814"><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持float32和bfloat16，则系统内部会自动采用高精度float32。</li><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持bfloat16，则会使用float16的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中某算子精度为float32，AI Core中该算子的实现不支持float32类型、仅支持float16类型，则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b14329055205212"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b14329055205212"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b14329055205212"></a>allow_mix_precision/allow_mix_precision_fp16</strong>：<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p13288949175211"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p13288949175211"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p13288949175211"></a>配置为allow_mix_precision或allow_mix_precision_fp16，效果等同，均表示使用混合精度float16、bfloat16和float32数据类型来处理神经网络的过程。allow_mix_precision_fp16为新版本中新增的，语义更清晰，便于理解。</p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p152814174917"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p152814174917"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p152814174917"></a>针对原始模型中float32和bfloat16数据类型的算子，按照内置的优化策略，自动将部分float32和bfloat16的算子降低精度到float16，从而在精度损失很小的情况下提升系统性能并减少内存使用。</p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p3445181144615"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p3445181144615"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p3445181144615"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ph10562197165916"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ph10562197165916"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i23791626927"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i23791626927"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i23791626927"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i163391631724"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i163391631724"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i163391631724"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_parmname544591134619"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_parmname544591134619"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_parmname544591134619"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul6368123316466"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul6368123316466"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul6368123316466"><li>若取值为true（白名单），则表示允许将当前float32和bfloat16类型的算子，降低精度到float16。</li><li>若取值为false（黑名单），则不允许将当前float32和bfloat16类型的算子降低精度到float16，相应算子仍旧使用float32或bfloat16精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b1133818511228"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b1133818511228"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b1133818511228"></a>allow_mix_precision_bf16：</strong><p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p645755825314"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p645755825314"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p645755825314"></a>表示使用混合精度bfloat16和float32数据类型来处理神经网络的过程。针对原始模型中float32数据类型的算子，按照内置的优化策略，自动将部分float32的算子降低精度到bfloat16，从而在精度损失很小的情况下提升系统性能并减少内存使用；如果AI Core中算子不支持bfloat16和float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p7213919209"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p7213919209"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_p7213919209"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ph221381915016"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ph221381915016"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ph221381915016"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i1843218381128"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i1843218381128"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i1843218381128"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i1674910411524"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i1674910411524"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_i1674910411524"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_parmname6213141915012"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_parmname6213141915012"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_parmname6213141915012"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul62133191409"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul62133191409"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul62133191409"><li>若取值为true（白名单），则表示允许将当前float32类型的算子，降低精度到<span>bfloat16</span>。</li><li>若取值为false（黑名单），则不允许将当前float32类型的算子降低精度到<span>bfloat16</span>，相应算子仍旧使用float32精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b1845717283465"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b1845717283465"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_b1845717283465"></a>allow_fp32_to_bf16：</strong><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul139030935"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul139030935"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312392865_ul139030935"><li>如果原图中算子精度为float32，则优先使用原图精度float32，如果AI Core中算子不支持float32，则降低精度到bfloat16；如果AI Core中算子不支持bfloat16，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中算子精度为bfloat16，则优先使用原图精度bfloat16，如果AI Core中算子不支持bfloat16，则选择float32，如果AI Core中算子不支持float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li></ul>
<p id="zh-cn_topic_0000002245680197_p1940315595482"><a name="zh-cn_topic_0000002245680197_p1940315595482"></a><a name="zh-cn_topic_0000002245680197_p1940315595482"></a>上述路径中的<span id="zh-cn_topic_0000002245680197_ph1027510266551"><a name="zh-cn_topic_0000002245680197_ph1027510266551"></a><a name="zh-cn_topic_0000002245680197_ph1027510266551"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002245680197_i4744144825919"><a name="zh-cn_topic_0000002245680197_i4744144825919"></a><a name="zh-cn_topic_0000002245680197_i4744144825919"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002245680197_ph17744144825911"><a name="zh-cn_topic_0000002245680197_ph17744144825911"></a><a name="zh-cn_topic_0000002245680197_ph17744144825911"></a>产品</span>进行选择。</p>
<p id="zh-cn_topic_0000002245680197_p51581537165"><a name="zh-cn_topic_0000002245680197_p51581537165"></a><a name="zh-cn_topic_0000002245680197_p51581537165"></a><strong id="zh-cn_topic_0000002245680197_b207981346194811"><a name="zh-cn_topic_0000002245680197_b207981346194811"></a><a name="zh-cn_topic_0000002245680197_b207981346194811"></a>参数默认值：</strong></p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001446874009_p145821441103218"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001446874009_p145821441103218"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001446874009_p145821441103218"></a>训练场景下，针对<span id="zh-cn_topic_0000002245680197_ph6764152619463"><a name="zh-cn_topic_0000002245680197_ph6764152619463"></a><a name="zh-cn_topic_0000002245680197_ph6764152619463"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>，参数默认值为“must_keep_origin_dtype”。</p>
<p id="zh-cn_topic_0000002245680197_p1781018279228"><a name="zh-cn_topic_0000002245680197_p1781018279228"></a><a name="zh-cn_topic_0000002245680197_p1781018279228"></a>训练场景下，针对<span id="zh-cn_topic_0000002245680197_ph4810182711226"><a name="zh-cn_topic_0000002245680197_ph4810182711226"></a><a name="zh-cn_topic_0000002245680197_ph4810182711226"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>，参数默认值为“must_keep_origin_dtype”。</p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001446874009_p176051727113817"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001446874009_p176051727113817"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001446874009_p176051727113817"></a>在线推理场景下，参数默认值为“force_fp16”。</p>
<p id="zh-cn_topic_0000002245680197_p750613235345"><a name="zh-cn_topic_0000002245680197_p750613235345"></a><a name="zh-cn_topic_0000002245680197_p750613235345"></a><strong id="zh-cn_topic_0000002245680197_b185533053417"><a name="zh-cn_topic_0000002245680197_b185533053417"></a><a name="zh-cn_topic_0000002245680197_b185533053417"></a>参数值约束：</strong></p>
<p id="zh-cn_topic_0000002245680197_p11624185813418"><a name="zh-cn_topic_0000002245680197_p11624185813418"></a><a name="zh-cn_topic_0000002245680197_p11624185813418"></a><strong id="zh-cn_topic_0000002245680197_b2777171963615"><a name="zh-cn_topic_0000002245680197_b2777171963615"></a><a name="zh-cn_topic_0000002245680197_b2777171963615"></a>bfloat16数据类型仅支持以下<span id="zh-cn_topic_0000002245680197_ph97231519171113"><a name="zh-cn_topic_0000002245680197_ph97231519171113"></a><a name="zh-cn_topic_0000002245680197_ph97231519171113"></a>产品</span></strong>：</p>
<p id="zh-cn_topic_0000002245680197_p12643143517324"><a name="zh-cn_topic_0000002245680197_p12643143517324"></a><a name="zh-cn_topic_0000002245680197_p12643143517324"></a><span id="zh-cn_topic_0000002245680197_ph664353543215"><a name="zh-cn_topic_0000002245680197_ph664353543215"></a><a name="zh-cn_topic_0000002245680197_ph664353543215"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002245680197_p18643735143214"><a name="zh-cn_topic_0000002245680197_p18643735143214"></a><a name="zh-cn_topic_0000002245680197_p18643735143214"></a><span id="zh-cn_topic_0000002245680197_ph264323511325"><a name="zh-cn_topic_0000002245680197_ph264323511325"></a><a name="zh-cn_topic_0000002245680197_ph264323511325"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680197_p668112323512"><a name="zh-cn_topic_0000002245680197_p668112323512"></a><a name="zh-cn_topic_0000002245680197_p668112323512"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680197_p45091825135217"><a name="zh-cn_topic_0000002245680197_p45091825135217"></a><a name="zh-cn_topic_0000002245680197_p45091825135217"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680197_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680197_p1684142515199"><a name="zh-cn_topic_0000002245680197_p1684142515199"></a><a name="zh-cn_topic_0000002245680197_p1684142515199"></a>ge.exec.precision_mode_v2</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680197_p1841525161919"><a name="zh-cn_topic_0000002245680197_p1841525161919"></a><a name="zh-cn_topic_0000002245680197_p1841525161919"></a>算子精度模式，配置要求为string类型。不能与ge.exec.precision_mode同时使用，建议使用ge.exec.precision_mode_v2参数。</p>
<a name="zh-cn_topic_0000002245680197_ul68416256192"></a><a name="zh-cn_topic_0000002245680197_ul68416256192"></a><ul id="zh-cn_topic_0000002245680197_ul68416256192"><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b6133153320135"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b6133153320135"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b6133153320135"></a>fp16</strong>：<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p37316156141"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p37316156141"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p37316156141"></a>表示原图中算子精度为float16、bfloat16或float32时，强制选择float16。</p>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b9661017144"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b9661017144"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b9661017144"></a>origin</strong>：<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p10420443128"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p10420443128"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p10420443128"></a>保持原图精度。</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul1872113713125"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul1872113713125"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul1872113713125"><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持float32和bfloat16，则系统内部会自动采用高精度float32。</li><li>如果原图中某算子精度为float16，AI Core中该算子的实现不支持float16、仅支持bfloat16，则会使用float16的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li><li>如果原图中某算子精度为float32，AI Core中该算子的实现不支持float32类型、仅支持float16类型，则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b1091213018170"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b1091213018170"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b1091213018170"></a>cube_fp16in_fp32out</strong>：<div class="p" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1372204971913"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1372204971913"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1372204971913"></a>AI Core中该算子既支持float32又支持float16数据类型时，系统内部根据算子类型不同，选择不同的处理方式。<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul169010276308"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul169010276308"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul169010276308"><li>对于矩阵计算类算子，系统内部会按算子实现的支持情况处理：<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ol6196318114911"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ol6196318114911"></a><ol id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ol6196318114911"><li>优先选择输入数据类型为float16且输出数据类型为float32；</li><li>如果1中的场景不支持，则选择输入数据类型为float32且输出数据类型为float32；</li><li>如果2中的场景不支持，则选择输入数据类型为float16且输出数据类型为float16；</li><li>如果3中的场景不支持，则报错。</li></ol>
</li><li>对于矢量计算类算子，表示原图中算子精度为float16或bfloat16，强制选择float32。<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p2355122020261"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p2355122020261"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p2355122020261"></a>如果原图中存在部分算子，在AI Core中该算子的实现不支持float32，比如某算子仅支持float16类型，则该参数不生效，仍然使用支持的float16；如果在AI Core中该算子的实现不支持float32，且又配置了黑名单（precision_reduce = false），则会使用float32的AI CPU算子；如果AI CPU算子也不支持，则执行报错。</p>
</li></ul>
</div>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b1113215426233"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b1113215426233"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b1113215426233"></a>mixed_float16</strong>：<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p13288949175211"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p13288949175211"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p13288949175211"></a>表示使用混合精度float16、bfloat16和float32数据类型来处理神经网络。针对原图中float32和bfloat16数据类型的算子，按照内置的优化策略，自动将部分float32和<span>bfloat16</span>的算子降低精度到float16，从而在精度损失很小的情况下提升系统性能并减少内存使用。</p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p3445181144615"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p3445181144615"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p3445181144615"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph10562197165916"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph10562197165916"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i820814615314"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i820814615314"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i820814615314"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i76815552310"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i76815552310"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i76815552310"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_parmname544591134619"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_parmname544591134619"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_parmname544591134619"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul6368123316466"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul6368123316466"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul6368123316466"><li>若取值为true（白名单），则表示允许将当前float32和<span>bfloat16</span>类型的算子，降低精度到float16。</li><li>若取值为false（黑名单），则不允许将当前float32和<span>bfloat16</span>类型的算子降低精度到float16，相应算子仍旧使用float32或<span>bfloat16</span>精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b4594173711235"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b4594173711235"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b4594173711235"></a>mixed_bfloat16</strong>：<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p645755825314"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p645755825314"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p645755825314"></a>表示使用混合精度bfloat16和float32数据类型来处理神经网络。针对原图中float32数据类型的算子，按照内置的优化策略，自动将部分float32的算子降低精度到<span>bfloat16</span>，从而在精度损失很小的情况下提升系统性能并减少内存使用；<span>如果算子不支持bfloat16和</span>float32，则使用AI CPU算子进行计算；如果AI CPU算子也不支持，则执行报错。</p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p7213919209"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p7213919209"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p7213919209"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph221381915016"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph221381915016"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph221381915016"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i1666213581835"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i1666213581835"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i1666213581835"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i3293221441"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i3293221441"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i3293221441"></a>xxx</em>-ops-info.json内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_parmname6213141915012"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_parmname6213141915012"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_parmname6213141915012"></a>“precision_reduce”</span>参数的取值：</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul62133191409"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul62133191409"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul62133191409"><li>若取值为true（白名单），则表示允许将当前float32类型的算子，降低精度到<span>bfloat16</span>。</li><li>若取值为false（黑名单），则不允许将当前float32类型的算子降低精度到<span>bfloat16</span>，相应算子仍旧使用float32精度。</li><li>若网络模型中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b7210361631"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b7210361631"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b7210361631"></a>mixed_hif8：</strong><p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p148818611318"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p148818611318"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p148818611318"></a>开启自动混合精度功能，表示混合使用hifloat8（此数据类型介绍可参见<a href="https://arxiv.org/abs/2409.16626?context=cs.AR" target="_blank" rel="noopener noreferrer">Link</a>）、float16、bfloat16和float32数据类型来处理神经网络。针对原图中float16、bfloat16和float32数据类型的算子，按照内置的优化策略，自动将部分float16、bfloat16和float32的算子降低精度到hifloat8，从而在精度损失很小的情况下提升系统性能并减少内存使用。<strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b9699153118144"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b9699153118144"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b9699153118144"></a>当前版本不支持该选项。</strong></p>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1110861315594"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1110861315594"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1110861315594"></a>若配置了该种模式，则可以在<span id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph189988304592"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph189988304592"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ph189988304592"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i7381282415"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i7381282415"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i7381282415"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i10251311246"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i10251311246"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_i10251311246"></a>xxx</em>-ops-info.json内置优化策略文件中查看“<strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b19575163635912"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b19575163635912"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b19575163635912"></a>precision_reduce</strong>”参数的取值：</p>
<a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul176671048185911"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul176671048185911"></a><ul id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_ul176671048185911"><li>若取值为true（白名单），则表示允许将当前float16、<span>bfloat16</span>和float32类型的算子，降低精度到hifloat8。</li><li>若取值为false（黑名单），则不允许将当前float16、<span>bfloat16</span>和float32类型的算子降低精度到hifloat8，相应算子仍旧使用float16、<span>bfloat16</span>或float32精度。</li><li>若原图中算子没有配置该参数（灰名单），当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
</li><li><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b760013935811"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b760013935811"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b760013935811"></a>cube_hif8</strong>：<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1165518421944"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1165518421944"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_p1165518421944"></a>表示若原图中的cube算子既支持hifloat8，又支持float16、bfloat16或float32数据类型时，强制选择hifloat8数据类型。<strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b0246174891418"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b0246174891418"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b0246174891418"></a><strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b18340134731515"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b18340134731515"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001653452773_b18340134731515"></a>当前版本不支持该选项。</strong></strong></p>
</li></ul>
<p id="zh-cn_topic_0000002245680197_p19995547114912"><a name="zh-cn_topic_0000002245680197_p19995547114912"></a><a name="zh-cn_topic_0000002245680197_p19995547114912"></a>上述路径中的<span id="zh-cn_topic_0000002245680197_ph9320113519012"><a name="zh-cn_topic_0000002245680197_ph9320113519012"></a><a name="zh-cn_topic_0000002245680197_ph9320113519012"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002245680197_i68739400014"><a name="zh-cn_topic_0000002245680197_i68739400014"></a><a name="zh-cn_topic_0000002245680197_i68739400014"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002245680197_ph208731401101"><a name="zh-cn_topic_0000002245680197_ph208731401101"></a><a name="zh-cn_topic_0000002245680197_ph208731401101"></a>产品</span>进行选择。</p>
<p id="zh-cn_topic_0000002245680197_p1489202591913"><a name="zh-cn_topic_0000002245680197_p1489202591913"></a><a name="zh-cn_topic_0000002245680197_p1489202591913"></a><strong id="zh-cn_topic_0000002245680197_b158922541911"><a name="zh-cn_topic_0000002245680197_b158922541911"></a><a name="zh-cn_topic_0000002245680197_b158922541911"></a>参数默认值：</strong></p>
<p id="zh-cn_topic_0000002245680197_p138972513198"><a name="zh-cn_topic_0000002245680197_p138972513198"></a><a name="zh-cn_topic_0000002245680197_p138972513198"></a>训练场景下，针对<span id="zh-cn_topic_0000002245680197_ph16891325161916"><a name="zh-cn_topic_0000002245680197_ph16891325161916"></a><a name="zh-cn_topic_0000002245680197_ph16891325161916"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>，参数默认值为“origin”。</p>
<p id="zh-cn_topic_0000002245680197_p127011171243"><a name="zh-cn_topic_0000002245680197_p127011171243"></a><a name="zh-cn_topic_0000002245680197_p127011171243"></a>训练场景下，针对<span id="zh-cn_topic_0000002245680197_ph227071713241"><a name="zh-cn_topic_0000002245680197_ph227071713241"></a><a name="zh-cn_topic_0000002245680197_ph227071713241"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>，参数默认值为“origin”。</p>
<p id="zh-cn_topic_0000002245680197_p118922561917"><a name="zh-cn_topic_0000002245680197_p118922561917"></a><a name="zh-cn_topic_0000002245680197_p118922561917"></a>在线推理场景下，参数默认值为“fp16”。</p>
<p id="zh-cn_topic_0000002245680197_p185141358184017"><a name="zh-cn_topic_0000002245680197_p185141358184017"></a><a name="zh-cn_topic_0000002245680197_p185141358184017"></a><strong id="zh-cn_topic_0000002245680197_b4877181014110"><a name="zh-cn_topic_0000002245680197_b4877181014110"></a><a name="zh-cn_topic_0000002245680197_b4877181014110"></a>参数值约束：</strong></p>
<p id="zh-cn_topic_0000002245680197_p926181810415"><a name="zh-cn_topic_0000002245680197_p926181810415"></a><a name="zh-cn_topic_0000002245680197_p926181810415"></a><strong id="zh-cn_topic_0000002245680197_b780181614120"><a name="zh-cn_topic_0000002245680197_b780181614120"></a><a name="zh-cn_topic_0000002245680197_b780181614120"></a>bfloat16数据类型仅支持以下<span id="zh-cn_topic_0000002245680197_ph010883381111"><a name="zh-cn_topic_0000002245680197_ph010883381111"></a><a name="zh-cn_topic_0000002245680197_ph010883381111"></a>产品</span></strong>：</p>
<p id="zh-cn_topic_0000002245680197_p19801141612411"><a name="zh-cn_topic_0000002245680197_p19801141612411"></a><a name="zh-cn_topic_0000002245680197_p19801141612411"></a><span id="zh-cn_topic_0000002245680197_ph9801161644113"><a name="zh-cn_topic_0000002245680197_ph9801161644113"></a><a name="zh-cn_topic_0000002245680197_ph9801161644113"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002245680197_p98011116114115"><a name="zh-cn_topic_0000002245680197_p98011116114115"></a><a name="zh-cn_topic_0000002245680197_p98011116114115"></a><span id="zh-cn_topic_0000002245680197_ph178016168414"><a name="zh-cn_topic_0000002245680197_ph178016168414"></a><a name="zh-cn_topic_0000002245680197_ph178016168414"></a><term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680197_p2891225121913"><a name="zh-cn_topic_0000002245680197_p2891225121913"></a><a name="zh-cn_topic_0000002245680197_p2891225121913"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680197_p5891325151911"><a name="zh-cn_topic_0000002245680197_p5891325151911"></a><a name="zh-cn_topic_0000002245680197_p5891325151911"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680197_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680197_p186126398296"><a name="zh-cn_topic_0000002245680197_p186126398296"></a><a name="zh-cn_topic_0000002245680197_p186126398296"></a>ge.exec.modify_mixlist</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680197_p62621139183213"><a name="zh-cn_topic_0000002245680197_p62621139183213"></a><a name="zh-cn_topic_0000002245680197_p62621139183213"></a>混合精度场景下，通过此参数指定混合精度黑白灰名单的路径以及文件名，自行指定哪些算子允许降精度，哪些算子不允许降精度。配置为路径以及文件名，文件为JSON格式。</p>
<p id="zh-cn_topic_0000002245680197_p1044212211520"><a name="zh-cn_topic_0000002245680197_p1044212211520"></a><a name="zh-cn_topic_0000002245680197_p1044212211520"></a>黑白灰名单，可从“<span id="zh-cn_topic_0000002245680197_ph123231510175111"><a name="zh-cn_topic_0000002245680197_ph123231510175111"></a><a name="zh-cn_topic_0000002245680197_ph123231510175111"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_i0397247191715"><a name="zh-cn_topic_0000002245680197_i0397247191715"></a><a name="zh-cn_topic_0000002245680197_i0397247191715"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_i78626493172"><a name="zh-cn_topic_0000002245680197_i78626493172"></a><a name="zh-cn_topic_0000002245680197_i78626493172"></a>xxx</em>-ops-info.json”内置优化策略文件中查看<span class="parmname" id="zh-cn_topic_0000002245680197_parmname193238108518"><a name="zh-cn_topic_0000002245680197_parmname193238108518"></a><a name="zh-cn_topic_0000002245680197_parmname193238108518"></a>“precision_reduce”</span>参数下的flag参数值（其中，<span id="zh-cn_topic_0000002245680197_ph17290122918117"><a name="zh-cn_topic_0000002245680197_ph17290122918117"></a><a name="zh-cn_topic_0000002245680197_ph17290122918117"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002245680197_i1838843711914"><a name="zh-cn_topic_0000002245680197_i1838843711914"></a><a name="zh-cn_topic_0000002245680197_i1838843711914"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002245680197_ph245211376137"><a name="zh-cn_topic_0000002245680197_ph245211376137"></a><a name="zh-cn_topic_0000002245680197_ph245211376137"></a>产品</span>进行选择。）：</p>
<a name="zh-cn_topic_0000002245680197_ul1473622618190"></a><a name="zh-cn_topic_0000002245680197_ul1473622618190"></a><ul id="zh-cn_topic_0000002245680197_ul1473622618190"><li>若取值为true（白名单），表示混合精度模式下，<strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073942_b2304123420539"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073942_b2304123420539"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073942_b2304123420539"></a>允许</strong>降低精度。</li><li>若取值为false（黑名单），表示混合精度模式下，<strong id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073942_b04811035105314"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073942_b04811035105314"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073942_b04811035105314"></a>不允许</strong>降低精度。</li><li>不配置该参数（灰名单），表示混合精度模式下，当前算子的混合精度处理机制和前一个算子保持一致，即如果前一个算子支持降精度处理，当前算子也支持降精度；如果前一个算子不允许降精度，当前算子也不支持降精度。</li></ul>
<div class="p" id="zh-cn_topic_0000002245680197_p489982953315"><a name="zh-cn_topic_0000002245680197_p489982953315"></a><a name="zh-cn_topic_0000002245680197_p489982953315"></a>配置示例：<pre class="screen" id="zh-cn_topic_0000002245680197_screen689942912339"><a name="zh-cn_topic_0000002245680197_screen689942912339"></a><a name="zh-cn_topic_0000002245680197_screen689942912339"></a>{"ge.exec.modify_mixlist", "/home/test/ops_info.json"};</pre>
</div>
<p id="zh-cn_topic_0000002245680197_p889922918332"><a name="zh-cn_topic_0000002245680197_p889922918332"></a><a name="zh-cn_topic_0000002245680197_p889922918332"></a>ops_info.json中可以指定算子类型，多个算子使用英文逗号分隔，样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002245680197_screen15227852153611"><a name="zh-cn_topic_0000002245680197_screen15227852153611"></a><a name="zh-cn_topic_0000002245680197_screen15227852153611"></a>{
  "black-list": {                  // 黑名单
     "to-remove": [                // 黑名单算子转换为灰名单算子
     "Xlog1py"
     ],
     "to-add": [                   // 白名单或灰名单算子转换为黑名单算子
     "Matmul",
     "Cast"
     ]
  },
  "white-list": {                  // 白名单
     "to-remove": [                // 白名单算子转换为灰名单算子 
     "Conv2D"
     ],
     "to-add": [                   // 黑名单或灰名单算子转换为白名单算子
     "Bias"
     ]
  }
}</pre>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0228309389_p1785210112503"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0228309389_p1785210112503"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0228309389_p1785210112503"></a>上述配置文件样例中展示的算子仅作为参考，请基于实际硬件环境和具体的算子内置优化策略进行配置。黑白灰名单查询样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002245680197_zh-cn_topic_0228309389_screen11429186175017"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0228309389_screen11429186175017"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0228309389_screen11429186175017"></a>"Conv2D":{
    "precision_reduce":{
        "flag":"true"
     }
},</pre>
<p id="zh-cn_topic_0000002245680197_p1034492515431"><a name="zh-cn_topic_0000002245680197_p1034492515431"></a><a name="zh-cn_topic_0000002245680197_p1034492515431"></a>true：白名单。false：黑名单。不配置：灰名单。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680197_p1949874775415"><a name="zh-cn_topic_0000002245680197_p1949874775415"></a><a name="zh-cn_topic_0000002245680197_p1949874775415"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680197_p049834719542"><a name="zh-cn_topic_0000002245680197_p049834719542"></a><a name="zh-cn_topic_0000002245680197_p049834719542"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680197_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680197_p12591105045615"><a name="zh-cn_topic_0000002245680197_p12591105045615"></a><a name="zh-cn_topic_0000002245680197_p12591105045615"></a>ge.customizeDtypes</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680197_p579618351471"><a name="zh-cn_topic_0000002245680197_p579618351471"></a><a name="zh-cn_topic_0000002245680197_p579618351471"></a>通过该参数自定义模型编译时算子的计算精度，模型中其他算子以ge.exec.precision_mode或ge.exec.precision_mode_v2指定的精度模式进行编译。该参数需要配置为配置文件路径及文件名，例如：/home/test/customize_dtypes.cfg。</p>
<p id="zh-cn_topic_0000002245680197_p1950952316389"><a name="zh-cn_topic_0000002245680197_p1950952316389"></a><a name="zh-cn_topic_0000002245680197_p1950952316389"></a><strong id="zh-cn_topic_0000002245680197_b1788773417386"><a name="zh-cn_topic_0000002245680197_b1788773417386"></a><a name="zh-cn_topic_0000002245680197_b1788773417386"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002245680197_ul064143915385"></a><a name="zh-cn_topic_0000002245680197_ul064143915385"></a><ul id="zh-cn_topic_0000002245680197_ul064143915385"><li>配置文件中列举需要自定义计算精度的算子名称或算子类型，每个算子单独一行，且算子类型必须为基于IR定义的算子的类型。</li><li>对于同一个算子，如果同时配置了算子名称和算子类型，编译时以算子名称为准。</li><li>指定某个算子的计算精度时，如果算子编译过程中该算子被融合掉，则该算子指定的计算精度不生效。</li></ul>
<p id="zh-cn_topic_0000002245680197_p97209557014"><a name="zh-cn_topic_0000002245680197_p97209557014"></a><a name="zh-cn_topic_0000002245680197_p97209557014"></a>配置文件格式要求：</p>
<pre class="screen" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_screen1111811011710"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_screen1111811011710"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_screen1111811011710"></a># 按照算子名称配置
<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i348131516582"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i348131516582"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i348131516582"></a>Opname1</em>::InputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i6372172415582"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i6372172415582"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i6372172415582"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i249792985811"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i249792985811"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i249792985811"></a>dtype1,…</em>
<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i161501785817"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i161501785817"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i161501785817"></a>Opname2</em>::InputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i116198268589"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i116198268589"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i116198268589"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i141196328581"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i141196328581"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i141196328581"></a>dtype1,…</em>
# 按照算子类型配置
OpType::<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i58992655812"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i58992655812"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i58992655812"></a>TypeName1</em>:InputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i791815516598"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i791815516598"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i791815516598"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i0350115610573"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i0350115610573"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i0350115610573"></a>dtype1,…</em>
OpType::<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i104981397582"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i104981397582"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i104981397582"></a>TypeName2</em>:InputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i132335593574"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i132335593574"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i132335593574"></a>dtype1,dtype2,…</em>OutputDtype:<em id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i52771811583"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i52771811583"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_i52771811583"></a>dtype1,…</em></pre>
<p id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_p14821143063816"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_p14821143063816"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_p14821143063816"></a>配置文件配置示例：</p>
<pre class="screen" id="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_screen1766716429819"><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_screen1766716429819"></a><a name="zh-cn_topic_0000002245680197_zh-cn_topic_0000001265073950_screen1766716429819"></a># 按照算子名称配置
resnet_v1_50/block1/unit_3/bottleneck_v1/Relu::InputDtype:float16,int8,OutputDtype:float16,int8
# 按照算子类型配置
OpType::Relu:InputDtype:float16,int8,OutputDtype:float16,int8</pre>
<div class="note" id="zh-cn_topic_0000002245680197_note2095432191110"><a name="zh-cn_topic_0000002245680197_note2095432191110"></a><a name="zh-cn_topic_0000002245680197_note2095432191110"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002245680197_ul442413276236"></a><a name="zh-cn_topic_0000002245680197_ul442413276236"></a><ul id="zh-cn_topic_0000002245680197_ul442413276236"><li>算子具体支持的计算精度可以从算子信息库中查看，默认存储路径为：<span id="zh-cn_topic_0000002245680197_ph8751715192013"><a name="zh-cn_topic_0000002245680197_ph8751715192013"></a><a name="zh-cn_topic_0000002245680197_ph8751715192013"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/config/<em id="zh-cn_topic_0000002245680197_i375171512018"><a name="zh-cn_topic_0000002245680197_i375171512018"></a><a name="zh-cn_topic_0000002245680197_i375171512018"></a>xxx</em>/aic-<em id="zh-cn_topic_0000002245680197_i875114151207"><a name="zh-cn_topic_0000002245680197_i875114151207"></a><a name="zh-cn_topic_0000002245680197_i875114151207"></a>xxx</em>-ops-info.json<p id="zh-cn_topic_0000002245680197_p451318561613"><a name="zh-cn_topic_0000002245680197_p451318561613"></a><a name="zh-cn_topic_0000002245680197_p451318561613"></a><span id="zh-cn_topic_0000002245680197_ph125481514312"><a name="zh-cn_topic_0000002245680197_ph125481514312"></a><a name="zh-cn_topic_0000002245680197_ph125481514312"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span><em id="zh-cn_topic_0000002245680197_i123341418214"><a name="zh-cn_topic_0000002245680197_i123341418214"></a><a name="zh-cn_topic_0000002245680197_i123341418214"></a>xxx</em>请根据实际<span id="zh-cn_topic_0000002245680197_ph123342411214"><a name="zh-cn_topic_0000002245680197_ph123342411214"></a><a name="zh-cn_topic_0000002245680197_ph123342411214"></a>产品</span>进行选择。</p>
</li><li>通过该参数指定的优先级高，因此可能会导致精度/性能的下降，如果指定的dtype不支持，会导致编译失败。</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680197_p145921914141714"><a name="zh-cn_topic_0000002245680197_p145921914141714"></a><a name="zh-cn_topic_0000002245680197_p145921914141714"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680197_p17592121411719"><a name="zh-cn_topic_0000002245680197_p17592121411719"></a><a name="zh-cn_topic_0000002245680197_p17592121411719"></a>session</p>
</td>
</tr>
</tbody>
</table>

## 精度比对<a name="section1995811215575"></a>

<a name="table4290332185815"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210480368_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002210480368_p3681132911170"><a name="zh-cn_topic_0000002210480368_p3681132911170"></a><a name="zh-cn_topic_0000002210480368_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002210480368_p326514861719"><a name="zh-cn_topic_0000002210480368_p326514861719"></a><a name="zh-cn_topic_0000002210480368_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002210480368_p1572818217519"><a name="zh-cn_topic_0000002210480368_p1572818217519"></a><a name="zh-cn_topic_0000002210480368_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002210480368_p197281421456"><a name="zh-cn_topic_0000002210480368_p197281421456"></a><a name="zh-cn_topic_0000002210480368_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210480368_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p110921315203"><a name="zh-cn_topic_0000002210480368_p110921315203"></a><a name="zh-cn_topic_0000002210480368_p110921315203"></a>ge.exec.enableDump</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p8682162920172"><a name="zh-cn_topic_0000002210480368_p8682162920172"></a><a name="zh-cn_topic_0000002210480368_p8682162920172"></a>是否开启dump功能。</p>
<a name="zh-cn_topic_0000002210480368_ul8719161073320"></a><a name="zh-cn_topic_0000002210480368_ul8719161073320"></a><ul id="zh-cn_topic_0000002210480368_ul8719161073320"><li>1：开启dump功能，从dump_path读取dump文件保存路径，dump_path为None时会产生异常。</li><li>0：（默认值）关闭dump功能。</li></ul>
<p id="zh-cn_topic_0000002210480368_p6501114675316"><a name="zh-cn_topic_0000002210480368_p6501114675316"></a><a name="zh-cn_topic_0000002210480368_p6501114675316"></a><strong id="zh-cn_topic_0000002210480368_b125019460535"><a name="zh-cn_topic_0000002210480368_b125019460535"></a><a name="zh-cn_topic_0000002210480368_b125019460535"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen2050115468533"><a name="zh-cn_topic_0000002210480368_screen2050115468533"></a><a name="zh-cn_topic_0000002210480368_screen2050115468533"></a>{"ge.exec.enableDump", "0"};</pre>
<div class="note" id="zh-cn_topic_0000002210480368_note18746184217720"><a name="zh-cn_topic_0000002210480368_note18746184217720"></a><a name="zh-cn_topic_0000002210480368_note18746184217720"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210480368_ul26131822171512"></a><a name="zh-cn_topic_0000002210480368_ul26131822171512"></a><ul id="zh-cn_topic_0000002210480368_ul26131822171512"><li>该参数与ge.exec.enableDumpDebug参数，全局场景以及同一个Session内场景，不能同时设置。</li><li>若“ge.exec.enableDump/ge.exec.enableDumpDebug（二选一）”参数配置为“1”，同时“ge.exec.enable_exception_dump”配置为“1”（即开启普通ExceptionDump），此时：<a name="zh-cn_topic_0000002210480368_ul18817113913915"></a><a name="zh-cn_topic_0000002210480368_ul18817113913915"></a><ul id="zh-cn_topic_0000002210480368_ul18817113913915"><li>针对动态shape网络，仅“ge.exec.enable_exception_dump”生效。</li><li>针对静态shape网络，“ge.exec.enable_exception_dump”与“ge.exec.enableDump/ge.exec.enableDumpDebug（二选一）”都生效。</li></ul>
</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p133652265329"><a name="zh-cn_topic_0000002210480368_p133652265329"></a><a name="zh-cn_topic_0000002210480368_p133652265329"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p6196520105213"><a name="zh-cn_topic_0000002210480368_p6196520105213"></a><a name="zh-cn_topic_0000002210480368_p6196520105213"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p53901893203"><a name="zh-cn_topic_0000002210480368_p53901893203"></a><a name="zh-cn_topic_0000002210480368_p53901893203"></a>ge.exec.dumpPath</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p20875134881015"><a name="zh-cn_topic_0000002210480368_p20875134881015"></a><a name="zh-cn_topic_0000002210480368_p20875134881015"></a>Dump文件保存路径。开启dump和溢出检测功能时，该参数必须配置。</p>
<p id="zh-cn_topic_0000002210480368_p5860838171615"><a name="zh-cn_topic_0000002210480368_p5860838171615"></a><a name="zh-cn_topic_0000002210480368_p5860838171615"></a>该参数指定的目录需要在启动训练的环境上（容器或Host侧）提前创建且确保安装时配置的运行用户具有读写权限，支持配置绝对路径或相对路径（相对执行命令行时的当前路径）。</p>
<a name="zh-cn_topic_0000002210480368_ul11442134515161"></a><a name="zh-cn_topic_0000002210480368_ul11442134515161"></a><ul id="zh-cn_topic_0000002210480368_ul11442134515161"><li>绝对路径配置以“/”开头，例如：/home/HwHiAiUser/output。</li><li>相对路径配置直接以目录名开始，例如：output。</li></ul>
<p id="zh-cn_topic_0000002210480368_p435923616197"><a name="zh-cn_topic_0000002210480368_p435923616197"></a><a name="zh-cn_topic_0000002210480368_p435923616197"></a>dump文件生成在该参数指定的目录下，即{dump_path}/{time}/{deviceid}/{model_name}/{model_id}/{data_index}目录下，以{dump_path}配置/home/HwHiAiUser/output为例，例如存放在<span class="uicontrol" id="zh-cn_topic_0000002210480368_zh-cn_topic_0228244807_uicontrol20687132713016"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0228244807_uicontrol20687132713016"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0228244807_uicontrol20687132713016"></a>“/home/HwHiAiUser/output/20200808163566/0/ge_default_20200808163719_121/11/0”</span>目录下。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p536814263322"><a name="zh-cn_topic_0000002210480368_p536814263322"></a><a name="zh-cn_topic_0000002210480368_p536814263322"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p9425842141515"><a name="zh-cn_topic_0000002210480368_p9425842141515"></a><a name="zh-cn_topic_0000002210480368_p9425842141515"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p19360135122010"><a name="zh-cn_topic_0000002210480368_p19360135122010"></a><a name="zh-cn_topic_0000002210480368_p19360135122010"></a>ge.exec.dumpStep</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p1268242991716"><a name="zh-cn_topic_0000002210480368_p1268242991716"></a><a name="zh-cn_topic_0000002210480368_p1268242991716"></a>指定采集哪些迭代的dump数据。默认值：None，表示所有迭代都会产生dump数据。</p>
<p id="zh-cn_topic_0000002210480368_p668272991719"><a name="zh-cn_topic_0000002210480368_p668272991719"></a><a name="zh-cn_topic_0000002210480368_p668272991719"></a>多个迭代用“|”分隔，例如：0|5|10；也可以用"-"指定迭代范围，例如：0|3-5|10。</p>
<p id="zh-cn_topic_0000002210480368_p8533110125410"><a name="zh-cn_topic_0000002210480368_p8533110125410"></a><a name="zh-cn_topic_0000002210480368_p8533110125410"></a><strong id="zh-cn_topic_0000002210480368_b19533810195416"><a name="zh-cn_topic_0000002210480368_b19533810195416"></a><a name="zh-cn_topic_0000002210480368_b19533810195416"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen19533121010540"><a name="zh-cn_topic_0000002210480368_screen19533121010540"></a><a name="zh-cn_topic_0000002210480368_screen19533121010540"></a>{"ge.exec.dumpStep", "None"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p0370172615323"><a name="zh-cn_topic_0000002210480368_p0370172615323"></a><a name="zh-cn_topic_0000002210480368_p0370172615323"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p154423427151"><a name="zh-cn_topic_0000002210480368_p154423427151"></a><a name="zh-cn_topic_0000002210480368_p154423427151"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p236513116202"><a name="zh-cn_topic_0000002210480368_p236513116202"></a><a name="zh-cn_topic_0000002210480368_p236513116202"></a>ge.exec.dumpMode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p10682122971712"><a name="zh-cn_topic_0000002210480368_p10682122971712"></a><a name="zh-cn_topic_0000002210480368_p10682122971712"></a>dump模式，用于指定dump算子输入数据还是输出数据。取值如下：</p>
<a name="zh-cn_topic_0000002210480368_ul17682229151714"></a><a name="zh-cn_topic_0000002210480368_ul17682229151714"></a><ul id="zh-cn_topic_0000002210480368_ul17682229151714"><li>input：仅dump算子输入数据。</li><li>output：（默认值）仅dump算子输出数据。</li><li>all：dump算子输入和输出数据。</li></ul>
<p id="zh-cn_topic_0000002210480368_p1770013393513"><a name="zh-cn_topic_0000002210480368_p1770013393513"></a><a name="zh-cn_topic_0000002210480368_p1770013393513"></a><strong id="zh-cn_topic_0000002210480368_b58841014135217"><a name="zh-cn_topic_0000002210480368_b58841014135217"></a><a name="zh-cn_topic_0000002210480368_b58841014135217"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen524472155210"><a name="zh-cn_topic_0000002210480368_screen524472155210"></a><a name="zh-cn_topic_0000002210480368_screen524472155210"></a>{"ge.exec.dumpMode", "input"};</pre>
<p id="zh-cn_topic_0000002210480368_p63649219529"><a name="zh-cn_topic_0000002210480368_p63649219529"></a><a name="zh-cn_topic_0000002210480368_p63649219529"></a><strong id="zh-cn_topic_0000002210480368_b5886111417528"><a name="zh-cn_topic_0000002210480368_b5886111417528"></a><a name="zh-cn_topic_0000002210480368_b5886111417528"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002210480368_p11107181175217"><a name="zh-cn_topic_0000002210480368_p11107181175217"></a><a name="zh-cn_topic_0000002210480368_p11107181175217"></a>配置为all时，由于部分算子在执行过程中会修改输入数据，例如集合通信类算子HcomAllGather、HcomAllReduce等，因此系统在进行dump时，会在算子执行前dump算子输入，在算子执行后dump算子输出，这样，针对同一个算子，算子输入、输出的dump数据是分开落盘，会出现多个dump文件，在解析dump文件后，用户可通过文件内容判断是输入还是输出。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p15372152663211"><a name="zh-cn_topic_0000002210480368_p15372152663211"></a><a name="zh-cn_topic_0000002210480368_p15372152663211"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p5462194251514"><a name="zh-cn_topic_0000002210480368_p5462194251514"></a><a name="zh-cn_topic_0000002210480368_p5462194251514"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p4949125714242"><a name="zh-cn_topic_0000002210480368_p4949125714242"></a><a name="zh-cn_topic_0000002210480368_p4949125714242"></a>ge.exec.dumpData</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p159491257142410"><a name="zh-cn_topic_0000002210480368_p159491257142410"></a><a name="zh-cn_topic_0000002210480368_p159491257142410"></a>指定算子dump内容类型，取值：</p>
<a name="zh-cn_topic_0000002210480368_ul847333833517"></a><a name="zh-cn_topic_0000002210480368_ul847333833517"></a><ul id="zh-cn_topic_0000002210480368_ul847333833517"><li>tensor：（默认值）dump算子数据。</li><li>stats：dump算子统计数据，保存结果为csv格式。一般情况下dump算子数据量大，用户可以尝试dump算子统计数据。</li></ul>
<p id="zh-cn_topic_0000002210480368_p249310371546"><a name="zh-cn_topic_0000002210480368_p249310371546"></a><a name="zh-cn_topic_0000002210480368_p249310371546"></a><strong id="zh-cn_topic_0000002210480368_b1449316374549"><a name="zh-cn_topic_0000002210480368_b1449316374549"></a><a name="zh-cn_topic_0000002210480368_b1449316374549"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen3493153725417"><a name="zh-cn_topic_0000002210480368_screen3493153725417"></a><a name="zh-cn_topic_0000002210480368_screen3493153725417"></a>{"ge.exec.dumpData", "tensor"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p6949125716240"><a name="zh-cn_topic_0000002210480368_p6949125716240"></a><a name="zh-cn_topic_0000002210480368_p6949125716240"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p19949205716248"><a name="zh-cn_topic_0000002210480368_p19949205716248"></a><a name="zh-cn_topic_0000002210480368_p19949205716248"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row3561164716539"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p182101148132518"><a name="zh-cn_topic_0000002210480368_p182101148132518"></a><a name="zh-cn_topic_0000002210480368_p182101148132518"></a>ge.exec.dumpLayer</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p111217554358"><a name="zh-cn_topic_0000002210480368_p111217554358"></a><a name="zh-cn_topic_0000002210480368_p111217554358"></a>指定需要dump的算子，取值为算子名，多个算子名之间使用空格分隔。</p>
<p id="zh-cn_topic_0000002210480368_p9826184919249"><a name="zh-cn_topic_0000002210480368_p9826184919249"></a><a name="zh-cn_topic_0000002210480368_p9826184919249"></a>若指定的算子其输入涉及data算子，会同时将data算子信息dump出来。</p>
<div class="p" id="zh-cn_topic_0000002210480368_p148010511249"><a name="zh-cn_topic_0000002210480368_p148010511249"></a><a name="zh-cn_topic_0000002210480368_p148010511249"></a><strong id="zh-cn_topic_0000002210480368_b164321715552"><a name="zh-cn_topic_0000002210480368_b164321715552"></a><a name="zh-cn_topic_0000002210480368_b164321715552"></a>配置示例</strong>：<pre class="screen" id="zh-cn_topic_0000002210480368_screen548075172415"><a name="zh-cn_topic_0000002210480368_screen548075172415"></a><a name="zh-cn_topic_0000002210480368_screen548075172415"></a>{"ge.exec.dumpLayer", "layer1 layer2 layer3"};</pre>
</div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p12210144872516"><a name="zh-cn_topic_0000002210480368_p12210144872516"></a><a name="zh-cn_topic_0000002210480368_p12210144872516"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p172101480252"><a name="zh-cn_topic_0000002210480368_p172101480252"></a><a name="zh-cn_topic_0000002210480368_p172101480252"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row165612047165310"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p15697652568"><a name="zh-cn_topic_0000002210480368_p15697652568"></a><a name="zh-cn_topic_0000002210480368_p15697652568"></a>ge.exec.enableDumpDebug</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p1720933413716"><a name="zh-cn_topic_0000002210480368_p1720933413716"></a><a name="zh-cn_topic_0000002210480368_p1720933413716"></a>是否开启溢出检测功能。</p>
<a name="zh-cn_topic_0000002210480368_ul1520912341771"></a><a name="zh-cn_topic_0000002210480368_ul1520912341771"></a><ul id="zh-cn_topic_0000002210480368_ul1520912341771"><li>1：开启溢出检测功能，从ge.exec.dumpPath读取Dump文件保存路径，路径配置为None时会产生异常。</li><li>0：（默认值）关闭溢出检测功能。</li></ul>
<p id="zh-cn_topic_0000002210480368_p11440191425511"><a name="zh-cn_topic_0000002210480368_p11440191425511"></a><a name="zh-cn_topic_0000002210480368_p11440191425511"></a><strong id="zh-cn_topic_0000002210480368_b154401114125511"><a name="zh-cn_topic_0000002210480368_b154401114125511"></a><a name="zh-cn_topic_0000002210480368_b154401114125511"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen644019143554"><a name="zh-cn_topic_0000002210480368_screen644019143554"></a><a name="zh-cn_topic_0000002210480368_screen644019143554"></a>{"ge.exec.enableDumpDebug", "0"};</pre>
<div class="note" id="zh-cn_topic_0000002210480368_note7881112121620"><a name="zh-cn_topic_0000002210480368_note7881112121620"></a><a name="zh-cn_topic_0000002210480368_note7881112121620"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210480368_ul9511528121613"></a><a name="zh-cn_topic_0000002210480368_ul9511528121613"></a><ul id="zh-cn_topic_0000002210480368_ul9511528121613"><li>该参数与ge.exec.enableDump参数，全局场景以及同一个Session内场景，不能同时设置。</li><li>若“ge.exec.enableDump/ge.exec.enableDumpDebug（二选一）”参数配置为“1”，同时“ge.exec.enable_exception_dump”配置为“1”（即开启普通ExceptionDump），此时：<a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000002210480368_ul18817113913915"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000002210480368_ul18817113913915"></a><ul id="zh-cn_topic_0000002210480368_zh-cn_topic_0000002210480368_ul18817113913915"><li>针对动态shape网络，仅“ge.exec.enable_exception_dump”生效。</li><li>针对静态shape网络，“ge.exec.enable_exception_dump”与“ge.exec.enableDump/ge.exec.enableDumpDebug（二选一）”都生效。</li></ul>
</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p561719181176"><a name="zh-cn_topic_0000002210480368_p561719181176"></a><a name="zh-cn_topic_0000002210480368_p561719181176"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p64741742161510"><a name="zh-cn_topic_0000002210480368_p64741742161510"></a><a name="zh-cn_topic_0000002210480368_p64741742161510"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row1550311883317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p639112594323"><a name="zh-cn_topic_0000002210480368_p639112594323"></a><a name="zh-cn_topic_0000002210480368_p639112594323"></a>ge.exec.dumpDebugMode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p3229527486"><a name="zh-cn_topic_0000002210480368_p3229527486"></a><a name="zh-cn_topic_0000002210480368_p3229527486"></a>溢出检测模式，取值如下：</p>
<a name="zh-cn_topic_0000002210480368_ul1133444410422"></a><a name="zh-cn_topic_0000002210480368_ul1133444410422"></a><ul id="zh-cn_topic_0000002210480368_ul1133444410422"><li>aicore_overflow：AI Core算子溢出检测，检测在算子输入数据正常的情况下，输出是否不正常的极大值（如float16下65500,38400,51200这些值）。一旦检测出这类问题，需要根据网络实际需求和算子逻辑来分析溢出原因并修改算子实现。</li><li>atomic_overflow：Atomic Add溢出检测，即除了AICore之外，还有其他涉及浮点计算的模块，比如SDMA，检测这些部分出现的溢出问题。</li><li>all：同时进行AI Core算子溢出检测和Atomic Add溢出检测。</li></ul>
<p id="zh-cn_topic_0000002210480368_p123471542194420"><a name="zh-cn_topic_0000002210480368_p123471542194420"></a><a name="zh-cn_topic_0000002210480368_p123471542194420"></a>针对如下<span id="zh-cn_topic_0000002210480368_ph20833205312295"><a name="zh-cn_topic_0000002210480368_ph20833205312295"></a><a name="zh-cn_topic_0000002210480368_ph20833205312295"></a>产品</span>，仅支持配置为“all”：</p>
<p id="zh-cn_topic_0000002210480368_p132832885012"><a name="zh-cn_topic_0000002210480368_p132832885012"></a><a name="zh-cn_topic_0000002210480368_p132832885012"></a><span id="zh-cn_topic_0000002210480368_ph5814950105014"><a name="zh-cn_topic_0000002210480368_ph5814950105014"></a><a name="zh-cn_topic_0000002210480368_ph5814950105014"></a><term id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210480368_p136251651135012"><a name="zh-cn_topic_0000002210480368_p136251651135012"></a><a name="zh-cn_topic_0000002210480368_p136251651135012"></a><span id="zh-cn_topic_0000002210480368_ph13754548217"><a name="zh-cn_topic_0000002210480368_ph13754548217"></a><a name="zh-cn_topic_0000002210480368_ph13754548217"></a><term id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p14617318121710"><a name="zh-cn_topic_0000002210480368_p14617318121710"></a><a name="zh-cn_topic_0000002210480368_p14617318121710"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p17482114281518"><a name="zh-cn_topic_0000002210480368_p17482114281518"></a><a name="zh-cn_topic_0000002210480368_p17482114281518"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row192920108337"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p961821419118"><a name="zh-cn_topic_0000002210480368_p961821419118"></a><a name="zh-cn_topic_0000002210480368_p961821419118"></a>ge.bufferOptimize</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_p361811411116"><a name="zh-cn_topic_0000002210480368_p361811411116"></a><a name="zh-cn_topic_0000002210480368_p361811411116"></a>数据缓存优化开关。</p>
<p id="zh-cn_topic_0000002210480368_p164307331517"><a name="zh-cn_topic_0000002210480368_p164307331517"></a><a name="zh-cn_topic_0000002210480368_p164307331517"></a><strong id="zh-cn_topic_0000002210480368_b721724318510"><a name="zh-cn_topic_0000002210480368_b721724318510"></a><a name="zh-cn_topic_0000002210480368_b721724318510"></a>参数值：</strong></p>
<a name="zh-cn_topic_0000002210480368_ul178711885913"></a><a name="zh-cn_topic_0000002210480368_ul178711885913"></a><ul id="zh-cn_topic_0000002210480368_ul178711885913"><li>l1_optimize：表示开启l1优化。当前版本该参数无效，等同于off_optimize。</li><li>l2_optimize：（默认值）表示开启l2优化。</li><li>off_optimize：表示关闭数据缓存优化。</li></ul>
<p id="zh-cn_topic_0000002210480368_p4556191812019"><a name="zh-cn_topic_0000002210480368_p4556191812019"></a><a name="zh-cn_topic_0000002210480368_p4556191812019"></a><strong id="zh-cn_topic_0000002210480368_b1980271474"><a name="zh-cn_topic_0000002210480368_b1980271474"></a><a name="zh-cn_topic_0000002210480368_b1980271474"></a>使用建议：</strong></p>
<p id="zh-cn_topic_0000002210480368_p1765011371263"><a name="zh-cn_topic_0000002210480368_p1765011371263"></a><a name="zh-cn_topic_0000002210480368_p1765011371263"></a>建议打开数据缓存优化功能：开启数据缓存优化可提高计算效率、提升性能，但由于部分算子在实现上可能存在未考虑的场景，导致影响精度，因此在出现精度问题时可以尝试关闭数据缓存优化。如果关闭数据缓存优化功能后，精度达标，则需要识别出问题算子，反馈给技术支持进一步分析、解决算子问题；解决算子问题后，建议仍旧保持开启数据缓存优化功能。</p>
<p id="zh-cn_topic_0000002210480368_p831381937"><a name="zh-cn_topic_0000002210480368_p831381937"></a><a name="zh-cn_topic_0000002210480368_p831381937"></a><strong id="zh-cn_topic_0000002210480368_b146623511613"><a name="zh-cn_topic_0000002210480368_b146623511613"></a><a name="zh-cn_topic_0000002210480368_b146623511613"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen103418301734"><a name="zh-cn_topic_0000002210480368_screen103418301734"></a><a name="zh-cn_topic_0000002210480368_screen103418301734"></a>{"ge.bufferOptimize", "l2_optimize"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p061931412111"><a name="zh-cn_topic_0000002210480368_p061931412111"></a><a name="zh-cn_topic_0000002210480368_p061931412111"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p677834918315"><a name="zh-cn_topic_0000002210480368_p677834918315"></a><a name="zh-cn_topic_0000002210480368_p677834918315"></a>session/graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480368_row736292816340"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480368_p19363172813414"><a name="zh-cn_topic_0000002210480368_p19363172813414"></a><a name="zh-cn_topic_0000002210480368_p19363172813414"></a>ge.fusionSwitchFile</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480368_zh-cn_topic_0221674006_p92931557193011"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0221674006_p92931557193011"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0221674006_p92931557193011"></a>融合规则（包括图融合和UB融合）开关配置文件路径以及文件名，路径和文件名：支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）、中文字符。</p>
<p id="zh-cn_topic_0000002210480368_p098510249587"><a name="zh-cn_topic_0000002210480368_p098510249587"></a><a name="zh-cn_topic_0000002210480368_p098510249587"></a>系统内置了一些图融合和UB融合规则，均为默认开启，可以根据需要关闭指定的融合规则，当前可以关闭的融合规则请参见<span id="zh-cn_topic_0000002210480368_ph314818225573"><a name="zh-cn_topic_0000002210480368_ph314818225573"></a><a name="zh-cn_topic_0000002210480368_ph314818225573"></a>《图融合和UB融合规则参考》</span>，但是由于系统机制，其他融合规则无法关闭。</p>
<p id="zh-cn_topic_0000002210480368_p20830639203114"><a name="zh-cn_topic_0000002210480368_p20830639203114"></a><a name="zh-cn_topic_0000002210480368_p20830639203114"></a>配置文件样例<em id="zh-cn_topic_0000002210480368_i159876254506"><a name="zh-cn_topic_0000002210480368_i159876254506"></a><a name="zh-cn_topic_0000002210480368_i159876254506"></a>fusion_switch.cfg</em>如下所示<em id="zh-cn_topic_0000002210480368_i1398762525017"><a name="zh-cn_topic_0000002210480368_i1398762525017"></a><a name="zh-cn_topic_0000002210480368_i1398762525017"></a>，</em>on表示开启，off表示关闭。</p>
<a name="zh-cn_topic_0000002210480368_ol1177718253381"></a><a name="zh-cn_topic_0000002210480368_ol1177718253381"></a><ol id="zh-cn_topic_0000002210480368_ol1177718253381"><li>非<span id="zh-cn_topic_0000002210480368_ph58025618389"><a name="zh-cn_topic_0000002210480368_ph58025618389"></a><a name="zh-cn_topic_0000002210480368_ph58025618389"></a>昇腾910_95 AI处理器</span>配置文件样例：<pre class="screen" id="zh-cn_topic_0000002210480368_screen1615193144410"><a name="zh-cn_topic_0000002210480368_screen1615193144410"></a><a name="zh-cn_topic_0000002210480368_screen1615193144410"></a>{
    "Switch":{
        "GraphFusion":{
            "RequantFusionPass":"on",
            "ConvToFullyConnectionFusionPass":"off",
            "SoftmaxFusionPass":"on",
            "NotRequantFusionPass":"on",
            "SplitConvConcatFusionPass":"on",
            "ConvConcatFusionPass":"on",
            "MatMulBiasAddFusionPass":"on",
            "PoolingFusionPass":"on",
            "ZConcatv2dFusionPass":"on",
            "ZConcatExt2FusionPass":"on",
            "TfMergeSubFusionPass":"on"
        },
        "UBFusion":{
            "TbePool2dQuantFusionPass":"on"
        }
    }
}</pre>
</li></ol>
<p id="zh-cn_topic_0000002210480368_p18482186152"><a name="zh-cn_topic_0000002210480368_p18482186152"></a><a name="zh-cn_topic_0000002210480368_p18482186152"></a>同时支持用户一键关闭融合规则：</p>
<a name="zh-cn_topic_0000002210480368_ol749210019309"></a><a name="zh-cn_topic_0000002210480368_ol749210019309"></a><ol id="zh-cn_topic_0000002210480368_ol749210019309"><li>非<span id="zh-cn_topic_0000002210480368_ph144921501300"><a name="zh-cn_topic_0000002210480368_ph144921501300"></a><a name="zh-cn_topic_0000002210480368_ph144921501300"></a>昇腾910_95 AI处理器</span>配置文件样例：<pre class="screen" id="zh-cn_topic_0000002210480368_screen26317388150"><a name="zh-cn_topic_0000002210480368_screen26317388150"></a><a name="zh-cn_topic_0000002210480368_screen26317388150"></a>{
    "Switch":{
        "GraphFusion":{
            "ALL":"off"
        },
        "UBFusion":{
            "ALL":"off"
         }
    }
}</pre>
</li></ol>
<p id="zh-cn_topic_0000002210480368_p6276611131714"><a name="zh-cn_topic_0000002210480368_p6276611131714"></a><a name="zh-cn_topic_0000002210480368_p6276611131714"></a>需要注意的是：</p>
<a name="zh-cn_topic_0000002210480368_ol197001411172"></a><a name="zh-cn_topic_0000002210480368_ol197001411172"></a><ol id="zh-cn_topic_0000002210480368_ol197001411172"><li>关闭某些融合规则可能会导致功能问题，因此此处的一键式关闭仅关闭系统部分融合规则，而不是全部融合规则。</li><li>一键式关闭融合规则时，可以同时开启部分融合规则：<a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_ol1177718253381"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_ol1177718253381"></a><ol type="a" id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_ol1177718253381"><li>非<span id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_ph58025618389"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_ph58025618389"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_ph58025618389"></a>昇腾910_95 AI处理器</span>配置文件样例：<pre class="screen" id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_screen1480185614389"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_screen1480185614389"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_screen1480185614389"></a>{
    "Switch":{
        "GraphFusion":{
            "ALL":"off",
            "<em id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_i16815220390"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_i16815220390"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_i16815220390"></a>SoftmaxFusionPass</em>":"on"
        },
        "UBFusion":{
            "ALL":"off",
            "<em id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_i5681722123911"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_i5681722123911"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_i5681722123911"></a>TbePool2dQuantFusionPass</em>":"on"
        }
    }
}</pre>
<p id="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_p180256163817"><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_p180256163817"></a><a name="zh-cn_topic_0000002210480368_zh-cn_topic_0000001265073926_p180256163817"></a></p>
</li></ol>
</li></ol>
<p id="zh-cn_topic_0000002210480368_p1155718307506"><a name="zh-cn_topic_0000002210480368_p1155718307506"></a><a name="zh-cn_topic_0000002210480368_p1155718307506"></a><strong id="zh-cn_topic_0000002210480368_b1410814367505"><a name="zh-cn_topic_0000002210480368_b1410814367505"></a><a name="zh-cn_topic_0000002210480368_b1410814367505"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480368_screen689942912339"><a name="zh-cn_topic_0000002210480368_screen689942912339"></a><a name="zh-cn_topic_0000002210480368_screen689942912339"></a>{"ge.fusionSwitchFile", "/home/test/<em id="zh-cn_topic_0000002210480368_i11213447175116"><a name="zh-cn_topic_0000002210480368_i11213447175116"></a><a name="zh-cn_topic_0000002210480368_i11213447175116"></a>fusion_switch.cfg</em>"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480368_p88444309458"><a name="zh-cn_topic_0000002210480368_p88444309458"></a><a name="zh-cn_topic_0000002210480368_p88444309458"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480368_p1536311283341"><a name="zh-cn_topic_0000002210480368_p1536311283341"></a><a name="zh-cn_topic_0000002210480368_p1536311283341"></a>all</p>
</td>
</tr>
</tbody>
</table>

## 性能调优<a name="section195781126165717"></a>

<a name="table1974119331584"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210640144_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002210640144_p3681132911170"><a name="zh-cn_topic_0000002210640144_p3681132911170"></a><a name="zh-cn_topic_0000002210640144_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002210640144_p326514861719"><a name="zh-cn_topic_0000002210640144_p326514861719"></a><a name="zh-cn_topic_0000002210640144_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002210640144_p1572818217519"><a name="zh-cn_topic_0000002210640144_p1572818217519"></a><a name="zh-cn_topic_0000002210640144_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002210640144_p197281421456"><a name="zh-cn_topic_0000002210640144_p197281421456"></a><a name="zh-cn_topic_0000002210640144_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210640144_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640144_p7167192612198"><a name="zh-cn_topic_0000002210640144_p7167192612198"></a><a name="zh-cn_topic_0000002210640144_p7167192612198"></a>ge.exec.variable_acc</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640144_p12682142931718"><a name="zh-cn_topic_0000002210640144_p12682142931718"></a><a name="zh-cn_topic_0000002210640144_p12682142931718"></a>是否开启变量格式优化。</p>
<p id="zh-cn_topic_0000002210640144_p1712410576340"><a name="zh-cn_topic_0000002210640144_p1712410576340"></a><a name="zh-cn_topic_0000002210640144_p1712410576340"></a><strong id="zh-cn_topic_0000002210640144_b731863123513"><a name="zh-cn_topic_0000002210640144_b731863123513"></a><a name="zh-cn_topic_0000002210640144_b731863123513"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210640144_ul16821729151718"></a><a name="zh-cn_topic_0000002210640144_ul16821729151718"></a><ul id="zh-cn_topic_0000002210640144_ul16821729151718"><li>True：（默认值）开启。</li><li>False：关闭。</li></ul>
<p id="zh-cn_topic_0000002210640144_p46823294179"><a name="zh-cn_topic_0000002210640144_p46823294179"></a><a name="zh-cn_topic_0000002210640144_p46823294179"></a>为了提高训练效率，在网络执行的变量初始化过程中，将变量转换成更适合在<span id="zh-cn_topic_0000002210640144_ph10891204712264"><a name="zh-cn_topic_0000002210640144_ph10891204712264"></a><a name="zh-cn_topic_0000002210640144_ph10891204712264"></a>昇腾AI处理器</span>上运行的数据格式。但在用户特殊要求场景下，可以选择关闭该功能开关。</p>
<p id="zh-cn_topic_0000002210640144_p13801123418273"><a name="zh-cn_topic_0000002210640144_p13801123418273"></a><a name="zh-cn_topic_0000002210640144_p13801123418273"></a><strong id="zh-cn_topic_0000002210640144_b7255152442810"><a name="zh-cn_topic_0000002210640144_b7255152442810"></a><a name="zh-cn_topic_0000002210640144_b7255152442810"></a>使用约束</strong>：</p>
<p id="zh-cn_topic_0000002210640144_p36577464268"><a name="zh-cn_topic_0000002210640144_p36577464268"></a><a name="zh-cn_topic_0000002210640144_p36577464268"></a>开启时，不能同时将ge.AllowMultiGraphParallelCompile配置为"1"，否则会校验报错。</p>
<p id="zh-cn_topic_0000002210640144_p538718473517"><a name="zh-cn_topic_0000002210640144_p538718473517"></a><a name="zh-cn_topic_0000002210640144_p538718473517"></a><strong id="zh-cn_topic_0000002210640144_b16705010203513"><a name="zh-cn_topic_0000002210640144_b16705010203513"></a><a name="zh-cn_topic_0000002210640144_b16705010203513"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640144_screen1397121193520"><a name="zh-cn_topic_0000002210640144_screen1397121193520"></a><a name="zh-cn_topic_0000002210640144_screen1397121193520"></a>{"ge.exec.variable_acc", "True"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640144_p163821526163210"><a name="zh-cn_topic_0000002210640144_p163821526163210"></a><a name="zh-cn_topic_0000002210640144_p163821526163210"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640144_p14131612145211"><a name="zh-cn_topic_0000002210640144_p14131612145211"></a><a name="zh-cn_topic_0000002210640144_p14131612145211"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640144_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640144_p145118585351"><a name="zh-cn_topic_0000002210640144_p145118585351"></a><a name="zh-cn_topic_0000002210640144_p145118585351"></a>ge.exec.op_precision_mode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640144_p18512585359"><a name="zh-cn_topic_0000002210640144_p18512585359"></a><a name="zh-cn_topic_0000002210640144_p18512585359"></a>设置指定算子内部处理时的精度模式，支持指定一个算子或多个算子。通过该参数传入自定义的精度模式配置文件op_precision.ini，可以为不同的算子设置不同的精度模式。</p>
<p id="zh-cn_topic_0000002210640144_p8407195641415"><a name="zh-cn_topic_0000002210640144_p8407195641415"></a><a name="zh-cn_topic_0000002210640144_p8407195641415"></a>ini文件中按照算子类型、节点名称设置精度模式，每一行设置一个算子类型或节点名称的精度模式，按节点名称设置精度模式的优先级高于按算子类型。</p>
<p id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p338552241016"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p338552241016"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p338552241016"></a>配置文件中支持设置如下精度模式：</p>
<a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ul16639842135612"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ul16639842135612"></a><ul id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ul16639842135612"><li>high_precision：表示高精度。</li><li>high_performance：表示高性能。</li><li>enable_float_32_execution：算子内部处理时使用FP32数据类型功能，该场景下FP32数据类型不会自动转换为HF32数据类型；若使用HF32计算，精度损失超过预期时，可启用该配置，指定部分算子内部计算时使用FP32，保持精度。<p id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p6661125485513"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p6661125485513"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p6661125485513"></a><strong id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b101171430566"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b101171430566"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b101171430566"></a>该选项仅支持以下<span id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph20833205312295"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph20833205312295"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph20833205312295"></a>产品</span>类型：</strong></p>
<p id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p59938817569"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p59938817569"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p59938817569"></a><span id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph7427131311565"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph7427131311565"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph7427131311565"></a><term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p4838111945615"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p4838111945615"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p4838111945615"></a><span id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph13754548217"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph13754548217"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_ph13754548217"></a><term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</li><li>enable_hi_float_32_execution：算子内部处理时使用HF32数据类型功能，使能后，FP32数据类型自动转换为HF32数据类型；该配置可以降低数据所占空间大小，实现性能提升。<strong id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b227075034919"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b227075034919"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b227075034919"></a>当前版本暂不支持。</strong></li><li>support_out_of_bound_index：表示对gather、scatter和segment类算子的indices输入进行越界校验，校验会降低算子的执行性能。</li><li>keep_fp16：算子内部处理时使用FP16数据类型功能，该场景下FP16数据类型不会自动转换为FP32数据类型；若使用FP32计算时性能不满足预期，同时精度要求不高情况下，可以选择keep_fp16模式，<strong id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b1721392915415"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b1721392915415"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_b1721392915415"></a>牺牲精度提升性能，不建议使用该低精度模式</strong>。</li><li>super_performance：表示超高性能，和高性能相比，在算法计算公式上进行了优化。</li></ul>
<p id="zh-cn_topic_0000002210640144_p4210141311493"><a name="zh-cn_topic_0000002210640144_p4210141311493"></a><a name="zh-cn_topic_0000002210640144_p4210141311493"></a>具体某个算子支持配置的精度/性能模式取值，可以通过CANN软件安装后文件存储路径的opp/built-in/op_impl/ai_core/tbe/impl_mode/all_ops_impl_mode.ini文件查看。</p>
<p id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p74141159433"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p74141159433"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_p74141159433"></a>op_precision.ini配置样例如下：</p>
<pre class="screen" id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_screen71961947803"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_screen71961947803"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_screen71961947803"></a>[ByOpType]
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i48893316212"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i48893316212"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i48893316212"></a>optype1</em>=high_precision
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i58891631220"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i58891631220"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i58891631220"></a>optype2</em>=high_performance
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i734314223467"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i734314223467"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i734314223467"></a>optype3</em>=enable_hi_float_32_execution
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i11382174217311"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i11382174217311"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i11382174217311"></a>optype4</em>=support_out_of_bound_index

[ByNodeName]
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i1241611183288"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i1241611183288"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i1241611183288"></a>nodename1</em>=high_precision
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i14485655192912"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i14485655192912"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i14485655192912"></a>nodename2</em>=high_performance
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i18104357134619"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i18104357134619"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i18104357134619"></a>nodename3</em>=enable_hi_float_32_execution
<em id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i3266115417"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i3266115417"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312392881_i3266115417"></a>nodename4</em>=support_out_of_bound_index</pre>
<p id="zh-cn_topic_0000002210640144_p18436104411388"><a name="zh-cn_topic_0000002210640144_p18436104411388"></a><a name="zh-cn_topic_0000002210640144_p18436104411388"></a><strong id="zh-cn_topic_0000002210640144_b1436194410380"><a name="zh-cn_topic_0000002210640144_b1436194410380"></a><a name="zh-cn_topic_0000002210640144_b1436194410380"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640144_screen2043674473810"><a name="zh-cn_topic_0000002210640144_screen2043674473810"></a><a name="zh-cn_topic_0000002210640144_screen2043674473810"></a>{"ge.exec.op_precision_mode", "<em id="zh-cn_topic_0000002210640144_i2467215861"><a name="zh-cn_topic_0000002210640144_i2467215861"></a><a name="zh-cn_topic_0000002210640144_i2467215861"></a>$HOME/conf/</em><em id="zh-cn_topic_0000002210640144_i1146718151614"><a name="zh-cn_topic_0000002210640144_i1146718151614"></a><a name="zh-cn_topic_0000002210640144_i1146718151614"></a>op_precision.ini</em>"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640144_p195125813351"><a name="zh-cn_topic_0000002210640144_p195125813351"></a><a name="zh-cn_topic_0000002210640144_p195125813351"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640144_p151115810352"><a name="zh-cn_topic_0000002210640144_p151115810352"></a><a name="zh-cn_topic_0000002210640144_p151115810352"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640144_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640144_p06182276183"><a name="zh-cn_topic_0000002210640144_p06182276183"></a><a name="zh-cn_topic_0000002210640144_p06182276183"></a>ge.optypelistForImplmode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640144_p6794137325"><a name="zh-cn_topic_0000002210640144_p6794137325"></a><a name="zh-cn_topic_0000002210640144_p6794137325"></a>列举算子optype的列表，该列表中的算子使用ge.opSelectImplmode参数指定的模式。</p>
<p id="zh-cn_topic_0000002210640144_p6239103018291"><a name="zh-cn_topic_0000002210640144_p6239103018291"></a><a name="zh-cn_topic_0000002210640144_p6239103018291"></a><strong id="zh-cn_topic_0000002210640144_b36373381290"><a name="zh-cn_topic_0000002210640144_b36373381290"></a><a name="zh-cn_topic_0000002210640144_b36373381290"></a>参数值约束：</strong></p>
<a name="zh-cn_topic_0000002210640144_ul124075520295"></a><a name="zh-cn_topic_0000002210640144_ul124075520295"></a><ul id="zh-cn_topic_0000002210640144_ul124075520295"><li>列表中的算子使用ge.opSelectImplmode参数指定的模式，当前仅支持指定为high_precision、high_performance两种模式，多个算子使用英文逗号进行分隔。</li><li>该参数需要与ge.opSelectImplmode参数配合使用，且仅对指定的算子生效，不指定的算子按照默认实现方式选择。例如：ge.opSelectImplmode配置为high_precision；ge.optypelistForImplmode配置为Pooling、SoftmaxV2。表示对Pooling、SoftmaxV2算子使用统一的高精度模式，未指定算子使用算子的默认实现方式。</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640144_p1759717499175"><a name="zh-cn_topic_0000002210640144_p1759717499175"></a><a name="zh-cn_topic_0000002210640144_p1759717499175"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640144_p1659784971710"><a name="zh-cn_topic_0000002210640144_p1659784971710"></a><a name="zh-cn_topic_0000002210640144_p1659784971710"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640144_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640144_p8399163684115"><a name="zh-cn_topic_0000002210640144_p8399163684115"></a><a name="zh-cn_topic_0000002210640144_p8399163684115"></a>ge.tiling_schedule_optimize</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640144_p1039973613417"><a name="zh-cn_topic_0000002210640144_p1039973613417"></a><a name="zh-cn_topic_0000002210640144_p1039973613417"></a>Tiling下沉调度优化开关。</p>
<p id="zh-cn_topic_0000002210640144_p62167612117"><a name="zh-cn_topic_0000002210640144_p62167612117"></a><a name="zh-cn_topic_0000002210640144_p62167612117"></a>由于NPU中AI Core内部存储无法完全容纳算子输入输出的所有数据，需要每次搬运一部分输入数据进行计算然后搬出，再搬运下一部分输入数据进行计算，该过程称之为Tiling；根据算子的shape等信息来确定数据切分算法相关参数（比如每次搬运的块大小，以及总共循环多少次）的计算程序，称之为Tiling实现。由于Tiling实现中完成的均为标量计算，AI Core并不擅长，故一般在Host侧CPU上执行，但是满足下述条件Tiling实现会下沉到Device侧执行：</p>
<a name="zh-cn_topic_0000002210640144_ol19579144632417"></a><a name="zh-cn_topic_0000002210640144_ol19579144632417"></a><ol id="zh-cn_topic_0000002210640144_ol19579144632417"><li>模型为静态shape。</li><li>模型中的算子支持Tiling下沉，比如FusedInferAttentionScore、IncreFlashAttention等融合算子。</li><li>支持Tiling下沉的算子值有依赖，需要满足前一个算子的值有device的执行结果；如果依赖的值是Const，则不需要下沉执行Tiling，编译时会完成Tiling。</li></ol>
<p id="zh-cn_topic_0000002210640144_p316713183319"><a name="zh-cn_topic_0000002210640144_p316713183319"></a><a name="zh-cn_topic_0000002210640144_p316713183319"></a><strong id="zh-cn_topic_0000002210640144_b7550111613348"><a name="zh-cn_topic_0000002210640144_b7550111613348"></a><a name="zh-cn_topic_0000002210640144_b7550111613348"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210640144_ul1378311218340"></a><a name="zh-cn_topic_0000002210640144_ul1378311218340"></a><ul id="zh-cn_topic_0000002210640144_ul1378311218340"><li>0：（默认值）关闭Tiling下沉。</li><li>1：使能Tiling下沉。</li></ul>
<p id="zh-cn_topic_0000002210640144_p697125813351"><a name="zh-cn_topic_0000002210640144_p697125813351"></a><a name="zh-cn_topic_0000002210640144_p697125813351"></a><strong id="zh-cn_topic_0000002210640144_b1497145843516"><a name="zh-cn_topic_0000002210640144_b1497145843516"></a><a name="zh-cn_topic_0000002210640144_b1497145843516"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640144_screen8981633914"><a name="zh-cn_topic_0000002210640144_screen8981633914"></a><a name="zh-cn_topic_0000002210640144_screen8981633914"></a>{"ge.tiling_schedule_optimize", "0"};</pre>
<p id="zh-cn_topic_0000002210640144_p138131916013"><a name="zh-cn_topic_0000002210640144_p138131916013"></a><a name="zh-cn_topic_0000002210640144_p138131916013"></a>该参数仅支持以下<span id="zh-cn_topic_0000002210640144_ph20833205312295"><a name="zh-cn_topic_0000002210640144_ph20833205312295"></a><a name="zh-cn_topic_0000002210640144_ph20833205312295"></a>产品</span>：</p>
<p id="zh-cn_topic_0000002210640144_p18120191704"><a name="zh-cn_topic_0000002210640144_p18120191704"></a><a name="zh-cn_topic_0000002210640144_p18120191704"></a><span id="zh-cn_topic_0000002210640144_ph1281101916019"><a name="zh-cn_topic_0000002210640144_ph1281101916019"></a><a name="zh-cn_topic_0000002210640144_ph1281101916019"></a><term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002210640144_p5811719900"><a name="zh-cn_topic_0000002210640144_p5811719900"></a><a name="zh-cn_topic_0000002210640144_p5811719900"></a><span id="zh-cn_topic_0000002210640144_ph18811619601"><a name="zh-cn_topic_0000002210640144_ph18811619601"></a><a name="zh-cn_topic_0000002210640144_ph18811619601"></a><term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002210640144_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640144_p19400103611415"><a name="zh-cn_topic_0000002210640144_p19400103611415"></a><a name="zh-cn_topic_0000002210640144_p19400103611415"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640144_p10400163616413"><a name="zh-cn_topic_0000002210640144_p10400163616413"></a><a name="zh-cn_topic_0000002210640144_p10400163616413"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640144_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640144_p997212364533"><a name="zh-cn_topic_0000002210640144_p997212364533"></a><a name="zh-cn_topic_0000002210640144_p997212364533"></a>ge.graphMaxParallelModelNum</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640144_p497343615312"><a name="zh-cn_topic_0000002210640144_p497343615312"></a><a name="zh-cn_topic_0000002210640144_p497343615312"></a>图执行模式下，同一个图可以在同一个device上被多个模型并行加载执行；该参数用于控制允许并行加载的最大模型数目。</p>
<p id="zh-cn_topic_0000002210640144_p19506111121111"><a name="zh-cn_topic_0000002210640144_p19506111121111"></a><a name="zh-cn_topic_0000002210640144_p19506111121111"></a><strong id="zh-cn_topic_0000002210640144_b85071716114"><a name="zh-cn_topic_0000002210640144_b85071716114"></a><a name="zh-cn_topic_0000002210640144_b85071716114"></a>参数取值：</strong></p>
<p id="zh-cn_topic_0000002210640144_p450623111215"><a name="zh-cn_topic_0000002210640144_p450623111215"></a><a name="zh-cn_topic_0000002210640144_p450623111215"></a>1~INT32_MAX，默认为8。</p>
<p id="zh-cn_topic_0000002210640144_p175072119113"><a name="zh-cn_topic_0000002210640144_p175072119113"></a><a name="zh-cn_topic_0000002210640144_p175072119113"></a><strong id="zh-cn_topic_0000002210640144_b13507121141120"><a name="zh-cn_topic_0000002210640144_b13507121141120"></a><a name="zh-cn_topic_0000002210640144_b13507121141120"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640144_screen11507171191115"><a name="zh-cn_topic_0000002210640144_screen11507171191115"></a><a name="zh-cn_topic_0000002210640144_screen11507171191115"></a>{"ge.graphMaxParallelModelNum", "8"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640144_p139731036165317"><a name="zh-cn_topic_0000002210640144_p139731036165317"></a><a name="zh-cn_topic_0000002210640144_p139731036165317"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640144_p139731836125310"><a name="zh-cn_topic_0000002210640144_p139731836125310"></a><a name="zh-cn_topic_0000002210640144_p139731836125310"></a>all</p>
</td>
</tr>
</tbody>
</table>

## Profiling<a name="section1245043112570"></a>

<a name="table14658334185811"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245600333_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002245600333_p3681132911170"><a name="zh-cn_topic_0000002245600333_p3681132911170"></a><a name="zh-cn_topic_0000002245600333_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002245600333_p326514861719"><a name="zh-cn_topic_0000002245600333_p326514861719"></a><a name="zh-cn_topic_0000002245600333_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002245600333_p1572818217519"><a name="zh-cn_topic_0000002245600333_p1572818217519"></a><a name="zh-cn_topic_0000002245600333_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002245600333_p197281421456"><a name="zh-cn_topic_0000002245600333_p197281421456"></a><a name="zh-cn_topic_0000002245600333_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245600333_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600333_p1682112931719"><a name="zh-cn_topic_0000002245600333_p1682112931719"></a><a name="zh-cn_topic_0000002245600333_p1682112931719"></a>ge.exec.profilingMode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600333_p986333917155"><a name="zh-cn_topic_0000002245600333_p986333917155"></a><a name="zh-cn_topic_0000002245600333_p986333917155"></a>是否开启Profiling功能。</p>
<a name="zh-cn_topic_0000002245600333_ul950515461604"></a><a name="zh-cn_topic_0000002245600333_ul950515461604"></a><ul id="zh-cn_topic_0000002245600333_ul950515461604"><li>1：开启Profiling功能，从ge.exec.profilingOptions读取Profiling的采集选项。</li><li>0：（默认值）关闭Profiling功能。</li></ul>
<p id="zh-cn_topic_0000002245600333_p244454619524"><a name="zh-cn_topic_0000002245600333_p244454619524"></a><a name="zh-cn_topic_0000002245600333_p244454619524"></a><strong id="zh-cn_topic_0000002245600333_b19444184613528"><a name="zh-cn_topic_0000002245600333_b19444184613528"></a><a name="zh-cn_topic_0000002245600333_b19444184613528"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245600333_screen94441746145215"><a name="zh-cn_topic_0000002245600333_screen94441746145215"></a><a name="zh-cn_topic_0000002245600333_screen94441746145215"></a>{"ge.exec.profilingMode", "0"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600333_p15359182618327"><a name="zh-cn_topic_0000002245600333_p15359182618327"></a><a name="zh-cn_topic_0000002245600333_p15359182618327"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600333_p1775324012118"><a name="zh-cn_topic_0000002245600333_p1775324012118"></a><a name="zh-cn_topic_0000002245600333_p1775324012118"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600333_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600333_p1868214296175"><a name="zh-cn_topic_0000002245600333_p1868214296175"></a><a name="zh-cn_topic_0000002245600333_p1868214296175"></a>ge.exec.profilingOptions</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600333_p4919198174919"><a name="zh-cn_topic_0000002245600333_p4919198174919"></a><a name="zh-cn_topic_0000002245600333_p4919198174919"></a>Profiling配置选项。</p>
<a name="zh-cn_topic_0000002245600333_ul45531956133618"></a><a name="zh-cn_topic_0000002245600333_ul45531956133618"></a><ul id="zh-cn_topic_0000002245600333_ul45531956133618"><li>output：Profiling采集结果文件保存路径。支持配置绝对路径或相对路径（相对执行命令行时的当前路径）。路径中不能包含特殊字符："\n"、"\f"、"\r"、"\b"、"\t"、"\v"、"\u007F"。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul11442134515161"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul11442134515161"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul11442134515161"><li>绝对路径配置以“/”开头，例如：/home/output。</li><li>相对路径配置直接以目录名开始，例如：output。</li><li>该参数优先级高于ASCEND_WORK_PATH。</li><li>该路径无需用户提前创建，采集过程中会自动创建。</li></ul>
</li><li>storage_limit：指定落盘目录允许存放的最大文件容量。当Profiling数据文件在磁盘中即将占满本参数设置的最大存储空间或剩余磁盘总空间即将被占满时（总空间剩余&lt;=20MB），则将磁盘内最早的文件进行老化删除处理。<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3376141114548"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3376141114548"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3376141114548"></a>范围[200, 4294967295]，单位为MB，设置该参数时必须带单位，例如200MB。</p>
<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3929518255"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3929518255"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3929518255"></a>未配置本参数时，默认取值为Profiling数据文件存放目录所在磁盘可用空间的90%。</p>
</li><li>training_trace：采集迭代轨迹数据开关，即训练任务及AI软件栈的软件信息，实现对训练任务的性能分析，重点关注前后向计算和梯度聚合更新等相关数据。当采集正向和反向算子数据时该参数必须配置为on。</li><li>task_trace、task_time：控制采集算子下发耗时和算子执行耗时的开关。涉及在task_time、op_summary、op_statistic等文件中输出相关耗时数据。配置值：<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1585373811014"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1585373811014"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1585373811014"><li>on：开启，默认值，和配置为l1的效果一样。</li><li>off：关闭。</li><li>l0：采集算子下发耗时、算子执行耗时数据。与l1相比，由于不采集算子基本信息数据，采集时性能开销较小，可更精准统计相关耗时数据。</li><li>l1：采集算子下发耗时、算子执行耗时数据以及算子基本信息数据，提供更全面的性能分析数据。</li></ul>
<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3651845151013"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3651845151013"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3651845151013"></a>当训练profiling mode开启即采集训练Profiling数据时，配置task_trace为on的同时training_trace也必须配置为on。</p>
</li><li>ge_api：采集动态shape算子在Host调度阶段的耗时数据。取值：<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul111980111"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul111980111"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul111980111"><li>off：关闭，默认为off。</li><li>l0：采集动态shape算子在Host调度主要阶段的耗时数据，可更精准统计相关耗时数据。</li><li>l1：采集动态shape算子在Host调度阶段更细粒度的耗时数据，提供更全面的性能分析数据。</li></ul>
</li><li>hccl：控制通信数据采集开关，可选on或off，默认为off。<div class="note" id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note0646102355816"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note0646102355816"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note0646102355816"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3646112315811"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3646112315811"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p3646112315811"></a>此开关后续版本会废弃，请使用task_time开关控制相关数据采集。</p>
</div></div>
</li><li>aicpu：采集AICPU算子的详细信息，如：算子执行时间、数据拷贝时间等。取值on/off，默认为off。</li><li>fp_point：指定训练网络迭代轨迹正向算子的开始位置，用于记录前向计算开始时间戳。配置值为指定的正向第一个算子名字。用户可以在训练脚本中，通过tf.io.write_graph将graph保存成.pbtxt文件，并获取文件中的name名称填入；也可直接配置为空，由系统自动识别正向算子的开始位置，例如"fp_point":""。</li><li>bp_point：指定训练网络迭代轨迹反向算子的结束位置，记录后向计算结束时间戳，bp_point和fp_point可以计算出正反向时间。配置值为指定的反向最后一个算子名字。用户可以在训练脚本中，通过tf.io.write_graph将graph保存成.pbtxt文件，并获取文件中的name名称填入；也可直接配置为空，由系统自动识别反向算子的结束位置，例如"bp_point":""。</li><li>aic_metrics：AI Core性能指标采集项，取值如下：<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul131435326233"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul131435326233"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul131435326233"><li>ArithmeticUtilization：各种计算类指标占比统计。</li><li>PipeUtilization：计算单元和搬运单元耗时占比，该项为默认值。</li><li>Memory：外部内存读写类指令占比。</li><li>MemoryL0：内部L0内存读写类指令占比。</li><li>MemoryUB：内部UB内存读写类指令占比。</li><li>ResourceConflictRatio：流水线队列类指令占比。</li><li>L2Cache：读写L2 Cache命中次数和缺失后重新分配次数。</li><li>MemoryAccess：算子在核上访存的带宽数据量。</li></ul>
<div class="note" id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note45191258143218"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note45191258143218"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note45191258143218"></a><span class="notetitle"> 说明： </span><div class="notebody"><div class="p" id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p95182058163218"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p95182058163218"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p95182058163218"></a>支持自定义需要采集的寄存器，例如："aic_metrics":"<strong id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_b77667292558"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_b77667292558"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_b77667292558"></a>Custom:</strong><em id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_i1219719373558"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_i1219719373558"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_i1219719373558"></a>0x49,0x8,0x15,0x1b,0x64,0x10</em>"。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul4137115203610"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul4137115203610"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul4137115203610"><li>Custom字段表示自定义类型，配置为具体的寄存器值，范围[0x1, 0x6E]。</li><li>配置的寄存器数最多不能超过8个，寄存器通过“,”区分开。</li><li>寄存器的值支持十六进制或十进制。</li></ul>
</div>
</div></div>
</li><li>l2：控制L2 Cache和TLB页表缓存命中率的开关，可选on或off，默认为off。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1667311178306"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1667311178306"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1667311178306"><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph1697274414508"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph1697274414508"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph1697274414508"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span>：支持采集L2 Cache和TLB页表缓存的命中率；分析AI Core命中L2次数推荐使用aic-metrics=L2Cache。</li><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph162341061416"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph162341061416"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph162341061416"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span>：支持采集L2 Cache和TLB页表缓存的命中率；分析AI Core命中L2次数推荐使用aic-metrics=L2Cache。</li></ul>
</li><li>msproftx：控制msproftx用户和上层框架程序输出性能数据的开关，可选on或off，默认值为off。<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p162946516318"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p162946516318"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p162946516318"></a>需要先在应用程序脚本中添加如下mstx API或msproftx API，推荐使用mstx API。</p>
</li><li>runtime_api：控制runtime API性能数据采集开关，可选on或off，默认为off。可采集runtime API性能数据，包括Host与Device之间、Device间的同步异步内存复制时延等。</li><li>sys_hardware_mem_freq：片上内存、QoS传输带宽、LLC三级缓存带宽、加速器带宽、SoC传输带宽、组件内存占用等的采集开关。不同产品的采集内容略有差异，请以实际结果为准。范围[1,100]，单位Hz。<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p139924018411"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p139924018411"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p139924018411"></a>已知在安装有glibc&lt;2.34的环境上采集memory数据，可能触发glibc的一个已知<a href="https://sourceware.org/bugzilla/show_bug.cgi?id=19329" target="_blank" rel="noopener noreferrer">Bug 19329</a>，通过升级环境的glibc版本可解决此问题。</p>
<div class="note" id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note3716182418422"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note3716182418422"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_note3716182418422"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p15913134474213"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p15913134474213"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p15913134474213"></a>对于以下型号，采集任务结束后，不建议用户增大采集频率，否则可能导致SoC传输带宽数据丢失。</p>
<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p6913204153019"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p6913204153019"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p6913204153019"></a><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_ph189131493020"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_ph189131493020"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_ph189131493020"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p6913844307"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p6913844307"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_p6913844307"></a><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_ph39132413306"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_ph39132413306"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_ph39132413306"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312388789_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
</div></div>
</li><li>llc_profiling：LLC Profiling采集事件，可以设置为：<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1430772902810"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1430772902810"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul1430772902810"><li>read：读事件，三级缓存读速率，默认为read。</li><li>write：写事件，三级缓存写速率。</li></ul>
</li><li>sys_io_sampling_freq：NIC、ROCE数据采集频率。范围[1,100]，单位Hz。<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p1133632210"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p1133632210"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p1133632210"></a><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph18311529172811"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph18311529172811"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph18311529172811"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_1"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_1"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_1"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_1"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_1"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_1"></a>Atlas A2 推理系列产品</term></span>：支持采集NIC、ROCE</p>
<p id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p19331731125"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p19331731125"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_p19331731125"></a><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph43307202186"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph43307202186"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph43307202186"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_1"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_1"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_1"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_1"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_1"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_1"></a>Atlas A3 推理系列产品</term></span>：支持采集NIC、ROCE</p>
</li><li>sys_interconnection_freq：集合通信带宽数据（HCCS）、<span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph664581518"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph664581518"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph664581518"></a>SIO数据、</span>PCIe数据采集频率以及片间传输带宽信息采集频率。范围[1,50]，单位Hz。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul86052919575"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul86052919575"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul86052919575"><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph69692033162810"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph69692033162810"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph69692033162810"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_2"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_2"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_2"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_2"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_2"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_2"></a>Atlas A2 推理系列产品</term></span>：支持采集HCCS、PCIe数据、片间传输带宽信息。</li><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph204417711495"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph204417711495"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph204417711495"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_2"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_2"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_2"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_2"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_2"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_2"></a>Atlas A3 推理系列产品</term></span>：支持采集HCCS、PCIe数据、片间传输带宽信息、SIO数据。</li></ul>
</li><li>dvpp_freq：DVPP采集频率。范围[1,100]，单位Hz。</li><li>instr_profiling：AI Core和AI Vector的带宽和延时采集开关。取值on/off，默认为off。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul14371185814818"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul14371185814818"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul14371185814818"><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph5441901025"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph5441901025"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph5441901025"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_3"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_3"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_3"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_3"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_3"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_3"></a>Atlas A2 推理系列产品</term></span>：不支持该开关，通过instr_profiling_freq控制该功能。</li><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph164843494919"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph164843494919"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph164843494919"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_3"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_3"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_3"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_3"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_3"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_3"></a>Atlas A3 推理系列产品</term></span>：不支持该开关，通过instr_profiling_freq控制该功能。</li></ul>
</li><li>instr_profiling_freq：AI Core和AI Vector的带宽和延时采集开关，配置了采集频率即开启相关采集能力。范围[300,30000]，单位Hz。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul8511440173111"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul8511440173111"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul8511440173111"><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph93581341723"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph93581341723"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph93581341723"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_4"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_4"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term11962195213215_4"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_4"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_4"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term184716139811_4"></a>Atlas A2 推理系列产品</term></span>：支持，但instr_profiling_freq与training_trace、task_trace、hccl、aicpu、fp_point、bp_point、aic_metrics、l2、task_time、runtime_api互斥，无法同时执行。</li><li><span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph597924293110"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph597924293110"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph597924293110"></a><term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_4"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_4"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term1253731311225_4"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_4"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_4"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_zh-cn_topic_0000001312391781_term131434243115_4"></a>Atlas A3 推理系列产品</term></span>：支持，但instr_profiling_freq与training_trace、task_trace、hccl、aicpu、fp_point、bp_point、aic_metrics、l2、task_time、runtime_api互斥，无法同时执行。</li></ul>
</li><li>host_sys：<span id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph11758754164613"><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph11758754164613"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ph11758754164613"></a>Host</span>侧性能数据采集开关。取值如下，可选其中的一项或多项，选多项时用英文逗号隔开，例如"host_sys": "cpu,mem"。<a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul19641126204014"></a><a name="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul19641126204014"></a><ul id="zh-cn_topic_0000002245600333_zh-cn_topic_0000001599556914_ul19641126204014"><li>cpu：进程级别的CPU利用率。</li><li>mem：进程级别的内存利用率。</li></ul>
</li><li>host_sys_usage：采集Host侧系统及所有进程的CPU和内存数据。取值包括cpu和mem，可选其中的一项或多项，选多项时用英文逗号隔开。</li><li>host_sys_usage_freq：配置Host侧系统和所有进程CPU、内存数据的采集频率。范围[1,50]，默认值50，单位Hz。</li></ul>
<p id="zh-cn_topic_0000002245600333_p1277601015353"><a name="zh-cn_topic_0000002245600333_p1277601015353"></a><a name="zh-cn_topic_0000002245600333_p1277601015353"></a>配置示例：</p>
<pre class="screen" id="zh-cn_topic_0000002245600333_screen5212423718"><a name="zh-cn_topic_0000002245600333_screen5212423718"></a><a name="zh-cn_topic_0000002245600333_screen5212423718"></a>std::map&lt;ge::AscendString, ge::AscendString&gt; ge_options = {{"ge.exec.deviceId", "0"},
                                  {"ge.graphRunMode", "1"},
                                  {"ge.exec.profilingMode", "1"},
                                  {"ge.exec.profilingOptions", R"({"output":"/tmp/profiling","training_trace":"on","fp_point":"resnet_model/conv2d/Conv2Dresnet_model/batch_normalization/FusedBatchNormV3_Reduce","bp_point":"gradients/AddN_70"})"}};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600333_p2361122613216"><a name="zh-cn_topic_0000002245600333_p2361122613216"></a><a name="zh-cn_topic_0000002245600333_p2361122613216"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600333_p1613213493210"><a name="zh-cn_topic_0000002245600333_p1613213493210"></a><a name="zh-cn_topic_0000002245600333_p1613213493210"></a>全局</p>
</td>
</tr>
</tbody>
</table>

## AOE<a name="section771243645713"></a>

<a name="table0870635165816"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245600325_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002245600325_p3681132911170"><a name="zh-cn_topic_0000002245600325_p3681132911170"></a><a name="zh-cn_topic_0000002245600325_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002245600325_p326514861719"><a name="zh-cn_topic_0000002245600325_p326514861719"></a><a name="zh-cn_topic_0000002245600325_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002245600325_p1572818217519"><a name="zh-cn_topic_0000002245600325_p1572818217519"></a><a name="zh-cn_topic_0000002245600325_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002245600325_p197281421456"><a name="zh-cn_topic_0000002245600325_p197281421456"></a><a name="zh-cn_topic_0000002245600325_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245600325_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600325_p7590143713142"><a name="zh-cn_topic_0000002245600325_p7590143713142"></a><a name="zh-cn_topic_0000002245600325_p7590143713142"></a>ge.mdl_bank_path</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600325_p54229445514"><a name="zh-cn_topic_0000002245600325_p54229445514"></a><a name="zh-cn_topic_0000002245600325_p54229445514"></a>加载子图调优后自定义知识库的路径。</p>
<p id="zh-cn_topic_0000002245600325_p337983854816"><a name="zh-cn_topic_0000002245600325_p337983854816"></a><a name="zh-cn_topic_0000002245600325_p337983854816"></a>该参数需要与ge.bufferOptimize参数配合使用，仅在数据缓存优化开关打开的情况下生效，通过利用高速缓存暂存数据的方式，达到提升性能的目的。</p>
<p id="zh-cn_topic_0000002245600325_p682562711473"><a name="zh-cn_topic_0000002245600325_p682562711473"></a><a name="zh-cn_topic_0000002245600325_p682562711473"></a><strong id="zh-cn_topic_0000002245600325_b164102619501"><a name="zh-cn_topic_0000002245600325_b164102619501"></a><a name="zh-cn_topic_0000002245600325_b164102619501"></a>参数值：</strong>模型调优后自定义知识库路径。</p>
<p id="zh-cn_topic_0000002245600325_p5300341154717"><a name="zh-cn_topic_0000002245600325_p5300341154717"></a><a name="zh-cn_topic_0000002245600325_p5300341154717"></a><strong id="zh-cn_topic_0000002245600325_b16747142714506"><a name="zh-cn_topic_0000002245600325_b16747142714506"></a><a name="zh-cn_topic_0000002245600325_b16747142714506"></a>参数值格式：</strong>支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）。</p>
<p id="zh-cn_topic_0000002245600325_p1018625119540"><a name="zh-cn_topic_0000002245600325_p1018625119540"></a><a name="zh-cn_topic_0000002245600325_p1018625119540"></a><strong id="zh-cn_topic_0000002245600325_b198513458371"><a name="zh-cn_topic_0000002245600325_b198513458371"></a><a name="zh-cn_topic_0000002245600325_b198513458371"></a>参数默认值：</strong>$HOME/Ascend/latest/data/aoe/custom/graph/<span id="zh-cn_topic_0000002245600325_ph3725518171818"><a name="zh-cn_topic_0000002245600325_ph3725518171818"></a><a name="zh-cn_topic_0000002245600325_ph3725518171818"></a><em id="zh-cn_topic_0000002245600325_zh-cn_topic_0000001312483385_i79331727136"><a name="zh-cn_topic_0000002245600325_zh-cn_topic_0000001312483385_i79331727136"></a><a name="zh-cn_topic_0000002245600325_zh-cn_topic_0000001312483385_i79331727136"></a>&lt;soc_version&gt;</em></span></p>
<p id="zh-cn_topic_0000002245600325_p487732932316"><a name="zh-cn_topic_0000002245600325_p487732932316"></a><a name="zh-cn_topic_0000002245600325_p487732932316"></a><strong id="zh-cn_topic_0000002245600325_b46204368230"><a name="zh-cn_topic_0000002245600325_b46204368230"></a><a name="zh-cn_topic_0000002245600325_b46204368230"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245600325_p11473123933220"><a name="zh-cn_topic_0000002245600325_p11473123933220"></a><a name="zh-cn_topic_0000002245600325_p11473123933220"></a>加载子图调优后自定义知识库路径优先级：ge.mdl_bank_path参数加载路径&gt;<strong id="zh-cn_topic_0000002245600325_b16540165613113"><a name="zh-cn_topic_0000002245600325_b16540165613113"></a><a name="zh-cn_topic_0000002245600325_b16540165613113"></a>TUNE_BANK_PATH</strong>环境变量设置路径&gt;默认子图调优后自定义知识库路径。</p>
<a name="zh-cn_topic_0000002245600325_ol1672437144820"></a><a name="zh-cn_topic_0000002245600325_ol1672437144820"></a><ol id="zh-cn_topic_0000002245600325_ol1672437144820"><li>如果模型编译前，通过<strong id="zh-cn_topic_0000002245600325_b1935210484289"><a name="zh-cn_topic_0000002245600325_b1935210484289"></a><a name="zh-cn_topic_0000002245600325_b1935210484289"></a>TUNE_BANK_PATH</strong>环境变量指定了子图调优自定义知识库路径，模型编译时又通过ge.mdl_bank_path参数加载了自定义知识库路径，该场景下以ge.mdl_bank_path参数加载的路径为准，<strong id="zh-cn_topic_0000002245600325_b108411046173416"><a name="zh-cn_topic_0000002245600325_b108411046173416"></a><a name="zh-cn_topic_0000002245600325_b108411046173416"></a>TUNE_BANK_PATH</strong>环境变量设置的路径不生效。</li><li>ge.mdl_bank_path参数和环境变量指定路径都不生效或无可用自定义知识库，则使用默认自定义知识库路径。</li><li>如果上述路径下都无可用的自定义知识库，则会查找子图调优内置知识库，该路径为：<span id="zh-cn_topic_0000002245600325_ph167891612151312"><a name="zh-cn_topic_0000002245600325_ph167891612151312"></a><a name="zh-cn_topic_0000002245600325_ph167891612151312"></a>${INSTALL_DIR}</span>/<em id="zh-cn_topic_0000002245600325_i10491153719215"><a name="zh-cn_topic_0000002245600325_i10491153719215"></a><a name="zh-cn_topic_0000002245600325_i10491153719215"></a>&lt;arch&gt;</em>-linux/data/fusion_strategy/built-in，<em id="zh-cn_topic_0000002245600325_i1982015202311"><a name="zh-cn_topic_0000002245600325_i1982015202311"></a><a name="zh-cn_topic_0000002245600325_i1982015202311"></a>&lt;arch&gt;</em>请替换为具体操作系统架构。</li></ol>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600325_p141549422233"><a name="zh-cn_topic_0000002245600325_p141549422233"></a><a name="zh-cn_topic_0000002245600325_p141549422233"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600325_p1969435915511"><a name="zh-cn_topic_0000002245600325_p1969435915511"></a><a name="zh-cn_topic_0000002245600325_p1969435915511"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245600325_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245600325_p1924154716142"><a name="zh-cn_topic_0000002245600325_p1924154716142"></a><a name="zh-cn_topic_0000002245600325_p1924154716142"></a>ge.op_bank_path</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245600325_p224144718147"><a name="zh-cn_topic_0000002245600325_p224144718147"></a><a name="zh-cn_topic_0000002245600325_p224144718147"></a>算子调优后自定义知识库路径。</p>
<p id="zh-cn_topic_0000002245600325_p12261182733210"><a name="zh-cn_topic_0000002245600325_p12261182733210"></a><a name="zh-cn_topic_0000002245600325_p12261182733210"></a><strong id="zh-cn_topic_0000002245600325_b2443339103212"><a name="zh-cn_topic_0000002245600325_b2443339103212"></a><a name="zh-cn_topic_0000002245600325_b2443339103212"></a>参数值格式：</strong>支持大小写字母（a-z，A-Z）、数字（0-9）、下划线（_）、中划线（-）、句点（.）。</p>
<p id="zh-cn_topic_0000002245600325_p99216541200"><a name="zh-cn_topic_0000002245600325_p99216541200"></a><a name="zh-cn_topic_0000002245600325_p99216541200"></a><strong id="zh-cn_topic_0000002245600325_b148144823217"><a name="zh-cn_topic_0000002245600325_b148144823217"></a><a name="zh-cn_topic_0000002245600325_b148144823217"></a>参数默认值：</strong>${HOME}/Ascend/latest/data/aoe/custom/op</p>
<p id="zh-cn_topic_0000002245600325_p184261414143217"><a name="zh-cn_topic_0000002245600325_p184261414143217"></a><a name="zh-cn_topic_0000002245600325_p184261414143217"></a><strong id="zh-cn_topic_0000002245600325_b16959125493219"><a name="zh-cn_topic_0000002245600325_b16959125493219"></a><a name="zh-cn_topic_0000002245600325_b16959125493219"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245600325_p113916614338"><a name="zh-cn_topic_0000002245600325_p113916614338"></a><a name="zh-cn_topic_0000002245600325_p113916614338"></a>加载算子调优后自定义知识库路径优先级：<strong id="zh-cn_topic_0000002245600325_b1313912673314"><a name="zh-cn_topic_0000002245600325_b1313912673314"></a><a name="zh-cn_topic_0000002245600325_b1313912673314"></a>TUNE_BANK_PATH</strong>环境变量设置路径&gt;ge.op_bank_path参数加载路径&gt;默认算子调优后自定义知识库路径。</p>
<a name="zh-cn_topic_0000002245600325_ol019764317331"></a><a name="zh-cn_topic_0000002245600325_ol019764317331"></a><ol id="zh-cn_topic_0000002245600325_ol019764317331"><li>如果模型转换前，通过<strong id="zh-cn_topic_0000002245600325_b71391663338"><a name="zh-cn_topic_0000002245600325_b71391663338"></a><a name="zh-cn_topic_0000002245600325_b71391663338"></a>TUNE_BANK_PATH</strong>环境变量指定了算子调优自定义知识库路径，模型编译时又通过ge.op_bank_path参数加载了自定义知识库路径，该场景下以<strong id="zh-cn_topic_0000002245600325_b91397683312"><a name="zh-cn_topic_0000002245600325_b91397683312"></a><a name="zh-cn_topic_0000002245600325_b91397683312"></a>TUNE_BANK_PATH</strong>环境变量设置的路径为准，ge.op_bank_path参数加载的路径不生效。</li><li>ge.op_bank_path参数和环境变量指定路径都不生效前提下，使用默认自定义知识库路径。</li><li>如果上述路径下都无可用的自定义知识库，则会查找算子调优内置知识库。</li></ol>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245600325_p9154184212315"><a name="zh-cn_topic_0000002245600325_p9154184212315"></a><a name="zh-cn_topic_0000002245600325_p9154184212315"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245600325_p162980118505"><a name="zh-cn_topic_0000002245600325_p162980118505"></a><a name="zh-cn_topic_0000002245600325_p162980118505"></a>all</p>
</td>
</tr>
</tbody>
</table>

## 异常补救<a name="section169115414574"></a>

<a name="table849011374583"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210640152_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002210640152_p3681132911170"><a name="zh-cn_topic_0000002210640152_p3681132911170"></a><a name="zh-cn_topic_0000002210640152_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002210640152_p326514861719"><a name="zh-cn_topic_0000002210640152_p326514861719"></a><a name="zh-cn_topic_0000002210640152_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002210640152_p1572818217519"><a name="zh-cn_topic_0000002210640152_p1572818217519"></a><a name="zh-cn_topic_0000002210640152_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002210640152_p197281421456"><a name="zh-cn_topic_0000002210640152_p197281421456"></a><a name="zh-cn_topic_0000002210640152_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210640152_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640152_p16834344413"><a name="zh-cn_topic_0000002210640152_p16834344413"></a><a name="zh-cn_topic_0000002210640152_p16834344413"></a>stream_sync_timeout</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640152_p884515559472"><a name="zh-cn_topic_0000002210640152_p884515559472"></a><a name="zh-cn_topic_0000002210640152_p884515559472"></a>图执行时，Stream同步等待超时时间，超过配置时间时报同步失败。单位：ms</p>
<p id="zh-cn_topic_0000002210640152_p18683113184414"><a name="zh-cn_topic_0000002210640152_p18683113184414"></a><a name="zh-cn_topic_0000002210640152_p18683113184414"></a>默认值-1，表示无等待时间，出现同步失败不报错。</p>
<p id="zh-cn_topic_0000002210640152_p44471713134412"><a name="zh-cn_topic_0000002210640152_p44471713134412"></a><a name="zh-cn_topic_0000002210640152_p44471713134412"></a><strong id="zh-cn_topic_0000002210640152_b144471813144413"><a name="zh-cn_topic_0000002210640152_b144471813144413"></a><a name="zh-cn_topic_0000002210640152_b144471813144413"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640152_screen1244761324410"><a name="zh-cn_topic_0000002210640152_screen1244761324410"></a><a name="zh-cn_topic_0000002210640152_screen1244761324410"></a>{"stream_sync_timeout", "-1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640152_p1868313344410"><a name="zh-cn_topic_0000002210640152_p1868313344410"></a><a name="zh-cn_topic_0000002210640152_p1868313344410"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640152_p6683193184410"><a name="zh-cn_topic_0000002210640152_p6683193184410"></a><a name="zh-cn_topic_0000002210640152_p6683193184410"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210640152_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210640152_p184101291444"><a name="zh-cn_topic_0000002210640152_p184101291444"></a><a name="zh-cn_topic_0000002210640152_p184101291444"></a>event_sync_timeout</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210640152_p1453912359503"><a name="zh-cn_topic_0000002210640152_p1453912359503"></a><a name="zh-cn_topic_0000002210640152_p1453912359503"></a>图执行时，event同步等待超时时间，超过配置时间时报同步失败。单位：ms</p>
<p id="zh-cn_topic_0000002210640152_p7539435175012"><a name="zh-cn_topic_0000002210640152_p7539435175012"></a><a name="zh-cn_topic_0000002210640152_p7539435175012"></a>默认值-1，表示无等待时间，出现同步失败不报错。</p>
<p id="zh-cn_topic_0000002210640152_p4994329134420"><a name="zh-cn_topic_0000002210640152_p4994329134420"></a><a name="zh-cn_topic_0000002210640152_p4994329134420"></a><strong id="zh-cn_topic_0000002210640152_b109942299441"><a name="zh-cn_topic_0000002210640152_b109942299441"></a><a name="zh-cn_topic_0000002210640152_b109942299441"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210640152_screen1599419296446"><a name="zh-cn_topic_0000002210640152_screen1599419296446"></a><a name="zh-cn_topic_0000002210640152_screen1599419296446"></a>{"event_sync_timeout", "-1"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210640152_p454093517507"><a name="zh-cn_topic_0000002210640152_p454093517507"></a><a name="zh-cn_topic_0000002210640152_p454093517507"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210640152_p954016357501"><a name="zh-cn_topic_0000002210640152_p954016357501"></a><a name="zh-cn_topic_0000002210640152_p954016357501"></a>全局/session</p>
</td>
</tr>
</tbody>
</table>

## 试验参数<a name="section587444415573"></a>

<a name="table1551993815811"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002245680209_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002245680209_p3681132911170"><a name="zh-cn_topic_0000002245680209_p3681132911170"></a><a name="zh-cn_topic_0000002245680209_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002245680209_p326514861719"><a name="zh-cn_topic_0000002245680209_p326514861719"></a><a name="zh-cn_topic_0000002245680209_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002245680209_p1572818217519"><a name="zh-cn_topic_0000002245680209_p1572818217519"></a><a name="zh-cn_topic_0000002245680209_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002245680209_p197281421456"><a name="zh-cn_topic_0000002245680209_p197281421456"></a><a name="zh-cn_topic_0000002245680209_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002245680209_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p11204184119232"><a name="zh-cn_topic_0000002245680209_p11204184119232"></a><a name="zh-cn_topic_0000002245680209_p11204184119232"></a>ge.jit_compile</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p9643153511912"><a name="zh-cn_topic_0000002245680209_p9643153511912"></a><a name="zh-cn_topic_0000002245680209_p9643153511912"></a><strong id="zh-cn_topic_0000002245680209_b1837830155910"><a name="zh-cn_topic_0000002245680209_b1837830155910"></a><a name="zh-cn_topic_0000002245680209_b1837830155910"></a>当前版本暂不支持。</strong></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p1396211510430"><a name="zh-cn_topic_0000002245680209_p1396211510430"></a><a name="zh-cn_topic_0000002245680209_p1396211510430"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p18962815174315"><a name="zh-cn_topic_0000002245680209_p18962815174315"></a><a name="zh-cn_topic_0000002245680209_p18962815174315"></a>全局/session</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680209_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p397613171538"><a name="zh-cn_topic_0000002245680209_p397613171538"></a><a name="zh-cn_topic_0000002245680209_p397613171538"></a>ge.build_inner_model</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p1397661717319"><a name="zh-cn_topic_0000002245680209_p1397661717319"></a><a name="zh-cn_topic_0000002245680209_p1397661717319"></a><strong id="zh-cn_topic_0000002245680209_b2022423812594"><a name="zh-cn_topic_0000002245680209_b2022423812594"></a><a name="zh-cn_topic_0000002245680209_b2022423812594"></a>当前版本暂不支持。</strong></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p195411014191216"><a name="zh-cn_topic_0000002245680209_p195411014191216"></a><a name="zh-cn_topic_0000002245680209_p195411014191216"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p1754119148123"><a name="zh-cn_topic_0000002245680209_p1754119148123"></a><a name="zh-cn_topic_0000002245680209_p1754119148123"></a>NA</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680209_row3561164716539"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p15381133224214"><a name="zh-cn_topic_0000002245680209_p15381133224214"></a><a name="zh-cn_topic_0000002245680209_p15381133224214"></a>ge.disableOptimizations</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p497510864"><a name="zh-cn_topic_0000002245680209_p497510864"></a><a name="zh-cn_topic_0000002245680209_p497510864"></a><strong id="zh-cn_topic_0000002245680209_b34456261450"><a name="zh-cn_topic_0000002245680209_b34456261450"></a><a name="zh-cn_topic_0000002245680209_b34456261450"></a>该参数为调试参数，当前不支持应用于商用产品中，后续版本会作为正式特性更新发布。</strong></p>
<p id="zh-cn_topic_0000002245680209_p122031851526"><a name="zh-cn_topic_0000002245680209_p122031851526"></a><a name="zh-cn_topic_0000002245680209_p122031851526"></a>该参数仅适用于如下<span id="zh-cn_topic_0000002245680209_ph20833205312295"><a name="zh-cn_topic_0000002245680209_ph20833205312295"></a><a name="zh-cn_topic_0000002245680209_ph20833205312295"></a>产品</span>：</p>
<p id="zh-cn_topic_0000002245680209_p768411192214"><a name="zh-cn_topic_0000002245680209_p768411192214"></a><a name="zh-cn_topic_0000002245680209_p768411192214"></a><span id="zh-cn_topic_0000002245680209_ph359124725"><a name="zh-cn_topic_0000002245680209_ph359124725"></a><a name="zh-cn_topic_0000002245680209_ph359124725"></a><term id="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term11962195213215"><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term11962195213215"></a><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term11962195213215"></a>Atlas A2 训练系列产品</term>/<term id="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term184716139811"><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term184716139811"></a><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term184716139811"></a>Atlas A2 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002245680209_p47941924922"><a name="zh-cn_topic_0000002245680209_p47941924922"></a><a name="zh-cn_topic_0000002245680209_p47941924922"></a><span id="zh-cn_topic_0000002245680209_ph1052018467554"><a name="zh-cn_topic_0000002245680209_ph1052018467554"></a><a name="zh-cn_topic_0000002245680209_ph1052018467554"></a><term id="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term131434243115"><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term131434243115"></a><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000001312391781_term131434243115"></a>Atlas A3 推理系列产品</term></span></p>
<p id="zh-cn_topic_0000002245680209_p745982674819"><a name="zh-cn_topic_0000002245680209_p745982674819"></a><a name="zh-cn_topic_0000002245680209_p745982674819"></a>用于指定<strong id="zh-cn_topic_0000002245680209_b19974857143316"><a name="zh-cn_topic_0000002245680209_b19974857143316"></a><a name="zh-cn_topic_0000002245680209_b19974857143316"></a>关闭</strong>的某一个或者多个编译优化pass。</p>
<p id="zh-cn_topic_0000002245680209_p15981655123218"><a name="zh-cn_topic_0000002245680209_p15981655123218"></a><a name="zh-cn_topic_0000002245680209_p15981655123218"></a>当前仅支持关闭如下pass：</p>
<pre class="screen" id="zh-cn_topic_0000002245680209_screen42391718183317"><a name="zh-cn_topic_0000002245680209_screen42391718183317"></a><a name="zh-cn_topic_0000002245680209_screen42391718183317"></a>"RemoveSameConstPass","ConstantFoldingPass","TransOpWithoutReshapeFusionPass"</pre>
<p id="zh-cn_topic_0000002245680209_p123651020173311"><a name="zh-cn_topic_0000002245680209_p123651020173311"></a><a name="zh-cn_topic_0000002245680209_p123651020173311"></a>注意：</p>
<a name="zh-cn_topic_0000002245680209_ol13928194517356"></a><a name="zh-cn_topic_0000002245680209_ol13928194517356"></a><ol id="zh-cn_topic_0000002245680209_ol13928194517356"><li>多个pass之间使用英文逗号分隔。</li><li>若用户指定关闭了其他pass，graph编译时不会处理，只会打印warning级别的日志。</li><li>若指定关闭了ConstantFoldingPass，graph编译或运行时可能会失败。</li><li>如果同时配置了其他编译优化选项，比如ge.oo.constantFolding，则ge.disableOptimizations优先级更高。</li></ol>
<p id="zh-cn_topic_0000002245680209_p969522013313"><a name="zh-cn_topic_0000002245680209_p969522013313"></a><a name="zh-cn_topic_0000002245680209_p969522013313"></a><strong id="zh-cn_topic_0000002245680209_b122310203315"><a name="zh-cn_topic_0000002245680209_b122310203315"></a><a name="zh-cn_topic_0000002245680209_b122310203315"></a>配置示例</strong>：</p>
<a name="zh-cn_topic_0000002245680209_ul532715377424"></a><a name="zh-cn_topic_0000002245680209_ul532715377424"></a><ul id="zh-cn_topic_0000002245680209_ul532715377424"><li>关闭单个pass<pre class="screen" id="zh-cn_topic_0000002245680209_screen14817710432"><a name="zh-cn_topic_0000002245680209_screen14817710432"></a><a name="zh-cn_topic_0000002245680209_screen14817710432"></a>std::map &lt;AscendString, AscendString&gt; session_options = {
{"ge.disableOptimizations", "RemoveSameConstPass"}
};</pre>
</li><li>关闭多个pass<pre class="screen" id="zh-cn_topic_0000002245680209_screen1710182816435"><a name="zh-cn_topic_0000002245680209_screen1710182816435"></a><a name="zh-cn_topic_0000002245680209_screen1710182816435"></a>std::map &lt;AscendString, AscendString&gt; session_options = {
{"ge.disableOptimizations", "RemoveSameConstPass, ConstantFoldingPass"}
};</pre>
</li></ul>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p438112328422"><a name="zh-cn_topic_0000002245680209_p438112328422"></a><a name="zh-cn_topic_0000002245680209_p438112328422"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p16381183219425"><a name="zh-cn_topic_0000002245680209_p16381183219425"></a><a name="zh-cn_topic_0000002245680209_p16381183219425"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680209_row165612047165310"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p645094510312"><a name="zh-cn_topic_0000002245680209_p645094510312"></a><a name="zh-cn_topic_0000002245680209_p645094510312"></a>ge.oo.level</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p155241939134310"><a name="zh-cn_topic_0000002245680209_p155241939134310"></a><a name="zh-cn_topic_0000002245680209_p155241939134310"></a><strong id="zh-cn_topic_0000002245680209_b112761862459"><a name="zh-cn_topic_0000002245680209_b112761862459"></a><a name="zh-cn_topic_0000002245680209_b112761862459"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002245680209_p81713419273"><a name="zh-cn_topic_0000002245680209_p81713419273"></a><a name="zh-cn_topic_0000002245680209_p81713419273"></a>图编译多级优化选项，包括子图优化、整图优化、<span>静态Shape模型下沉</span>等。</p>
<p id="zh-cn_topic_0000002245680209_p13590204722713"><a name="zh-cn_topic_0000002245680209_p13590204722713"></a><a name="zh-cn_topic_0000002245680209_p13590204722713"></a><span>静态Shape模型下沉</span>：静态Shape模型在编译时即可确定所有算子的输入输出Shape，完成模型级内存编排、算子的Tiling计算等Host侧计算，在模型加载时整体下发到Device流上，但不立即执行，通过下发模型执行Task触发模型中所有Task的执行。</p>
<p id="zh-cn_topic_0000002245680209_p14787525853"><a name="zh-cn_topic_0000002245680209_p14787525853"></a><a name="zh-cn_topic_0000002245680209_p14787525853"></a><strong id="zh-cn_topic_0000002245680209_b84818267518"><a name="zh-cn_topic_0000002245680209_b84818267518"></a><a name="zh-cn_topic_0000002245680209_b84818267518"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245680209_ul28245481651"></a><a name="zh-cn_topic_0000002245680209_ul28245481651"></a><ul id="zh-cn_topic_0000002245680209_ul28245481651"><li>O1：会关闭所有图融合和UB融合Pass，只做促成静态下沉的相关优化，如InferShape（进行输出Tensor的shape推导）、常量折叠、死边消除等。<p id="zh-cn_topic_0000002245680209_zh-cn_topic_0000002058018885_p6524118144416"><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000002058018885_p6524118144416"></a><a name="zh-cn_topic_0000002245680209_zh-cn_topic_0000002058018885_p6524118144416"></a></p>
</li><li>O3：（默认值）开启所有优化。</li></ul>
<p id="zh-cn_topic_0000002245680209_p1417116268291"><a name="zh-cn_topic_0000002245680209_p1417116268291"></a><a name="zh-cn_topic_0000002245680209_p1417116268291"></a><strong id="zh-cn_topic_0000002245680209_b628623310294"><a name="zh-cn_topic_0000002245680209_b628623310294"></a><a name="zh-cn_topic_0000002245680209_b628623310294"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245680209_p11936115015517"><a name="zh-cn_topic_0000002245680209_p11936115015517"></a><a name="zh-cn_topic_0000002245680209_p11936115015517"></a>取值为O1时，会关闭所有图融合和UB融合PASS，只开启静态下沉的相关PASS，但是如下路径文件中的图融合PASS，由于关闭后会有功能问题，会默认开启：</p>
<p id="zh-cn_topic_0000002245680209_p12878123125212"><a name="zh-cn_topic_0000002245680209_p12878123125212"></a><a name="zh-cn_topic_0000002245680209_p12878123125212"></a>“<span id="zh-cn_topic_0000002245680209_ph111861254121815"><a name="zh-cn_topic_0000002245680209_ph111861254121815"></a><a name="zh-cn_topic_0000002245680209_ph111861254121815"></a>${INSTALL_DIR}</span>/x86_64-linux/lib64/plugin/opskernel/fusion_pass/config/fusion_config.json”文件中"ExceptionalPassOfO1Level"字段下的所有图融合PASS。</p>
<p id="zh-cn_topic_0000002245680209_li1541231181614p0"><a name="zh-cn_topic_0000002245680209_li1541231181614p0"></a><a name="zh-cn_topic_0000002245680209_li1541231181614p0"></a>其中<span id="zh-cn_topic_0000002245680209_ph13176162271813"><a name="zh-cn_topic_0000002245680209_ph13176162271813"></a><a name="zh-cn_topic_0000002245680209_ph13176162271813"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002245680209_p3439430952"><a name="zh-cn_topic_0000002245680209_p3439430952"></a><a name="zh-cn_topic_0000002245680209_p3439430952"></a><strong id="zh-cn_topic_0000002245680209_b343917305512"><a name="zh-cn_topic_0000002245680209_b343917305512"></a><a name="zh-cn_topic_0000002245680209_b343917305512"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245680209_screen184398308519"><a name="zh-cn_topic_0000002245680209_screen184398308519"></a><a name="zh-cn_topic_0000002245680209_screen184398308519"></a>{"ge.oo.level", "O3"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p164509451138"><a name="zh-cn_topic_0000002245680209_p164509451138"></a><a name="zh-cn_topic_0000002245680209_p164509451138"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p2045011451734"><a name="zh-cn_topic_0000002245680209_p2045011451734"></a><a name="zh-cn_topic_0000002245680209_p2045011451734"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680209_row1268619554438"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p8455165012318"><a name="zh-cn_topic_0000002245680209_p8455165012318"></a><a name="zh-cn_topic_0000002245680209_p8455165012318"></a>ge.oo.constantFolding</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p295082412913"><a name="zh-cn_topic_0000002245680209_p295082412913"></a><a name="zh-cn_topic_0000002245680209_p295082412913"></a><strong id="zh-cn_topic_0000002245680209_b995032417912"><a name="zh-cn_topic_0000002245680209_b995032417912"></a><a name="zh-cn_topic_0000002245680209_b995032417912"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002245680209_p245519502315"><a name="zh-cn_topic_0000002245680209_p245519502315"></a><a name="zh-cn_topic_0000002245680209_p245519502315"></a>是否开启常量折叠优化。</p>
<p id="zh-cn_topic_0000002245680209_p1414619230342"><a name="zh-cn_topic_0000002245680209_p1414619230342"></a><a name="zh-cn_topic_0000002245680209_p1414619230342"></a>常量折叠是将计算图中可以预先确定输出值的节点替换成常量，并对计算图进行一些结构简化的操作。</p>
<p id="zh-cn_topic_0000002245680209_p13761510719"><a name="zh-cn_topic_0000002245680209_p13761510719"></a><a name="zh-cn_topic_0000002245680209_p13761510719"></a><strong id="zh-cn_topic_0000002245680209_b1436914561976"><a name="zh-cn_topic_0000002245680209_b1436914561976"></a><a name="zh-cn_topic_0000002245680209_b1436914561976"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245680209_ul9173551280"></a><a name="zh-cn_topic_0000002245680209_ul9173551280"></a><ul id="zh-cn_topic_0000002245680209_ul9173551280"><li>true：（默认值）开启。</li><li>false：关闭。</li></ul>
<p id="zh-cn_topic_0000002245680209_p20880195910714"><a name="zh-cn_topic_0000002245680209_p20880195910714"></a><a name="zh-cn_topic_0000002245680209_p20880195910714"></a><strong id="zh-cn_topic_0000002245680209_b1588018591372"><a name="zh-cn_topic_0000002245680209_b1588018591372"></a><a name="zh-cn_topic_0000002245680209_b1588018591372"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245680209_screen965610184108"><a name="zh-cn_topic_0000002245680209_screen965610184108"></a><a name="zh-cn_topic_0000002245680209_screen965610184108"></a>{"ge.oo.constantFolding", "true"};</pre>
<p id="zh-cn_topic_0000002245680209_p629784131013"><a name="zh-cn_topic_0000002245680209_p629784131013"></a><a name="zh-cn_topic_0000002245680209_p629784131013"></a><strong id="zh-cn_topic_0000002245680209_b11108313101010"><a name="zh-cn_topic_0000002245680209_b11108313101010"></a><a name="zh-cn_topic_0000002245680209_b11108313101010"></a>使用约束：</strong></p>
<p id="zh-cn_topic_0000002245680209_p1252110154108"><a name="zh-cn_topic_0000002245680209_p1252110154108"></a><a name="zh-cn_topic_0000002245680209_p1252110154108"></a>如果同时配置了其他编译优化选项，比如ge.disableOptimizations，则ge.disableOptimizations优先级更高。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p7592511243"><a name="zh-cn_topic_0000002245680209_p7592511243"></a><a name="zh-cn_topic_0000002245680209_p7592511243"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p759105112415"><a name="zh-cn_topic_0000002245680209_p759105112415"></a><a name="zh-cn_topic_0000002245680209_p759105112415"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680209_row2710195764312"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p139410474312"><a name="zh-cn_topic_0000002245680209_p139410474312"></a><a name="zh-cn_topic_0000002245680209_p139410474312"></a>ge.oo.deadCodeElimination</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p226419281893"><a name="zh-cn_topic_0000002245680209_p226419281893"></a><a name="zh-cn_topic_0000002245680209_p226419281893"></a><strong id="zh-cn_topic_0000002245680209_b626413288915"><a name="zh-cn_topic_0000002245680209_b626413288915"></a><a name="zh-cn_topic_0000002245680209_b626413288915"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002245680209_p15988112512916"><a name="zh-cn_topic_0000002245680209_p15988112512916"></a><a name="zh-cn_topic_0000002245680209_p15988112512916"></a>是否开启死边消除优化。</p>
<p id="zh-cn_topic_0000002245680209_p81794043414"><a name="zh-cn_topic_0000002245680209_p81794043414"></a><a name="zh-cn_topic_0000002245680209_p81794043414"></a>死边消除：switch死边消除，switch的pred输入（1号输入）为const节点时，根据const的值消除其中一条分支：const为true时，消除false分支；const为false时，消除true分支。</p>
<p id="zh-cn_topic_0000002245680209_p20988172512915"><a name="zh-cn_topic_0000002245680209_p20988172512915"></a><a name="zh-cn_topic_0000002245680209_p20988172512915"></a><strong id="zh-cn_topic_0000002245680209_b10988825991"><a name="zh-cn_topic_0000002245680209_b10988825991"></a><a name="zh-cn_topic_0000002245680209_b10988825991"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245680209_ul149881025394"></a><a name="zh-cn_topic_0000002245680209_ul149881025394"></a><ul id="zh-cn_topic_0000002245680209_ul149881025394"><li>true：（默认值）开启。</li><li>false：关闭。</li></ul>
<p id="zh-cn_topic_0000002245680209_p109881251197"><a name="zh-cn_topic_0000002245680209_p109881251197"></a><a name="zh-cn_topic_0000002245680209_p109881251197"></a><strong id="zh-cn_topic_0000002245680209_b12988152518915"><a name="zh-cn_topic_0000002245680209_b12988152518915"></a><a name="zh-cn_topic_0000002245680209_b12988152518915"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002245680209_screen1898817259910"><a name="zh-cn_topic_0000002245680209_screen1898817259910"></a><a name="zh-cn_topic_0000002245680209_screen1898817259910"></a>{"ge.oo.deadCodeElimination", "true"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p1662011523420"><a name="zh-cn_topic_0000002245680209_p1662011523420"></a><a name="zh-cn_topic_0000002245680209_p1662011523420"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p1162010521742"><a name="zh-cn_topic_0000002245680209_p1162010521742"></a><a name="zh-cn_topic_0000002245680209_p1162010521742"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002245680209_row01327328280"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002245680209_p97404812318"><a name="zh-cn_topic_0000002245680209_p97404812318"></a><a name="zh-cn_topic_0000002245680209_p97404812318"></a>ge.autoMultistreamParallelMode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002245680209_p19669192142612"><a name="zh-cn_topic_0000002245680209_p19669192142612"></a><a name="zh-cn_topic_0000002245680209_p19669192142612"></a><strong id="zh-cn_topic_0000002245680209_b195466302610"><a name="zh-cn_topic_0000002245680209_b195466302610"></a><a name="zh-cn_topic_0000002245680209_b195466302610"></a>调试功能扩展参数，当前不支持应用于商用产品中，后续版本会作为正式功能更新发布。</strong></p>
<p id="zh-cn_topic_0000002245680209_p11612107163216"><a name="zh-cn_topic_0000002245680209_p11612107163216"></a><a name="zh-cn_topic_0000002245680209_p11612107163216"></a>该参数仅适用于静态shpae图场景，开发者可通过配置此参数开启Cube算子与Vector算子的并行执行，以提升图执行性能。</p>
<p id="zh-cn_topic_0000002245680209_p92695716252"><a name="zh-cn_topic_0000002245680209_p92695716252"></a><a name="zh-cn_topic_0000002245680209_p92695716252"></a><strong id="zh-cn_topic_0000002245680209_b415512822618"><a name="zh-cn_topic_0000002245680209_b415512822618"></a><a name="zh-cn_topic_0000002245680209_b415512822618"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002245680209_ul96970511253"></a><a name="zh-cn_topic_0000002245680209_ul96970511253"></a><ul id="zh-cn_topic_0000002245680209_ul96970511253"><li>cv：代表开启Cube算子与Vector算子的并行执行功能。</li><li>None（默认值），即不开启Cube算子与Vector算子的并行执行功能。</li></ul>
<div class="notice" id="zh-cn_topic_0000002245680209_note29471911813"><a name="zh-cn_topic_0000002245680209_note29471911813"></a><a name="zh-cn_topic_0000002245680209_note29471911813"></a><span class="noticetitle"> 须知： </span><div class="noticebody"><p id="zh-cn_topic_0000002245680209_p951841619"><a name="zh-cn_topic_0000002245680209_p951841619"></a><a name="zh-cn_topic_0000002245680209_p951841619"></a>该参数仅限于推荐类型网络的训练场景使用。</p>
</div></div>
<div class="p" id="zh-cn_topic_0000002245680209_p161101952243"><a name="zh-cn_topic_0000002245680209_p161101952243"></a><a name="zh-cn_topic_0000002245680209_p161101952243"></a><strong id="zh-cn_topic_0000002245680209_b898101217267"><a name="zh-cn_topic_0000002245680209_b898101217267"></a><a name="zh-cn_topic_0000002245680209_b898101217267"></a>配置示例：</strong><pre class="screen" id="zh-cn_topic_0000002245680209_screen4724154013236"><a name="zh-cn_topic_0000002245680209_screen4724154013236"></a><a name="zh-cn_topic_0000002245680209_screen4724154013236"></a>{"ge.autoMultistreamParallelMode", "cv"};</pre>
</div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002245680209_p137403862313"><a name="zh-cn_topic_0000002245680209_p137403862313"></a><a name="zh-cn_topic_0000002245680209_p137403862313"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002245680209_p9740158122311"><a name="zh-cn_topic_0000002245680209_p9740158122311"></a><a name="zh-cn_topic_0000002245680209_p9740158122311"></a>session/graph</p>
</td>
</tr>
</tbody>
</table>

## 后续版本废弃配置<a name="section11143750115713"></a>

<a name="table855612397584"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002210480380_row12247013356"><th class="cellrowborder" valign="top" width="14.39%" id="mcps1.1.5.1.1"><p id="zh-cn_topic_0000002210480380_p3681132911170"><a name="zh-cn_topic_0000002210480380_p3681132911170"></a><a name="zh-cn_topic_0000002210480380_p3681132911170"></a>Options key</p>
</th>
<th class="cellrowborder" valign="top" width="71.14%" id="mcps1.1.5.1.2"><p id="zh-cn_topic_0000002210480380_p326514861719"><a name="zh-cn_topic_0000002210480380_p326514861719"></a><a name="zh-cn_topic_0000002210480380_p326514861719"></a>Options value</p>
</th>
<th class="cellrowborder" valign="top" width="7.5200000000000005%" id="mcps1.1.5.1.3"><p id="zh-cn_topic_0000002210480380_p1572818217519"><a name="zh-cn_topic_0000002210480380_p1572818217519"></a><a name="zh-cn_topic_0000002210480380_p1572818217519"></a>必选/可选</p>
</th>
<th class="cellrowborder" valign="top" width="6.950000000000001%" id="mcps1.1.5.1.4"><p id="zh-cn_topic_0000002210480380_p197281421456"><a name="zh-cn_topic_0000002210480380_p197281421456"></a><a name="zh-cn_topic_0000002210480380_p197281421456"></a>全局/session/graph级别生效</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002210480380_row92247011357"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480380_p17460352141912"><a name="zh-cn_topic_0000002210480380_p17460352141912"></a><a name="zh-cn_topic_0000002210480380_p17460352141912"></a>ge.graphMemoryMaxSize</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480380_p84377819012"><a name="zh-cn_topic_0000002210480380_p84377819012"></a><a name="zh-cn_topic_0000002210480380_p84377819012"></a><strong id="zh-cn_topic_0000002210480380_b94231391501"><a name="zh-cn_topic_0000002210480380_b94231391501"></a><a name="zh-cn_topic_0000002210480380_b94231391501"></a>该参数后续版本废弃，请勿使用。</strong></p>
<p id="zh-cn_topic_0000002210480380_p1768212912178"><a name="zh-cn_topic_0000002210480380_p1768212912178"></a><a name="zh-cn_topic_0000002210480380_p1768212912178"></a>网络静态内存和最大动态内存，可根据网络大小指定。单位：Byte，取值范围：[0, 256*1024*1024*1024]或[0, 274877906944]。当前受芯片硬件限制，ge.graphMemoryMaxSize和ge.variableMemoryMaxSize总和最大支持31G。如果不设置，默认为26GB。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480380_p1037682619323"><a name="zh-cn_topic_0000002210480380_p1037682619323"></a><a name="zh-cn_topic_0000002210480380_p1037682619323"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480380_p1378012130527"><a name="zh-cn_topic_0000002210480380_p1378012130527"></a><a name="zh-cn_topic_0000002210480380_p1378012130527"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480380_row28384065314"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480380_p8579146201919"><a name="zh-cn_topic_0000002210480380_p8579146201919"></a><a name="zh-cn_topic_0000002210480380_p8579146201919"></a>ge.variableMemoryMaxSize</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480380_p119286111403"><a name="zh-cn_topic_0000002210480380_p119286111403"></a><a name="zh-cn_topic_0000002210480380_p119286111403"></a><strong id="zh-cn_topic_0000002210480380_b1538312121400"><a name="zh-cn_topic_0000002210480380_b1538312121400"></a><a name="zh-cn_topic_0000002210480380_b1538312121400"></a>该参数后续版本废弃，请勿使用。</strong></p>
<p id="zh-cn_topic_0000002210480380_p168292911178"><a name="zh-cn_topic_0000002210480380_p168292911178"></a><a name="zh-cn_topic_0000002210480380_p168292911178"></a>变量内存，可根据网络大小指定。单位：Byte，取值范围：[0, 256*1024*1024*1024]或[0, 274877906944]。当前受芯片硬件限制，ge.graphMemoryMaxSize和ge.variableMemoryMaxSize总和最大支持31G。如果不设置，默认为5GB。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480380_p16378226113210"><a name="zh-cn_topic_0000002210480380_p16378226113210"></a><a name="zh-cn_topic_0000002210480380_p16378226113210"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480380_p1559491212526"><a name="zh-cn_topic_0000002210480380_p1559491212526"></a><a name="zh-cn_topic_0000002210480380_p1559491212526"></a>all</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480380_row1324124455319"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480380_p5396128135118"><a name="zh-cn_topic_0000002210480380_p5396128135118"></a><a name="zh-cn_topic_0000002210480380_p5396128135118"></a>ge.exec.dynamicGraphExecuteMode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480380_p4392165514505"><a name="zh-cn_topic_0000002210480380_p4392165514505"></a><a name="zh-cn_topic_0000002210480380_p4392165514505"></a><strong id="zh-cn_topic_0000002210480380_b1351105711503"><a name="zh-cn_topic_0000002210480380_b1351105711503"></a><a name="zh-cn_topic_0000002210480380_b1351105711503"></a>该参数已废弃，请勿使用。</strong></p>
<p id="zh-cn_topic_0000002210480380_p13396192817510"><a name="zh-cn_topic_0000002210480380_p13396192817510"></a><a name="zh-cn_topic_0000002210480380_p13396192817510"></a>对于动态输入场景，需要通过该参数设置执行模式，取值为：dynamic_execute。</p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480380_p2396112814515"><a name="zh-cn_topic_0000002210480380_p2396112814515"></a><a name="zh-cn_topic_0000002210480380_p2396112814515"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480380_p9396628195114"><a name="zh-cn_topic_0000002210480380_p9396628195114"></a><a name="zh-cn_topic_0000002210480380_p9396628195114"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480380_row6241154465317"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480380_p11608358170"><a name="zh-cn_topic_0000002210480380_p11608358170"></a><a name="zh-cn_topic_0000002210480380_p11608358170"></a>ge.exec.dataInputsShapeRange</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480380_p8309905212"><a name="zh-cn_topic_0000002210480380_p8309905212"></a><a name="zh-cn_topic_0000002210480380_p8309905212"></a><strong id="zh-cn_topic_0000002210480380_b152291097214"><a name="zh-cn_topic_0000002210480380_b152291097214"></a><a name="zh-cn_topic_0000002210480380_b152291097214"></a>该参数已废弃，请勿使用。</strong></p>
<p id="zh-cn_topic_0000002210480380_p12125192712476"><a name="zh-cn_topic_0000002210480380_p12125192712476"></a><a name="zh-cn_topic_0000002210480380_p12125192712476"></a>动态输入的shape范围。例如全图有2个data输入，配置示例为：</p>
<pre class="screen" id="zh-cn_topic_0000002210480380_screen829423114511"><a name="zh-cn_topic_0000002210480380_screen829423114511"></a><a name="zh-cn_topic_0000002210480380_screen829423114511"></a>std::map&lt;ge::AscendString, ge::AscendString&gt; ge_options = {{"ge.exec.deviceId", "0"},
      {"ge.graphRunMode", "1"},
      {"ge.exec.dynamicGraphExecuteMode", "dynamic_execute"},
      {"ge.exec.dataInputsShapeRange", "[128 ,3<font style="font-size:8pt" Face="Courier New" >~</font>5, 2<font style="font-size:8pt" Face="Courier New" >~</font>128, -1],[ 128 ,3<font style="font-size:8pt" Face="Courier New" >~</font>5, 2<font style="font-size:8pt" Face="Courier New" >~</font>128, -1]"}};</pre>
<a name="zh-cn_topic_0000002210480380_ul10660105318312"></a><a name="zh-cn_topic_0000002210480380_ul10660105318312"></a><ul id="zh-cn_topic_0000002210480380_ul10660105318312"><li>设置格式为："[n1,c1,h1,w1],[n2,c2,h2,w2]"，例如："[8~20,3,5,-1],[5,3~9,10,-1]"。可以不指定节点名，默认第一个中括号为第一个输入节点，节点中间使用英文逗号分隔。按照index设置INPUT_SHAPE_RANGE时，data节点需要设置属性index，说明是第几个输入，index从0开始。</li><li>动态维度有shape范围的用波浪号“~”表示，固定维度用固定数字表示，无限定范围的用-1表示。</li><li>对于标量输入，也需要填入shape范围，表示方法为：[]。</li><li>对于多输入场景，例如有三个输入时，如果只有第二个第三个输入具有shape范围，第一个输入为固定输入时，仍需要将固定输入shape填入options字段内，例如：<p id="zh-cn_topic_0000002210480380_p798910541513"><a name="zh-cn_topic_0000002210480380_p798910541513"></a><a name="zh-cn_topic_0000002210480380_p798910541513"></a>{"ge.exec.dataInputsShapeRange", "[3,3,4,10], [-1,3,2~1000,-1],[-1,-1,-1,-1]"}};</p>
</li></ul>
<div class="note" id="zh-cn_topic_0000002210480380_note19893746105618"><a name="zh-cn_topic_0000002210480380_note19893746105618"></a><a name="zh-cn_topic_0000002210480380_note19893746105618"></a><span class="notetitle"> 说明： </span><div class="notebody"><a name="zh-cn_topic_0000002210480380_ul986682992911"></a><a name="zh-cn_topic_0000002210480380_ul986682992911"></a><ul id="zh-cn_topic_0000002210480380_ul986682992911"><li>若没有指定节点名，则节点默认按照index顺序存储，存储示例如下：<p id="zh-cn_topic_0000002210480380_p2274222576"><a name="zh-cn_topic_0000002210480380_p2274222576"></a><a name="zh-cn_topic_0000002210480380_p2274222576"></a>xxx_0，xxx_1，xxx_2，……</p>
<p id="zh-cn_topic_0000002210480380_p14274722579"><a name="zh-cn_topic_0000002210480380_p14274722579"></a><a name="zh-cn_topic_0000002210480380_p14274722579"></a>其中下划线后为节点在网络脚本中的定义顺序索引，节点会按照此索引的字母顺序进行排布，所以当节点的个数大于10时，则排序为“xxx_0 -&gt; xxx_10 -&gt; xxx_2 -&gt; xxx_3”，网络脚本中定义索引为10的节点排在了索引为2的节点前面，导致定义的shape range与实际输入的节点不匹配。</p>
<p id="zh-cn_topic_0000002210480380_p7541643155711"><a name="zh-cn_topic_0000002210480380_p7541643155711"></a><a name="zh-cn_topic_0000002210480380_p7541643155711"></a>为避免此问题，当节点的输入个数大于10时，建议在网络脚本中指定节点的名称，则节点会以指定的名称进行命名，实现shape range与节点名称的关联。</p>
</li><li>如果该参数与ge.dynamicDims同时配置，示例如下：<pre class="screen" id="zh-cn_topic_0000002210480380_screen2778239113212"><a name="zh-cn_topic_0000002210480380_screen2778239113212"></a><a name="zh-cn_topic_0000002210480380_screen2778239113212"></a>std::map&lt;ge::AscendString, ge::AscendString&gt; ge_options = 
     {{"ge.inputShape", "data:1,1,40,-1;label:1,-1;mask:-1,-1" },
      {"ge.dynamicDims", "20,20,1,1;40,40,2,2;80,60,4,4"},
        <em id="zh-cn_topic_0000002210480380_i556701243517"><a name="zh-cn_topic_0000002210480380_i556701243517"></a><a name="zh-cn_topic_0000002210480380_i556701243517"></a>xxx</em>
      {"ge.exec.dataInputsShapeRange", "[128, 3<font style="font-size:8pt" Face="Courier New" >~</font>5, 2<font style="font-size:8pt" Face="Courier New" >~</font>128, -1],[ 128 ,3<font style="font-size:8pt" Face="Courier New" >~</font>5, 2<font style="font-size:8pt" Face="Courier New" >~</font>128, -1]"}};</pre>
<p id="zh-cn_topic_0000002210480380_p17224378321"><a name="zh-cn_topic_0000002210480380_p17224378321"></a><a name="zh-cn_topic_0000002210480380_p17224378321"></a>ge.dynamicDims参数功能（动态分档）优先级高于ge.exec.dataInputsShapeRange参数功能（动态shape范围）。</p>
</li></ul>
</div></div>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480380_p11427204510172"><a name="zh-cn_topic_0000002210480380_p11427204510172"></a><a name="zh-cn_topic_0000002210480380_p11427204510172"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480380_p1842717453175"><a name="zh-cn_topic_0000002210480380_p1842717453175"></a><a name="zh-cn_topic_0000002210480380_p1842717453175"></a>graph</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480380_row1056164718532"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480380_p1796591113612"><a name="zh-cn_topic_0000002210480380_p1796591113612"></a><a name="zh-cn_topic_0000002210480380_p1796591113612"></a>ge.opSelectImplmode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480380_p1382503016395"><a name="zh-cn_topic_0000002210480380_p1382503016395"></a><a name="zh-cn_topic_0000002210480380_p1382503016395"></a><strong id="zh-cn_topic_0000002210480380_b338014426456"><a name="zh-cn_topic_0000002210480380_b338014426456"></a><a name="zh-cn_topic_0000002210480380_b338014426456"></a>该参数功能已经不演进，后续版本会废弃，推荐使用ge.exec.op_precision_mode参数。</strong></p>
<p id="zh-cn_topic_0000002210480380_p0459617115"><a name="zh-cn_topic_0000002210480380_p0459617115"></a><a name="zh-cn_topic_0000002210480380_p0459617115"></a><span id="zh-cn_topic_0000002210480380_ph1555712386204"><a name="zh-cn_topic_0000002210480380_ph1555712386204"></a><a name="zh-cn_topic_0000002210480380_ph1555712386204"></a>昇腾AI处理器</span>部分内置算子有高精度和高性能实现方式，用户可以通过该参数配置模型编译时选择哪种算子。</p>
<p id="zh-cn_topic_0000002210480380_p128181371311"><a name="zh-cn_topic_0000002210480380_p128181371311"></a><a name="zh-cn_topic_0000002210480380_p128181371311"></a>高精度是指在float16输入场景，通过泰勒展开/牛顿迭代等手段进一步提升算子的精度；高性能是指在float16输入的情况下，不影响网络精度前提的最优性能实现。</p>
<p id="zh-cn_topic_0000002210480380_p18808872169"><a name="zh-cn_topic_0000002210480380_p18808872169"></a><a name="zh-cn_topic_0000002210480380_p18808872169"></a><strong id="zh-cn_topic_0000002210480380_b163723373278"><a name="zh-cn_topic_0000002210480380_b163723373278"></a><a name="zh-cn_topic_0000002210480380_b163723373278"></a>参数取值：</strong></p>
<a name="zh-cn_topic_0000002210480380_ul1185710368116"></a><a name="zh-cn_topic_0000002210480380_ul1185710368116"></a><ul id="zh-cn_topic_0000002210480380_ul1185710368116"><li><strong id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b1752173519487"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b1752173519487"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b1752173519487"></a>high_precision</strong>：表示算子采用高精度实现模式。<p id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p79886343518"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p79886343518"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p79886343518"></a>该选项采用系统内置的配置文件设置算子实现模式，内置配置文件路径为<span id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph10562197165916"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph10562197165916"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph10562197165916"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/impl_mode/high_precision.ini。</p>
<p id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p1382733134116"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p1382733134116"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p1382733134116"></a>为保持兼容，该参数仅对high_precision.ini文件中算子列表生效，通过该列表可以控制算子生效的范围并保证之前版本的网络模型不受影响。</p>
</li><li><strong id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b19880362488"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b19880362488"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b19880362488"></a>high_performance</strong>：（默认值）表示算子采用高性能实现模式。<p id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p521419617314"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p521419617314"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p521419617314"></a>该选项采用系统内置的配置文件设置算子实现模式，内置配置文件路径为<span id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph115493481412"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph115493481412"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph115493481412"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/impl_mode/high_performance.ini。</p>
<p id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p56341418558"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p56341418558"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p56341418558"></a>为保持兼容，该参数仅对high_performance.ini文件中算子列表生效，通过该列表可以控制算子生效的范围并保证之前版本的网络模型不受影响。</p>
</li><li><strong id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b11324153824812"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b11324153824812"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b11324153824812"></a>high_precision_for_all</strong>：表示算子采用高精度实现模式。<p id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p125151221414"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p125151221414"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p125151221414"></a>该选项采用系统内置的配置文件设置算子实现模式，内置配置文件路径为<span id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph5364411414"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph5364411414"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_ph5364411414"></a>${INSTALL_DIR}</span>/opp/built-in/op_impl/ai_core/tbe/impl_mode/high_precision_for_all.ini，该文件中列表后续可能会跟随版本更新。</p>
<p id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p19278864222"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p19278864222"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_p19278864222"></a><strong id="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b097321901812"><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b097321901812"></a><a name="zh-cn_topic_0000002210480380_zh-cn_topic_0000001312473901_b097321901812"></a>该实现模式不保证兼容</strong>，如果后续新的软件包中有算子新增了实现模式（即配置文件中新增了某个算子的实现模式），之前版本使用high_precision_for_all的网络模型，在新版本上性能可能会下降。</p>
</li></ul>
<p id="zh-cn_topic_0000002210480380_p1664111571591"><a name="zh-cn_topic_0000002210480380_p1664111571591"></a><a name="zh-cn_topic_0000002210480380_p1664111571591"></a>上述实现模式，根据算子的dtype进行区分。其中，<span id="zh-cn_topic_0000002210480380_ph1027510266551"><a name="zh-cn_topic_0000002210480380_ph1027510266551"></a><a name="zh-cn_topic_0000002210480380_ph1027510266551"></a>${INSTALL_DIR}请替换为CANN软件安装后文件存储路径。以root用户安装为例，则安装后文件存储路径为：/usr/local/Ascend/cann。</span></p>
<p id="zh-cn_topic_0000002210480380_p1942316404212"><a name="zh-cn_topic_0000002210480380_p1942316404212"></a><a name="zh-cn_topic_0000002210480380_p1942316404212"></a><strong id="zh-cn_topic_0000002210480380_b54231141421"><a name="zh-cn_topic_0000002210480380_b54231141421"></a><a name="zh-cn_topic_0000002210480380_b54231141421"></a>配置示例：</strong></p>
<pre class="screen" id="zh-cn_topic_0000002210480380_screen8423148425"><a name="zh-cn_topic_0000002210480380_screen8423148425"></a><a name="zh-cn_topic_0000002210480380_screen8423148425"></a>{"ge.opSelectImplmode", "high_performance"};</pre>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480380_p14601104814175"><a name="zh-cn_topic_0000002210480380_p14601104814175"></a><a name="zh-cn_topic_0000002210480380_p14601104814175"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480380_p18601144811715"><a name="zh-cn_topic_0000002210480380_p18601144811715"></a><a name="zh-cn_topic_0000002210480380_p18601144811715"></a>全局</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002210480380_row3561164716539"><td class="cellrowborder" valign="top" width="14.39%" headers="mcps1.1.5.1.1 "><p id="zh-cn_topic_0000002210480380_p1997921124011"><a name="zh-cn_topic_0000002210480380_p1997921124011"></a><a name="zh-cn_topic_0000002210480380_p1997921124011"></a>ge.shape_generalized_build_mode</p>
</td>
<td class="cellrowborder" valign="top" width="71.14%" headers="mcps1.1.5.1.2 "><p id="zh-cn_topic_0000002210480380_p99973215401"><a name="zh-cn_topic_0000002210480380_p99973215401"></a><a name="zh-cn_topic_0000002210480380_p99973215401"></a><strong id="zh-cn_topic_0000002210480380_b2051020421991"><a name="zh-cn_topic_0000002210480380_b2051020421991"></a><a name="zh-cn_topic_0000002210480380_b2051020421991"></a>该参数在后续版本废弃、请勿使用。</strong></p>
</td>
<td class="cellrowborder" valign="top" width="7.5200000000000005%" headers="mcps1.1.5.1.3 "><p id="zh-cn_topic_0000002210480380_p11997521144017"><a name="zh-cn_topic_0000002210480380_p11997521144017"></a><a name="zh-cn_topic_0000002210480380_p11997521144017"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="6.950000000000001%" headers="mcps1.1.5.1.4 "><p id="zh-cn_topic_0000002210480380_p79971521174020"><a name="zh-cn_topic_0000002210480380_p79971521174020"></a><a name="zh-cn_topic_0000002210480380_p79971521174020"></a>graph</p>
</td>
</tr>
</tbody>
</table>

