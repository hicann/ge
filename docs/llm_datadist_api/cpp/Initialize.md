# Initialize<a name="ZH-CN_TOPIC_0000002374103410"></a>

## 产品支持情况<a name="section8178181118225"></a>

<a name="zh-cn_topic_0000002407583129_table38301303189"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000002407583129_row20831180131817"><th class="cellrowborder" valign="top" width="57.99999999999999%" id="mcps1.1.3.1.1"><p id="zh-cn_topic_0000002407583129_p1883113061818"><a name="zh-cn_topic_0000002407583129_p1883113061818"></a><a name="zh-cn_topic_0000002407583129_p1883113061818"></a><span id="zh-cn_topic_0000002407583129_ph20833205312295"><a name="zh-cn_topic_0000002407583129_ph20833205312295"></a><a name="zh-cn_topic_0000002407583129_ph20833205312295"></a>产品</span></p>
</th>
<th class="cellrowborder" align="center" valign="top" width="42%" id="mcps1.1.3.1.2"><p id="zh-cn_topic_0000002407583129_p783113012187"><a name="zh-cn_topic_0000002407583129_p783113012187"></a><a name="zh-cn_topic_0000002407583129_p783113012187"></a>是否支持</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000002407583129_row220181016240"><td class="cellrowborder" valign="top" width="57.99999999999999%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002407583129_p48327011813"><a name="zh-cn_topic_0000002407583129_p48327011813"></a><a name="zh-cn_topic_0000002407583129_p48327011813"></a><span id="zh-cn_topic_0000002407583129_ph583230201815"><a name="zh-cn_topic_0000002407583129_ph583230201815"></a><a name="zh-cn_topic_0000002407583129_ph583230201815"></a><term id="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term1253731311225"><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term1253731311225"></a><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term1253731311225"></a>Atlas A3 训练系列产品</term>/<term id="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term12835255145414"><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term12835255145414"></a><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term12835255145414"></a>Atlas A3 推理系列产品</term></span></p>
</td>
<td class="cellrowborder" align="center" valign="top" width="42%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002407583129_p7948163910184"><a name="zh-cn_topic_0000002407583129_p7948163910184"></a><a name="zh-cn_topic_0000002407583129_p7948163910184"></a>√</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002407583129_row173226882415"><td class="cellrowborder" valign="top" width="57.99999999999999%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002407583129_p14832120181815"><a name="zh-cn_topic_0000002407583129_p14832120181815"></a><a name="zh-cn_topic_0000002407583129_p14832120181815"></a><span id="zh-cn_topic_0000002407583129_ph980713477118"><a name="zh-cn_topic_0000002407583129_ph980713477118"></a><a name="zh-cn_topic_0000002407583129_ph980713477118"></a><term id="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term454024162214"><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term454024162214"></a><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term454024162214"></a>Atlas A2 推理系列产品</term></span></p>
</td>
<td class="cellrowborder" align="center" valign="top" width="42%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002407583129_p19948143911820"><a name="zh-cn_topic_0000002407583129_p19948143911820"></a><a name="zh-cn_topic_0000002407583129_p19948143911820"></a>√</p>
</td>
</tr>
<tr id="zh-cn_topic_0000002407583129_row15882185517522"><td class="cellrowborder" valign="top" width="57.99999999999999%" headers="mcps1.1.3.1.1 "><p id="zh-cn_topic_0000002407583129_p1682479135314"><a name="zh-cn_topic_0000002407583129_p1682479135314"></a><a name="zh-cn_topic_0000002407583129_p1682479135314"></a><span id="zh-cn_topic_0000002407583129_ph14880920154918"><a name="zh-cn_topic_0000002407583129_ph14880920154918"></a><a name="zh-cn_topic_0000002407583129_ph14880920154918"></a><term id="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term16184138172215"><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term16184138172215"></a><a name="zh-cn_topic_0000002407583129_zh-cn_topic_0000001312391781_term16184138172215"></a>Atlas A2 训练系列产品</term></span></p>
</td>
<td class="cellrowborder" align="center" valign="top" width="42%" headers="mcps1.1.3.1.2 "><p id="zh-cn_topic_0000002407583129_p578615025316"><a name="zh-cn_topic_0000002407583129_p578615025316"></a><a name="zh-cn_topic_0000002407583129_p578615025316"></a>x</p>
</td>
</tr>
</tbody>
</table>

## 函数功能<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_section3729174918713"></a>

初始化LLM-DataDist。

## 函数原型<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_section84161445741"></a>

```
Status Initialize(const std::map<AscendString, AscendString> &options)
```

## 参数说明<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_section63604780"></a>

<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_table47561922"></a>
<table><thead align="left"><tr id="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_row29169897"><th class="cellrowborder" valign="top" width="27.63%" id="mcps1.1.4.1.1"><p id="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p13951479"><a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p13951479"></a><a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p13951479"></a>参数名</p>
</th>
<th class="cellrowborder" valign="top" width="27.900000000000002%" id="mcps1.1.4.1.2"><p id="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p56327989"><a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p56327989"></a><a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p56327989"></a>输入/输出</p>
</th>
<th class="cellrowborder" valign="top" width="44.47%" id="mcps1.1.4.1.3"><p id="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p66531170"><a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p66531170"></a><a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_zh-cn_topic_0182636394_p66531170"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="zh-cn_topic_0000001461072801_row17754717144"><td class="cellrowborder" valign="top" width="27.63%" headers="mcps1.1.4.1.1 "><p id="zh-cn_topic_0000001461072801_p16786142181615"><a name="zh-cn_topic_0000001461072801_p16786142181615"></a><a name="zh-cn_topic_0000001461072801_p16786142181615"></a>options</p>
</td>
<td class="cellrowborder" valign="top" width="27.900000000000002%" headers="mcps1.1.4.1.2 "><p id="zh-cn_topic_0000001461072801_p177869428168"><a name="zh-cn_topic_0000001461072801_p177869428168"></a><a name="zh-cn_topic_0000001461072801_p177869428168"></a>输入</p>
</td>
<td class="cellrowborder" valign="top" width="44.47%" headers="mcps1.1.4.1.3 "><p id="zh-cn_topic_0000001461072801_p14787174219161"><a name="zh-cn_topic_0000001461072801_p14787174219161"></a><a name="zh-cn_topic_0000001461072801_p14787174219161"></a>初始化参数值。具体请参考<a href="#table8396338161010">表1</a>。</p>
</td>
</tr>
</tbody>
</table>

**表 1**  options

<a name="table8396338161010"></a>
<table><thead align="left"><tr id="row739693821013"><th class="cellrowborder" valign="top" width="27.54%" id="mcps1.2.4.1.1"><p id="p18396238171019"><a name="p18396238171019"></a><a name="p18396238171019"></a>参数名</p>
</th>
<th class="cellrowborder" valign="top" width="13.100000000000001%" id="mcps1.2.4.1.2"><p id="p6396163811103"><a name="p6396163811103"></a><a name="p6396163811103"></a>可选/必选</p>
</th>
<th class="cellrowborder" valign="top" width="59.36%" id="mcps1.2.4.1.3"><p id="p153965385101"><a name="p153965385101"></a><a name="p153965385101"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row24374561993"><td class="cellrowborder" valign="top" width="27.54%" headers="mcps1.2.4.1.1 "><p id="p134383568918"><a name="p134383568918"></a><a name="p134383568918"></a>OPTION_LISTEN_IP_INFO</p>
</td>
<td class="cellrowborder" valign="top" width="13.100000000000001%" headers="mcps1.2.4.1.2 "><p id="p16438125619917"><a name="p16438125619917"></a><a name="p16438125619917"></a>Pormpt必选</p>
</td>
<td class="cellrowborder" valign="top" width="59.36%" headers="mcps1.2.4.1.3 "><p id="p6767144812213"><a name="p6767144812213"></a><a name="p6767144812213"></a>表示Device侧的IP地址和端口。</p>
<p id="p4913155192718"><a name="p4913155192718"></a><a name="p4913155192718"></a>配置示例：如"192.168.1.1:26000"，单进程多卡场景，传入多个时使用英文分号分割。</p>
</td>
</tr>
<tr id="row92022108110"><td class="cellrowborder" valign="top" width="27.54%" headers="mcps1.2.4.1.1 "><p id="p33441120414"><a name="p33441120414"></a><a name="p33441120414"></a>OPTION_DEVICE_ID</p>
</td>
<td class="cellrowborder" valign="top" width="13.100000000000001%" headers="mcps1.2.4.1.2 "><p id="p882672716113"><a name="p882672716113"></a><a name="p882672716113"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="59.36%" headers="mcps1.2.4.1.3 "><p id="p1082619275117"><a name="p1082619275117"></a><a name="p1082619275117"></a>设置当前进程的Device ID，如"0"，单进程多卡场景，传入多个时使用英文分号分割。</p>
</td>
</tr>
<tr id="row171171314519"><td class="cellrowborder" valign="top" width="27.54%" headers="mcps1.2.4.1.1 "><p id="p6344132018110"><a name="p6344132018110"></a><a name="p6344132018110"></a>OPTION_SYNC_CACHE_WAIT_TIME</p>
</td>
<td class="cellrowborder" valign="top" width="13.100000000000001%" headers="mcps1.2.4.1.2 "><p id="p7826327710"><a name="p7826327710"></a><a name="p7826327710"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="59.36%" headers="mcps1.2.4.1.3 "><p id="p1982682716111"><a name="p1982682716111"></a><a name="p1982682716111"></a>kv相关操作的超时时间，单位：ms。不配置默认为1000ms。相关接口如下。</p>
<a name="ul024317191379"></a><a name="ul024317191379"></a><ul id="ul024317191379"><li><a href="AllocateCache.md">AllocateCache</a></li><li><a href="DeallocateCache.md">DeallocateCache</a></li><li><a href="PullKvCache.md">PullKvCache</a></li><li><a href="PullKvBlocks.md">PullKvBlocks</a></li><li><a href="CopyKvCache.md">CopyKvCache</a></li><li><a href="CopyKvBlocks.md">CopyKvBlocks</a></li><li><a href="PushKvCache.md">PushKvCache</a></li><li><a href="PushKvBlocks.md">PushKvBlocks</a></li></ul>
</td>
</tr>
<tr id="row5107157318"><td class="cellrowborder" valign="top" width="27.54%" headers="mcps1.2.4.1.1 "><p id="p3344162019119"><a name="p3344162019119"></a><a name="p3344162019119"></a>OPTION_BUF_POOL_CFG</p>
</td>
<td class="cellrowborder" valign="top" width="13.100000000000001%" headers="mcps1.2.4.1.2 "><p id="p17826227913"><a name="p17826227913"></a><a name="p17826227913"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="59.36%" headers="mcps1.2.4.1.3 "><p id="p2825732687"><a name="p2825732687"></a><a name="p2825732687"></a>配置内存池大小与档位信息，提高内存申请性能和使用率。格式为json string，字段含义见<a href="#table75421185315">表2</a>，使用示例如下所示。</p>
<a name="screen98021133115418"></a><a name="screen98021133115418"></a><pre class="screen" codetype="Cpp" id="screen98021133115418">{
"buf_cfg":[{"total_size":2097152,"blk_size":256,"max_buf_size":8192}],
"buf_pool_size": 2147483648
}</pre>
</td>
</tr>
<tr id="row10515341114"><td class="cellrowborder" valign="top" width="27.54%" headers="mcps1.2.4.1.1 "><p id="p1190485118212"><a name="p1190485118212"></a><a name="p1190485118212"></a>OPTION_ENABLE_SET_ROLE</p>
</td>
<td class="cellrowborder" valign="top" width="13.100000000000001%" headers="mcps1.2.4.1.2 "><p id="p1668349115"><a name="p1668349115"></a><a name="p1668349115"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="59.36%" headers="mcps1.2.4.1.3 "><p id="p1243916451149"><a name="p1243916451149"></a><a name="p1243916451149"></a>配置是否支持角色平滑切换。取值如下。</p>
<a name="ul164452351351"></a><a name="ul164452351351"></a><ul id="ul164452351351"><li>1：支持。</li><li>0：不支持，不配置默认为不支持。</li></ul>
<p id="p0611341110"><a name="p0611341110"></a><a name="p0611341110"></a>相关接口：<a href="SetRole.md">SetRole</a>。</p>
</td>
</tr>
</tbody>
</table>

**表 2**  OPTION\_BUF\_POOL\_CFG配置

<a name="table75421185315"></a>
<table><thead align="left"><tr id="row1851521195315"><th class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.2.4.1.1"><p id="p86891525195314"><a name="p86891525195314"></a><a name="p86891525195314"></a>配置项</p>
</th>
<th class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.2.4.1.2"><p id="p26891425185311"><a name="p26891425185311"></a><a name="p26891425185311"></a>可选/必选</p>
</th>
<th class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.2.4.1.3"><p id="p0689162555312"><a name="p0689162555312"></a><a name="p0689162555312"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row1655214530"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.1 "><p id="p19592175314"><a name="p19592175314"></a><a name="p19592175314"></a>buf_cfg</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.2 "><p id="p5510214536"><a name="p5510214536"></a><a name="p5510214536"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.3 "><p id="p10517213532"><a name="p10517213532"></a><a name="p10517213532"></a>内存池档位配置，详见<a href="#table146612414525">表3</a>。</p>
</td>
</tr>
<tr id="row14552185320"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.1 "><p id="p105721105317"><a name="p105721105317"></a><a name="p105721105317"></a>buf_pool_size</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.2 "><p id="p7514214533"><a name="p7514214533"></a><a name="p7514214533"></a>可选</p>
</td>
<td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.3 "><p id="p15512217538"><a name="p15512217538"></a><a name="p15512217538"></a>内存池大小，单位为byte。</p>
</td>
</tr>
</tbody>
</table>

**表 3**  buf\_cfg配置

<a name="table146612414525"></a>
<table><thead align="left"><tr id="row6661134155218"><th class="cellrowborder" valign="top" width="33.33333333333333%" id="mcps1.2.4.1.1"><p id="p1945121135220"><a name="p1945121135220"></a><a name="p1945121135220"></a>配置项</p>
</th>
<th class="cellrowborder" valign="top" width="35.12351235123513%" id="mcps1.2.4.1.2"><p id="p5451611105216"><a name="p5451611105216"></a><a name="p5451611105216"></a>可选/必选</p>
</th>
<th class="cellrowborder" valign="top" width="31.543154315431543%" id="mcps1.2.4.1.3"><p id="p1645111175210"><a name="p1645111175210"></a><a name="p1645111175210"></a>描述</p>
</th>
</tr>
</thead>
<tbody><tr id="row1266115415218"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.1 "><p id="p6795123015219"><a name="p6795123015219"></a><a name="p6795123015219"></a>total_size</p>
</td>
<td class="cellrowborder" valign="top" width="35.12351235123513%" headers="mcps1.2.4.1.2 "><p id="p18795173025219"><a name="p18795173025219"></a><a name="p18795173025219"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="31.543154315431543%" headers="mcps1.2.4.1.3 "><p id="p1679523095211"><a name="p1679523095211"></a><a name="p1679523095211"></a>当前档位内存池的大小，单位byte。</p>
<div class="note" id="note1812931418578"><a name="note1812931418578"></a><a name="note1812931418578"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p16129141435713"><a name="p16129141435713"></a><a name="p16129141435713"></a>total_size是2M的倍数，且total_size是blk_size的倍数，最大值不应超过0xFFFFFFFF。</p>
</div></div>
</td>
</tr>
<tr id="row1066117435217"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.1 "><p id="p12795630165210"><a name="p12795630165210"></a><a name="p12795630165210"></a>blk_size</p>
</td>
<td class="cellrowborder" valign="top" width="35.12351235123513%" headers="mcps1.2.4.1.2 "><p id="p187951930105216"><a name="p187951930105216"></a><a name="p187951930105216"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="31.543154315431543%" headers="mcps1.2.4.1.3 "><p id="p14795630165216"><a name="p14795630165216"></a><a name="p14795630165216"></a>当前档位一次可以申请的最小内存值，单位byte。</p>
<div class="note" id="note13331492576"><a name="note13331492576"></a><a name="note13331492576"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p83354914574"><a name="p83354914574"></a><a name="p83354914574"></a>要求满足2^n，且在(0,2M]之间，小于或等于max_buf_size。</p>
</div></div>
</td>
</tr>
<tr id="row966822375211"><td class="cellrowborder" valign="top" width="33.33333333333333%" headers="mcps1.2.4.1.1 "><p id="p179573010527"><a name="p179573010527"></a><a name="p179573010527"></a>max_buf_size</p>
</td>
<td class="cellrowborder" valign="top" width="35.12351235123513%" headers="mcps1.2.4.1.2 "><p id="p7796123016524"><a name="p7796123016524"></a><a name="p7796123016524"></a>必选</p>
</td>
<td class="cellrowborder" valign="top" width="31.543154315431543%" headers="mcps1.2.4.1.3 "><p id="p479618307523"><a name="p479618307523"></a><a name="p479618307523"></a>当前档位一次可以申请的最大内存值，单位byte。</p>
<div class="note" id="note3728111235815"><a name="note3728111235815"></a><a name="note3728111235815"></a><span class="notetitle"> 说明： </span><div class="notebody"><p id="p1677315238589"><a name="p1677315238589"></a><a name="p1677315238589"></a>小于total_size，max_buf_size必须保持严格递增。</p>
</div></div>
</td>
</tr>
</tbody>
</table>

## 返回值<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_section413535858"></a>

-   LLM\_SUCCESS：成功
-   LLM\_PARAM\_INVALID：参数错误
-   其他：失败

## 异常处理<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_section1548781517515"></a>

无

## 约束说明<a name="zh-cn_topic_0000001461072801_zh-cn_topic_0000001265240866_section2021419196520"></a>

需要和[Finalize](Finalize.md)配对使用，初始化成功后，任何退出前都需要调用[Finalize](Finalize.md)保证资源释放，否则会出现资源释放顺序不符合预期而导致问题。

